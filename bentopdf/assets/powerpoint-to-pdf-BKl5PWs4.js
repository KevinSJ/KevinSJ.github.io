const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jszip.min-3IPKxw9h.js","assets/main-DWubsKaN.js","assets/style-CYUbkObH.js","assets/style-BSB0ervv.css","assets/_commonjs-dynamic-modules-TDtrdbi3.js"])))=>i.map(i=>d[i]);
import{c as C,i as I}from"./style-CYUbkObH.js";import"./version-BHeJdyYx.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-Q5E4PlzL.js";import{s as t,a as p,h as u,b as v,d as P,_ as D,f as k}from"./main-DWubsKaN.js";import{g as T}from"./libreoffice-loader-CCIf03AR.js";import"./mobileMenu-BoMunYmR.js";document.addEventListener("DOMContentLoaded",()=>{t.files=[];const c=document.getElementById("file-input"),r=document.getElementById("drop-zone"),g=document.getElementById("convert-options"),d=document.getElementById("file-display-area"),f=document.getElementById("file-controls"),E=document.getElementById("add-more-btn"),L=document.getElementById("clear-files-btn"),b=document.getElementById("back-to-tools"),w=document.getElementById("process-btn");b&&b.addEventListener("click",()=>{window.location.href="/bentopdf/"});const m=async()=>{if(g)if(t.files.length>0){if(d){d.innerHTML="";for(let e=0;e<t.files.length;e++){const s=t.files[e],i=document.createElement("div");i.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const o=document.createElement("div");o.className="flex flex-col overflow-hidden";const n=document.createElement("div");n.className="truncate font-medium text-gray-200 text-sm mb-1",n.textContent=s.name;const a=document.createElement("div");a.className="text-xs text-gray-400",a.textContent=k(s.size),o.append(n,a);const l=document.createElement("button");l.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",l.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',l.onclick=()=>{t.files=t.files.filter((x,y)=>y!==e),m()},i.append(o,l),d.appendChild(i)}C({icons:I})}f&&f.classList.remove("hidden"),g.classList.remove("hidden")}else d&&(d.innerHTML=""),f&&f.classList.add("hidden"),g.classList.add("hidden")},h=()=>{t.files=[],t.pdfDoc=null,m()},_=async()=>{try{if(t.files.length===0){p("No Files","Please select at least one PowerPoint file."),u();return}const e=T();if(await e.initialize(s=>{v(s.message,s.percent)}),t.files.length===1){const s=t.files[0];v("Processing...");const i=await e.convertToPdf(s),o=s.name.replace(/\.(ppt|pptx|odp)$/i,"")+".pdf";P(i,o),u(),p("Conversion Complete",`Successfully converted ${s.name} to PDF.`,"success",()=>h())}else{v("Processing...");const s=(await D(async()=>{const{default:n}=await import("./jszip.min-3IPKxw9h.js").then(a=>a.j);return{default:n}},__vite__mapDeps([0,1,2,3,4]))).default,i=new s;for(let n=0;n<t.files.length;n++){const a=t.files[n];v(`Converting ${n+1}/${t.files.length}: ${a.name}...`);const l=await e.convertToPdf(a),x=a.name.replace(/\.(ppt|pptx|odp)$/i,""),y=await l.arrayBuffer();i.file(`${x}.pdf`,y)}const o=await i.generateAsync({type:"blob"});P(o,"powerpoint-converted.zip"),u(),p("Conversion Complete",`Successfully converted ${t.files.length} PowerPoint file(s) to PDF.`,"success",()=>h())}}catch(e){u(),p("Error",`An error occurred during conversion. Error: ${e.message}`)}},B=e=>{e&&e.length>0&&(t.files=[...t.files,...Array.from(e)],m())};c&&r&&(c.addEventListener("change",e=>{B(e.target.files)}),r.addEventListener("dragover",e=>{e.preventDefault(),r.classList.add("bg-gray-700")}),r.addEventListener("dragleave",e=>{e.preventDefault(),r.classList.remove("bg-gray-700")}),r.addEventListener("drop",e=>{e.preventDefault(),r.classList.remove("bg-gray-700");const s=e.dataTransfer?.files;if(s&&s.length>0){const i=Array.from(s).filter(o=>{const n=o.name.toLowerCase();return n.endsWith(".ppt")||n.endsWith(".pptx")||n.endsWith(".odp")});if(i.length>0){const o=new DataTransfer;i.forEach(n=>o.items.add(n)),B(o.files)}}}),c.addEventListener("click",()=>{c.value=""})),E&&E.addEventListener("click",()=>{c.click()}),L&&L.addEventListener("click",()=>{h()}),w&&w.addEventListener("click",_),m()});
