import{c as h,i as x}from"./style-D1FQfXNQ.js";import"./version-Dw8ZKLCV.js";import"./simple-mode-footer-D78rH_WB.js";import{m as L,n as k,a as m,b as g,d as y,h as B,f as I}from"./main-Da82M_MD.js";import{J as C}from"./jszip.min-DQhFtpFI.js";import"./mobileMenu-BoMunYmR.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";const E=new L(k("pymupdf"));let d=null;const w=()=>{const o=document.getElementById("file-display-area"),n=document.getElementById("options-panel");if(!(!o||!n))if(o.innerHTML="",d){n.classList.remove("hidden");const a=document.createElement("div");a.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const s=document.createElement("div");s.className="flex flex-col overflow-hidden";const c=document.createElement("div");c.className="truncate font-medium text-gray-200 text-sm mb-1",c.textContent=d.name;const e=document.createElement("div");e.className="text-xs text-gray-400",e.textContent=I(d.size),s.append(c,e);const t=document.createElement("button");t.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",t.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',t.onclick=v,a.append(s,t),o.appendChild(a),h({icons:x})}else n.classList.add("hidden")},v=()=>{d=null;const o=document.getElementById("file-input");o&&(o.value=""),w()};function b(o){return o.map(n=>n.map(a=>{const s=a??"";return s.includes(",")||s.includes('"')||s.includes(`
`)?`"${s.replace(/"/g,'""')}"`:s}).join(",")).join(`
`)}async function $(){if(!d){m("No File","Please upload a PDF file first.");return}const o=document.querySelectorAll('input[name="export-format"]');let n="csv";o.forEach(a=>{a.checked&&(n=a.value)}),g("Loading Engine...");try{await E.load(),g("Extracting tables...");const a=await E.open(d),s=a.pageCount,c=d.name.replace(/\.[^/.]+$/,""),e=[];for(let t=0;t<s;t++)g(`Scanning page ${t+1} of ${s}...`),a.getPage(t).findTables().forEach((l,f)=>{e.push({page:t+1,tableIndex:f+1,rows:l.rows,markdown:l.markdown,rowCount:l.rowCount,colCount:l.colCount})});if(e.length===0){m("No Tables Found","No tables were detected in this PDF.");return}if(e.length===1){const t=e[0];let i,r,l;n==="csv"?(i=b(t.rows),r="csv",l="text/csv"):n==="json"?(i=JSON.stringify(t.rows,null,2),r="json",l="application/json"):(i=t.markdown,r="md",l="text/markdown");const f=new Blob([i],{type:l});y(f,`${c}_table.${r}`),m("Success","Extracted 1 table successfully!","success",v)}else{g("Creating ZIP file...");const t=new C;e.forEach((r,l)=>{const f=`table_${l+1}_page${r.page}`;let u,p;n==="csv"?(u=b(r.rows),p="csv"):n==="json"?(u=JSON.stringify(r.rows,null,2),p="json"):(u=r.markdown,p="md"),t.file(`${f}.${p}`,u)});const i=await t.generateAsync({type:"blob"});y(i,`${c}_tables.zip`),m("Success",`Extracted ${e.length} tables successfully!`,"success",v)}}catch(a){console.error(a);const s=a instanceof Error?a.message:"Unknown error";m("Error",`Failed to extract tables. ${s}`)}finally{B()}}document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("file-input"),n=document.getElementById("drop-zone"),a=document.getElementById("process-btn"),s=document.getElementById("back-to-tools");s&&s.addEventListener("click",()=>{window.location.href="/"});const c=e=>{if(!e||e.length===0)return;const t=Array.from(e).find(i=>i.type==="application/pdf");if(!t){m("Invalid File","Please upload a PDF file.");return}d=t,w()};o&&n&&(o.addEventListener("change",e=>{c(e.target.files)}),n.addEventListener("dragover",e=>{e.preventDefault(),n.classList.add("bg-gray-700")}),n.addEventListener("dragleave",e=>{e.preventDefault(),n.classList.remove("bg-gray-700")}),n.addEventListener("drop",e=>{e.preventDefault(),n.classList.remove("bg-gray-700"),c(e.dataTransfer?.files??null)}),o.addEventListener("click",()=>{o.value=""})),a&&a.addEventListener("click",$)});
