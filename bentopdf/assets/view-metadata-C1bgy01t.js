import{c as v,i as L}from"./style-D1FQfXNQ.js";import"./version-Dw8ZKLCV.js";import"./simple-mode-footer-D78rH_WB.js";import{a as x,f as N,b as C,c as M,h as I,z as S}from"./main-Da82M_MD.js";import"./mobileMenu-BoMunYmR.js";const m={file:null,metadata:{}};function D(){m.file=null,m.metadata={};const e=document.getElementById("file-display-area");e&&(e.innerHTML="");const t=document.getElementById("tool-options");t&&t.classList.add("hidden");const n=document.getElementById("metadata-display");n&&(n.innerHTML="");const a=document.getElementById("file-input");a&&(a.value="")}function h(e){const t=document.createElement("div");t.className="mb-6";const n=document.createElement("h3");n.className="text-lg font-semibold text-white mb-2",n.textContent=e;const a=document.createElement("ul");return a.className="space-y-3 text-sm bg-gray-900 p-4 rounded-lg border border-gray-700",t.append(n,a),{wrapper:t,ul:a}}function b(e,t){const n=document.createElement("li");n.className="flex flex-col sm:flex-row";const a=document.createElement("strong");a.className="w-40 flex-shrink-0 text-gray-400",a.textContent=e;const o=document.createElement("div");return o.className="flex-grow text-white break-all",o.textContent=t,n.append(a,o),n}function T(e){if(!e||typeof e!="string"||!e.startsWith("D:"))return String(e||"");try{const t=e.substring(2,6),n=e.substring(6,8),a=e.substring(8,10),o=e.substring(10,12),i=e.substring(12,14),s=e.substring(14,16);return new Date(`${t}-${n}-${a}T${o}:${i}:${s}Z`).toLocaleString()}catch{return e}}function E(e,t,n=0){const a=document.createElement("li");a.className="flex flex-col sm:flex-row";const o=document.createElement("strong");o.className="w-56 flex-shrink-0 text-gray-400",o.textContent=e,o.style.paddingLeft=`${n*1.2}rem`;const i=document.createElement("div");return i.className="flex-grow text-white break-all",i.textContent=t,a.append(o,i),a}function B(e,t=0){const n=document.createElement("li");n.className="flex pt-2";const a=document.createElement("strong");return a.className="w-full flex-shrink-0 text-gray-300 font-medium",a.textContent=e,a.style.paddingLeft=`${t*1.2}rem`,n.append(a),n}function u(e,t,n){const a=["xap:CreateDate","xap:ModifyDate","xap:MetadataDate"],o=Array.from(e.children);for(const i of o){if(i.nodeType!==1)continue;let s=i.tagName;const c=Array.from(i.children).filter(function(f){return f.nodeType===1});if(s==="rdf:li"){u(i,t,n);continue}if(s==="rdf:Alt"&&(s="(alt container)"),i.getAttribute("rdf:parseType")==="Resource"&&c.length===0){t.appendChild(E(s,"(Empty Resource)",n));continue}if(c.length>0)t.appendChild(B(s,n)),u(i,t,n+1);else{let f=(i.textContent||"").trim();f&&(a.includes(s)&&(f=S(f)),t.appendChild(E(s,f,n)))}}}async function k(){const e=document.getElementById("metadata-display");if(!(!e||!m.file)){e.innerHTML="",m.metadata={},C("Analyzing full PDF metadata...");try{const t=await m.file.arrayBuffer(),n=await M({data:t}).promise,[a,o]=await Promise.all([n.getMetadata(),n.getFieldObjects()]),{info:i,metadata:s}=a,c=s?s.getRaw():null,f=h("Info Dictionary");if(i&&Object.keys(i).length>0)for(const d in i){const r=i[d];let l;if(r===null||typeof r>"u")l="- Not Set -";else if(typeof r=="object"&&r!==null&&"name"in r)l=String(r.name);else if(typeof r=="object")try{l=JSON.stringify(r)}catch{l="[object Object]"}else(d==="CreationDate"||d==="ModDate")&&typeof r=="string"?l=T(r):l=String(r);m.metadata[d]=l,f.ul.appendChild(b(d,l))}else f.ul.innerHTML='<li><span class="text-gray-500 italic">- No Info Dictionary data found -</span></li>';e.appendChild(f.wrapper);const g=h("Interactive Form Fields");if(o&&Object.keys(o).length>0)for(const d in o){const l=o[d][0].fieldValue||"- Not Set -";g.ul.appendChild(b(d,String(l)))}else g.ul.innerHTML='<li><span class="text-gray-500 italic">- No interactive form fields found -</span></li>';e.appendChild(g.wrapper);const p=h("XMP Metadata");if(c)try{const r=new DOMParser().parseFromString(c,"application/xml"),l=r.getElementsByTagName("rdf:Description");if(l.length>0)for(let y=0;y<l.length;y++)u(l[y],p.ul,0);else u(r.documentElement,p.ul,0);p.ul.children.length===0&&(p.ul.innerHTML='<li><span class="text-gray-500 italic">- No parseable XMP properties found -</span></li>')}catch(d){console.error("Failed to parse XMP XML:",d),p.ul.innerHTML='<li><span class="text-red-500 italic">- Error parsing XMP XML. Displaying raw. -</span></li>';const r=document.createElement("pre");r.className="text-xs text-gray-300 whitespace-pre-wrap break-all",r.textContent=c,p.ul.appendChild(r)}else p.ul.innerHTML='<li><span class="text-gray-500 italic">- No XMP metadata found -</span></li>';e.appendChild(p.wrapper),v({icons:L})}catch(t){console.error("Failed to view metadata or fields:",t),x("Error","Could not fully analyze the PDF. It may be corrupted or have an unusual structure.")}finally{I()}}}async function F(){const e=document.getElementById("file-display-area"),t=document.getElementById("tool-options");if(e)if(e.innerHTML="",m.file){const n=document.createElement("div");n.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const a=document.createElement("div");a.className="flex flex-col overflow-hidden";const o=document.createElement("div");o.className="truncate font-medium text-gray-200 text-sm mb-1",o.textContent=m.file.name;const i=document.createElement("div");i.className="text-xs text-gray-400",i.textContent=`${N(m.file.size)}`,a.append(o,i);const s=document.createElement("button");s.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",s.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',s.onclick=function(){D()},n.append(a,s),e.appendChild(n),v({icons:L}),await k(),t&&t.classList.remove("hidden")}else t&&t.classList.add("hidden")}function O(){const e=JSON.stringify(m.metadata,null,2);navigator.clipboard.writeText(e).then(function(){x("Copied","Metadata copied to clipboard as JSON.")}).catch(function(t){console.error("Failed to copy:",t),x("Error","Failed to copy metadata to clipboard.")})}function w(e){if(e&&e.length>0){const t=e[0];(t.type==="application/pdf"||t.name.toLowerCase().endsWith(".pdf"))&&(m.file=t,F())}}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("file-input"),t=document.getElementById("drop-zone"),n=document.getElementById("copy-metadata"),a=document.getElementById("back-to-tools");a&&a.addEventListener("click",function(){window.location.href="/"}),e&&t&&(e.addEventListener("change",function(o){w(o.target.files)}),t.addEventListener("dragover",function(o){o.preventDefault(),t.classList.add("bg-gray-700")}),t.addEventListener("dragleave",function(o){o.preventDefault(),t.classList.remove("bg-gray-700")}),t.addEventListener("drop",function(o){o.preventDefault(),t.classList.remove("bg-gray-700");const i=o.dataTransfer?.files;if(i&&i.length>0){const s=Array.from(i).filter(function(c){return c.type==="application/pdf"||c.name.toLowerCase().endsWith(".pdf")});if(s.length>0){const c=new DataTransfer;c.items.add(s[0]),w(c.files)}}}),e.addEventListener("click",function(){e.value=""})),n&&n.addEventListener("click",O)});
