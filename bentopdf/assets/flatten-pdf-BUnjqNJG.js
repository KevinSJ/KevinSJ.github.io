import{c as v,i as L}from"./style-D1FQfXNQ.js";import"./version-Dw8ZKLCV.js";import"./simple-mode-footer-D78rH_WB.js";import{a as f,r as m,P as u,d as p,f as B}from"./main-Da82M_MD.js";import{J as w}from"./jszip.min-DQhFtpFI.js";import"./mobileMenu-BoMunYmR.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";const l={files:[]};function g(e){e.getForm().flatten()}function h(){l.files=[];const e=document.getElementById("file-display-area");e&&(e.innerHTML="");const t=document.getElementById("tool-options");t&&t.classList.add("hidden");const n=document.getElementById("file-controls");n&&n.classList.add("hidden");const s=document.getElementById("file-input");s&&(s.value="")}async function E(){const e=document.getElementById("file-display-area"),t=document.getElementById("tool-options"),n=document.getElementById("file-controls");e&&(e.innerHTML="",l.files.length>0?(l.files.forEach((s,i)=>{const a=document.createElement("div");a.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const o=document.createElement("div");o.className="flex flex-col overflow-hidden";const d=document.createElement("div");d.className="truncate font-medium text-gray-200 text-sm mb-1",d.textContent=s.name;const r=document.createElement("div");r.className="text-xs text-gray-400",r.textContent=B(s.size),o.append(d,r);const c=document.createElement("button");c.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",c.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',c.onclick=function(){l.files.splice(i,1),E()},a.append(o,c),e.appendChild(a)}),v({icons:L}),t&&t.classList.remove("hidden"),n&&n.classList.remove("hidden")):(t&&t.classList.add("hidden"),n&&n.classList.add("hidden")))}function y(e){if(e&&e.length>0){const t=Array.from(e).filter(n=>n.type==="application/pdf"||n.name.toLowerCase().endsWith(".pdf"));t.length>0&&(l.files.push(...t),E())}}async function x(){if(l.files.length===0){f("No Files","Please select at least one PDF file.");return}const e=document.getElementById("loader-modal"),t=document.getElementById("loader-text");try{if(l.files.length===1){e&&e.classList.remove("hidden"),t&&(t.textContent="Flattening PDF...");const n=l.files[0],s=await m(n),i=await u.load(s,{ignoreEncryption:!0});try{g(i)}catch(o){if(!o.message.includes("getForm"))throw o}const a=await i.save();p(new Blob([a],{type:"application/pdf"}),`flattened_${n.name}`),e&&e.classList.add("hidden")}else{e&&e.classList.remove("hidden"),t&&(t.textContent="Flattening multiple PDFs...");const n=new w;let s=0;for(let i=0;i<l.files.length;i++){const a=l.files[i];t&&(t.textContent=`Flattening ${i+1}/${l.files.length}: ${a.name}...`);try{const o=await m(a),d=await u.load(o,{ignoreEncryption:!0});try{g(d)}catch(c){if(!c.message.includes("getForm"))throw c}const r=await d.save();n.file(`flattened_${a.name}`,r),s++}catch(o){console.error(`Error processing ${a.name}:`,o)}}if(s>0){const i=await n.generateAsync({type:"blob"});p(i,"flattened_pdfs.zip"),f("Success",`Processed ${s} PDFs.`,"success",()=>{h()})}else f("Error","No PDFs could be processed.");e&&e.classList.add("hidden")}}catch(n){console.error(n),e&&e.classList.add("hidden"),f("Error",n.message||"An unexpected error occurred.")}}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("file-input"),t=document.getElementById("drop-zone"),n=document.getElementById("process-btn"),s=document.getElementById("add-more-btn"),i=document.getElementById("clear-files-btn"),a=document.getElementById("back-to-tools");a&&a.addEventListener("click",function(){window.location.href="/"}),e&&t&&(e.addEventListener("change",function(o){y(o.target.files)}),t.addEventListener("dragover",function(o){o.preventDefault(),t.classList.add("bg-gray-700")}),t.addEventListener("dragleave",function(o){o.preventDefault(),t.classList.remove("bg-gray-700")}),t.addEventListener("drop",function(o){o.preventDefault(),t.classList.remove("bg-gray-700"),y(o.dataTransfer?.files)}),e.addEventListener("click",function(){e.value=""})),n&&n.addEventListener("click",x),s&&s.addEventListener("click",function(){e.value="",e.click()}),i&&i.addEventListener("click",function(){h()})});
