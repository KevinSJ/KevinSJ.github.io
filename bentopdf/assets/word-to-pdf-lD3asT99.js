const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jszip.min-3IPKxw9h.js","assets/main-DWubsKaN.js","assets/style-CYUbkObH.js","assets/style-BSB0ervv.css","assets/_commonjs-dynamic-modules-TDtrdbi3.js"])))=>i.map(i=>d[i]);
import{c as B,i as x}from"./style-CYUbkObH.js";import"./version-BHeJdyYx.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-Q5E4PlzL.js";import{s as t,a as g,h as u,b as v,d as W,_ as C,f as I}from"./main-DWubsKaN.js";import{g as z}from"./libreoffice-loader-CCIf03AR.js";import"./mobileMenu-BoMunYmR.js";document.addEventListener("DOMContentLoaded",()=>{t.files=[];const a=document.getElementById("file-input"),r=document.getElementById("drop-zone"),p=document.getElementById("convert-options"),d=document.getElementById("file-display-area"),f=document.getElementById("file-controls"),E=document.getElementById("add-more-btn"),P=document.getElementById("clear-files-btn"),D=document.getElementById("back-to-tools"),L=document.getElementById("process-btn");D&&D.addEventListener("click",()=>{window.location.href="/bentopdf/"});const m=async()=>{if(p)if(t.files.length>0){if(d){d.innerHTML="";for(let e=0;e<t.files.length;e++){const n=t.files[e],i=document.createElement("div");i.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const s=document.createElement("div");s.className="flex flex-col overflow-hidden";const o=document.createElement("div");o.className="truncate font-medium text-gray-200 text-sm mb-1",o.textContent=n.name;const l=document.createElement("div");l.className="text-xs text-gray-400",l.textContent=I(n.size),s.append(o,l);const c=document.createElement("button");c.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",c.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',c.onclick=()=>{t.files=t.files.filter((b,y)=>y!==e),m()},i.append(s,c),d.appendChild(i)}B({icons:x})}f&&f.classList.remove("hidden"),p.classList.remove("hidden")}else d&&(d.innerHTML=""),f&&f.classList.add("hidden"),p.classList.add("hidden")},h=()=>{t.files=[],t.pdfDoc=null,m()},w=async()=>{try{if(console.log("[Word2PDF] Starting conversion..."),console.log("[Word2PDF] Number of files:",t.files.length),t.files.length===0){g("No Files","Please select at least one Word document."),u();return}const e=z();if(console.log("[Word2PDF] Got converter instance"),console.log("[Word2PDF] Initializing LibreOffice..."),await e.initialize(n=>{console.log("[Word2PDF] Init progress:",n.percent+"%",n.message),v(n.message,n.percent)}),console.log("[Word2PDF] LibreOffice initialized successfully!"),t.files.length===1){const n=t.files[0];console.log("[Word2PDF] Converting single file:",n.name),v("Processing...");const i=await e.convertToPdf(n);console.log("[Word2PDF] Conversion complete! PDF size:",i.size);const s=n.name.replace(/\.(doc|docx|odt|rtf)$/i,"")+".pdf";W(i,s),console.log("[Word2PDF] File downloaded:",s),u(),g("Conversion Complete",`Successfully converted ${n.name} to PDF.`,"success",()=>h())}else{console.log("[Word2PDF] Converting multiple files:",t.files.length),v("Processing...");const n=(await C(async()=>{const{default:o}=await import("./jszip.min-3IPKxw9h.js").then(l=>l.j);return{default:o}},__vite__mapDeps([0,1,2,3,4]))).default,i=new n;for(let o=0;o<t.files.length;o++){const l=t.files[o];console.log(`[Word2PDF] Converting file ${o+1}/${t.files.length}:`,l.name),v(`Converting ${o+1}/${t.files.length}: ${l.name}...`);const c=await e.convertToPdf(l);console.log(`[Word2PDF] Converted ${l.name}, PDF size:`,c.size);const b=l.name.replace(/\.(doc|docx|odt|rtf)$/i,""),y=await c.arrayBuffer();i.file(`${b}.pdf`,y)}console.log("[Word2PDF] Generating ZIP file...");const s=await i.generateAsync({type:"blob"});console.log("[Word2PDF] ZIP size:",s.size),W(s,"word-converted.zip"),u(),g("Conversion Complete",`Successfully converted ${t.files.length} Word document(s) to PDF.`,"success",()=>h())}}catch(e){console.error("[Word2PDF] ERROR:",e),console.error("[Word2PDF] Error stack:",e.stack),u(),g("Error",`An error occurred during conversion. Error: ${e.message}`)}},F=e=>{e&&e.length>0&&(t.files=[...t.files,...Array.from(e)],m())};a&&r&&(a.addEventListener("change",e=>{F(e.target.files)}),r.addEventListener("dragover",e=>{e.preventDefault(),r.classList.add("bg-gray-700")}),r.addEventListener("dragleave",e=>{e.preventDefault(),r.classList.remove("bg-gray-700")}),r.addEventListener("drop",e=>{e.preventDefault(),r.classList.remove("bg-gray-700");const n=e.dataTransfer?.files;if(n&&n.length>0){const i=Array.from(n).filter(s=>{const o=s.name.toLowerCase();return o.endsWith(".doc")||o.endsWith(".docx")||o.endsWith(".odt")||o.endsWith(".rtf")});if(i.length>0){const s=new DataTransfer;i.forEach(o=>s.items.add(o)),F(s.files)}}}),a.addEventListener("click",()=>{a.value=""})),E&&E.addEventListener("click",()=>{a.click()}),P&&P.addEventListener("click",()=>{h()}),L&&L.addEventListener("click",w),m()});
