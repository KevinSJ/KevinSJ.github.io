import{K as We,p as ut,J as Pa,eE as dr,L as Va}from"./main-Da82M_MD.js";var _t,mr;function fe(){return mr||(mr=1,_t={options:{usePureJavaScript:!1}}),_t}var Nt={exports:{}},Rt,Er;function Oa(){if(Er)return Rt;Er=1;var i={};Rt=i;var e={};i.encode=function(y,N,S){if(typeof N!="string")throw new TypeError('"alphabet" must be a string.');if(S!==void 0&&typeof S!="number")throw new TypeError('"maxline" must be a number.');var h="";if(!(y instanceof Uint8Array))h=a(y,N);else{var t=0,C=N.length,l=N.charAt(0),x=[0];for(t=0;t<y.length;++t){for(var k=0,E=y[t];k<x.length;++k)E+=x[k]<<8,x[k]=E%C,E=E/C|0;for(;E>0;)x.push(E%C),E=E/C|0}for(t=0;y[t]===0&&t<y.length-1;++t)h+=l;for(t=x.length-1;t>=0;--t)h+=N[x[t]]}if(S){var u=new RegExp(".{1,"+S+"}","g");h=h.match(u).join(`\r
`)}return h},i.decode=function(y,N){if(typeof y!="string")throw new TypeError('"input" must be a string.');if(typeof N!="string")throw new TypeError('"alphabet" must be a string.');var S=e[N];if(!S){S=e[N]=[];for(var h=0;h<N.length;++h)S[N.charCodeAt(h)]=h}y=y.replace(/\s/g,"");for(var t=N.length,C=N.charAt(0),l=[0],h=0;h<y.length;h++){var x=S[y.charCodeAt(h)];if(x===void 0)return;for(var k=0,E=x;k<l.length;++k)E+=l[k]*t,l[k]=E&255,E>>=8;for(;E>0;)l.push(E&255),E>>=8}for(var u=0;y[u]===C&&u<y.length-1;++u)l.push(0);return typeof We<"u"?We.from(l.reverse()):new Uint8Array(l.reverse())};function a(y,N){var S=0,h=N.length,t=N.charAt(0),C=[0];for(S=0;S<y.length();++S){for(var l=0,x=y.at(S);l<C.length;++l)x+=C[l]<<8,C[l]=x%h,x=x/h|0;for(;x>0;)C.push(x%h),x=x/h|0}var k="";for(S=0;y.at(S)===0&&S<y.length()-1;++S)k+=t;for(S=C.length-1;S>=0;--S)k+=N[C[S]];return k}return Rt}var xr;function de(){if(xr)return Nt.exports;xr=1;var i=fe(),e=Oa(),a=Nt.exports=i.util=i.util||{};(function(){if(typeof ut<"u"&&ut.nextTick&&!ut.browser){a.nextTick=ut.nextTick,typeof setImmediate=="function"?a.setImmediate=setImmediate:a.setImmediate=a.nextTick;return}if(typeof setImmediate=="function"){a.setImmediate=function(){return setImmediate.apply(void 0,arguments)},a.nextTick=function(n){return setImmediate(n)};return}if(a.setImmediate=function(n){setTimeout(n,0)},typeof window<"u"&&typeof window.postMessage=="function"){let n=function(r){if(r.source===window&&r.data===s){r.stopPropagation();var B=d.slice();d.length=0,B.forEach(function(D){D()})}};var s="forge.setImmediate",d=[];a.setImmediate=function(r){d.push(r),d.length===1&&window.postMessage(s,"*")},window.addEventListener("message",n,!0)}if(typeof MutationObserver<"u"){var p=Date.now(),I=!0,R=document.createElement("div"),d=[];new MutationObserver(function(){var r=d.slice();d.length=0,r.forEach(function(B){B()})}).observe(R,{attributes:!0});var c=a.setImmediate;a.setImmediate=function(r){Date.now()-p>15?(p=Date.now(),c(r)):(d.push(r),d.length===1&&R.setAttribute("a",I=!I))}}a.nextTick=a.setImmediate})(),a.isNodejs=typeof ut<"u"&&ut.versions&&ut.versions.node,a.globalScope=(function(){return a.isNodejs?Pa:typeof self>"u"?window:self})(),a.isArray=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"},a.isArrayBuffer=function(s){return typeof ArrayBuffer<"u"&&s instanceof ArrayBuffer},a.isArrayBufferView=function(s){return s&&a.isArrayBuffer(s.buffer)&&s.byteLength!==void 0};function y(s){if(!(s===8||s===16||s===24||s===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+s)}a.ByteBuffer=N;function N(s){if(this.data="",this.read=0,typeof s=="string")this.data=s;else if(a.isArrayBuffer(s)||a.isArrayBufferView(s))if(typeof We<"u"&&s instanceof We)this.data=s.toString("binary");else{var d=new Uint8Array(s);try{this.data=String.fromCharCode.apply(null,d)}catch{for(var p=0;p<d.length;++p)this.putByte(d[p])}}else(s instanceof N||typeof s=="object"&&typeof s.data=="string"&&typeof s.read=="number")&&(this.data=s.data,this.read=s.read);this._constructedStringLength=0}a.ByteStringBuffer=N;var S=4096;a.ByteStringBuffer.prototype._optimizeConstructedString=function(s){this._constructedStringLength+=s,this._constructedStringLength>S&&(this.data.substr(0,1),this._constructedStringLength=0)},a.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},a.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},a.ByteStringBuffer.prototype.putByte=function(s){return this.putBytes(String.fromCharCode(s))},a.ByteStringBuffer.prototype.fillWithByte=function(s,d){s=String.fromCharCode(s);for(var p=this.data;d>0;)d&1&&(p+=s),d>>>=1,d>0&&(s+=s);return this.data=p,this._optimizeConstructedString(d),this},a.ByteStringBuffer.prototype.putBytes=function(s){return this.data+=s,this._optimizeConstructedString(s.length),this},a.ByteStringBuffer.prototype.putString=function(s){return this.putBytes(a.encodeUtf8(s))},a.ByteStringBuffer.prototype.putInt16=function(s){return this.putBytes(String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},a.ByteStringBuffer.prototype.putInt24=function(s){return this.putBytes(String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},a.ByteStringBuffer.prototype.putInt32=function(s){return this.putBytes(String.fromCharCode(s>>24&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},a.ByteStringBuffer.prototype.putInt16Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255))},a.ByteStringBuffer.prototype.putInt24Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s>>16&255))},a.ByteStringBuffer.prototype.putInt32Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>24&255))},a.ByteStringBuffer.prototype.putInt=function(s,d){y(d);var p="";do d-=8,p+=String.fromCharCode(s>>d&255);while(d>0);return this.putBytes(p)},a.ByteStringBuffer.prototype.putSignedInt=function(s,d){return s<0&&(s+=2<<d-1),this.putInt(s,d)},a.ByteStringBuffer.prototype.putBuffer=function(s){return this.putBytes(s.getBytes())},a.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},a.ByteStringBuffer.prototype.getInt16=function(){var s=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,s},a.ByteStringBuffer.prototype.getInt24=function(){var s=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,s},a.ByteStringBuffer.prototype.getInt32=function(){var s=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,s},a.ByteStringBuffer.prototype.getInt16Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,s},a.ByteStringBuffer.prototype.getInt24Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,s},a.ByteStringBuffer.prototype.getInt32Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,s},a.ByteStringBuffer.prototype.getInt=function(s){y(s);var d=0;do d=(d<<8)+this.data.charCodeAt(this.read++),s-=8;while(s>0);return d},a.ByteStringBuffer.prototype.getSignedInt=function(s){var d=this.getInt(s),p=2<<s-2;return d>=p&&(d-=p<<1),d},a.ByteStringBuffer.prototype.getBytes=function(s){var d;return s?(s=Math.min(this.length(),s),d=this.data.slice(this.read,this.read+s),this.read+=s):s===0?d="":(d=this.read===0?this.data:this.data.slice(this.read),this.clear()),d},a.ByteStringBuffer.prototype.bytes=function(s){return typeof s>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+s)},a.ByteStringBuffer.prototype.at=function(s){return this.data.charCodeAt(this.read+s)},a.ByteStringBuffer.prototype.setAt=function(s,d){return this.data=this.data.substr(0,this.read+s)+String.fromCharCode(d)+this.data.substr(this.read+s+1),this},a.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},a.ByteStringBuffer.prototype.copy=function(){var s=a.createBuffer(this.data);return s.read=this.read,s},a.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},a.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},a.ByteStringBuffer.prototype.truncate=function(s){var d=Math.max(0,this.length()-s);return this.data=this.data.substr(this.read,d),this.read=0,this},a.ByteStringBuffer.prototype.toHex=function(){for(var s="",d=this.read;d<this.data.length;++d){var p=this.data.charCodeAt(d);p<16&&(s+="0"),s+=p.toString(16)}return s},a.ByteStringBuffer.prototype.toString=function(){return a.decodeUtf8(this.bytes())};function h(s,d){d=d||{},this.read=d.readOffset||0,this.growSize=d.growSize||1024;var p=a.isArrayBuffer(s),I=a.isArrayBufferView(s);if(p||I){p?this.data=new DataView(s):this.data=new DataView(s.buffer,s.byteOffset,s.byteLength),this.write="writeOffset"in d?d.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,s!=null&&this.putBytes(s),"writeOffset"in d&&(this.write=d.writeOffset)}a.DataBuffer=h,a.DataBuffer.prototype.length=function(){return this.write-this.read},a.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},a.DataBuffer.prototype.accommodate=function(s,d){if(this.length()>=s)return this;d=Math.max(d||this.growSize,s);var p=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),I=new Uint8Array(this.length()+d);return I.set(p),this.data=new DataView(I.buffer),this},a.DataBuffer.prototype.putByte=function(s){return this.accommodate(1),this.data.setUint8(this.write++,s),this},a.DataBuffer.prototype.fillWithByte=function(s,d){this.accommodate(d);for(var p=0;p<d;++p)this.data.setUint8(s);return this},a.DataBuffer.prototype.putBytes=function(s,d){if(a.isArrayBufferView(s)){var p=new Uint8Array(s.buffer,s.byteOffset,s.byteLength),I=p.byteLength-p.byteOffset;this.accommodate(I);var R=new Uint8Array(this.data.buffer,this.write);return R.set(p),this.write+=I,this}if(a.isArrayBuffer(s)){var p=new Uint8Array(s);this.accommodate(p.byteLength);var R=new Uint8Array(this.data.buffer);return R.set(p,this.write),this.write+=p.byteLength,this}if(s instanceof a.DataBuffer||typeof s=="object"&&typeof s.read=="number"&&typeof s.write=="number"&&a.isArrayBufferView(s.data)){var p=new Uint8Array(s.data.byteLength,s.read,s.length());this.accommodate(p.byteLength);var R=new Uint8Array(s.data.byteLength,this.write);return R.set(p),this.write+=p.byteLength,this}if(s instanceof a.ByteStringBuffer&&(s=s.data,d="binary"),d=d||"binary",typeof s=="string"){var c;if(d==="hex")return this.accommodate(Math.ceil(s.length/2)),c=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.hex.decode(s,c,this.write),this;if(d==="base64")return this.accommodate(Math.ceil(s.length/4)*3),c=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.base64.decode(s,c,this.write),this;if(d==="utf8"&&(s=a.encodeUtf8(s),d="binary"),d==="binary"||d==="raw")return this.accommodate(s.length),c=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.raw.decode(c),this;if(d==="utf16")return this.accommodate(s.length*2),c=new Uint16Array(this.data.buffer,this.write),this.write+=a.text.utf16.encode(c),this;throw new Error("Invalid encoding: "+d)}throw Error("Invalid parameter: "+s)},a.DataBuffer.prototype.putBuffer=function(s){return this.putBytes(s),s.clear(),this},a.DataBuffer.prototype.putString=function(s){return this.putBytes(s,"utf16")},a.DataBuffer.prototype.putInt16=function(s){return this.accommodate(2),this.data.setInt16(this.write,s),this.write+=2,this},a.DataBuffer.prototype.putInt24=function(s){return this.accommodate(3),this.data.setInt16(this.write,s>>8&65535),this.data.setInt8(this.write,s>>16&255),this.write+=3,this},a.DataBuffer.prototype.putInt32=function(s){return this.accommodate(4),this.data.setInt32(this.write,s),this.write+=4,this},a.DataBuffer.prototype.putInt16Le=function(s){return this.accommodate(2),this.data.setInt16(this.write,s,!0),this.write+=2,this},a.DataBuffer.prototype.putInt24Le=function(s){return this.accommodate(3),this.data.setInt8(this.write,s>>16&255),this.data.setInt16(this.write,s>>8&65535,!0),this.write+=3,this},a.DataBuffer.prototype.putInt32Le=function(s){return this.accommodate(4),this.data.setInt32(this.write,s,!0),this.write+=4,this},a.DataBuffer.prototype.putInt=function(s,d){y(d),this.accommodate(d/8);do d-=8,this.data.setInt8(this.write++,s>>d&255);while(d>0);return this},a.DataBuffer.prototype.putSignedInt=function(s,d){return y(d),this.accommodate(d/8),s<0&&(s+=2<<d-1),this.putInt(s,d)},a.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},a.DataBuffer.prototype.getInt16=function(){var s=this.data.getInt16(this.read);return this.read+=2,s},a.DataBuffer.prototype.getInt24=function(){var s=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,s},a.DataBuffer.prototype.getInt32=function(){var s=this.data.getInt32(this.read);return this.read+=4,s},a.DataBuffer.prototype.getInt16Le=function(){var s=this.data.getInt16(this.read,!0);return this.read+=2,s},a.DataBuffer.prototype.getInt24Le=function(){var s=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,s},a.DataBuffer.prototype.getInt32Le=function(){var s=this.data.getInt32(this.read,!0);return this.read+=4,s},a.DataBuffer.prototype.getInt=function(s){y(s);var d=0;do d=(d<<8)+this.data.getInt8(this.read++),s-=8;while(s>0);return d},a.DataBuffer.prototype.getSignedInt=function(s){var d=this.getInt(s),p=2<<s-2;return d>=p&&(d-=p<<1),d},a.DataBuffer.prototype.getBytes=function(s){var d;return s?(s=Math.min(this.length(),s),d=this.data.slice(this.read,this.read+s),this.read+=s):s===0?d="":(d=this.read===0?this.data:this.data.slice(this.read),this.clear()),d},a.DataBuffer.prototype.bytes=function(s){return typeof s>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+s)},a.DataBuffer.prototype.at=function(s){return this.data.getUint8(this.read+s)},a.DataBuffer.prototype.setAt=function(s,d){return this.data.setUint8(s,d),this},a.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},a.DataBuffer.prototype.copy=function(){return new a.DataBuffer(this)},a.DataBuffer.prototype.compact=function(){if(this.read>0){var s=new Uint8Array(this.data.buffer,this.read),d=new Uint8Array(s.byteLength);d.set(s),this.data=new DataView(d),this.write-=this.read,this.read=0}return this},a.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},a.DataBuffer.prototype.truncate=function(s){return this.write=Math.max(0,this.length()-s),this.read=Math.min(this.read,this.write),this},a.DataBuffer.prototype.toHex=function(){for(var s="",d=this.read;d<this.data.byteLength;++d){var p=this.data.getUint8(d);p<16&&(s+="0"),s+=p.toString(16)}return s},a.DataBuffer.prototype.toString=function(s){var d=new Uint8Array(this.data,this.read,this.length());if(s=s||"utf8",s==="binary"||s==="raw")return a.binary.raw.encode(d);if(s==="hex")return a.binary.hex.encode(d);if(s==="base64")return a.binary.base64.encode(d);if(s==="utf8")return a.text.utf8.decode(d);if(s==="utf16")return a.text.utf16.decode(d);throw new Error("Invalid encoding: "+s)},a.createBuffer=function(s,d){return d=d||"raw",s!==void 0&&d==="utf8"&&(s=a.encodeUtf8(s)),new a.ByteBuffer(s)},a.fillString=function(s,d){for(var p="";d>0;)d&1&&(p+=s),d>>>=1,d>0&&(s+=s);return p},a.xorBytes=function(s,d,p){for(var I="",R="",c="",n=0,r=0;p>0;--p,++n)R=s.charCodeAt(n)^d.charCodeAt(n),r>=10&&(I+=c,c="",r=0),c+=String.fromCharCode(R),++r;return I+=c,I},a.hexToBytes=function(s){var d="",p=0;for(s.length&!0&&(p=1,d+=String.fromCharCode(parseInt(s[0],16)));p<s.length;p+=2)d+=String.fromCharCode(parseInt(s.substr(p,2),16));return d},a.bytesToHex=function(s){return a.createBuffer(s).toHex()},a.int32ToBytes=function(s){return String.fromCharCode(s>>24&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255)};var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",C=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],l="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";a.encode64=function(s,d){for(var p="",I="",R,c,n,r=0;r<s.length;)R=s.charCodeAt(r++),c=s.charCodeAt(r++),n=s.charCodeAt(r++),p+=t.charAt(R>>2),p+=t.charAt((R&3)<<4|c>>4),isNaN(c)?p+="==":(p+=t.charAt((c&15)<<2|n>>6),p+=isNaN(n)?"=":t.charAt(n&63)),d&&p.length>d&&(I+=p.substr(0,d)+`\r
`,p=p.substr(d));return I+=p,I},a.decode64=function(s){s=s.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var d="",p,I,R,c,n=0;n<s.length;)p=C[s.charCodeAt(n++)-43],I=C[s.charCodeAt(n++)-43],R=C[s.charCodeAt(n++)-43],c=C[s.charCodeAt(n++)-43],d+=String.fromCharCode(p<<2|I>>4),R!==64&&(d+=String.fromCharCode((I&15)<<4|R>>2),c!==64&&(d+=String.fromCharCode((R&3)<<6|c)));return d},a.encodeUtf8=function(s){return unescape(encodeURIComponent(s))},a.decodeUtf8=function(s){return decodeURIComponent(escape(s))},a.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e.encode,decode:e.decode}},a.binary.raw.encode=function(s){return String.fromCharCode.apply(null,s)},a.binary.raw.decode=function(s,d,p){var I=d;I||(I=new Uint8Array(s.length)),p=p||0;for(var R=p,c=0;c<s.length;++c)I[R++]=s.charCodeAt(c);return d?R-p:I},a.binary.hex.encode=a.bytesToHex,a.binary.hex.decode=function(s,d,p){var I=d;I||(I=new Uint8Array(Math.ceil(s.length/2))),p=p||0;var R=0,c=p;for(s.length&1&&(R=1,I[c++]=parseInt(s[0],16));R<s.length;R+=2)I[c++]=parseInt(s.substr(R,2),16);return d?c-p:I},a.binary.base64.encode=function(s,d){for(var p="",I="",R,c,n,r=0;r<s.byteLength;)R=s[r++],c=s[r++],n=s[r++],p+=t.charAt(R>>2),p+=t.charAt((R&3)<<4|c>>4),isNaN(c)?p+="==":(p+=t.charAt((c&15)<<2|n>>6),p+=isNaN(n)?"=":t.charAt(n&63)),d&&p.length>d&&(I+=p.substr(0,d)+`\r
`,p=p.substr(d));return I+=p,I},a.binary.base64.decode=function(s,d,p){var I=d;I||(I=new Uint8Array(Math.ceil(s.length/4)*3)),s=s.replace(/[^A-Za-z0-9\+\/\=]/g,""),p=p||0;for(var R,c,n,r,B=0,D=p;B<s.length;)R=C[s.charCodeAt(B++)-43],c=C[s.charCodeAt(B++)-43],n=C[s.charCodeAt(B++)-43],r=C[s.charCodeAt(B++)-43],I[D++]=R<<2|c>>4,n!==64&&(I[D++]=(c&15)<<4|n>>2,r!==64&&(I[D++]=(n&3)<<6|r));return d?D-p:I.subarray(0,D)},a.binary.base58.encode=function(s,d){return a.binary.baseN.encode(s,l,d)},a.binary.base58.decode=function(s,d){return a.binary.baseN.decode(s,l,d)},a.text={utf8:{},utf16:{}},a.text.utf8.encode=function(s,d,p){s=a.encodeUtf8(s);var I=d;I||(I=new Uint8Array(s.length)),p=p||0;for(var R=p,c=0;c<s.length;++c)I[R++]=s.charCodeAt(c);return d?R-p:I},a.text.utf8.decode=function(s){return a.decodeUtf8(String.fromCharCode.apply(null,s))},a.text.utf16.encode=function(s,d,p){var I=d;I||(I=new Uint8Array(s.length*2));var R=new Uint16Array(I.buffer);p=p||0;for(var c=p,n=p,r=0;r<s.length;++r)R[n++]=s.charCodeAt(r),c+=2;return d?c-p:I},a.text.utf16.decode=function(s){return String.fromCharCode.apply(null,new Uint16Array(s.buffer))},a.deflate=function(s,d,p){if(d=a.decode64(s.deflate(a.encode64(d)).rval),p){var I=2,R=d.charCodeAt(1);R&32&&(I=6),d=d.substring(I,d.length-4)}return d},a.inflate=function(s,d,p){var I=s.inflate(a.encode64(d)).rval;return I===null?null:a.decode64(I)};var x=function(s,d,p){if(!s)throw new Error("WebStorage not available.");var I;if(p===null?I=s.removeItem(d):(p=a.encode64(JSON.stringify(p)),I=s.setItem(d,p)),typeof I<"u"&&I.rval!==!0){var R=new Error(I.error.message);throw R.id=I.error.id,R.name=I.error.name,R}},k=function(s,d){if(!s)throw new Error("WebStorage not available.");var p=s.getItem(d);if(s.init)if(p.rval===null){if(p.error){var I=new Error(p.error.message);throw I.id=p.error.id,I.name=p.error.name,I}p=null}else p=p.rval;return p!==null&&(p=JSON.parse(a.decode64(p))),p},E=function(s,d,p,I){var R=k(s,d);R===null&&(R={}),R[p]=I,x(s,d,R)},u=function(s,d,p){var I=k(s,d);return I!==null&&(I=p in I?I[p]:null),I},v=function(s,d,p){var I=k(s,d);if(I!==null&&p in I){delete I[p];var R=!0;for(var c in I){R=!1;break}R&&(I=null),x(s,d,I)}},m=function(s,d){x(s,d,null)},g=function(s,d,p){var I=null;typeof p>"u"&&(p=["web","flash"]);var R,c=!1,n=null;for(var r in p){R=p[r];try{if(R==="flash"||R==="both"){if(d[0]===null)throw new Error("Flash local storage not available.");I=s.apply(this,d),c=R==="flash"}(R==="web"||R==="both")&&(d[0]=localStorage,I=s.apply(this,d),c=!0)}catch(B){n=B}if(c)break}if(!c)throw n;return I};return a.setItem=function(s,d,p,I,R){g(E,arguments,R)},a.getItem=function(s,d,p,I){return g(u,arguments,I)},a.removeItem=function(s,d,p,I){g(v,arguments,I)},a.clearItems=function(s,d,p){g(m,arguments,p)},a.isEmpty=function(s){for(var d in s)if(s.hasOwnProperty(d))return!1;return!0},a.format=function(s){for(var d=/%./g,p,I,R=0,c=[],n=0;p=d.exec(s);){I=s.substring(n,d.lastIndex-2),I.length>0&&c.push(I),n=d.lastIndex;var r=p[0][1];switch(r){case"s":case"o":R<arguments.length?c.push(arguments[R+++1]):c.push("<?>");break;case"%":c.push("%");break;default:c.push("<%"+r+"?>")}}return c.push(s.substring(n)),c.join("")},a.formatNumber=function(s,d,p,I){var R=s,c=isNaN(d=Math.abs(d))?2:d,n=p===void 0?",":p,r=I===void 0?".":I,B=R<0?"-":"",D=parseInt(R=Math.abs(+R||0).toFixed(c),10)+"",V=D.length>3?D.length%3:0;return B+(V?D.substr(0,V)+r:"")+D.substr(V).replace(/(\d{3})(?=\d)/g,"$1"+r)+(c?n+Math.abs(R-D).toFixed(c).slice(2):"")},a.formatSize=function(s){return s>=1073741824?s=a.formatNumber(s/1073741824,2,".","")+" GiB":s>=1048576?s=a.formatNumber(s/1048576,2,".","")+" MiB":s>=1024?s=a.formatNumber(s/1024,0)+" KiB":s=a.formatNumber(s,0)+" bytes",s},a.bytesFromIP=function(s){return s.indexOf(".")!==-1?a.bytesFromIPv4(s):s.indexOf(":")!==-1?a.bytesFromIPv6(s):null},a.bytesFromIPv4=function(s){if(s=s.split("."),s.length!==4)return null;for(var d=a.createBuffer(),p=0;p<s.length;++p){var I=parseInt(s[p],10);if(isNaN(I))return null;d.putByte(I)}return d.getBytes()},a.bytesFromIPv6=function(s){var d=0;s=s.split(":").filter(function(n){return n.length===0&&++d,!0});for(var p=(8-s.length+d)*2,I=a.createBuffer(),R=0;R<8;++R){if(!s[R]||s[R].length===0){I.fillWithByte(0,p),p=0;continue}var c=a.hexToBytes(s[R]);c.length<2&&I.putByte(0),I.putBytes(c)}return I.getBytes()},a.bytesToIP=function(s){return s.length===4?a.bytesToIPv4(s):s.length===16?a.bytesToIPv6(s):null},a.bytesToIPv4=function(s){if(s.length!==4)return null;for(var d=[],p=0;p<s.length;++p)d.push(s.charCodeAt(p));return d.join(".")},a.bytesToIPv6=function(s){if(s.length!==16)return null;for(var d=[],p=[],I=0,R=0;R<s.length;R+=2){for(var c=a.bytesToHex(s[R]+s[R+1]);c[0]==="0"&&c!=="0";)c=c.substr(1);if(c==="0"){var n=p[p.length-1],r=d.length;!n||r!==n.end+1?p.push({start:r,end:r}):(n.end=r,n.end-n.start>p[I].end-p[I].start&&(I=p.length-1))}d.push(c)}if(p.length>0){var B=p[I];B.end-B.start>0&&(d.splice(B.start,B.end-B.start+1,""),B.start===0&&d.unshift(""),B.end===7&&d.push(""))}return d.join(":")},a.estimateCores=function(s,d){if(typeof s=="function"&&(d=s,s={}),s=s||{},"cores"in a&&!s.update)return d(null,a.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return a.cores=navigator.hardwareConcurrency,d(null,a.cores);if(typeof Worker>"u")return a.cores=1,d(null,a.cores);if(typeof Blob>"u")return a.cores=2,d(null,a.cores);var p=URL.createObjectURL(new Blob(["(",(function(){self.addEventListener("message",function(n){var r=Date.now(),B=r+4;self.postMessage({st:r,et:B})})}).toString(),")()"],{type:"application/javascript"}));I([],5,16);function I(n,r,B){if(r===0){var D=Math.floor(n.reduce(function(V,L){return V+L},0)/n.length);return a.cores=Math.max(1,D),URL.revokeObjectURL(p),d(null,a.cores)}R(B,function(V,L){n.push(c(B,L)),I(n,r-1,B)})}function R(n,r){for(var B=[],D=[],V=0;V<n;++V){var L=new Worker(p);L.addEventListener("message",function(O){if(D.push(O.data),D.length===n){for(var q=0;q<n;++q)B[q].terminate();r(null,D)}}),B.push(L)}for(var V=0;V<n;++V)B[V].postMessage(V)}function c(n,r){for(var B=[],D=0;D<n;++D)for(var V=r[D],L=B[D]=[],O=0;O<n;++O)if(D!==O){var q=r[O];(V.st>q.st&&V.st<q.et||q.st>V.st&&q.st<V.et)&&L.push(O)}return B.reduce(function(M,H){return Math.max(M,H.length)},0)}},Nt.exports}var wt,Sr;function pr(){if(Sr)return wt;Sr=1;var i=fe();de(),wt=i.cipher=i.cipher||{},i.cipher.algorithms=i.cipher.algorithms||{},i.cipher.createCipher=function(a,y){var N=a;if(typeof N=="string"&&(N=i.cipher.getAlgorithm(N),N&&(N=N())),!N)throw new Error("Unsupported algorithm: "+a);return new i.cipher.BlockCipher({algorithm:N,key:y,decrypt:!1})},i.cipher.createDecipher=function(a,y){var N=a;if(typeof N=="string"&&(N=i.cipher.getAlgorithm(N),N&&(N=N())),!N)throw new Error("Unsupported algorithm: "+a);return new i.cipher.BlockCipher({algorithm:N,key:y,decrypt:!0})},i.cipher.registerAlgorithm=function(a,y){a=a.toUpperCase(),i.cipher.algorithms[a]=y},i.cipher.getAlgorithm=function(a){return a=a.toUpperCase(),a in i.cipher.algorithms?i.cipher.algorithms[a]:null};var e=i.cipher.BlockCipher=function(a){this.algorithm=a.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=a.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=a.decrypt,this.algorithm.initialize(a)};return e.prototype.start=function(a){a=a||{};var y={};for(var N in a)y[N]=a[N];y.decrypt=this._decrypt,this._finish=!1,this._input=i.util.createBuffer(),this.output=a.output||i.util.createBuffer(),this.mode.start(y)},e.prototype.update=function(a){for(a&&this._input.putBuffer(a);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(a){a&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(N){return a(this.blockSize,N,!1)},this.mode.unpad=function(N){return a(this.blockSize,N,!0)});var y={};return y.decrypt=this._decrypt,y.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,y)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,y))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,y))},wt}var Lt={exports:{}},Tr;function oa(){if(Tr)return Lt.exports;Tr=1;var i=fe();de(),i.cipher=i.cipher||{};var e=Lt.exports=i.cipher.modes=i.cipher.modes||{};e.ecb=function(S){S=S||{},this.name="ECB",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(S){},e.ecb.prototype.encrypt=function(S,h,t){if(S.length()<this.blockSize&&!(t&&S.length()>0))return!0;for(var C=0;C<this._ints;++C)this._inBlock[C]=S.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var C=0;C<this._ints;++C)h.putInt32(this._outBlock[C])},e.ecb.prototype.decrypt=function(S,h,t){if(S.length()<this.blockSize&&!(t&&S.length()>0))return!0;for(var C=0;C<this._ints;++C)this._inBlock[C]=S.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var C=0;C<this._ints;++C)h.putInt32(this._outBlock[C])},e.ecb.prototype.pad=function(S,h){var t=S.length()===this.blockSize?this.blockSize:this.blockSize-S.length();return S.fillWithByte(t,t),!0},e.ecb.prototype.unpad=function(S,h){if(h.overflow>0)return!1;var t=S.length(),C=S.at(t-1);return C>this.blockSize<<2?!1:(S.truncate(C),!0)},e.cbc=function(S){S=S||{},this.name="CBC",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(S){if(S.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in S)this._iv=a(S.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(S,h,t){if(S.length()<this.blockSize&&!(t&&S.length()>0))return!0;for(var C=0;C<this._ints;++C)this._inBlock[C]=this._prev[C]^S.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var C=0;C<this._ints;++C)h.putInt32(this._outBlock[C]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(S,h,t){if(S.length()<this.blockSize&&!(t&&S.length()>0))return!0;for(var C=0;C<this._ints;++C)this._inBlock[C]=S.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var C=0;C<this._ints;++C)h.putInt32(this._prev[C]^this._outBlock[C]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(S,h){var t=S.length()===this.blockSize?this.blockSize:this.blockSize-S.length();return S.fillWithByte(t,t),!0},e.cbc.prototype.unpad=function(S,h){if(h.overflow>0)return!1;var t=S.length(),C=S.at(t-1);return C>this.blockSize<<2?!1:(S.truncate(C),!0)},e.cfb=function(S){S=S||{},this.name="CFB",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=i.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");this._iv=a(S.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(S,h,t){var C=S.length();if(C===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&C>=this.blockSize){for(var l=0;l<this._ints;++l)this._inBlock[l]=S.getInt32()^this._outBlock[l],h.putInt32(this._inBlock[l]);return}var x=(this.blockSize-C)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialBlock[l]=S.getInt32()^this._outBlock[l],this._partialOutput.putInt32(this._partialBlock[l]);if(x>0)S.read-=this.blockSize;else for(var l=0;l<this._ints;++l)this._inBlock[l]=this._partialBlock[l];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(C-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(S,h,t){var C=S.length();if(C===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&C>=this.blockSize){for(var l=0;l<this._ints;++l)this._inBlock[l]=S.getInt32(),h.putInt32(this._inBlock[l]^this._outBlock[l]);return}var x=(this.blockSize-C)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialBlock[l]=S.getInt32(),this._partialOutput.putInt32(this._partialBlock[l]^this._outBlock[l]);if(x>0)S.read-=this.blockSize;else for(var l=0;l<this._ints;++l)this._inBlock[l]=this._partialBlock[l];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(C-this._partialBytes)),this._partialBytes=0},e.ofb=function(S){S=S||{},this.name="OFB",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=i.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");this._iv=a(S.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(S,h,t){var C=S.length();if(S.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&C>=this.blockSize){for(var l=0;l<this._ints;++l)h.putInt32(S.getInt32()^this._outBlock[l]),this._inBlock[l]=this._outBlock[l];return}var x=(this.blockSize-C)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialOutput.putInt32(S.getInt32()^this._outBlock[l]);if(x>0)S.read-=this.blockSize;else for(var l=0;l<this._ints;++l)this._inBlock[l]=this._outBlock[l];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(C-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(S){S=S||{},this.name="CTR",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=i.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");this._iv=a(S.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(S,h,t){var C=S.length();if(C===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&C>=this.blockSize)for(var l=0;l<this._ints;++l)h.putInt32(S.getInt32()^this._outBlock[l]);else{var x=(this.blockSize-C)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialOutput.putInt32(S.getInt32()^this._outBlock[l]);if(x>0&&(S.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(C-this._partialBytes)),this._partialBytes=0}y(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(S){S=S||{},this.name="GCM",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=i.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");var h=i.util.createBuffer(S.iv);this._cipherLength=0;var t;if("additionalData"in S?t=i.util.createBuffer(S.additionalData):t=i.util.createBuffer(),"tagLength"in S?this._tagLength=S.tagLength:this._tagLength=128,this._tag=null,S.decrypt&&(this._tag=i.util.createBuffer(S.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var C=h.length();if(C===12)this._j0=[h.getInt32(),h.getInt32(),h.getInt32(),1];else{for(this._j0=[0,0,0,0];h.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[h.getInt32(),h.getInt32(),h.getInt32(),h.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(N(C*8)))}this._inBlock=this._j0.slice(0),y(this._inBlock),this._partialBytes=0,t=i.util.createBuffer(t),this._aDataLength=N(t.length()*8);var l=t.length()%this.blockSize;for(l&&t.fillWithByte(0,this.blockSize-l),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},e.gcm.prototype.encrypt=function(S,h,t){var C=S.length();if(C===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&C>=this.blockSize){for(var l=0;l<this._ints;++l)h.putInt32(this._outBlock[l]^=S.getInt32());this._cipherLength+=this.blockSize}else{var x=(this.blockSize-C)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialOutput.putInt32(S.getInt32()^this._outBlock[l]);if(x<=0||t){if(t){var k=C%this.blockSize;this._cipherLength+=k,this._partialOutput.truncate(this.blockSize-k)}else this._cipherLength+=this.blockSize;for(var l=0;l<this._ints;++l)this._outBlock[l]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return S.read-=this.blockSize,h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(C-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),y(this._inBlock)},e.gcm.prototype.decrypt=function(S,h,t){var C=S.length();if(C<this.blockSize&&!(t&&C>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),y(this._inBlock),this._hashBlock[0]=S.getInt32(),this._hashBlock[1]=S.getInt32(),this._hashBlock[2]=S.getInt32(),this._hashBlock[3]=S.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var l=0;l<this._ints;++l)h.putInt32(this._outBlock[l]^this._hashBlock[l]);C<this.blockSize?this._cipherLength+=C%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(S,h){var t=!0;h.decrypt&&h.overflow&&S.truncate(this.blockSize-h.overflow),this.tag=i.util.createBuffer();var C=this._aDataLength.concat(N(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,C);var l=[];this.cipher.encrypt(this._j0,l);for(var x=0;x<this._ints;++x)this.tag.putInt32(this._s[x]^l[x]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),h.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t},e.gcm.prototype.multiply=function(S,h){for(var t=[0,0,0,0],C=h.slice(0),l=0;l<128;++l){var x=S[l/32|0]&1<<31-l%32;x&&(t[0]^=C[0],t[1]^=C[1],t[2]^=C[2],t[3]^=C[3]),this.pow(C,C)}return t},e.gcm.prototype.pow=function(S,h){for(var t=S[3]&1,C=3;C>0;--C)h[C]=S[C]>>>1|(S[C-1]&1)<<31;h[0]=S[0]>>>1,t&&(h[0]^=this._R)},e.gcm.prototype.tableMultiply=function(S){for(var h=[0,0,0,0],t=0;t<32;++t){var C=t/8|0,l=S[C]>>>(7-t%8)*4&15,x=this._m[t][l];h[0]^=x[0],h[1]^=x[1],h[2]^=x[2],h[3]^=x[3]}return h},e.gcm.prototype.ghash=function(S,h,t){return h[0]^=t[0],h[1]^=t[1],h[2]^=t[2],h[3]^=t[3],this.tableMultiply(h)},e.gcm.prototype.generateHashTable=function(S,h){for(var t=8/h,C=4*t,l=16*t,x=new Array(l),k=0;k<l;++k){var E=[0,0,0,0],u=k/C|0,v=(C-1-k%C)*h;E[u]=1<<h-1<<v,x[k]=this.generateSubHashTable(this.multiply(E,S),h)}return x},e.gcm.prototype.generateSubHashTable=function(S,h){var t=1<<h,C=t>>>1,l=new Array(t);l[C]=S.slice(0);for(var x=C>>>1;x>0;)this.pow(l[2*x],l[x]=[]),x>>=1;for(x=2;x<C;){for(var k=1;k<x;++k){var E=l[x],u=l[k];l[x+k]=[E[0]^u[0],E[1]^u[1],E[2]^u[2],E[3]^u[3]]}x*=2}for(l[0]=[0,0,0,0],x=C+1;x<t;++x){var v=l[x^C];l[x]=[S[0]^v[0],S[1]^v[1],S[2]^v[2],S[3]^v[3]]}return l};function a(S,h){if(typeof S=="string"&&(S=i.util.createBuffer(S)),i.util.isArray(S)&&S.length>4){var t=S;S=i.util.createBuffer();for(var C=0;C<t.length;++C)S.putByte(t[C])}if(S.length()<h)throw new Error("Invalid IV length; got "+S.length()+" bytes and expected "+h+" bytes.");if(!i.util.isArray(S)){for(var l=[],x=h/4,C=0;C<x;++C)l.push(S.getInt32());S=l}return S}function y(S){S[S.length-1]=S[S.length-1]+1&4294967295}function N(S){return[S/4294967296|0,S&4294967295]}return Lt.exports}var Dt,Ir;function lt(){if(Ir)return Dt;Ir=1;var i=fe();pr(),oa(),de(),Dt=i.aes=i.aes||{},i.aes.startEncrypting=function(u,v,m,g){var s=E({key:u,output:m,decrypt:!1,mode:g});return s.start(v),s},i.aes.createEncryptionCipher=function(u,v){return E({key:u,output:null,decrypt:!1,mode:v})},i.aes.startDecrypting=function(u,v,m,g){var s=E({key:u,output:m,decrypt:!0,mode:g});return s.start(v),s},i.aes.createDecryptionCipher=function(u,v){return E({key:u,output:null,decrypt:!0,mode:v})},i.aes.Algorithm=function(u,v){a||l();var m=this;m.name=u,m.mode=new v({blockSize:16,cipher:{encrypt:function(g,s){return k(m._w,g,s,!1)},decrypt:function(g,s){return k(m._w,g,s,!0)}}}),m._init=!1},i.aes.Algorithm.prototype.initialize=function(u){if(!this._init){var v=u.key,m;if(typeof v=="string"&&(v.length===16||v.length===24||v.length===32))v=i.util.createBuffer(v);else if(i.util.isArray(v)&&(v.length===16||v.length===24||v.length===32)){m=v,v=i.util.createBuffer();for(var g=0;g<m.length;++g)v.putByte(m[g])}if(!i.util.isArray(v)){m=v,v=[];var s=m.length();if(s===16||s===24||s===32){s=s>>>2;for(var g=0;g<s;++g)v.push(m.getInt32())}}if(!i.util.isArray(v)||!(v.length===4||v.length===6||v.length===8))throw new Error("Invalid key parameter.");var d=this.mode.name,p=["CFB","OFB","CTR","GCM"].indexOf(d)!==-1;this._w=x(v,u.decrypt&&!p),this._init=!0}},i.aes._expandKey=function(u,v){return a||l(),x(u,v)},i.aes._updateBlock=k,e("AES-ECB",i.cipher.modes.ecb),e("AES-CBC",i.cipher.modes.cbc),e("AES-CFB",i.cipher.modes.cfb),e("AES-OFB",i.cipher.modes.ofb),e("AES-CTR",i.cipher.modes.ctr),e("AES-GCM",i.cipher.modes.gcm);function e(u,v){var m=function(){return new i.aes.Algorithm(u,v)};i.cipher.registerAlgorithm(u,m)}var a=!1,y=4,N,S,h,t,C;function l(){a=!0,h=[0,1,2,4,8,16,32,64,128,27,54];for(var u=new Array(256),v=0;v<128;++v)u[v]=v<<1,u[v+128]=v+128<<1^283;N=new Array(256),S=new Array(256),t=new Array(4),C=new Array(4);for(var v=0;v<4;++v)t[v]=new Array(256),C[v]=new Array(256);for(var m=0,g=0,s,d,p,I,R,c,n,v=0;v<256;++v){I=g^g<<1^g<<2^g<<3^g<<4,I=I>>8^I&255^99,N[m]=I,S[I]=m,R=u[I],s=u[m],d=u[s],p=u[d],c=R<<24^I<<16^I<<8^(I^R),n=(s^d^p)<<24^(m^p)<<16^(m^d^p)<<8^(m^s^p);for(var r=0;r<4;++r)t[r][m]=c,C[r][I]=n,c=c<<24|c>>>8,n=n<<24|n>>>8;m===0?m=g=1:(m=s^u[u[u[s^p]]],g^=u[u[g]])}}function x(u,v){for(var m=u.slice(0),g,s=1,d=m.length,p=d+6+1,I=y*p,R=d;R<I;++R)g=m[R-1],R%d===0?(g=N[g>>>16&255]<<24^N[g>>>8&255]<<16^N[g&255]<<8^N[g>>>24]^h[s]<<24,s++):d>6&&R%d===4&&(g=N[g>>>24]<<24^N[g>>>16&255]<<16^N[g>>>8&255]<<8^N[g&255]),m[R]=m[R-d]^g;if(v){var c,n=C[0],r=C[1],B=C[2],D=C[3],V=m.slice(0);I=m.length;for(var R=0,L=I-y;R<I;R+=y,L-=y)if(R===0||R===I-y)V[R]=m[L],V[R+1]=m[L+3],V[R+2]=m[L+2],V[R+3]=m[L+1];else for(var O=0;O<y;++O)c=m[L+O],V[R+(3&-O)]=n[N[c>>>24]]^r[N[c>>>16&255]]^B[N[c>>>8&255]]^D[N[c&255]];m=V}return m}function k(u,v,m,g){var s=u.length/4-1,d,p,I,R,c;g?(d=C[0],p=C[1],I=C[2],R=C[3],c=S):(d=t[0],p=t[1],I=t[2],R=t[3],c=N);var n,r,B,D,V,L,O;n=v[0]^u[0],r=v[g?3:1]^u[1],B=v[2]^u[2],D=v[g?1:3]^u[3];for(var q=3,M=1;M<s;++M)V=d[n>>>24]^p[r>>>16&255]^I[B>>>8&255]^R[D&255]^u[++q],L=d[r>>>24]^p[B>>>16&255]^I[D>>>8&255]^R[n&255]^u[++q],O=d[B>>>24]^p[D>>>16&255]^I[n>>>8&255]^R[r&255]^u[++q],D=d[D>>>24]^p[n>>>16&255]^I[r>>>8&255]^R[B&255]^u[++q],n=V,r=L,B=O;m[0]=c[n>>>24]<<24^c[r>>>16&255]<<16^c[B>>>8&255]<<8^c[D&255]^u[++q],m[g?3:1]=c[r>>>24]<<24^c[B>>>16&255]<<16^c[D>>>8&255]<<8^c[n&255]^u[++q],m[2]=c[B>>>24]<<24^c[D>>>16&255]<<16^c[n>>>8&255]<<8^c[r&255]^u[++q],m[g?1:3]=c[D>>>24]<<24^c[n>>>16&255]<<16^c[r>>>8&255]<<8^c[B&255]^u[++q]}function E(u){u=u||{};var v=(u.mode||"CBC").toUpperCase(),m="AES-"+v,g;u.decrypt?g=i.cipher.createDecipher(m,u.key):g=i.cipher.createCipher(m,u.key);var s=g.start;return g.start=function(d,p){var I=null;p instanceof i.util.ByteBuffer&&(I=p,p={}),p=p||{},p.output=I,p.iv=d,s.call(g,p)},g}return Dt}var kt={exports:{}},Ut={exports:{}},Pt={exports:{}},Ar;function ct(){if(Ar)return Pt.exports;Ar=1;var i=fe();i.pki=i.pki||{};var e=Pt.exports=i.pki.oids=i.oids=i.oids||{};function a(N,S){e[N]=S,e[S]=N}function y(N,S){e[N]=S}return a("1.2.840.113549.1.1.1","rsaEncryption"),a("1.2.840.113549.1.1.4","md5WithRSAEncryption"),a("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),a("1.2.840.113549.1.1.7","RSAES-OAEP"),a("1.2.840.113549.1.1.8","mgf1"),a("1.2.840.113549.1.1.9","pSpecified"),a("1.2.840.113549.1.1.10","RSASSA-PSS"),a("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),a("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),a("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),a("1.3.101.112","EdDSA25519"),a("1.2.840.10040.4.3","dsa-with-sha1"),a("1.3.14.3.2.7","desCBC"),a("1.3.14.3.2.26","sha1"),a("1.3.14.3.2.29","sha1WithRSASignature"),a("2.16.840.1.101.3.4.2.1","sha256"),a("2.16.840.1.101.3.4.2.2","sha384"),a("2.16.840.1.101.3.4.2.3","sha512"),a("2.16.840.1.101.3.4.2.4","sha224"),a("2.16.840.1.101.3.4.2.5","sha512-224"),a("2.16.840.1.101.3.4.2.6","sha512-256"),a("1.2.840.113549.2.2","md2"),a("1.2.840.113549.2.5","md5"),a("1.2.840.113549.1.7.1","data"),a("1.2.840.113549.1.7.2","signedData"),a("1.2.840.113549.1.7.3","envelopedData"),a("1.2.840.113549.1.7.4","signedAndEnvelopedData"),a("1.2.840.113549.1.7.5","digestedData"),a("1.2.840.113549.1.7.6","encryptedData"),a("1.2.840.113549.1.9.1","emailAddress"),a("1.2.840.113549.1.9.2","unstructuredName"),a("1.2.840.113549.1.9.3","contentType"),a("1.2.840.113549.1.9.4","messageDigest"),a("1.2.840.113549.1.9.5","signingTime"),a("1.2.840.113549.1.9.6","counterSignature"),a("1.2.840.113549.1.9.7","challengePassword"),a("1.2.840.113549.1.9.8","unstructuredAddress"),a("1.2.840.113549.1.9.14","extensionRequest"),a("1.2.840.113549.1.9.20","friendlyName"),a("1.2.840.113549.1.9.21","localKeyId"),a("1.2.840.113549.1.9.22.1","x509Certificate"),a("1.2.840.113549.1.12.10.1.1","keyBag"),a("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),a("1.2.840.113549.1.12.10.1.3","certBag"),a("1.2.840.113549.1.12.10.1.4","crlBag"),a("1.2.840.113549.1.12.10.1.5","secretBag"),a("1.2.840.113549.1.12.10.1.6","safeContentsBag"),a("1.2.840.113549.1.5.13","pkcs5PBES2"),a("1.2.840.113549.1.5.12","pkcs5PBKDF2"),a("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),a("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),a("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),a("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),a("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),a("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),a("1.2.840.113549.2.7","hmacWithSHA1"),a("1.2.840.113549.2.8","hmacWithSHA224"),a("1.2.840.113549.2.9","hmacWithSHA256"),a("1.2.840.113549.2.10","hmacWithSHA384"),a("1.2.840.113549.2.11","hmacWithSHA512"),a("1.2.840.113549.3.7","des-EDE3-CBC"),a("2.16.840.1.101.3.4.1.2","aes128-CBC"),a("2.16.840.1.101.3.4.1.22","aes192-CBC"),a("2.16.840.1.101.3.4.1.42","aes256-CBC"),a("2.5.4.3","commonName"),a("2.5.4.4","surname"),a("2.5.4.5","serialNumber"),a("2.5.4.6","countryName"),a("2.5.4.7","localityName"),a("2.5.4.8","stateOrProvinceName"),a("2.5.4.9","streetAddress"),a("2.5.4.10","organizationName"),a("2.5.4.11","organizationalUnitName"),a("2.5.4.12","title"),a("2.5.4.13","description"),a("2.5.4.15","businessCategory"),a("2.5.4.17","postalCode"),a("2.5.4.42","givenName"),a("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),a("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),a("2.16.840.1.113730.1.1","nsCertType"),a("2.16.840.1.113730.1.13","nsComment"),y("2.5.29.1","authorityKeyIdentifier"),y("2.5.29.2","keyAttributes"),y("2.5.29.3","certificatePolicies"),y("2.5.29.4","keyUsageRestriction"),y("2.5.29.5","policyMapping"),y("2.5.29.6","subtreesConstraint"),y("2.5.29.7","subjectAltName"),y("2.5.29.8","issuerAltName"),y("2.5.29.9","subjectDirectoryAttributes"),y("2.5.29.10","basicConstraints"),y("2.5.29.11","nameConstraints"),y("2.5.29.12","policyConstraints"),y("2.5.29.13","basicConstraints"),a("2.5.29.14","subjectKeyIdentifier"),a("2.5.29.15","keyUsage"),y("2.5.29.16","privateKeyUsagePeriod"),a("2.5.29.17","subjectAltName"),a("2.5.29.18","issuerAltName"),a("2.5.29.19","basicConstraints"),y("2.5.29.20","cRLNumber"),y("2.5.29.21","cRLReason"),y("2.5.29.22","expirationDate"),y("2.5.29.23","instructionCode"),y("2.5.29.24","invalidityDate"),y("2.5.29.25","cRLDistributionPoints"),y("2.5.29.26","issuingDistributionPoint"),y("2.5.29.27","deltaCRLIndicator"),y("2.5.29.28","issuingDistributionPoint"),y("2.5.29.29","certificateIssuer"),y("2.5.29.30","nameConstraints"),a("2.5.29.31","cRLDistributionPoints"),a("2.5.29.32","certificatePolicies"),y("2.5.29.33","policyMappings"),y("2.5.29.34","policyConstraints"),a("2.5.29.35","authorityKeyIdentifier"),y("2.5.29.36","policyConstraints"),a("2.5.29.37","extKeyUsage"),y("2.5.29.46","freshestCRL"),y("2.5.29.54","inhibitAnyPolicy"),a("1.3.6.1.4.1.11129.2.4.2","timestampList"),a("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),a("1.3.6.1.5.5.7.3.1","serverAuth"),a("1.3.6.1.5.5.7.3.2","clientAuth"),a("1.3.6.1.5.5.7.3.3","codeSigning"),a("1.3.6.1.5.5.7.3.4","emailProtection"),a("1.3.6.1.5.5.7.3.8","timeStamping"),Pt.exports}var Br;function rt(){if(Br)return Ut.exports;Br=1;var i=fe();de(),ct();var e=Ut.exports=i.asn1=i.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.maxDepth=256,e.create=function(h,t,C,l,x){if(i.util.isArray(l)){for(var k=[],E=0;E<l.length;++E)l[E]!==void 0&&k.push(l[E]);l=k}var u={tagClass:h,type:t,constructed:C,composed:C||i.util.isArray(l),value:l};return x&&"bitStringContents"in x&&(u.bitStringContents=x.bitStringContents,u.original=e.copy(u)),u},e.copy=function(h,t){var C;if(i.util.isArray(h)){C=[];for(var l=0;l<h.length;++l)C.push(e.copy(h[l],t));return C}return typeof h=="string"?h:(C={tagClass:h.tagClass,type:h.type,constructed:h.constructed,composed:h.composed,value:e.copy(h.value,t)},t&&!t.excludeBitStringContents&&(C.bitStringContents=h.bitStringContents),C)},e.equals=function(h,t,C){if(i.util.isArray(h)){if(!i.util.isArray(t)||h.length!==t.length)return!1;for(var l=0;l<h.length;++l)if(!e.equals(h[l],t[l]))return!1;return!0}if(typeof h!=typeof t)return!1;if(typeof h=="string")return h===t;var x=h.tagClass===t.tagClass&&h.type===t.type&&h.constructed===t.constructed&&h.composed===t.composed&&e.equals(h.value,t.value);return C&&C.includeBitStringContents&&(x=x&&h.bitStringContents===t.bitStringContents),x},e.getBerValueLength=function(h){var t=h.getByte();if(t!==128){var C,l=t&128;return l?C=h.getInt((t&127)<<3):C=t,C}};function a(h,t,C){if(C>t){var l=new Error("Too few bytes to parse DER.");throw l.available=h.length(),l.remaining=t,l.requested=C,l}}var y=function(h,t){var C=h.getByte();if(t--,C!==128){var l,x=C&128;if(!x)l=C;else{var k=C&127;a(h,t,k),l=h.getInt(k<<3)}if(l<0)throw new Error("Negative length: "+l);return l}};e.fromDer=function(h,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"maxDepth"in t||(t.maxDepth=e.maxDepth),typeof h=="string"&&(h=i.util.createBuffer(h));var C=h.length(),l=N(h,h.length(),0,t);if(t.parseAllBytes&&h.length()!==0){var x=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw x.byteCount=C,x.remaining=h.length(),x}return l};function N(h,t,C,l){if(C>=l.maxDepth)throw new Error("ASN.1 parsing error: Max depth exceeded.");var x;a(h,t,2);var k=h.getByte();t--;var E=k&192,u=k&31;x=h.length();var v=y(h,t);if(t-=x-h.length(),v!==void 0&&v>t){if(l.strict){var m=new Error("Too few bytes to read ASN.1 value.");throw m.available=h.length(),m.remaining=t,m.requested=v,m}v=t}var g,s,d=(k&32)===32;if(d)if(g=[],v===void 0)for(;;){if(a(h,t,2),h.bytes(2)==="\0\0"){h.getBytes(2),t-=2;break}x=h.length(),g.push(N(h,t,C+1,l)),t-=x-h.length()}else for(;v>0;)x=h.length(),g.push(N(h,v,C+1,l)),t-=x-h.length(),v-=x-h.length();if(g===void 0&&E===e.Class.UNIVERSAL&&u===e.Type.BITSTRING&&(s=h.bytes(v)),g===void 0&&l.decodeBitStrings&&E===e.Class.UNIVERSAL&&u===e.Type.BITSTRING&&v>1){var p=h.read,I=t,R=0;if(u===e.Type.BITSTRING&&(a(h,t,1),R=h.getByte(),t--),R===0)try{x=h.length();var c={strict:!0,decodeBitStrings:!0},n=N(h,t,C+1,c),r=x-h.length();t-=r,u==e.Type.BITSTRING&&r++;var B=n.tagClass;r===v&&(B===e.Class.UNIVERSAL||B===e.Class.CONTEXT_SPECIFIC)&&(g=[n])}catch{}g===void 0&&(h.read=p,t=I)}if(g===void 0){if(v===void 0){if(l.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");v=t}if(u===e.Type.BMPSTRING)for(g="";v>0;v-=2)a(h,t,2),g+=String.fromCharCode(h.getInt16()),t-=2;else g=h.getBytes(v),t-=v}var D=s===void 0?null:{bitStringContents:s};return e.create(E,u,d,g,D)}e.toDer=function(h){var t=i.util.createBuffer(),C=h.tagClass|h.type,l=i.util.createBuffer(),x=!1;if("bitStringContents"in h&&(x=!0,h.original&&(x=e.equals(h,h.original))),x)l.putBytes(h.bitStringContents);else if(h.composed){h.constructed?C|=32:l.putByte(0);for(var k=0;k<h.value.length;++k)h.value[k]!==void 0&&l.putBuffer(e.toDer(h.value[k]))}else if(h.type===e.Type.BMPSTRING)for(var k=0;k<h.value.length;++k)l.putInt16(h.value.charCodeAt(k));else h.type===e.Type.INTEGER&&h.value.length>1&&(h.value.charCodeAt(0)===0&&(h.value.charCodeAt(1)&128)===0||h.value.charCodeAt(0)===255&&(h.value.charCodeAt(1)&128)===128)?l.putBytes(h.value.substr(1)):l.putBytes(h.value);if(t.putByte(C),l.length()<=127)t.putByte(l.length()&127);else{var E=l.length(),u="";do u+=String.fromCharCode(E&255),E=E>>>8;while(E>0);t.putByte(u.length|128);for(var k=u.length-1;k>=0;--k)t.putByte(u.charCodeAt(k))}return t.putBuffer(l),t},e.oidToDer=function(h){var t=h.split("."),C=i.util.createBuffer();C.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var l,x,k,E,u=2;u<t.length;++u){if(l=!0,x=[],k=parseInt(t[u],10),k>4294967295)throw new Error("OID value too large; max is 32-bits.");do E=k&127,k=k>>>7,l||(E|=128),x.push(E),l=!1;while(k>0);for(var v=x.length-1;v>=0;--v)C.putByte(x[v])}return C},e.derToOid=function(h){var t;typeof h=="string"&&(h=i.util.createBuffer(h));var C=h.getByte();t=Math.floor(C/40)+"."+C%40;for(var l=0;h.length()>0;){if(l>70368744177663)throw new Error("OID value too large; max is 53-bits.");C=h.getByte(),l=l*128,C&128?l+=C&127:(t+="."+(l+C),l=0)}return t},e.utcTimeToDate=function(h){var t=new Date,C=parseInt(h.substr(0,2),10);C=C>=50?1900+C:2e3+C;var l=parseInt(h.substr(2,2),10)-1,x=parseInt(h.substr(4,2),10),k=parseInt(h.substr(6,2),10),E=parseInt(h.substr(8,2),10),u=0;if(h.length>11){var v=h.charAt(10),m=10;v!=="+"&&v!=="-"&&(u=parseInt(h.substr(10,2),10),m+=2)}if(t.setUTCFullYear(C,l,x),t.setUTCHours(k,E,u,0),m&&(v=h.charAt(m),v==="+"||v==="-")){var g=parseInt(h.substr(m+1,2),10),s=parseInt(h.substr(m+4,2),10),d=g*60+s;d*=6e4,v==="+"?t.setTime(+t-d):t.setTime(+t+d)}return t},e.generalizedTimeToDate=function(h){var t=new Date,C=parseInt(h.substr(0,4),10),l=parseInt(h.substr(4,2),10)-1,x=parseInt(h.substr(6,2),10),k=parseInt(h.substr(8,2),10),E=parseInt(h.substr(10,2),10),u=parseInt(h.substr(12,2),10),v=0,m=0,g=!1;h.charAt(h.length-1)==="Z"&&(g=!0);var s=h.length-5,d=h.charAt(s);if(d==="+"||d==="-"){var p=parseInt(h.substr(s+1,2),10),I=parseInt(h.substr(s+4,2),10);m=p*60+I,m*=6e4,d==="+"&&(m*=-1),g=!0}return h.charAt(14)==="."&&(v=parseFloat(h.substr(14),10)*1e3),g?(t.setUTCFullYear(C,l,x),t.setUTCHours(k,E,u,v),t.setTime(+t+m)):(t.setFullYear(C,l,x),t.setHours(k,E,u,v)),t},e.dateToUtcTime=function(h){if(typeof h=="string")return h;var t="",C=[];C.push((""+h.getUTCFullYear()).substr(2)),C.push(""+(h.getUTCMonth()+1)),C.push(""+h.getUTCDate()),C.push(""+h.getUTCHours()),C.push(""+h.getUTCMinutes()),C.push(""+h.getUTCSeconds());for(var l=0;l<C.length;++l)C[l].length<2&&(t+="0"),t+=C[l];return t+="Z",t},e.dateToGeneralizedTime=function(h){if(typeof h=="string")return h;var t="",C=[];C.push(""+h.getUTCFullYear()),C.push(""+(h.getUTCMonth()+1)),C.push(""+h.getUTCDate()),C.push(""+h.getUTCHours()),C.push(""+h.getUTCMinutes()),C.push(""+h.getUTCSeconds());for(var l=0;l<C.length;++l)C[l].length<2&&(t+="0"),t+=C[l];return t+="Z",t},e.integerToDer=function(h){var t=i.util.createBuffer();if(h>=-128&&h<128)return t.putSignedInt(h,8);if(h>=-32768&&h<32768)return t.putSignedInt(h,16);if(h>=-8388608&&h<8388608)return t.putSignedInt(h,24);if(h>=-2147483648&&h<2147483648)return t.putSignedInt(h,32);var C=new Error("Integer too large; max is 32-bits.");throw C.integer=h,C},e.derToInteger=function(h){typeof h=="string"&&(h=i.util.createBuffer(h));var t=h.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return h.getSignedInt(t)},e.validate=function(h,t,C,l){var x=!1;if((h.tagClass===t.tagClass||typeof t.tagClass>"u")&&(h.type===t.type||typeof t.type>"u"))if(h.constructed===t.constructed||typeof t.constructed>"u"){if(x=!0,t.value&&i.util.isArray(t.value))for(var k=0,E=0;x&&E<t.value.length;++E){var u=t.value[E];x=!!u.optional;var v=h.value[k];if(!v){u.optional||(x=!1,l&&l.push("["+t.name+'] Missing required element. Expected tag class "'+u.tagClass+'", type "'+u.type+'"'));continue}var m=typeof u.tagClass<"u"&&typeof u.type<"u";if(m&&(v.tagClass!==u.tagClass||v.type!==u.type))if(u.optional){x=!0;continue}else{x=!1,l&&l.push("["+t.name+"] Tag mismatch. Expected ("+u.tagClass+","+u.type+"), got ("+v.tagClass+","+v.type+")");break}var g=e.validate(v,u,C,l);if(g)++k,x=!0;else if(u.optional)x=!0;else{x=!1;break}}if(x&&C&&(t.capture&&(C[t.capture]=h.value),t.captureAsn1&&(C[t.captureAsn1]=h),t.captureBitStringContents&&"bitStringContents"in h&&(C[t.captureBitStringContents]=h.bitStringContents),t.captureBitStringValue&&"bitStringContents"in h))if(h.bitStringContents.length<2)C[t.captureBitStringValue]="";else{var s=h.bitStringContents.charCodeAt(0);if(s!==0)throw new Error("captureBitStringValue only supported for zero unused bits");C[t.captureBitStringValue]=h.bitStringContents.slice(1)}}else l&&l.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+h.constructed+'"');else l&&(h.tagClass!==t.tagClass&&l.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+h.tagClass+'"'),h.type!==t.type&&l.push("["+t.name+'] Expected type "'+t.type+'", got "'+h.type+'"'));return x};var S=/[^\\u0000-\\u00ff]/;return e.prettyPrint=function(h,t,C){var l="";t=t||0,C=C||2,t>0&&(l+=`
`);for(var x="",k=0;k<t*C;++k)x+=" ";switch(l+=x+"Tag: ",h.tagClass){case e.Class.UNIVERSAL:l+="Universal:";break;case e.Class.APPLICATION:l+="Application:";break;case e.Class.CONTEXT_SPECIFIC:l+="Context-Specific:";break;case e.Class.PRIVATE:l+="Private:";break}if(h.tagClass===e.Class.UNIVERSAL)switch(l+=h.type,h.type){case e.Type.NONE:l+=" (None)";break;case e.Type.BOOLEAN:l+=" (Boolean)";break;case e.Type.INTEGER:l+=" (Integer)";break;case e.Type.BITSTRING:l+=" (Bit string)";break;case e.Type.OCTETSTRING:l+=" (Octet string)";break;case e.Type.NULL:l+=" (Null)";break;case e.Type.OID:l+=" (Object Identifier)";break;case e.Type.ODESC:l+=" (Object Descriptor)";break;case e.Type.EXTERNAL:l+=" (External or Instance of)";break;case e.Type.REAL:l+=" (Real)";break;case e.Type.ENUMERATED:l+=" (Enumerated)";break;case e.Type.EMBEDDED:l+=" (Embedded PDV)";break;case e.Type.UTF8:l+=" (UTF8)";break;case e.Type.ROID:l+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:l+=" (Sequence)";break;case e.Type.SET:l+=" (Set)";break;case e.Type.PRINTABLESTRING:l+=" (Printable String)";break;case e.Type.IA5String:l+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:l+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:l+=" (Generalized time)";break;case e.Type.BMPSTRING:l+=" (BMP String)";break}else l+=h.type;if(l+=`
`,l+=x+"Constructed: "+h.constructed+`
`,h.composed){for(var E=0,u="",k=0;k<h.value.length;++k)h.value[k]!==void 0&&(E+=1,u+=e.prettyPrint(h.value[k],t+1,C),k+1<h.value.length&&(u+=","));l+=x+"Sub values: "+E+u}else{if(l+=x+"Value: ",h.type===e.Type.OID){var v=e.derToOid(h.value);l+=v,i.pki&&i.pki.oids&&v in i.pki.oids&&(l+=" ("+i.pki.oids[v]+") ")}if(h.type===e.Type.INTEGER)try{l+=e.derToInteger(h.value)}catch{l+="0x"+i.util.bytesToHex(h.value)}else if(h.type===e.Type.BITSTRING){if(h.value.length>1?l+="0x"+i.util.bytesToHex(h.value.slice(1)):l+="(none)",h.value.length>0){var m=h.value.charCodeAt(0);m==1?l+=" (1 unused bit shown)":m>1&&(l+=" ("+m+" unused bits shown)")}}else if(h.type===e.Type.OCTETSTRING)S.test(h.value)||(l+="("+h.value+") "),l+="0x"+i.util.bytesToHex(h.value);else if(h.type===e.Type.UTF8)try{l+=i.util.decodeUtf8(h.value)}catch(g){if(g.message==="URI malformed")l+="0x"+i.util.bytesToHex(h.value)+" (malformed UTF8)";else throw g}else h.type===e.Type.PRINTABLESTRING||h.type===e.Type.IA5String?l+=h.value:S.test(h.value)?l+="0x"+i.util.bytesToHex(h.value):h.value.length===0?l+="[null]":l+=h.value}return l},Ut.exports}var Vt={exports:{}},Ot,br;function nt(){if(br)return Ot;br=1;var i=fe();return Ot=i.md=i.md||{},i.md.algorithms=i.md.algorithms||{},Ot}var _r;function yt(){if(_r)return Vt.exports;_r=1;var i=fe();nt(),de();var e=Vt.exports=i.hmac=i.hmac||{};return e.create=function(){var a=null,y=null,N=null,S=null,h={};return h.start=function(t,C){if(t!==null)if(typeof t=="string")if(t=t.toLowerCase(),t in i.md.algorithms)y=i.md.algorithms[t].create();else throw new Error('Unknown hash algorithm "'+t+'"');else y=t;if(C===null)C=a;else{if(typeof C=="string")C=i.util.createBuffer(C);else if(i.util.isArray(C)){var l=C;C=i.util.createBuffer();for(var x=0;x<l.length;++x)C.putByte(l[x])}var k=C.length();k>y.blockLength&&(y.start(),y.update(C.bytes()),C=y.digest()),N=i.util.createBuffer(),S=i.util.createBuffer(),k=C.length();for(var x=0;x<k;++x){var l=C.at(x);N.putByte(54^l),S.putByte(92^l)}if(k<y.blockLength)for(var l=y.blockLength-k,x=0;x<l;++x)N.putByte(54),S.putByte(92);a=C,N=N.bytes(),S=S.bytes()}y.start(),y.update(N)},h.update=function(t){y.update(t)},h.getMac=function(){var t=y.digest().bytes();return y.start(),y.update(S),y.update(t),y.digest()},h.digest=h.getMac,h},Vt.exports}var Ft={exports:{}},Nr;function vr(){if(Nr)return Ft.exports;Nr=1;var i=fe();nt(),de();var e=Ft.exports=i.md5=i.md5||{};i.md.md5=i.md.algorithms.md5=e,e.create=function(){h||t();var l=null,x=i.util.createBuffer(),k=new Array(16),E={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return E.start=function(){E.messageLength=0,E.fullMessageLength=E.messageLength64=[];for(var u=E.messageLengthSize/4,v=0;v<u;++v)E.fullMessageLength.push(0);return x=i.util.createBuffer(),l={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},E},E.start(),E.update=function(u,v){v==="utf8"&&(u=i.util.encodeUtf8(u));var m=u.length;E.messageLength+=m,m=[m/4294967296>>>0,m>>>0];for(var g=E.fullMessageLength.length-1;g>=0;--g)E.fullMessageLength[g]+=m[1],m[1]=m[0]+(E.fullMessageLength[g]/4294967296>>>0),E.fullMessageLength[g]=E.fullMessageLength[g]>>>0,m[0]=m[1]/4294967296>>>0;return x.putBytes(u),C(l,k,x),(x.read>2048||x.length()===0)&&x.compact(),E},E.digest=function(){var u=i.util.createBuffer();u.putBytes(x.bytes());var v=E.fullMessageLength[E.fullMessageLength.length-1]+E.messageLengthSize,m=v&E.blockLength-1;u.putBytes(a.substr(0,E.blockLength-m));for(var g,s=0,d=E.fullMessageLength.length-1;d>=0;--d)g=E.fullMessageLength[d]*8+s,s=g/4294967296>>>0,u.putInt32Le(g>>>0);var p={h0:l.h0,h1:l.h1,h2:l.h2,h3:l.h3};C(p,k,u);var I=i.util.createBuffer();return I.putInt32Le(p.h0),I.putInt32Le(p.h1),I.putInt32Le(p.h2),I.putInt32Le(p.h3),I},E};var a=null,y=null,N=null,S=null,h=!1;function t(){a="",a+=i.util.fillString("\0",64),y=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],N=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],S=new Array(64);for(var l=0;l<64;++l)S[l]=Math.floor(Math.abs(Math.sin(l+1))*4294967296);h=!0}function C(l,x,k){for(var E,u,v,m,g,s,d,p,I=k.length();I>=64;){for(u=l.h0,v=l.h1,m=l.h2,g=l.h3,p=0;p<16;++p)x[p]=k.getInt32Le(),s=g^v&(m^g),E=u+s+S[p]+x[p],d=N[p],u=g,g=m,m=v,v+=E<<d|E>>>32-d;for(;p<32;++p)s=m^g&(v^m),E=u+s+S[p]+x[y[p]],d=N[p],u=g,g=m,m=v,v+=E<<d|E>>>32-d;for(;p<48;++p)s=v^m^g,E=u+s+S[p]+x[y[p]],d=N[p],u=g,g=m,m=v,v+=E<<d|E>>>32-d;for(;p<64;++p)s=m^(v|~g),E=u+s+S[p]+x[y[p]],d=N[p],u=g,g=m,m=v,v+=E<<d|E>>>32-d;l.h0=l.h0+u|0,l.h1=l.h1+v|0,l.h2=l.h2+m|0,l.h3=l.h3+g|0,I-=64}}return Ft.exports}var Kt={exports:{}},Rr;function pt(){if(Rr)return Kt.exports;Rr=1;var i=fe();de();var e=Kt.exports=i.pem=i.pem||{};e.encode=function(N,S){S=S||{};var h="-----BEGIN "+N.type+`-----\r
`,t;if(N.procType&&(t={name:"Proc-Type",values:[String(N.procType.version),N.procType.type]},h+=a(t)),N.contentDomain&&(t={name:"Content-Domain",values:[N.contentDomain]},h+=a(t)),N.dekInfo&&(t={name:"DEK-Info",values:[N.dekInfo.algorithm]},N.dekInfo.parameters&&t.values.push(N.dekInfo.parameters),h+=a(t)),N.headers)for(var C=0;C<N.headers.length;++C)h+=a(N.headers[C]);return N.procType&&(h+=`\r
`),h+=i.util.encode64(N.body,S.maxline||64)+`\r
`,h+="-----END "+N.type+`-----\r
`,h},e.decode=function(N){for(var S=[],h=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,t=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,C=/\r?\n/,l;l=h.exec(N),!!l;){var x=l[1];x==="NEW CERTIFICATE REQUEST"&&(x="CERTIFICATE REQUEST");var k={type:x,procType:null,contentDomain:null,dekInfo:null,headers:[],body:i.util.decode64(l[3])};if(S.push(k),!!l[2]){for(var E=l[2].split(C),u=0;l&&u<E.length;){for(var v=E[u].replace(/\s+$/,""),m=u+1;m<E.length;++m){var g=E[m];if(!/\s/.test(g[0]))break;v+=g,u=m}if(l=v.match(t),l){for(var s={name:l[1],values:[]},d=l[2].split(","),p=0;p<d.length;++p)s.values.push(y(d[p]));if(k.procType)if(!k.contentDomain&&s.name==="Content-Domain")k.contentDomain=d[0]||"";else if(!k.dekInfo&&s.name==="DEK-Info"){if(s.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');k.dekInfo={algorithm:d[0],parameters:d[1]||null}}else k.headers.push(s);else{if(s.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(s.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');k.procType={version:d[0],type:d[1]}}}++u}if(k.procType==="ENCRYPTED"&&!k.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(S.length===0)throw new Error("Invalid PEM formatted message.");return S};function a(N){for(var S=N.name+": ",h=[],t=function(E,u){return" "+u},C=0;C<N.values.length;++C)h.push(N.values[C].replace(/^(\S+\r\n)/,t));S+=h.join(",")+`\r
`;for(var l=0,x=-1,C=0;C<S.length;++C,++l)if(l>65&&x!==-1){var k=S[x];k===","?(++x,S=S.substr(0,x)+`\r
 `+S.substr(x)):S=S.substr(0,x)+`\r
`+k+S.substr(x+1),l=C-x-1,x=-1,++C}else(S[C]===" "||S[C]==="	"||S[C]===",")&&(x=C);return S}function y(N){return N.replace(/^\s+/,"")}return Kt.exports}var Mt={exports:{}},qt,wr;function It(){if(wr)return qt;wr=1;var i=fe();pr(),oa(),de(),qt=i.des=i.des||{},i.des.startEncrypting=function(u,v,m,g){var s=E({key:u,output:m,decrypt:!1,mode:g||(v===null?"ECB":"CBC")});return s.start(v),s},i.des.createEncryptionCipher=function(u,v){return E({key:u,output:null,decrypt:!1,mode:v})},i.des.startDecrypting=function(u,v,m,g){var s=E({key:u,output:m,decrypt:!0,mode:g||(v===null?"ECB":"CBC")});return s.start(v),s},i.des.createDecryptionCipher=function(u,v){return E({key:u,output:null,decrypt:!0,mode:v})},i.des.Algorithm=function(u,v){var m=this;m.name=u,m.mode=new v({blockSize:8,cipher:{encrypt:function(g,s){return k(m._keys,g,s,!1)},decrypt:function(g,s){return k(m._keys,g,s,!0)}}}),m._init=!1},i.des.Algorithm.prototype.initialize=function(u){if(!this._init){var v=i.util.createBuffer(u.key);if(this.name.indexOf("3DES")===0&&v.length()!==24)throw new Error("Invalid Triple-DES key size: "+v.length()*8);this._keys=x(v),this._init=!0}},e("DES-ECB",i.cipher.modes.ecb),e("DES-CBC",i.cipher.modes.cbc),e("DES-CFB",i.cipher.modes.cfb),e("DES-OFB",i.cipher.modes.ofb),e("DES-CTR",i.cipher.modes.ctr),e("3DES-ECB",i.cipher.modes.ecb),e("3DES-CBC",i.cipher.modes.cbc),e("3DES-CFB",i.cipher.modes.cfb),e("3DES-OFB",i.cipher.modes.ofb),e("3DES-CTR",i.cipher.modes.ctr);function e(u,v){var m=function(){return new i.des.Algorithm(u,v)};i.cipher.registerAlgorithm(u,m)}var a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],y=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],N=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],S=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],t=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],C=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],l=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function x(u){for(var v=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],m=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],g=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],s=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],d=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],p=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],I=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],R=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],n=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],r=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],B=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],D=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],V=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],L=u.length()>8?3:1,O=[],q=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],M=0,H,Y=0;Y<L;Y++){var W=u.getInt32(),$=u.getInt32();H=(W>>>4^$)&252645135,$^=H,W^=H<<4,H=($>>>-16^W)&65535,W^=H,$^=H<<-16,H=(W>>>2^$)&858993459,$^=H,W^=H<<2,H=($>>>-16^W)&65535,W^=H,$^=H<<-16,H=(W>>>1^$)&1431655765,$^=H,W^=H<<1,H=($>>>8^W)&16711935,W^=H,$^=H<<8,H=(W>>>1^$)&1431655765,$^=H,W^=H<<1,H=W<<8|$>>>20&240,W=$<<24|$<<8&16711680|$>>>8&65280|$>>>24&240,$=H;for(var ie=0;ie<q.length;++ie){q[ie]?(W=W<<2|W>>>26,$=$<<2|$>>>26):(W=W<<1|W>>>27,$=$<<1|$>>>27),W&=-15,$&=-15;var se=v[W>>>28]|m[W>>>24&15]|g[W>>>20&15]|s[W>>>16&15]|d[W>>>12&15]|p[W>>>8&15]|I[W>>>4&15],he=R[$>>>28]|c[$>>>24&15]|n[$>>>20&15]|r[$>>>16&15]|B[$>>>12&15]|D[$>>>8&15]|V[$>>>4&15];H=(he>>>16^se)&65535,O[M++]=se^H,O[M++]=he^H<<16}}return O}function k(u,v,m,g){var s=u.length===32?3:9,d;s===3?d=g?[30,-2,-2]:[0,32,2]:d=g?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var p,I=v[0],R=v[1];p=(I>>>4^R)&252645135,R^=p,I^=p<<4,p=(I>>>16^R)&65535,R^=p,I^=p<<16,p=(R>>>2^I)&858993459,I^=p,R^=p<<2,p=(R>>>8^I)&16711935,I^=p,R^=p<<8,p=(I>>>1^R)&1431655765,R^=p,I^=p<<1,I=I<<1|I>>>31,R=R<<1|R>>>31;for(var c=0;c<s;c+=3){for(var n=d[c+1],r=d[c+2],B=d[c];B!=n;B+=r){var D=R^u[B],V=(R>>>4|R<<28)^u[B+1];p=I,I=R,R=p^(y[D>>>24&63]|S[D>>>16&63]|t[D>>>8&63]|l[D&63]|a[V>>>24&63]|N[V>>>16&63]|h[V>>>8&63]|C[V&63])}p=I,I=R,R=p}I=I>>>1|I<<31,R=R>>>1|R<<31,p=(I>>>1^R)&1431655765,R^=p,I^=p<<1,p=(R>>>8^I)&16711935,I^=p,R^=p<<8,p=(R>>>2^I)&858993459,I^=p,R^=p<<2,p=(I>>>16^R)&65535,R^=p,I^=p<<16,p=(I>>>4^R)&252645135,R^=p,I^=p<<4,m[0]=I,m[1]=R}function E(u){u=u||{};var v=(u.mode||"CBC").toUpperCase(),m="DES-"+v,g;u.decrypt?g=i.cipher.createDecipher(m,u.key):g=i.cipher.createCipher(m,u.key);var s=g.start;return g.start=function(d,p){var I=null;p instanceof i.util.ByteBuffer&&(I=p,p={}),p=p||{},p.output=I,p.iv=d,s.call(g,p)},g}return qt}var Ht,Lr;function yr(){if(Lr)return Ht;Lr=1;var i=fe();yt(),nt(),de();var e=i.pkcs5=i.pkcs5||{},a;return i.util.isNodejs&&!i.options.usePureJavaScript&&(a=dr),Ht=i.pbkdf2=e.pbkdf2=function(y,N,S,h,t,C){if(typeof t=="function"&&(C=t,t=null),i.util.isNodejs&&!i.options.usePureJavaScript&&a.pbkdf2&&(t===null||typeof t!="object")&&(a.pbkdf2Sync.length>4||!t||t==="sha1"))return typeof t!="string"&&(t="sha1"),y=We.from(y,"binary"),N=We.from(N,"binary"),C?a.pbkdf2Sync.length===4?a.pbkdf2(y,N,S,h,function(c,n){if(c)return C(c);C(null,n.toString("binary"))}):a.pbkdf2(y,N,S,h,t,function(c,n){if(c)return C(c);C(null,n.toString("binary"))}):a.pbkdf2Sync.length===4?a.pbkdf2Sync(y,N,S,h).toString("binary"):a.pbkdf2Sync(y,N,S,h,t).toString("binary");if((typeof t>"u"||t===null)&&(t="sha1"),typeof t=="string"){if(!(t in i.md.algorithms))throw new Error("Unknown hash algorithm: "+t);t=i.md[t].create()}var l=t.digestLength;if(h>4294967295*l){var x=new Error("Derived key is too long.");if(C)return C(x);throw x}var k=Math.ceil(h/l),E=h-(k-1)*l,u=i.hmac.create();u.start(t,y);var v="",m,g,s;if(!C){for(var d=1;d<=k;++d){u.start(null,null),u.update(N),u.update(i.util.int32ToBytes(d)),m=s=u.digest().getBytes();for(var p=2;p<=S;++p)u.start(null,null),u.update(s),g=u.digest().getBytes(),m=i.util.xorBytes(m,g,l),s=g;v+=d<k?m:m.substr(0,E)}return v}var d=1,p;function I(){if(d>k)return C(null,v);u.start(null,null),u.update(N),u.update(i.util.int32ToBytes(d)),m=s=u.digest().getBytes(),p=2,R()}function R(){if(p<=S)return u.start(null,null),u.update(s),g=u.digest().getBytes(),m=i.util.xorBytes(m,g,l),s=g,++p,i.util.setImmediate(R);v+=d<k?m:m.substr(0,E),++d,I()}I()},Ht}var xt={exports:{}},Gt={exports:{}},Dr;function ua(){if(Dr)return Gt.exports;Dr=1;var i=fe();nt(),de();var e=Gt.exports=i.sha256=i.sha256||{};i.md.sha256=i.md.algorithms.sha256=e,e.create=function(){y||S();var t=null,C=i.util.createBuffer(),l=new Array(64),x={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return x.start=function(){x.messageLength=0,x.fullMessageLength=x.messageLength64=[];for(var k=x.messageLengthSize/4,E=0;E<k;++E)x.fullMessageLength.push(0);return C=i.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},x},x.start(),x.update=function(k,E){E==="utf8"&&(k=i.util.encodeUtf8(k));var u=k.length;x.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var v=x.fullMessageLength.length-1;v>=0;--v)x.fullMessageLength[v]+=u[1],u[1]=u[0]+(x.fullMessageLength[v]/4294967296>>>0),x.fullMessageLength[v]=x.fullMessageLength[v]>>>0,u[0]=u[1]/4294967296>>>0;return C.putBytes(k),h(t,l,C),(C.read>2048||C.length()===0)&&C.compact(),x},x.digest=function(){var k=i.util.createBuffer();k.putBytes(C.bytes());var E=x.fullMessageLength[x.fullMessageLength.length-1]+x.messageLengthSize,u=E&x.blockLength-1;k.putBytes(a.substr(0,x.blockLength-u));for(var v,m,g=x.fullMessageLength[0]*8,s=0;s<x.fullMessageLength.length-1;++s)v=x.fullMessageLength[s+1]*8,m=v/4294967296>>>0,g+=m,k.putInt32(g>>>0),g=v>>>0;k.putInt32(g);var d={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};h(d,l,k);var p=i.util.createBuffer();return p.putInt32(d.h0),p.putInt32(d.h1),p.putInt32(d.h2),p.putInt32(d.h3),p.putInt32(d.h4),p.putInt32(d.h5),p.putInt32(d.h6),p.putInt32(d.h7),p},x};var a=null,y=!1,N=null;function S(){a="",a+=i.util.fillString("\0",64),N=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],y=!0}function h(t,C,l){for(var x,k,E,u,v,m,g,s,d,p,I,R,c,n,r,B=l.length();B>=64;){for(g=0;g<16;++g)C[g]=l.getInt32();for(;g<64;++g)x=C[g-2],x=(x>>>17|x<<15)^(x>>>19|x<<13)^x>>>10,k=C[g-15],k=(k>>>7|k<<25)^(k>>>18|k<<14)^k>>>3,C[g]=x+C[g-7]+k+C[g-16]|0;for(s=t.h0,d=t.h1,p=t.h2,I=t.h3,R=t.h4,c=t.h5,n=t.h6,r=t.h7,g=0;g<64;++g)u=(R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7),v=n^R&(c^n),E=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),m=s&d|p&(s^d),x=r+u+v+N[g]+C[g],k=E+m,r=n,n=c,c=R,R=I+x>>>0,I=p,p=d,d=s,s=x+k>>>0;t.h0=t.h0+s|0,t.h1=t.h1+d|0,t.h2=t.h2+p|0,t.h3=t.h3+I|0,t.h4=t.h4+R|0,t.h5=t.h5+c|0,t.h6=t.h6+n|0,t.h7=t.h7+r|0,B-=64}}return Gt.exports}var Qt={exports:{}},kr;function fa(){if(kr)return Qt.exports;kr=1;var i=fe();de();var e=null;i.util.isNodejs&&!i.options.usePureJavaScript&&!ut.versions["node-webkit"]&&(e=dr);var a=Qt.exports=i.prng=i.prng||{};return a.create=function(y){for(var N={plugin:y,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},S=y.md,h=new Array(32),t=0;t<32;++t)h[t]=S.create();N.pools=h,N.pool=0,N.generate=function(E,u){if(!u)return N.generateSync(E);var v=N.plugin.cipher,m=N.plugin.increment,g=N.plugin.formatKey,s=N.plugin.formatSeed,d=i.util.createBuffer();N.key=null,p();function p(I){if(I)return u(I);if(d.length()>=E)return u(null,d.getBytes(E));if(N.generated>1048575&&(N.key=null),N.key===null)return i.util.nextTick(function(){C(p)});var R=v(N.key,N.seed);N.generated+=R.length,d.putBytes(R),N.key=g(v(N.key,m(N.seed))),N.seed=s(v(N.key,N.seed)),i.util.setImmediate(p)}},N.generateSync=function(E){var u=N.plugin.cipher,v=N.plugin.increment,m=N.plugin.formatKey,g=N.plugin.formatSeed;N.key=null;for(var s=i.util.createBuffer();s.length()<E;){N.generated>1048575&&(N.key=null),N.key===null&&l();var d=u(N.key,N.seed);N.generated+=d.length,s.putBytes(d),N.key=m(u(N.key,v(N.seed))),N.seed=g(u(N.key,N.seed))}return s.getBytes(E)};function C(E){if(N.pools[0].messageLength>=32)return x(),E();var u=32-N.pools[0].messageLength<<5;N.seedFile(u,function(v,m){if(v)return E(v);N.collect(m),x(),E()})}function l(){if(N.pools[0].messageLength>=32)return x();var E=32-N.pools[0].messageLength<<5;N.collect(N.seedFileSync(E)),x()}function x(){N.reseeds=N.reseeds===4294967295?0:N.reseeds+1;var E=N.plugin.md.create();E.update(N.keyBytes);for(var u=1,v=0;v<32;++v)N.reseeds%u===0&&(E.update(N.pools[v].digest().getBytes()),N.pools[v].start()),u=u<<1;N.keyBytes=E.digest().getBytes(),E.start(),E.update(N.keyBytes);var m=E.digest().getBytes();N.key=N.plugin.formatKey(N.keyBytes),N.seed=N.plugin.formatSeed(m),N.generated=0}function k(E){var u=null,v=i.util.globalScope,m=v.crypto||v.msCrypto;m&&m.getRandomValues&&(u=function(r){return m.getRandomValues(r)});var g=i.util.createBuffer();if(u)for(;g.length()<E;){var s=Math.max(1,Math.min(E-g.length(),65536)/4),d=new Uint32Array(Math.floor(s));try{u(d);for(var p=0;p<d.length;++p)g.putInt32(d[p])}catch(r){if(!(typeof QuotaExceededError<"u"&&r instanceof QuotaExceededError))throw r}}if(g.length()<E)for(var I,R,c,n=Math.floor(Math.random()*65536);g.length()<E;){R=16807*(n&65535),I=16807*(n>>16),R+=(I&32767)<<16,R+=I>>15,R=(R&2147483647)+(R>>31),n=R&4294967295;for(var p=0;p<3;++p)c=n>>>(p<<3),c^=Math.floor(Math.random()*256),g.putByte(c&255)}return g.getBytes(E)}return e?(N.seedFile=function(E,u){e.randomBytes(E,function(v,m){if(v)return u(v);u(null,m.toString())})},N.seedFileSync=function(E){return e.randomBytes(E).toString()}):(N.seedFile=function(E,u){try{u(null,k(E))}catch(v){u(v)}},N.seedFileSync=k),N.collect=function(E){for(var u=E.length,v=0;v<u;++v)N.pools[N.pool].update(E.substr(v,1)),N.pool=N.pool===31?0:N.pool+1},N.collectInt=function(E,u){for(var v="",m=0;m<u;m+=8)v+=String.fromCharCode(E>>m&255);N.collect(v)},N.registerWorker=function(E){if(E===self)N.seedFile=function(v,m){function g(s){var d=s.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",g),m(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:v}}})};else{var u=function(v){var m=v.data;m.forge&&m.forge.prng&&N.seedFile(m.forge.prng.needed,function(g,s){E.postMessage({forge:{prng:{err:g,bytes:s}}})})};E.addEventListener("message",u)}},N},Qt.exports}var Ur;function et(){if(Ur)return xt.exports;Ur=1;var i=fe();return lt(),ua(),fa(),de(),(function(){if(i.random&&i.random.getBytes){xt.exports=i.random;return}(function(e){var a={},y=new Array(4),N=i.util.createBuffer();a.formatKey=function(E){var u=i.util.createBuffer(E);return E=new Array(4),E[0]=u.getInt32(),E[1]=u.getInt32(),E[2]=u.getInt32(),E[3]=u.getInt32(),i.aes._expandKey(E,!1)},a.formatSeed=function(E){var u=i.util.createBuffer(E);return E=new Array(4),E[0]=u.getInt32(),E[1]=u.getInt32(),E[2]=u.getInt32(),E[3]=u.getInt32(),E},a.cipher=function(E,u){return i.aes._updateBlock(E,u,y,!1),N.putInt32(y[0]),N.putInt32(y[1]),N.putInt32(y[2]),N.putInt32(y[3]),N.getBytes()},a.increment=function(E){return++E[3],E},a.md=i.md.sha256;function S(){var E=i.prng.create(a);return E.getBytes=function(u,v){return E.generate(u,v)},E.getBytesSync=function(u){return E.generate(u)},E}var h=S(),t=null,C=i.util.globalScope,l=C.crypto||C.msCrypto;if(l&&l.getRandomValues&&(t=function(E){return l.getRandomValues(E)}),i.options.usePureJavaScript||!i.util.isNodejs&&!t){if(h.collectInt(+new Date,32),typeof navigator<"u"){var x="";for(var k in navigator)try{typeof navigator[k]=="string"&&(x+=navigator[k])}catch{}h.collect(x),x=null}e&&(e().mousemove(function(E){h.collectInt(E.clientX,16),h.collectInt(E.clientY,16)}),e().keypress(function(E){h.collectInt(E.charCode,8)}))}if(!i.random)i.random=h;else for(var k in h)i.random[k]=h[k];i.random.createInstance=S,xt.exports=i.random})(typeof jQuery<"u"?jQuery:null)})(),xt.exports}var zt,Pr;function la(){if(Pr)return zt;Pr=1;var i=fe();de();var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],a=[1,2,3,5],y=function(h,t){return h<<t&65535|(h&65535)>>16-t},N=function(h,t){return(h&65535)>>t|h<<16-t&65535};zt=i.rc2=i.rc2||{},i.rc2.expandKey=function(h,t){typeof h=="string"&&(h=i.util.createBuffer(h)),t=t||128;var C=h,l=h.length(),x=t,k=Math.ceil(x/8),E=255>>(x&7),u;for(u=l;u<128;u++)C.putByte(e[C.at(u-1)+C.at(u-l)&255]);for(C.setAt(128-k,e[C.at(128-k)&E]),u=127-k;u>=0;u--)C.setAt(u,e[C.at(u+1)^C.at(u+k)]);return C};var S=function(h,t,C){var l=!1,x=null,k=null,E=null,u,v,m,g,s=[];for(h=i.rc2.expandKey(h,t),m=0;m<64;m++)s.push(h.getInt16Le());C?(u=function(I){for(m=0;m<4;m++)I[m]+=s[g]+(I[(m+3)%4]&I[(m+2)%4])+(~I[(m+3)%4]&I[(m+1)%4]),I[m]=y(I[m],a[m]),g++},v=function(I){for(m=0;m<4;m++)I[m]+=s[I[(m+3)%4]&63]}):(u=function(I){for(m=3;m>=0;m--)I[m]=N(I[m],a[m]),I[m]-=s[g]+(I[(m+3)%4]&I[(m+2)%4])+(~I[(m+3)%4]&I[(m+1)%4]),g--},v=function(I){for(m=3;m>=0;m--)I[m]-=s[I[(m+3)%4]&63]});var d=function(I){var R=[];for(m=0;m<4;m++){var c=x.getInt16Le();E!==null&&(C?c^=E.getInt16Le():E.putInt16Le(c)),R.push(c&65535)}g=C?0:63;for(var n=0;n<I.length;n++)for(var r=0;r<I[n][0];r++)I[n][1](R);for(m=0;m<4;m++)E!==null&&(C?E.putInt16Le(R[m]):R[m]^=E.getInt16Le()),k.putInt16Le(R[m])},p=null;return p={start:function(I,R){I&&typeof I=="string"&&(I=i.util.createBuffer(I)),l=!1,x=i.util.createBuffer(),k=R||new i.util.createBuffer,E=I,p.output=k},update:function(I){for(l||x.putBuffer(I);x.length()>=8;)d([[5,u],[1,v],[6,u],[1,v],[5,u]])},finish:function(I){var R=!0;if(C)if(I)R=I(8,x,!C);else{var c=x.length()===8?8:8-x.length();x.fillWithByte(c,c)}if(R&&(l=!0,p.update()),!C&&(R=x.length()===0,R))if(I)R=I(8,k,!C);else{var n=k.length(),r=k.at(n-1);r>n?R=!1:k.truncate(r)}return R}},p};return i.rc2.startEncrypting=function(h,t,C){var l=i.rc2.createEncryptionCipher(h,128);return l.start(t,C),l},i.rc2.createEncryptionCipher=function(h,t){return S(h,t,!0)},i.rc2.startDecrypting=function(h,t,C){var l=i.rc2.createDecryptionCipher(h,128);return l.start(t,C),l},i.rc2.createDecryptionCipher=function(h,t){return S(h,t,!1)},zt}var Yt,Vr;function At(){if(Vr)return Yt;Vr=1;var i=fe();Yt=i.jsbn=i.jsbn||{};var e;function a(T,b,U){this.data=[],T!=null&&(typeof T=="number"?this.fromNumber(T,b,U):b==null&&typeof T!="string"?this.fromString(T,256):this.fromString(T,b))}i.jsbn.BigInteger=a;function y(){return new a(null)}function N(T,b,U,K,Q,X){for(;--X>=0;){var re=b*this.data[T++]+U.data[K]+Q;Q=Math.floor(re/67108864),U.data[K++]=re&67108863}return Q}function S(T,b,U,K,Q,X){for(var re=b&32767,J=b>>15;--X>=0;){var pe=this.data[T]&32767,Fe=this.data[T++]>>15,Xe=J*pe+Fe*re;pe=re*pe+((Xe&32767)<<15)+U.data[K]+(Q&1073741823),Q=(pe>>>30)+(Xe>>>15)+J*Fe+(Q>>>30),U.data[K++]=pe&1073741823}return Q}function h(T,b,U,K,Q,X){for(var re=b&16383,J=b>>14;--X>=0;){var pe=this.data[T]&16383,Fe=this.data[T++]>>14,Xe=J*pe+Fe*re;pe=re*pe+((Xe&16383)<<14)+U.data[K]+Q,Q=(pe>>28)+(Xe>>14)+J*Fe,U.data[K++]=pe&268435455}return Q}typeof navigator>"u"?(a.prototype.am=h,e=28):navigator.appName=="Microsoft Internet Explorer"?(a.prototype.am=S,e=30):navigator.appName!="Netscape"?(a.prototype.am=N,e=26):(a.prototype.am=h,e=28),a.prototype.DB=e,a.prototype.DM=(1<<e)-1,a.prototype.DV=1<<e;var t=52;a.prototype.FV=Math.pow(2,t),a.prototype.F1=t-e,a.prototype.F2=2*e-t;var C="0123456789abcdefghijklmnopqrstuvwxyz",l=new Array,x,k;for(x=48,k=0;k<=9;++k)l[x++]=k;for(x=97,k=10;k<36;++k)l[x++]=k;for(x=65,k=10;k<36;++k)l[x++]=k;function E(T){return C.charAt(T)}function u(T,b){var U=l[T.charCodeAt(b)];return U??-1}function v(T){for(var b=this.t-1;b>=0;--b)T.data[b]=this.data[b];T.t=this.t,T.s=this.s}function m(T){this.t=1,this.s=T<0?-1:0,T>0?this.data[0]=T:T<-1?this.data[0]=T+this.DV:this.t=0}function g(T){var b=y();return b.fromInt(T),b}function s(T,b){var U;if(b==16)U=4;else if(b==8)U=3;else if(b==256)U=8;else if(b==2)U=1;else if(b==32)U=5;else if(b==4)U=2;else{this.fromRadix(T,b);return}this.t=0,this.s=0;for(var K=T.length,Q=!1,X=0;--K>=0;){var re=U==8?T[K]&255:u(T,K);if(re<0){T.charAt(K)=="-"&&(Q=!0);continue}Q=!1,X==0?this.data[this.t++]=re:X+U>this.DB?(this.data[this.t-1]|=(re&(1<<this.DB-X)-1)<<X,this.data[this.t++]=re>>this.DB-X):this.data[this.t-1]|=re<<X,X+=U,X>=this.DB&&(X-=this.DB)}U==8&&(T[0]&128)!=0&&(this.s=-1,X>0&&(this.data[this.t-1]|=(1<<this.DB-X)-1<<X)),this.clamp(),Q&&a.ZERO.subTo(this,this)}function d(){for(var T=this.s&this.DM;this.t>0&&this.data[this.t-1]==T;)--this.t}function p(T){if(this.s<0)return"-"+this.negate().toString(T);var b;if(T==16)b=4;else if(T==8)b=3;else if(T==2)b=1;else if(T==32)b=5;else if(T==4)b=2;else return this.toRadix(T);var U=(1<<b)-1,K,Q=!1,X="",re=this.t,J=this.DB-re*this.DB%b;if(re-- >0)for(J<this.DB&&(K=this.data[re]>>J)>0&&(Q=!0,X=E(K));re>=0;)J<b?(K=(this.data[re]&(1<<J)-1)<<b-J,K|=this.data[--re]>>(J+=this.DB-b)):(K=this.data[re]>>(J-=b)&U,J<=0&&(J+=this.DB,--re)),K>0&&(Q=!0),Q&&(X+=E(K));return Q?X:"0"}function I(){var T=y();return a.ZERO.subTo(this,T),T}function R(){return this.s<0?this.negate():this}function c(T){var b=this.s-T.s;if(b!=0)return b;var U=this.t;if(b=U-T.t,b!=0)return this.s<0?-b:b;for(;--U>=0;)if((b=this.data[U]-T.data[U])!=0)return b;return 0}function n(T){var b=1,U;return(U=T>>>16)!=0&&(T=U,b+=16),(U=T>>8)!=0&&(T=U,b+=8),(U=T>>4)!=0&&(T=U,b+=4),(U=T>>2)!=0&&(T=U,b+=2),(U=T>>1)!=0&&(T=U,b+=1),b}function r(){return this.t<=0?0:this.DB*(this.t-1)+n(this.data[this.t-1]^this.s&this.DM)}function B(T,b){var U;for(U=this.t-1;U>=0;--U)b.data[U+T]=this.data[U];for(U=T-1;U>=0;--U)b.data[U]=0;b.t=this.t+T,b.s=this.s}function D(T,b){for(var U=T;U<this.t;++U)b.data[U-T]=this.data[U];b.t=Math.max(this.t-T,0),b.s=this.s}function V(T,b){var U=T%this.DB,K=this.DB-U,Q=(1<<K)-1,X=Math.floor(T/this.DB),re=this.s<<U&this.DM,J;for(J=this.t-1;J>=0;--J)b.data[J+X+1]=this.data[J]>>K|re,re=(this.data[J]&Q)<<U;for(J=X-1;J>=0;--J)b.data[J]=0;b.data[X]=re,b.t=this.t+X+1,b.s=this.s,b.clamp()}function L(T,b){b.s=this.s;var U=Math.floor(T/this.DB);if(U>=this.t){b.t=0;return}var K=T%this.DB,Q=this.DB-K,X=(1<<K)-1;b.data[0]=this.data[U]>>K;for(var re=U+1;re<this.t;++re)b.data[re-U-1]|=(this.data[re]&X)<<Q,b.data[re-U]=this.data[re]>>K;K>0&&(b.data[this.t-U-1]|=(this.s&X)<<Q),b.t=this.t-U,b.clamp()}function O(T,b){for(var U=0,K=0,Q=Math.min(T.t,this.t);U<Q;)K+=this.data[U]-T.data[U],b.data[U++]=K&this.DM,K>>=this.DB;if(T.t<this.t){for(K-=T.s;U<this.t;)K+=this.data[U],b.data[U++]=K&this.DM,K>>=this.DB;K+=this.s}else{for(K+=this.s;U<T.t;)K-=T.data[U],b.data[U++]=K&this.DM,K>>=this.DB;K-=T.s}b.s=K<0?-1:0,K<-1?b.data[U++]=this.DV+K:K>0&&(b.data[U++]=K),b.t=U,b.clamp()}function q(T,b){var U=this.abs(),K=T.abs(),Q=U.t;for(b.t=Q+K.t;--Q>=0;)b.data[Q]=0;for(Q=0;Q<K.t;++Q)b.data[Q+U.t]=U.am(0,K.data[Q],b,Q,0,U.t);b.s=0,b.clamp(),this.s!=T.s&&a.ZERO.subTo(b,b)}function M(T){for(var b=this.abs(),U=T.t=2*b.t;--U>=0;)T.data[U]=0;for(U=0;U<b.t-1;++U){var K=b.am(U,b.data[U],T,2*U,0,1);(T.data[U+b.t]+=b.am(U+1,2*b.data[U],T,2*U+1,K,b.t-U-1))>=b.DV&&(T.data[U+b.t]-=b.DV,T.data[U+b.t+1]=1)}T.t>0&&(T.data[T.t-1]+=b.am(U,b.data[U],T,2*U,0,1)),T.s=0,T.clamp()}function H(T,b,U){var K=T.abs();if(!(K.t<=0)){var Q=this.abs();if(Q.t<K.t){b?.fromInt(0),U!=null&&this.copyTo(U);return}U==null&&(U=y());var X=y(),re=this.s,J=T.s,pe=this.DB-n(K.data[K.t-1]);pe>0?(K.lShiftTo(pe,X),Q.lShiftTo(pe,U)):(K.copyTo(X),Q.copyTo(U));var Fe=X.t,Xe=X.data[Fe-1];if(Xe!=0){var ze=Xe*(1<<this.F1)+(Fe>1?X.data[Fe-2]>>this.F2:0),it=this.FV/ze,mt=(1<<this.F1)/ze,$e=1<<this.F2,Je=U.t,Et=Je-Fe,ot=b??y();for(X.dlShiftTo(Et,ot),U.compareTo(ot)>=0&&(U.data[U.t++]=1,U.subTo(ot,U)),a.ONE.dlShiftTo(Fe,ot),ot.subTo(X,X);X.t<Fe;)X.data[X.t++]=0;for(;--Et>=0;){var bt=U.data[--Je]==Xe?this.DM:Math.floor(U.data[Je]*it+(U.data[Je-1]+$e)*mt);if((U.data[Je]+=X.am(0,bt,U,Et,0,Fe))<bt)for(X.dlShiftTo(Et,ot),U.subTo(ot,U);U.data[Je]<--bt;)U.subTo(ot,U)}b!=null&&(U.drShiftTo(Fe,b),re!=J&&a.ZERO.subTo(b,b)),U.t=Fe,U.clamp(),pe>0&&U.rShiftTo(pe,U),re<0&&a.ZERO.subTo(U,U)}}}function Y(T){var b=y();return this.abs().divRemTo(T,null,b),this.s<0&&b.compareTo(a.ZERO)>0&&T.subTo(b,b),b}function W(T){this.m=T}function $(T){return T.s<0||T.compareTo(this.m)>=0?T.mod(this.m):T}function ie(T){return T}function se(T){T.divRemTo(this.m,null,T)}function he(T,b,U){T.multiplyTo(b,U),this.reduce(U)}function ge(T,b){T.squareTo(b),this.reduce(b)}W.prototype.convert=$,W.prototype.revert=ie,W.prototype.reduce=se,W.prototype.mulTo=he,W.prototype.sqrTo=ge;function j(){if(this.t<1)return 0;var T=this.data[0];if((T&1)==0)return 0;var b=T&3;return b=b*(2-(T&15)*b)&15,b=b*(2-(T&255)*b)&255,b=b*(2-((T&65535)*b&65535))&65535,b=b*(2-T*b%this.DV)%this.DV,b>0?this.DV-b:-b}function ue(T){this.m=T,this.mp=T.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<T.DB-15)-1,this.mt2=2*T.t}function Z(T){var b=y();return T.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),T.s<0&&b.compareTo(a.ZERO)>0&&this.m.subTo(b,b),b}function qe(T){var b=y();return T.copyTo(b),this.reduce(b),b}function le(T){for(;T.t<=this.mt2;)T.data[T.t++]=0;for(var b=0;b<this.m.t;++b){var U=T.data[b]&32767,K=U*this.mpl+((U*this.mph+(T.data[b]>>15)*this.mpl&this.um)<<15)&T.DM;for(U=b+this.m.t,T.data[U]+=this.m.am(0,K,T,b,0,this.m.t);T.data[U]>=T.DV;)T.data[U]-=T.DV,T.data[++U]++}T.clamp(),T.drShiftTo(this.m.t,T),T.compareTo(this.m)>=0&&T.subTo(this.m,T)}function f(T,b){T.squareTo(b),this.reduce(b)}function w(T,b,U){T.multiplyTo(b,U),this.reduce(U)}ue.prototype.convert=Z,ue.prototype.revert=qe,ue.prototype.reduce=le,ue.prototype.mulTo=w,ue.prototype.sqrTo=f;function _(){return(this.t>0?this.data[0]&1:this.s)==0}function o(T,b){if(T>4294967295||T<1)return a.ONE;var U=y(),K=y(),Q=b.convert(this),X=n(T)-1;for(Q.copyTo(U);--X>=0;)if(b.sqrTo(U,K),(T&1<<X)>0)b.mulTo(K,Q,U);else{var re=U;U=K,K=re}return b.revert(U)}function A(T,b){var U;return T<256||b.isEven()?U=new W(b):U=new ue(b),this.exp(T,U)}a.prototype.copyTo=v,a.prototype.fromInt=m,a.prototype.fromString=s,a.prototype.clamp=d,a.prototype.dlShiftTo=B,a.prototype.drShiftTo=D,a.prototype.lShiftTo=V,a.prototype.rShiftTo=L,a.prototype.subTo=O,a.prototype.multiplyTo=q,a.prototype.squareTo=M,a.prototype.divRemTo=H,a.prototype.invDigit=j,a.prototype.isEven=_,a.prototype.exp=o,a.prototype.toString=p,a.prototype.negate=I,a.prototype.abs=R,a.prototype.compareTo=c,a.prototype.bitLength=r,a.prototype.mod=Y,a.prototype.modPowInt=A,a.ZERO=g(0),a.ONE=g(1);function F(){var T=y();return this.copyTo(T),T}function P(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function z(){return this.t==0?this.s:this.data[0]<<24>>24}function ee(){return this.t==0?this.s:this.data[0]<<16>>16}function ae(T){return Math.floor(Math.LN2*this.DB/Math.log(T))}function G(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function te(T){if(T==null&&(T=10),this.signum()==0||T<2||T>36)return"0";var b=this.chunkSize(T),U=Math.pow(T,b),K=g(U),Q=y(),X=y(),re="";for(this.divRemTo(K,Q,X);Q.signum()>0;)re=(U+X.intValue()).toString(T).substr(1)+re,Q.divRemTo(K,Q,X);return X.intValue().toString(T)+re}function ne(T,b){this.fromInt(0),b==null&&(b=10);for(var U=this.chunkSize(b),K=Math.pow(b,U),Q=!1,X=0,re=0,J=0;J<T.length;++J){var pe=u(T,J);if(pe<0){T.charAt(J)=="-"&&this.signum()==0&&(Q=!0);continue}re=b*re+pe,++X>=U&&(this.dMultiply(K),this.dAddOffset(re,0),X=0,re=0)}X>0&&(this.dMultiply(Math.pow(b,X)),this.dAddOffset(re,0)),Q&&a.ZERO.subTo(this,this)}function ce(T,b,U){if(typeof b=="number")if(T<2)this.fromInt(1);else for(this.fromNumber(T,U),this.testBit(T-1)||this.bitwiseTo(a.ONE.shiftLeft(T-1),Te,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>T&&this.subTo(a.ONE.shiftLeft(T-1),this);else{var K=new Array,Q=T&7;K.length=(T>>3)+1,b.nextBytes(K),Q>0?K[0]&=(1<<Q)-1:K[0]=0,this.fromString(K,256)}}function oe(){var T=this.t,b=new Array;b[0]=this.s;var U=this.DB-T*this.DB%8,K,Q=0;if(T-- >0)for(U<this.DB&&(K=this.data[T]>>U)!=(this.s&this.DM)>>U&&(b[Q++]=K|this.s<<this.DB-U);T>=0;)U<8?(K=(this.data[T]&(1<<U)-1)<<8-U,K|=this.data[--T]>>(U+=this.DB-8)):(K=this.data[T]>>(U-=8)&255,U<=0&&(U+=this.DB,--T)),(K&128)!=0&&(K|=-256),Q==0&&(this.s&128)!=(K&128)&&++Q,(Q>0||K!=this.s)&&(b[Q++]=K);return b}function Ce(T){return this.compareTo(T)==0}function Se(T){return this.compareTo(T)<0?this:T}function xe(T){return this.compareTo(T)>0?this:T}function me(T,b,U){var K,Q,X=Math.min(T.t,this.t);for(K=0;K<X;++K)U.data[K]=b(this.data[K],T.data[K]);if(T.t<this.t){for(Q=T.s&this.DM,K=X;K<this.t;++K)U.data[K]=b(this.data[K],Q);U.t=this.t}else{for(Q=this.s&this.DM,K=X;K<T.t;++K)U.data[K]=b(Q,T.data[K]);U.t=T.t}U.s=b(this.s,T.s),U.clamp()}function ve(T,b){return T&b}function ye(T){var b=y();return this.bitwiseTo(T,ve,b),b}function Te(T,b){return T|b}function Ke(T){var b=y();return this.bitwiseTo(T,Te,b),b}function Me(T,b){return T^b}function He(T){var b=y();return this.bitwiseTo(T,Me,b),b}function Ge(T,b){return T&~b}function Qe(T){var b=y();return this.bitwiseTo(T,Ge,b),b}function Ye(){for(var T=y(),b=0;b<this.t;++b)T.data[b]=this.DM&~this.data[b];return T.t=this.t,T.s=~this.s,T}function je(T){var b=y();return T<0?this.rShiftTo(-T,b):this.lShiftTo(T,b),b}function tt(T){var b=y();return T<0?this.lShiftTo(-T,b):this.rShiftTo(T,b),b}function at(T){if(T==0)return-1;var b=0;return(T&65535)==0&&(T>>=16,b+=16),(T&255)==0&&(T>>=8,b+=8),(T&15)==0&&(T>>=4,b+=4),(T&3)==0&&(T>>=2,b+=2),(T&1)==0&&++b,b}function st(){for(var T=0;T<this.t;++T)if(this.data[T]!=0)return T*this.DB+at(this.data[T]);return this.s<0?this.t*this.DB:-1}function ft(T){for(var b=0;T!=0;)T&=T-1,++b;return b}function ht(){for(var T=0,b=this.s&this.DM,U=0;U<this.t;++U)T+=ft(this.data[U]^b);return T}function vt(T){var b=Math.floor(T/this.DB);return b>=this.t?this.s!=0:(this.data[b]&1<<T%this.DB)!=0}function Ct(T,b){var U=a.ONE.shiftLeft(T);return this.bitwiseTo(U,b,U),U}function Ae(T){return this.changeBit(T,Te)}function Be(T){return this.changeBit(T,Ge)}function be(T){return this.changeBit(T,Me)}function _e(T,b){for(var U=0,K=0,Q=Math.min(T.t,this.t);U<Q;)K+=this.data[U]+T.data[U],b.data[U++]=K&this.DM,K>>=this.DB;if(T.t<this.t){for(K+=T.s;U<this.t;)K+=this.data[U],b.data[U++]=K&this.DM,K>>=this.DB;K+=this.s}else{for(K+=this.s;U<T.t;)K+=T.data[U],b.data[U++]=K&this.DM,K>>=this.DB;K+=T.s}b.s=K<0?-1:0,K>0?b.data[U++]=K:K<-1&&(b.data[U++]=this.DV+K),b.t=U,b.clamp()}function Ne(T){var b=y();return this.addTo(T,b),b}function Re(T){var b=y();return this.subTo(T,b),b}function we(T){var b=y();return this.multiplyTo(T,b),b}function Le(T){var b=y();return this.divRemTo(T,b,null),b}function De(T){var b=y();return this.divRemTo(T,null,b),b}function ke(T){var b=y(),U=y();return this.divRemTo(T,b,U),new Array(b,U)}function Ue(T){this.data[this.t]=this.am(0,T-1,this,0,0,this.t),++this.t,this.clamp()}function Pe(T,b){if(T!=0){for(;this.t<=b;)this.data[this.t++]=0;for(this.data[b]+=T;this.data[b]>=this.DV;)this.data[b]-=this.DV,++b>=this.t&&(this.data[this.t++]=0),++this.data[b]}}function Ee(){}function Ie(T){return T}function Ve(T,b,U){T.multiplyTo(b,U)}function Oe(T,b){T.squareTo(b)}Ee.prototype.convert=Ie,Ee.prototype.revert=Ie,Ee.prototype.mulTo=Ve,Ee.prototype.sqrTo=Oe;function Ea(T){return this.exp(T,new Ee)}function xa(T,b,U){var K=Math.min(this.t+T.t,b);for(U.s=0,U.t=K;K>0;)U.data[--K]=0;var Q;for(Q=U.t-this.t;K<Q;++K)U.data[K+this.t]=this.am(0,T.data[K],U,K,0,this.t);for(Q=Math.min(T.t,b);K<Q;++K)this.am(0,T.data[K],U,K,0,b-K);U.clamp()}function Sa(T,b,U){--b;var K=U.t=this.t+T.t-b;for(U.s=0;--K>=0;)U.data[K]=0;for(K=Math.max(b-this.t,0);K<T.t;++K)U.data[this.t+K-b]=this.am(b-K,T.data[K],U,0,0,this.t+K-b);U.clamp(),U.drShiftTo(1,U)}function dt(T){this.r2=y(),this.q3=y(),a.ONE.dlShiftTo(2*T.t,this.r2),this.mu=this.r2.divide(T),this.m=T}function Ta(T){if(T.s<0||T.t>2*this.m.t)return T.mod(this.m);if(T.compareTo(this.m)<0)return T;var b=y();return T.copyTo(b),this.reduce(b),b}function Ia(T){return T}function Aa(T){for(T.drShiftTo(this.m.t-1,this.r2),T.t>this.m.t+1&&(T.t=this.m.t+1,T.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);T.compareTo(this.r2)<0;)T.dAddOffset(1,this.m.t+1);for(T.subTo(this.r2,T);T.compareTo(this.m)>=0;)T.subTo(this.m,T)}function Ba(T,b){T.squareTo(b),this.reduce(b)}function ba(T,b,U){T.multiplyTo(b,U),this.reduce(U)}dt.prototype.convert=Ta,dt.prototype.revert=Ia,dt.prototype.reduce=Aa,dt.prototype.mulTo=ba,dt.prototype.sqrTo=Ba;function _a(T,b){var U=T.bitLength(),K,Q=g(1),X;if(U<=0)return Q;U<18?K=1:U<48?K=3:U<144?K=4:U<768?K=5:K=6,U<8?X=new W(b):b.isEven()?X=new dt(b):X=new ue(b);var re=new Array,J=3,pe=K-1,Fe=(1<<K)-1;if(re[1]=X.convert(this),K>1){var Xe=y();for(X.sqrTo(re[1],Xe);J<=Fe;)re[J]=y(),X.mulTo(Xe,re[J-2],re[J]),J+=2}var ze=T.t-1,it,mt=!0,$e=y(),Je;for(U=n(T.data[ze])-1;ze>=0;){for(U>=pe?it=T.data[ze]>>U-pe&Fe:(it=(T.data[ze]&(1<<U+1)-1)<<pe-U,ze>0&&(it|=T.data[ze-1]>>this.DB+U-pe)),J=K;(it&1)==0;)it>>=1,--J;if((U-=J)<0&&(U+=this.DB,--ze),mt)re[it].copyTo(Q),mt=!1;else{for(;J>1;)X.sqrTo(Q,$e),X.sqrTo($e,Q),J-=2;J>0?X.sqrTo(Q,$e):(Je=Q,Q=$e,$e=Je),X.mulTo($e,re[it],Q)}for(;ze>=0&&(T.data[ze]&1<<U)==0;)X.sqrTo(Q,$e),Je=Q,Q=$e,$e=Je,--U<0&&(U=this.DB-1,--ze)}return X.revert(Q)}function Na(T){var b=this.s<0?this.negate():this.clone(),U=T.s<0?T.negate():T.clone();if(b.compareTo(U)<0){var K=b;b=U,U=K}var Q=b.getLowestSetBit(),X=U.getLowestSetBit();if(X<0)return b;for(Q<X&&(X=Q),X>0&&(b.rShiftTo(X,b),U.rShiftTo(X,U));b.signum()>0;)(Q=b.getLowestSetBit())>0&&b.rShiftTo(Q,b),(Q=U.getLowestSetBit())>0&&U.rShiftTo(Q,U),b.compareTo(U)>=0?(b.subTo(U,b),b.rShiftTo(1,b)):(U.subTo(b,U),U.rShiftTo(1,U));return X>0&&U.lShiftTo(X,U),U}function Ra(T){if(T<=0)return 0;var b=this.DV%T,U=this.s<0?T-1:0;if(this.t>0)if(b==0)U=this.data[0]%T;else for(var K=this.t-1;K>=0;--K)U=(b*U+this.data[K])%T;return U}function wa(T){var b=T.isEven();if(this.isEven()&&b||T.signum()==0)return a.ZERO;for(var U=T.clone(),K=this.clone(),Q=g(1),X=g(0),re=g(0),J=g(1);U.signum()!=0;){for(;U.isEven();)U.rShiftTo(1,U),b?((!Q.isEven()||!X.isEven())&&(Q.addTo(this,Q),X.subTo(T,X)),Q.rShiftTo(1,Q)):X.isEven()||X.subTo(T,X),X.rShiftTo(1,X);for(;K.isEven();)K.rShiftTo(1,K),b?((!re.isEven()||!J.isEven())&&(re.addTo(this,re),J.subTo(T,J)),re.rShiftTo(1,re)):J.isEven()||J.subTo(T,J),J.rShiftTo(1,J);U.compareTo(K)>=0?(U.subTo(K,U),b&&Q.subTo(re,Q),X.subTo(J,X)):(K.subTo(U,K),b&&re.subTo(Q,re),J.subTo(X,J))}if(K.compareTo(a.ONE)!=0)return a.ZERO;if(J.compareTo(T)>=0)return J.subtract(T);if(J.signum()<0)J.addTo(T,J);else return J;return J.signum()<0?J.add(T):J}var Ze=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],La=(1<<26)/Ze[Ze.length-1];function Da(T){var b,U=this.abs();if(U.t==1&&U.data[0]<=Ze[Ze.length-1]){for(b=0;b<Ze.length;++b)if(U.data[0]==Ze[b])return!0;return!1}if(U.isEven())return!1;for(b=1;b<Ze.length;){for(var K=Ze[b],Q=b+1;Q<Ze.length&&K<La;)K*=Ze[Q++];for(K=U.modInt(K);b<Q;)if(K%Ze[b++]==0)return!1}return U.millerRabin(T)}function ka(T){var b=this.subtract(a.ONE),U=b.getLowestSetBit();if(U<=0)return!1;for(var K=b.shiftRight(U),Q=Ua(),X,re=0;re<T;++re){do X=new a(this.bitLength(),Q);while(X.compareTo(a.ONE)<=0||X.compareTo(b)>=0);var J=X.modPow(K,this);if(J.compareTo(a.ONE)!=0&&J.compareTo(b)!=0){for(var pe=1;pe++<U&&J.compareTo(b)!=0;)if(J=J.modPowInt(2,this),J.compareTo(a.ONE)==0)return!1;if(J.compareTo(b)!=0)return!1}}return!0}function Ua(){return{nextBytes:function(T){for(var b=0;b<T.length;++b)T[b]=Math.floor(Math.random()*256)}}}return a.prototype.chunkSize=ae,a.prototype.toRadix=te,a.prototype.fromRadix=ne,a.prototype.fromNumber=ce,a.prototype.bitwiseTo=me,a.prototype.changeBit=Ct,a.prototype.addTo=_e,a.prototype.dMultiply=Ue,a.prototype.dAddOffset=Pe,a.prototype.multiplyLowerTo=xa,a.prototype.multiplyUpperTo=Sa,a.prototype.modInt=Ra,a.prototype.millerRabin=ka,a.prototype.clone=F,a.prototype.intValue=P,a.prototype.byteValue=z,a.prototype.shortValue=ee,a.prototype.signum=G,a.prototype.toByteArray=oe,a.prototype.equals=Ce,a.prototype.min=Se,a.prototype.max=xe,a.prototype.and=ye,a.prototype.or=Ke,a.prototype.xor=He,a.prototype.andNot=Qe,a.prototype.not=Ye,a.prototype.shiftLeft=je,a.prototype.shiftRight=tt,a.prototype.getLowestSetBit=st,a.prototype.bitCount=ht,a.prototype.testBit=vt,a.prototype.setBit=Ae,a.prototype.clearBit=Be,a.prototype.flipBit=be,a.prototype.add=Ne,a.prototype.subtract=Re,a.prototype.multiply=we,a.prototype.divide=Le,a.prototype.remainder=De,a.prototype.divideAndRemainder=ke,a.prototype.modPow=_a,a.prototype.modInverse=wa,a.prototype.pow=Ea,a.prototype.gcd=Na,a.prototype.isProbablePrime=Da,Yt}var Xt={exports:{}},Wt={exports:{}},Or;function gt(){if(Or)return Wt.exports;Or=1;var i=fe();nt(),de();var e=Wt.exports=i.sha1=i.sha1||{};i.md.sha1=i.md.algorithms.sha1=e,e.create=function(){y||N();var h=null,t=i.util.createBuffer(),C=new Array(80),l={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return l.start=function(){l.messageLength=0,l.fullMessageLength=l.messageLength64=[];for(var x=l.messageLengthSize/4,k=0;k<x;++k)l.fullMessageLength.push(0);return t=i.util.createBuffer(),h={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},l},l.start(),l.update=function(x,k){k==="utf8"&&(x=i.util.encodeUtf8(x));var E=x.length;l.messageLength+=E,E=[E/4294967296>>>0,E>>>0];for(var u=l.fullMessageLength.length-1;u>=0;--u)l.fullMessageLength[u]+=E[1],E[1]=E[0]+(l.fullMessageLength[u]/4294967296>>>0),l.fullMessageLength[u]=l.fullMessageLength[u]>>>0,E[0]=E[1]/4294967296>>>0;return t.putBytes(x),S(h,C,t),(t.read>2048||t.length()===0)&&t.compact(),l},l.digest=function(){var x=i.util.createBuffer();x.putBytes(t.bytes());var k=l.fullMessageLength[l.fullMessageLength.length-1]+l.messageLengthSize,E=k&l.blockLength-1;x.putBytes(a.substr(0,l.blockLength-E));for(var u,v,m=l.fullMessageLength[0]*8,g=0;g<l.fullMessageLength.length-1;++g)u=l.fullMessageLength[g+1]*8,v=u/4294967296>>>0,m+=v,x.putInt32(m>>>0),m=u>>>0;x.putInt32(m);var s={h0:h.h0,h1:h.h1,h2:h.h2,h3:h.h3,h4:h.h4};S(s,C,x);var d=i.util.createBuffer();return d.putInt32(s.h0),d.putInt32(s.h1),d.putInt32(s.h2),d.putInt32(s.h3),d.putInt32(s.h4),d},l};var a=null,y=!1;function N(){a="",a+=i.util.fillString("\0",64),y=!0}function S(h,t,C){for(var l,x,k,E,u,v,m,g,s=C.length();s>=64;){for(x=h.h0,k=h.h1,E=h.h2,u=h.h3,v=h.h4,g=0;g<16;++g)l=C.getInt32(),t[g]=l,m=u^k&(E^u),l=(x<<5|x>>>27)+m+v+1518500249+l,v=u,u=E,E=(k<<30|k>>>2)>>>0,k=x,x=l;for(;g<20;++g)l=t[g-3]^t[g-8]^t[g-14]^t[g-16],l=l<<1|l>>>31,t[g]=l,m=u^k&(E^u),l=(x<<5|x>>>27)+m+v+1518500249+l,v=u,u=E,E=(k<<30|k>>>2)>>>0,k=x,x=l;for(;g<32;++g)l=t[g-3]^t[g-8]^t[g-14]^t[g-16],l=l<<1|l>>>31,t[g]=l,m=k^E^u,l=(x<<5|x>>>27)+m+v+1859775393+l,v=u,u=E,E=(k<<30|k>>>2)>>>0,k=x,x=l;for(;g<40;++g)l=t[g-6]^t[g-16]^t[g-28]^t[g-32],l=l<<2|l>>>30,t[g]=l,m=k^E^u,l=(x<<5|x>>>27)+m+v+1859775393+l,v=u,u=E,E=(k<<30|k>>>2)>>>0,k=x,x=l;for(;g<60;++g)l=t[g-6]^t[g-16]^t[g-28]^t[g-32],l=l<<2|l>>>30,t[g]=l,m=k&E|u&(k^E),l=(x<<5|x>>>27)+m+v+2400959708+l,v=u,u=E,E=(k<<30|k>>>2)>>>0,k=x,x=l;for(;g<80;++g)l=t[g-6]^t[g-16]^t[g-28]^t[g-32],l=l<<2|l>>>30,t[g]=l,m=k^E^u,l=(x<<5|x>>>27)+m+v+3395469782+l,v=u,u=E,E=(k<<30|k>>>2)>>>0,k=x,x=l;h.h0=h.h0+x|0,h.h1=h.h1+k|0,h.h2=h.h2+E|0,h.h3=h.h3+u|0,h.h4=h.h4+v|0,s-=64}}return Wt.exports}var Fr;function ca(){if(Fr)return Xt.exports;Fr=1;var i=fe();de(),et(),gt();var e=Xt.exports=i.pkcs1=i.pkcs1||{};e.encode_rsa_oaep=function(y,N,S){var h,t,C,l;typeof S=="string"?(h=S,t=arguments[3]||void 0,C=arguments[4]||void 0):S&&(h=S.label||void 0,t=S.seed||void 0,C=S.md||void 0,S.mgf1&&S.mgf1.md&&(l=S.mgf1.md)),C?C.start():C=i.md.sha1.create(),l||(l=C);var x=Math.ceil(y.n.bitLength()/8),k=x-2*C.digestLength-2;if(N.length>k){var E=new Error("RSAES-OAEP input message length is too long.");throw E.length=N.length,E.maxLength=k,E}h||(h=""),C.update(h,"raw");for(var u=C.digest(),v="",m=k-N.length,g=0;g<m;g++)v+="\0";var s=u.getBytes()+v+""+N;if(!t)t=i.random.getBytes(C.digestLength);else if(t.length!==C.digestLength){var E=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw E.seedLength=t.length,E.digestLength=C.digestLength,E}var d=a(t,x-C.digestLength-1,l),p=i.util.xorBytes(s,d,s.length),I=a(p,C.digestLength,l),R=i.util.xorBytes(t,I,t.length);return"\0"+R+p},e.decode_rsa_oaep=function(y,N,S){var h,t,C;typeof S=="string"?(h=S,t=arguments[3]||void 0):S&&(h=S.label||void 0,t=S.md||void 0,S.mgf1&&S.mgf1.md&&(C=S.mgf1.md));var l=Math.ceil(y.n.bitLength()/8);if(N.length!==l){var p=new Error("RSAES-OAEP encoded message length is invalid.");throw p.length=N.length,p.expectedLength=l,p}if(t===void 0?t=i.md.sha1.create():t.start(),C||(C=t),l<2*t.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");h||(h=""),t.update(h,"raw");for(var x=t.digest().getBytes(),k=N.charAt(0),E=N.substring(1,t.digestLength+1),u=N.substring(1+t.digestLength),v=a(u,t.digestLength,C),m=i.util.xorBytes(E,v,E.length),g=a(m,l-t.digestLength-1,C),s=i.util.xorBytes(u,g,u.length),d=s.substring(0,t.digestLength),p=k!=="\0",I=0;I<t.digestLength;++I)p|=x.charAt(I)!==d.charAt(I);for(var R=1,c=t.digestLength,n=t.digestLength;n<s.length;n++){var r=s.charCodeAt(n),B=r&1^1,D=R?65534:0;p|=r&D,R=R&B,c+=R}if(p||s.charCodeAt(c)!==1)throw new Error("Invalid RSAES-OAEP padding.");return s.substring(c+1)};function a(y,N,S){S||(S=i.md.sha1.create());for(var h="",t=Math.ceil(N/S.digestLength),C=0;C<t;++C){var l=String.fromCharCode(C>>24&255,C>>16&255,C>>8&255,C&255);S.start(),S.update(y+l),h+=S.digest().getBytes()}return h.substring(0,N)}return Xt.exports}var St={exports:{}},Kr;function ha(){if(Kr)return St.exports;Kr=1;var i=fe();return de(),At(),et(),(function(){if(i.prime){St.exports=i.prime;return}var e=St.exports=i.prime=i.prime||{},a=i.jsbn.BigInteger,y=[6,4,2,4,2,4,6,2],N=new a(null);N.fromInt(30);var S=function(E,u){return E|u};e.generateProbablePrime=function(E,u,v){typeof u=="function"&&(v=u,u={}),u=u||{};var m=u.algorithm||"PRIMEINC";typeof m=="string"&&(m={name:m}),m.options=m.options||{};var g=u.prng||i.random,s={nextBytes:function(d){for(var p=g.getBytesSync(d.length),I=0;I<d.length;++I)d[I]=p.charCodeAt(I)}};if(m.name==="PRIMEINC")return h(E,s,m.options,v);throw new Error("Invalid prime generation algorithm: "+m.name)};function h(E,u,v,m){return"workers"in v?l(E,u,v,m):t(E,u,v,m)}function t(E,u,v,m){var g=x(E,u),s=0,d=k(g.bitLength());"millerRabinTests"in v&&(d=v.millerRabinTests);var p=10;"maxBlockTime"in v&&(p=v.maxBlockTime),C(g,E,u,s,d,p,m)}function C(E,u,v,m,g,s,d){var p=+new Date;do{if(E.bitLength()>u&&(E=x(u,v)),E.isProbablePrime(g))return d(null,E);E.dAddOffset(y[m++%8],0)}while(s<0||+new Date-p<s);i.util.setImmediate(function(){C(E,u,v,m,g,s,d)})}function l(E,u,v,m){if(typeof Worker>"u")return t(E,u,v,m);var g=x(E,u),s=v.workers,d=v.workLoad||100,p=d*30/8,I=v.workerScript||"forge/prime.worker.js";if(s===-1)return i.util.estimateCores(function(c,n){c&&(n=2),s=n-1,R()});R();function R(){s=Math.max(1,s);for(var c=[],n=0;n<s;++n)c[n]=new Worker(I);for(var n=0;n<s;++n)c[n].addEventListener("message",B);var r=!1;function B(D){if(!r){var V=D.data;if(V.found){for(var L=0;L<c.length;++L)c[L].terminate();return r=!0,m(null,new a(V.prime,16))}g.bitLength()>E&&(g=x(E,u));var O=g.toString(16);D.target.postMessage({hex:O,workLoad:d}),g.dAddOffset(p,0)}}}}function x(E,u){var v=new a(E,u),m=E-1;return v.testBit(m)||v.bitwiseTo(a.ONE.shiftLeft(m),S,v),v.dAddOffset(31-v.mod(N).byteValue(),0),v}function k(E){return E<=100?27:E<=150?18:E<=200?15:E<=250?12:E<=300?9:E<=350?8:E<=400?7:E<=500?6:E<=600?5:E<=800?4:E<=1250?3:2}})(),St.exports}var jt,Mr;function Bt(){if(Mr)return jt;Mr=1;var i=fe();if(rt(),At(),ct(),ca(),ha(),et(),de(),typeof e>"u")var e=i.jsbn.BigInteger;var a=i.util.isNodejs?dr:null,y=i.asn1,N=i.util;i.pki=i.pki||{},jt=i.pki.rsa=i.rsa=i.rsa||{};var S=i.pki,h=[6,4,2,4,2,4,6,2],t={name:"PrivateKeyInfo",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:y.Class.UNIVERSAL,type:y.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},C={name:"RSAPrivateKey",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},l={name:"RSAPublicKey",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},x=i.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},k={name:"DigestInfo",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:y.Class.UNIVERSAL,type:y.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:y.Class.UNIVERSAL,type:y.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},E=function(n){var r;if(n.algorithm in S.oids)r=S.oids[n.algorithm];else{var B=new Error("Unknown message digest algorithm.");throw B.algorithm=n.algorithm,B}var D=y.oidToDer(r).getBytes(),V=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),L=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);L.value.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,D)),L.value.push(y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,""));var O=y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,n.digest().getBytes());return V.value.push(L),V.value.push(O),y.toDer(V).getBytes()},u=function(n,r,B){if(B)return n.modPow(r.e,r.n);if(!r.p||!r.q)return n.modPow(r.d,r.n);r.dP||(r.dP=r.d.mod(r.p.subtract(e.ONE))),r.dQ||(r.dQ=r.d.mod(r.q.subtract(e.ONE))),r.qInv||(r.qInv=r.q.modInverse(r.p));var D;do D=new e(i.util.bytesToHex(i.random.getBytes(r.n.bitLength()/8)),16);while(D.compareTo(r.n)>=0||!D.gcd(r.n).equals(e.ONE));n=n.multiply(D.modPow(r.e,r.n)).mod(r.n);for(var V=n.mod(r.p).modPow(r.dP,r.p),L=n.mod(r.q).modPow(r.dQ,r.q);V.compareTo(L)<0;)V=V.add(r.p);var O=V.subtract(L).multiply(r.qInv).mod(r.p).multiply(r.q).add(L);return O=O.multiply(D.modInverse(r.n)).mod(r.n),O};S.rsa.encrypt=function(n,r,B){var D=B,V,L=Math.ceil(r.n.bitLength()/8);B!==!1&&B!==!0?(D=B===2,V=v(n,r,B)):(V=i.util.createBuffer(),V.putBytes(n));for(var O=new e(V.toHex(),16),q=u(O,r,D),M=q.toString(16),H=i.util.createBuffer(),Y=L-Math.ceil(M.length/2);Y>0;)H.putByte(0),--Y;return H.putBytes(i.util.hexToBytes(M)),H.getBytes()},S.rsa.decrypt=function(n,r,B,D){var V=Math.ceil(r.n.bitLength()/8);if(n.length!==V){var L=new Error("Encrypted message length is invalid.");throw L.length=n.length,L.expected=V,L}var O=new e(i.util.createBuffer(n).toHex(),16);if(O.compareTo(r.n)>=0)throw new Error("Encrypted message is invalid.");for(var q=u(O,r,B),M=q.toString(16),H=i.util.createBuffer(),Y=V-Math.ceil(M.length/2);Y>0;)H.putByte(0),--Y;return H.putBytes(i.util.hexToBytes(M)),D!==!1?m(H.getBytes(),r,B):H.getBytes()},S.rsa.createKeyPairGenerationState=function(n,r,B){typeof n=="string"&&(n=parseInt(n,10)),n=n||2048,B=B||{};var D=B.prng||i.random,V={nextBytes:function(q){for(var M=D.getBytesSync(q.length),H=0;H<q.length;++H)q[H]=M.charCodeAt(H)}},L=B.algorithm||"PRIMEINC",O;if(L==="PRIMEINC")O={algorithm:L,state:0,bits:n,rng:V,eInt:r||65537,e:new e(null),p:null,q:null,qBits:n>>1,pBits:n-(n>>1),pqState:0,num:null,keys:null},O.e.fromInt(O.eInt);else throw new Error("Invalid key generation algorithm: "+L);return O},S.rsa.stepKeyPairGenerationState=function(n,r){"algorithm"in n||(n.algorithm="PRIMEINC");var B=new e(null);B.fromInt(30);for(var D=0,V=function(W,$){return W|$},L=+new Date,O,q=0;n.keys===null&&(r<=0||q<r);){if(n.state===0){var M=n.p===null?n.pBits:n.qBits,H=M-1;n.pqState===0?(n.num=new e(M,n.rng),n.num.testBit(H)||n.num.bitwiseTo(e.ONE.shiftLeft(H),V,n.num),n.num.dAddOffset(31-n.num.mod(B).byteValue(),0),D=0,++n.pqState):n.pqState===1?n.num.bitLength()>M?n.pqState=0:n.num.isProbablePrime(d(n.num.bitLength()))?++n.pqState:n.num.dAddOffset(h[D++%8],0):n.pqState===2?n.pqState=n.num.subtract(e.ONE).gcd(n.e).compareTo(e.ONE)===0?3:0:n.pqState===3&&(n.pqState=0,n.p===null?n.p=n.num:n.q=n.num,n.p!==null&&n.q!==null&&++n.state,n.num=null)}else if(n.state===1)n.p.compareTo(n.q)<0&&(n.num=n.p,n.p=n.q,n.q=n.num),++n.state;else if(n.state===2)n.p1=n.p.subtract(e.ONE),n.q1=n.q.subtract(e.ONE),n.phi=n.p1.multiply(n.q1),++n.state;else if(n.state===3)n.phi.gcd(n.e).compareTo(e.ONE)===0?++n.state:(n.p=null,n.q=null,n.state=0);else if(n.state===4)n.n=n.p.multiply(n.q),n.n.bitLength()===n.bits?++n.state:(n.q=null,n.state=0);else if(n.state===5){var Y=n.e.modInverse(n.phi);n.keys={privateKey:S.rsa.setPrivateKey(n.n,n.e,Y,n.p,n.q,Y.mod(n.p1),Y.mod(n.q1),n.q.modInverse(n.p)),publicKey:S.rsa.setPublicKey(n.n,n.e)}}O=+new Date,q+=O-L,L=O}return n.keys!==null},S.rsa.generateKeyPair=function(n,r,B,D){if(arguments.length===1?typeof n=="object"?(B=n,n=void 0):typeof n=="function"&&(D=n,n=void 0):arguments.length===2?typeof n=="number"?typeof r=="function"?(D=r,r=void 0):typeof r!="number"&&(B=r,r=void 0):(B=n,D=r,n=void 0,r=void 0):arguments.length===3&&(typeof r=="number"?typeof B=="function"&&(D=B,B=void 0):(D=B,B=r,r=void 0)),B=B||{},n===void 0&&(n=B.bits||2048),r===void 0&&(r=B.e||65537),!i.options.usePureJavaScript&&!B.prng&&n>=256&&n<=16384&&(r===65537||r===3)){if(D){if(p("generateKeyPair"))return a.generateKeyPair("rsa",{modulusLength:n,publicExponent:r,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(q,M,H){if(q)return D(q);D(null,{privateKey:S.privateKeyFromPem(H),publicKey:S.publicKeyFromPem(M)})});if(I("generateKey")&&I("exportKey"))return N.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:c(r),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(q){return N.globalScope.crypto.subtle.exportKey("pkcs8",q.privateKey)}).then(void 0,function(q){D(q)}).then(function(q){if(q){var M=S.privateKeyFromAsn1(y.fromDer(i.util.createBuffer(q)));D(null,{privateKey:M,publicKey:S.setRsaPublicKey(M.n,M.e)})}});if(R("generateKey")&&R("exportKey")){var V=N.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:c(r),hash:{name:"SHA-256"}},!0,["sign","verify"]);V.oncomplete=function(q){var M=q.target.result,H=N.globalScope.msCrypto.subtle.exportKey("pkcs8",M.privateKey);H.oncomplete=function(Y){var W=Y.target.result,$=S.privateKeyFromAsn1(y.fromDer(i.util.createBuffer(W)));D(null,{privateKey:$,publicKey:S.setRsaPublicKey($.n,$.e)})},H.onerror=function(Y){D(Y)}},V.onerror=function(q){D(q)};return}}else if(p("generateKeyPairSync")){var L=a.generateKeyPairSync("rsa",{modulusLength:n,publicExponent:r,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:S.privateKeyFromPem(L.privateKey),publicKey:S.publicKeyFromPem(L.publicKey)}}}var O=S.rsa.createKeyPairGenerationState(n,r,B);if(!D)return S.rsa.stepKeyPairGenerationState(O,0),O.keys;g(O,B,D)},S.setRsaPublicKey=S.rsa.setPublicKey=function(n,r){var B={n,e:r};return B.encrypt=function(D,V,L){if(typeof V=="string"?V=V.toUpperCase():V===void 0&&(V="RSAES-PKCS1-V1_5"),V==="RSAES-PKCS1-V1_5")V={encode:function(q,M,H){return v(q,M,2).getBytes()}};else if(V==="RSA-OAEP"||V==="RSAES-OAEP")V={encode:function(q,M){return i.pkcs1.encode_rsa_oaep(M,q,L)}};else if(["RAW","NONE","NULL",null].indexOf(V)!==-1)V={encode:function(q){return q}};else if(typeof V=="string")throw new Error('Unsupported encryption scheme: "'+V+'".');var O=V.encode(D,B,!0);return S.rsa.encrypt(O,B,!0)},B.verify=function(D,V,L,O){typeof L=="string"?L=L.toUpperCase():L===void 0&&(L="RSASSA-PKCS1-V1_5"),O===void 0&&(O={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in O||(O._parseAllDigestBytes=!0),L==="RSASSA-PKCS1-V1_5"?L={verify:function(M,H){H=m(H,B,!0);var Y=y.fromDer(H,{parseAllBytes:O._parseAllDigestBytes}),W={},$=[];if(!y.validate(Y,k,W,$)){var ie=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw ie.errors=$,ie}var se=y.derToOid(W.algorithmIdentifier);if(!(se===i.oids.md2||se===i.oids.md5||se===i.oids.sha1||se===i.oids.sha224||se===i.oids.sha256||se===i.oids.sha384||se===i.oids.sha512||se===i.oids["sha512-224"]||se===i.oids["sha512-256"])){var ie=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw ie.oid=se,ie}if((se===i.oids.md2||se===i.oids.md5)&&!("parameters"in W))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifier NULL parameters.");return M===W.digest}}:(L==="NONE"||L==="NULL"||L===null)&&(L={verify:function(M,H){return H=m(H,B,!0),M===H}});var q=S.rsa.decrypt(V,B,!0,!1);return L.verify(D,q,B.n.bitLength())},B},S.setRsaPrivateKey=S.rsa.setPrivateKey=function(n,r,B,D,V,L,O,q){var M={n,e:r,d:B,p:D,q:V,dP:L,dQ:O,qInv:q};return M.decrypt=function(H,Y,W){typeof Y=="string"?Y=Y.toUpperCase():Y===void 0&&(Y="RSAES-PKCS1-V1_5");var $=S.rsa.decrypt(H,M,!1,!1);if(Y==="RSAES-PKCS1-V1_5")Y={decode:m};else if(Y==="RSA-OAEP"||Y==="RSAES-OAEP")Y={decode:function(ie,se){return i.pkcs1.decode_rsa_oaep(se,ie,W)}};else if(["RAW","NONE","NULL",null].indexOf(Y)!==-1)Y={decode:function(ie){return ie}};else throw new Error('Unsupported encryption scheme: "'+Y+'".');return Y.decode($,M,!1)},M.sign=function(H,Y){var W=!1;typeof Y=="string"&&(Y=Y.toUpperCase()),Y===void 0||Y==="RSASSA-PKCS1-V1_5"?(Y={encode:E},W=1):(Y==="NONE"||Y==="NULL"||Y===null)&&(Y={encode:function(){return H}},W=1);var $=Y.encode(H,M.n.bitLength());return S.rsa.encrypt($,M,W)},M},S.wrapRsaPrivateKey=function(n){return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(0).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(S.oids.rsaEncryption).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")]),y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,y.toDer(n).getBytes())])},S.privateKeyFromAsn1=function(n){var r={},B=[];if(y.validate(n,t,r,B)&&(n=y.fromDer(i.util.createBuffer(r.privateKey))),r={},B=[],!y.validate(n,C,r,B)){var D=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw D.errors=B,D}var V,L,O,q,M,H,Y,W;return V=i.util.createBuffer(r.privateKeyModulus).toHex(),L=i.util.createBuffer(r.privateKeyPublicExponent).toHex(),O=i.util.createBuffer(r.privateKeyPrivateExponent).toHex(),q=i.util.createBuffer(r.privateKeyPrime1).toHex(),M=i.util.createBuffer(r.privateKeyPrime2).toHex(),H=i.util.createBuffer(r.privateKeyExponent1).toHex(),Y=i.util.createBuffer(r.privateKeyExponent2).toHex(),W=i.util.createBuffer(r.privateKeyCoefficient).toHex(),S.setRsaPrivateKey(new e(V,16),new e(L,16),new e(O,16),new e(q,16),new e(M,16),new e(H,16),new e(Y,16),new e(W,16))},S.privateKeyToAsn1=S.privateKeyToRSAPrivateKey=function(n){return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(0).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,s(n.n)),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,s(n.e)),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,s(n.d)),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,s(n.p)),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,s(n.q)),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,s(n.dP)),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,s(n.dQ)),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,s(n.qInv))])},S.publicKeyFromAsn1=function(n){var r={},B=[];if(y.validate(n,x,r,B)){var D=y.derToOid(r.publicKeyOid);if(D!==S.oids.rsaEncryption){var V=new Error("Cannot read public key. Unknown OID.");throw V.oid=D,V}n=r.rsaPublicKey}if(B=[],!y.validate(n,l,r,B)){var V=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw V.errors=B,V}var L=i.util.createBuffer(r.publicKeyModulus).toHex(),O=i.util.createBuffer(r.publicKeyExponent).toHex();return S.setRsaPublicKey(new e(L,16),new e(O,16))},S.publicKeyToAsn1=S.publicKeyToSubjectPublicKeyInfo=function(n){return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(S.oids.rsaEncryption).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")]),y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,[S.publicKeyToRSAPublicKey(n)])])},S.publicKeyToRSAPublicKey=function(n){return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,s(n.n)),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,s(n.e))])};function v(n,r,B){var D=i.util.createBuffer(),V=Math.ceil(r.n.bitLength()/8);if(n.length>V-11){var L=new Error("Message is too long for PKCS#1 v1.5 padding.");throw L.length=n.length,L.max=V-11,L}D.putByte(0),D.putByte(B);var O=V-3-n.length,q;if(B===0||B===1){q=B===0?0:255;for(var M=0;M<O;++M)D.putByte(q)}else for(;O>0;){for(var H=0,Y=i.random.getBytes(O),M=0;M<O;++M)q=Y.charCodeAt(M),q===0?++H:D.putByte(q);O=H}return D.putByte(0),D.putBytes(n),D}function m(n,r,B,D){var V=Math.ceil(r.n.bitLength()/8),L=i.util.createBuffer(n),O=L.getByte(),q=L.getByte();if(O!==0||B&&q!==0&&q!==1||!B&&q!=2||B&&q===0&&typeof D>"u")throw new Error("Encryption block is invalid.");var M=0;if(q===0){M=V-3-D;for(var H=0;H<M;++H)if(L.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(q===1)for(M=0;L.length()>1;){if(L.getByte()!==255){--L.read;break}++M}else if(q===2)for(M=0;L.length()>1;){if(L.getByte()===0){--L.read;break}++M}var Y=L.getByte();if(Y!==0||M!==V-3-L.length())throw new Error("Encryption block is invalid.");return L.getBytes()}function g(n,r,B){typeof r=="function"&&(B=r,r={}),r=r||{};var D={algorithm:{name:r.algorithm||"PRIMEINC",options:{workers:r.workers||2,workLoad:r.workLoad||100,workerScript:r.workerScript}}};"prng"in r&&(D.prng=r.prng),V();function V(){L(n.pBits,function(q,M){if(q)return B(q);if(n.p=M,n.q!==null)return O(q,n.q);L(n.qBits,O)})}function L(q,M){i.prime.generateProbablePrime(q,D,M)}function O(q,M){if(q)return B(q);if(n.q=M,n.p.compareTo(n.q)<0){var H=n.p;n.p=n.q,n.q=H}if(n.p.subtract(e.ONE).gcd(n.e).compareTo(e.ONE)!==0){n.p=null,V();return}if(n.q.subtract(e.ONE).gcd(n.e).compareTo(e.ONE)!==0){n.q=null,L(n.qBits,O);return}if(n.p1=n.p.subtract(e.ONE),n.q1=n.q.subtract(e.ONE),n.phi=n.p1.multiply(n.q1),n.phi.gcd(n.e).compareTo(e.ONE)!==0){n.p=n.q=null,V();return}if(n.n=n.p.multiply(n.q),n.n.bitLength()!==n.bits){n.q=null,L(n.qBits,O);return}var Y=n.e.modInverse(n.phi);n.keys={privateKey:S.rsa.setPrivateKey(n.n,n.e,Y,n.p,n.q,Y.mod(n.p1),Y.mod(n.q1),n.q.modInverse(n.p)),publicKey:S.rsa.setPublicKey(n.n,n.e)},B(null,n.keys)}}function s(n){var r=n.toString(16);r[0]>="8"&&(r="00"+r);var B=i.util.hexToBytes(r);return B.length>1&&(B.charCodeAt(0)===0&&(B.charCodeAt(1)&128)===0||B.charCodeAt(0)===255&&(B.charCodeAt(1)&128)===128)?B.substr(1):B}function d(n){return n<=100?27:n<=150?18:n<=200?15:n<=250?12:n<=300?9:n<=350?8:n<=400?7:n<=500?6:n<=600?5:n<=800?4:n<=1250?3:2}function p(n){return i.util.isNodejs&&typeof a[n]=="function"}function I(n){return typeof N.globalScope<"u"&&typeof N.globalScope.crypto=="object"&&typeof N.globalScope.crypto.subtle=="object"&&typeof N.globalScope.crypto.subtle[n]=="function"}function R(n){return typeof N.globalScope<"u"&&typeof N.globalScope.msCrypto=="object"&&typeof N.globalScope.msCrypto.subtle=="object"&&typeof N.globalScope.msCrypto.subtle[n]=="function"}function c(n){for(var r=i.util.hexToBytes(n.toString(16)),B=new Uint8Array(r.length),D=0;D<r.length;++D)B[D]=r.charCodeAt(D);return B}return jt}var Zt,qr;function da(){if(qr)return Zt;qr=1;var i=fe();if(lt(),rt(),It(),nt(),ct(),yr(),pt(),et(),la(),Bt(),de(),typeof e>"u")var e=i.jsbn.BigInteger;var a=i.asn1,y=i.pki=i.pki||{};Zt=y.pbe=i.pbe=i.pbe||{};var N=y.oids,S={name:"EncryptedPrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},h={name:"PBES2Algorithms",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},t={name:"pkcs-12PbeParams",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"iterations"}]};y.encryptPrivateKeyInfo=function(E,u,v){v=v||{},v.saltSize=v.saltSize||8,v.count=v.count||2048,v.algorithm=v.algorithm||"aes128",v.prfAlgorithm=v.prfAlgorithm||"sha1";var m=i.random.getBytesSync(v.saltSize),g=v.count,s=a.integerToDer(g),d,p,I;if(v.algorithm.indexOf("aes")===0||v.algorithm==="des"){var R,c,n;switch(v.algorithm){case"aes128":d=16,R=16,c=N["aes128-CBC"],n=i.aes.createEncryptionCipher;break;case"aes192":d=24,R=16,c=N["aes192-CBC"],n=i.aes.createEncryptionCipher;break;case"aes256":d=32,R=16,c=N["aes256-CBC"],n=i.aes.createEncryptionCipher;break;case"des":d=8,R=8,c=N.desCBC,n=i.des.createEncryptionCipher;break;default:var r=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw r.algorithm=v.algorithm,r}var B="hmacWith"+v.prfAlgorithm.toUpperCase(),D=x(B),V=i.pkcs5.pbkdf2(u,m,g,d,D),L=i.random.getBytesSync(R),O=n(V);O.start(L),O.update(a.toDer(E)),O.finish(),I=O.output.getBytes();var q=k(m,s,d,B);p=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(N.pkcs5PBES2).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(N.pkcs5PBKDF2).getBytes()),q]),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(c).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,L)])])])}else if(v.algorithm==="3des"){d=24;var M=new i.util.ByteBuffer(m),V=y.pbe.generatePkcs12Key(u,M,1,g,d),L=y.pbe.generatePkcs12Key(u,M,2,g,d),O=i.des.createEncryptionCipher(V);O.start(L),O.update(a.toDer(E)),O.finish(),I=O.output.getBytes(),p=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(N["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,m),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,s.getBytes())])])}else{var r=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw r.algorithm=v.algorithm,r}var H=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[p,a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,I)]);return H},y.decryptPrivateKeyInfo=function(E,u){var v=null,m={},g=[];if(!a.validate(E,S,m,g)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=g,s}var d=a.derToOid(m.encryptionOid),p=y.pbe.getCipher(d,m.encryptionParams,u),I=i.util.createBuffer(m.encryptedData);return p.update(I),p.finish()&&(v=a.fromDer(p.output)),v},y.encryptedPrivateKeyToPem=function(E,u){var v={type:"ENCRYPTED PRIVATE KEY",body:a.toDer(E).getBytes()};return i.pem.encode(v,{maxline:u})},y.encryptedPrivateKeyFromPem=function(E){var u=i.pem.decode(E)[0];if(u.type!=="ENCRYPTED PRIVATE KEY"){var v=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw v.headerType=u.type,v}if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return a.fromDer(u.body)},y.encryptRsaPrivateKey=function(E,u,v){if(v=v||{},!v.legacy){var m=y.wrapRsaPrivateKey(y.privateKeyToAsn1(E));return m=y.encryptPrivateKeyInfo(m,u,v),y.encryptedPrivateKeyToPem(m)}var g,s,d,p;switch(v.algorithm){case"aes128":g="AES-128-CBC",d=16,s=i.random.getBytesSync(16),p=i.aes.createEncryptionCipher;break;case"aes192":g="AES-192-CBC",d=24,s=i.random.getBytesSync(16),p=i.aes.createEncryptionCipher;break;case"aes256":g="AES-256-CBC",d=32,s=i.random.getBytesSync(16),p=i.aes.createEncryptionCipher;break;case"3des":g="DES-EDE3-CBC",d=24,s=i.random.getBytesSync(8),p=i.des.createEncryptionCipher;break;case"des":g="DES-CBC",d=8,s=i.random.getBytesSync(8),p=i.des.createEncryptionCipher;break;default:var I=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+v.algorithm+'".');throw I.algorithm=v.algorithm,I}var R=i.pbe.opensslDeriveBytes(u,s.substr(0,8),d),c=p(R);c.start(s),c.update(a.toDer(y.privateKeyToAsn1(E))),c.finish();var n={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:g,parameters:i.util.bytesToHex(s).toUpperCase()},body:c.output.getBytes()};return i.pem.encode(n)},y.decryptRsaPrivateKey=function(E,u){var v=null,m=i.pem.decode(E)[0];if(m.type!=="ENCRYPTED PRIVATE KEY"&&m.type!=="PRIVATE KEY"&&m.type!=="RSA PRIVATE KEY"){var g=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw g.headerType=g,g}if(m.procType&&m.procType.type==="ENCRYPTED"){var s,d;switch(m.dekInfo.algorithm){case"DES-CBC":s=8,d=i.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,d=i.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,d=i.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,d=i.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,d=i.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,d=function(n){return i.rc2.createDecryptionCipher(n,40)};break;case"RC2-64-CBC":s=8,d=function(n){return i.rc2.createDecryptionCipher(n,64)};break;case"RC2-128-CBC":s=16,d=function(n){return i.rc2.createDecryptionCipher(n,128)};break;default:var g=new Error('Could not decrypt private key; unsupported encryption algorithm "'+m.dekInfo.algorithm+'".');throw g.algorithm=m.dekInfo.algorithm,g}var p=i.util.hexToBytes(m.dekInfo.parameters),I=i.pbe.opensslDeriveBytes(u,p.substr(0,8),s),R=d(I);if(R.start(p),R.update(i.util.createBuffer(m.body)),R.finish())v=R.output.getBytes();else return v}else v=m.body;return m.type==="ENCRYPTED PRIVATE KEY"?v=y.decryptPrivateKeyInfo(a.fromDer(v),u):v=a.fromDer(v),v!==null&&(v=y.privateKeyFromAsn1(v)),v},y.pbe.generatePkcs12Key=function(E,u,v,m,g,s){var d,p;if(typeof s>"u"||s===null){if(!("sha1"in i.md))throw new Error('"sha1" hash algorithm unavailable.');s=i.md.sha1.create()}var I=s.digestLength,R=s.blockLength,c=new i.util.ByteBuffer,n=new i.util.ByteBuffer;if(E!=null){for(p=0;p<E.length;p++)n.putInt16(E.charCodeAt(p));n.putInt16(0)}var r=n.length(),B=u.length(),D=new i.util.ByteBuffer;D.fillWithByte(v,R);var V=R*Math.ceil(B/R),L=new i.util.ByteBuffer;for(p=0;p<V;p++)L.putByte(u.at(p%B));var O=R*Math.ceil(r/R),q=new i.util.ByteBuffer;for(p=0;p<O;p++)q.putByte(n.at(p%r));var M=L;M.putBuffer(q);for(var H=Math.ceil(g/I),Y=1;Y<=H;Y++){var W=new i.util.ByteBuffer;W.putBytes(D.bytes()),W.putBytes(M.bytes());for(var $=0;$<m;$++)s.start(),s.update(W.getBytes()),W=s.digest();var ie=new i.util.ByteBuffer;for(p=0;p<R;p++)ie.putByte(W.at(p%I));var se=Math.ceil(B/R)+Math.ceil(r/R),he=new i.util.ByteBuffer;for(d=0;d<se;d++){var ge=new i.util.ByteBuffer(M.getBytes(R)),j=511;for(p=ie.length()-1;p>=0;p--)j=j>>8,j+=ie.at(p)+ge.at(p),ge.setAt(p,j&255);he.putBuffer(ge)}M=he,c.putBuffer(W)}return c.truncate(c.length()-g),c},y.pbe.getCipher=function(E,u,v){switch(E){case y.oids.pkcs5PBES2:return y.pbe.getCipherForPBES2(E,u,v);case y.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case y.oids["pbewithSHAAnd40BitRC2-CBC"]:return y.pbe.getCipherForPKCS12PBE(E,u,v);default:var m=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw m.oid=E,m.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],m}},y.pbe.getCipherForPBES2=function(E,u,v){var m={},g=[];if(!a.validate(u,h,m,g)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=g,s}if(E=a.derToOid(m.kdfOid),E!==y.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=E,s.supportedOids=["pkcs5PBKDF2"],s}if(E=a.derToOid(m.encOid),E!==y.oids["aes128-CBC"]&&E!==y.oids["aes192-CBC"]&&E!==y.oids["aes256-CBC"]&&E!==y.oids["des-EDE3-CBC"]&&E!==y.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=E,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var d=m.kdfSalt,p=i.util.createBuffer(m.kdfIterationCount);p=p.getInt(p.length()<<3);var I,R;switch(y.oids[E]){case"aes128-CBC":I=16,R=i.aes.createDecryptionCipher;break;case"aes192-CBC":I=24,R=i.aes.createDecryptionCipher;break;case"aes256-CBC":I=32,R=i.aes.createDecryptionCipher;break;case"des-EDE3-CBC":I=24,R=i.des.createDecryptionCipher;break;case"desCBC":I=8,R=i.des.createDecryptionCipher;break}var c=l(m.prfOid),n=i.pkcs5.pbkdf2(v,d,p,I,c),r=m.encIv,B=R(n);return B.start(r),B},y.pbe.getCipherForPKCS12PBE=function(E,u,v){var m={},g=[];if(!a.validate(u,t,m,g)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=g,s}var d=i.util.createBuffer(m.salt),p=i.util.createBuffer(m.iterations);p=p.getInt(p.length()<<3);var I,R,c;switch(E){case y.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:I=24,R=8,c=i.des.startDecrypting;break;case y.oids["pbewithSHAAnd40BitRC2-CBC"]:I=5,R=8,c=function(V,L){var O=i.rc2.createDecryptionCipher(V,40);return O.start(L,null),O};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=E,s}var n=l(m.prfOid),r=y.pbe.generatePkcs12Key(v,d,1,p,I,n);n.start();var B=y.pbe.generatePkcs12Key(v,d,2,p,R,n);return c(r,B)},y.pbe.opensslDeriveBytes=function(E,u,v,m){if(typeof m>"u"||m===null){if(!("md5"in i.md))throw new Error('"md5" hash algorithm unavailable.');m=i.md.md5.create()}u===null&&(u="");for(var g=[C(m,E+u)],s=16,d=1;s<v;++d,s+=16)g.push(C(m,g[d-1]+E+u));return g.join("").substr(0,v)};function C(E,u){return E.start().update(u).digest().getBytes()}function l(E){var u;if(!E)u="hmacWithSHA1";else if(u=y.oids[a.derToOid(E)],!u){var v=new Error("Unsupported PRF OID.");throw v.oid=E,v.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],v}return x(u)}function x(E){var u=i.md;switch(E){case"hmacWithSHA224":u=i.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":E=E.substr(8).toLowerCase();break;default:var v=new Error("Unsupported PRF algorithm.");throw v.algorithm=E,v.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],v}if(!u||!(E in u))throw new Error("Unknown hash algorithm: "+E);return u[E].create()}function k(E,u,v,m){var g=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,E),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,u.getBytes())]);return m!=="hmacWithSHA1"&&g.value.push(a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,i.util.hexToBytes(v.toString(16))),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(y.oids[m]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")])),g}return Zt}var $t={exports:{}},Jt={exports:{}},Hr;function pa(){if(Hr)return Jt.exports;Hr=1;var i=fe();rt(),de();var e=i.asn1,a=Jt.exports=i.pkcs7asn1=i.pkcs7asn1||{};i.pkcs7=i.pkcs7||{},i.pkcs7.asn1=a;var y={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};a.contentInfoValidator=y;var N={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};a.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(N)},a.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(N)};var S={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};return a.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},y,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[S]}]},a.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]},Jt.exports}var er={exports:{}},tr={exports:{}},Gr;function va(){if(Gr)return tr.exports;Gr=1;var i=fe();de(),i.mgf=i.mgf||{};var e=tr.exports=i.mgf.mgf1=i.mgf1=i.mgf1||{};return e.create=function(a){var y={generate:function(N,S){for(var h=new i.util.ByteBuffer,t=Math.ceil(S/a.digestLength),C=0;C<t;C++){var l=new i.util.ByteBuffer;l.putInt32(C),a.start(),a.update(N+l.getBytes()),h.putBuffer(a.digest())}return h.truncate(h.length()-S),h.getBytes()}};return y},tr.exports}var rr,Qr;function Fa(){if(Qr)return rr;Qr=1;var i=fe();return va(),rr=i.mgf=i.mgf||{},i.mgf.mgf1=i.mgf1,rr}var ar={exports:{}},zr;function gr(){if(zr)return ar.exports;zr=1;var i=fe();et(),de();var e=ar.exports=i.pss=i.pss||{};return e.create=function(a){arguments.length===3&&(a={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var y=a.md,N=a.mgf,S=y.digestLength,h=a.salt||null;typeof h=="string"&&(h=i.util.createBuffer(h));var t;if("saltLength"in a)t=a.saltLength;else if(h!==null)t=h.length();else throw new Error("Salt length not specified or specific salt not given.");if(h!==null&&h.length()!==t)throw new Error("Given salt length does not match length of given salt.");var C=a.prng||i.random,l={};return l.encode=function(x,k){var E,u=k-1,v=Math.ceil(u/8),m=x.digest().getBytes();if(v<S+t+2)throw new Error("Message is too long to encrypt.");var g;h===null?g=C.getBytesSync(t):g=h.bytes();var s=new i.util.ByteBuffer;s.fillWithByte(0,8),s.putBytes(m),s.putBytes(g),y.start(),y.update(s.getBytes());var d=y.digest().getBytes(),p=new i.util.ByteBuffer;p.fillWithByte(0,v-t-S-2),p.putByte(1),p.putBytes(g);var I=p.getBytes(),R=v-S-1,c=N.generate(d,R),n="";for(E=0;E<R;E++)n+=String.fromCharCode(I.charCodeAt(E)^c.charCodeAt(E));var r=65280>>8*v-u&255;return n=String.fromCharCode(n.charCodeAt(0)&~r)+n.substr(1),n+d+""},l.verify=function(x,k,E){var u,v=E-1,m=Math.ceil(v/8);if(k=k.substr(-m),m<S+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(k.charCodeAt(m-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var g=m-S-1,s=k.substr(0,g),d=k.substr(g,S),p=65280>>8*m-v&255;if((s.charCodeAt(0)&p)!==0)throw new Error("Bits beyond keysize not zero as expected.");var I=N.generate(d,g),R="";for(u=0;u<g;u++)R+=String.fromCharCode(s.charCodeAt(u)^I.charCodeAt(u));R=String.fromCharCode(R.charCodeAt(0)&~p)+R.substr(1);var c=m-S-t-2;for(u=0;u<c;u++)if(R.charCodeAt(u)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(c)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var n=R.substr(-t),r=new i.util.ByteBuffer;r.fillWithByte(0,8),r.putBytes(x),r.putBytes(n),y.start(),y.update(r.getBytes());var B=y.digest().getBytes();return d===B},l},ar.exports}var Yr;function Cr(){if(Yr)return er.exports;Yr=1;var i=fe();lt(),rt(),It(),nt(),Fa(),ct(),pt(),gr(),Bt(),de();var e=i.asn1,a=er.exports=i.pki=i.pki||{},y=a.oids,N={};N.CN=y.commonName,N.commonName="CN",N.C=y.countryName,N.countryName="C",N.L=y.localityName,N.localityName="L",N.ST=y.stateOrProvinceName,N.stateOrProvinceName="ST",N.O=y.organizationName,N.organizationName="O",N.OU=y.organizationalUnitName,N.organizationalUnitName="OU",N.E=y.emailAddress,N.emailAddress="E";var S=i.pki.rsa.publicKeyValidator,h={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},S,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},t={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},C={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},S,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},l={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[C,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};a.RDNAttributesAsArray=function(c,n){for(var r=[],B,D,V,L=0;L<c.value.length;++L){B=c.value[L];for(var O=0;O<B.value.length;++O)V={},D=B.value[O],V.type=e.derToOid(D.value[0].value),V.value=D.value[1].value,V.valueTagClass=D.value[1].type,V.type in y&&(V.name=y[V.type],V.name in N&&(V.shortName=N[V.name])),n&&(n.update(V.type),n.update(V.value)),r.push(V)}return r},a.CRIAttributesAsArray=function(c){for(var n=[],r=0;r<c.length;++r)for(var B=c[r],D=e.derToOid(B.value[0].value),V=B.value[1].value,L=0;L<V.length;++L){var O={};if(O.type=D,O.value=V[L].value,O.valueTagClass=V[L].type,O.type in y&&(O.name=y[O.type],O.name in N&&(O.shortName=N[O.name])),O.type===y.extensionRequest){O.extensions=[];for(var q=0;q<O.value.length;++q)O.extensions.push(a.certificateExtensionFromAsn1(O.value[q]))}n.push(O)}return n};function x(c,n){typeof n=="string"&&(n={shortName:n});for(var r=null,B,D=0;r===null&&D<c.attributes.length;++D)B=c.attributes[D],(n.type&&n.type===B.type||n.name&&n.name===B.name||n.shortName&&n.shortName===B.shortName)&&(r=B);return r}var k=function(c,n,r){var B={};if(c!==y["RSASSA-PSS"])return B;r&&(B={hash:{algorithmOid:y.sha1},mgf:{algorithmOid:y.mgf1,hash:{algorithmOid:y.sha1}},saltLength:20});var D={},V=[];if(!e.validate(n,t,D,V)){var L=new Error("Cannot read RSASSA-PSS parameter block.");throw L.errors=V,L}return D.hashOid!==void 0&&(B.hash=B.hash||{},B.hash.algorithmOid=e.derToOid(D.hashOid)),D.maskGenOid!==void 0&&(B.mgf=B.mgf||{},B.mgf.algorithmOid=e.derToOid(D.maskGenOid),B.mgf.hash=B.mgf.hash||{},B.mgf.hash.algorithmOid=e.derToOid(D.maskGenHashOid)),D.saltLength!==void 0&&(B.saltLength=D.saltLength.charCodeAt(0)),B},E=function(c){switch(y[c.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return i.md.sha1.create();case"md5WithRSAEncryption":return i.md.md5.create();case"sha256WithRSAEncryption":return i.md.sha256.create();case"sha384WithRSAEncryption":return i.md.sha384.create();case"sha512WithRSAEncryption":return i.md.sha512.create();case"RSASSA-PSS":return i.md.sha256.create();default:var n=new Error("Could not compute "+c.type+" digest. Unknown signature OID.");throw n.signatureOid=c.signatureOid,n}},u=function(c){var n=c.certificate,r;switch(n.signatureOid){case y.sha1WithRSAEncryption:case y.sha1WithRSASignature:break;case y["RSASSA-PSS"]:var B,D;if(B=y[n.signatureParameters.mgf.hash.algorithmOid],B===void 0||i.md[B]===void 0){var V=new Error("Unsupported MGF hash function.");throw V.oid=n.signatureParameters.mgf.hash.algorithmOid,V.name=B,V}if(D=y[n.signatureParameters.mgf.algorithmOid],D===void 0||i.mgf[D]===void 0){var V=new Error("Unsupported MGF function.");throw V.oid=n.signatureParameters.mgf.algorithmOid,V.name=D,V}if(D=i.mgf[D].create(i.md[B].create()),B=y[n.signatureParameters.hash.algorithmOid],B===void 0||i.md[B]===void 0){var V=new Error("Unsupported RSASSA-PSS hash function.");throw V.oid=n.signatureParameters.hash.algorithmOid,V.name=B,V}r=i.pss.create(i.md[B].create(),D,n.signatureParameters.saltLength);break}return n.publicKey.verify(c.md.digest().getBytes(),c.signature,r)};a.certificateFromPem=function(c,n,r){var B=i.pem.decode(c)[0];if(B.type!=="CERTIFICATE"&&B.type!=="X509 CERTIFICATE"&&B.type!=="TRUSTED CERTIFICATE"){var D=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw D.headerType=B.type,D}if(B.procType&&B.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var V=e.fromDer(B.body,r);return a.certificateFromAsn1(V,n)},a.certificateToPem=function(c,n){var r={type:"CERTIFICATE",body:e.toDer(a.certificateToAsn1(c)).getBytes()};return i.pem.encode(r,{maxline:n})},a.publicKeyFromPem=function(c){var n=i.pem.decode(c)[0];if(n.type!=="PUBLIC KEY"&&n.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=n.type,r}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var B=e.fromDer(n.body);return a.publicKeyFromAsn1(B)},a.publicKeyToPem=function(c,n){var r={type:"PUBLIC KEY",body:e.toDer(a.publicKeyToAsn1(c)).getBytes()};return i.pem.encode(r,{maxline:n})},a.publicKeyToRSAPublicKeyPem=function(c,n){var r={type:"RSA PUBLIC KEY",body:e.toDer(a.publicKeyToRSAPublicKey(c)).getBytes()};return i.pem.encode(r,{maxline:n})},a.getPublicKeyFingerprint=function(c,n){n=n||{};var r=n.md||i.md.sha1.create(),B=n.type||"RSAPublicKey",D;switch(B){case"RSAPublicKey":D=e.toDer(a.publicKeyToRSAPublicKey(c)).getBytes();break;case"SubjectPublicKeyInfo":D=e.toDer(a.publicKeyToAsn1(c)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+n.type+'".')}r.start(),r.update(D);var V=r.digest();if(n.encoding==="hex"){var L=V.toHex();return n.delimiter?L.match(/.{2}/g).join(n.delimiter):L}else{if(n.encoding==="binary")return V.getBytes();if(n.encoding)throw new Error('Unknown encoding "'+n.encoding+'".')}return V},a.certificationRequestFromPem=function(c,n,r){var B=i.pem.decode(c)[0];if(B.type!=="CERTIFICATE REQUEST"){var D=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw D.headerType=B.type,D}if(B.procType&&B.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var V=e.fromDer(B.body,r);return a.certificationRequestFromAsn1(V,n)},a.certificationRequestToPem=function(c,n){var r={type:"CERTIFICATE REQUEST",body:e.toDer(a.certificationRequestToAsn1(c)).getBytes()};return i.pem.encode(r,{maxline:n})},a.createCertificate=function(){var c={};return c.version=2,c.serialNumber="00",c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.validity={},c.validity.notBefore=new Date,c.validity.notAfter=new Date,c.issuer={},c.issuer.getField=function(n){return x(c.issuer,n)},c.issuer.addField=function(n){m([n]),c.issuer.attributes.push(n)},c.issuer.attributes=[],c.issuer.hash=null,c.subject={},c.subject.getField=function(n){return x(c.subject,n)},c.subject.addField=function(n){m([n]),c.subject.attributes.push(n)},c.subject.attributes=[],c.subject.hash=null,c.extensions=[],c.publicKey=null,c.md=null,c.setSubject=function(n,r){m(n),c.subject.attributes=n,delete c.subject.uniqueId,r&&(c.subject.uniqueId=r),c.subject.hash=null},c.setIssuer=function(n,r){m(n),c.issuer.attributes=n,delete c.issuer.uniqueId,r&&(c.issuer.uniqueId=r),c.issuer.hash=null},c.setExtensions=function(n){for(var r=0;r<n.length;++r)g(n[r],{cert:c});c.extensions=n},c.getExtension=function(n){typeof n=="string"&&(n={name:n});for(var r=null,B,D=0;r===null&&D<c.extensions.length;++D)B=c.extensions[D],(n.id&&B.id===n.id||n.name&&B.name===n.name)&&(r=B);return r},c.sign=function(n,r){c.md=r||i.md.sha1.create();var B=y[c.md.algorithm+"WithRSAEncryption"];if(!B){var D=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw D.algorithm=c.md.algorithm,D}c.signatureOid=c.siginfo.algorithmOid=B,c.tbsCertificate=a.getTBSCertificate(c);var V=e.toDer(c.tbsCertificate);c.md.update(V.getBytes()),c.signature=n.sign(c.md)},c.verify=function(n){var r=!1;if(!c.issued(n)){var B=n.issuer,D=c.subject,V=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw V.expectedIssuer=D.attributes,V.actualIssuer=B.attributes,V}var L=n.md;if(L===null){L=E({signatureOid:n.signatureOid,type:"certificate"});var O=n.tbsCertificate||a.getTBSCertificate(n),q=e.toDer(O);L.update(q.getBytes())}return L!==null&&(r=u({certificate:c,md:L,signature:n.signature})),r},c.isIssuer=function(n){var r=!1,B=c.issuer,D=n.subject;if(B.hash&&D.hash)r=B.hash===D.hash;else if(B.attributes.length===D.attributes.length){r=!0;for(var V,L,O=0;r&&O<B.attributes.length;++O)V=B.attributes[O],L=D.attributes[O],(V.type!==L.type||V.value!==L.value)&&(r=!1)}return r},c.issued=function(n){return n.isIssuer(c)},c.generateSubjectKeyIdentifier=function(){return a.getPublicKeyFingerprint(c.publicKey,{type:"RSAPublicKey"})},c.verifySubjectKeyIdentifier=function(){for(var n=y.subjectKeyIdentifier,r=0;r<c.extensions.length;++r){var B=c.extensions[r];if(B.id===n){var D=c.generateSubjectKeyIdentifier().getBytes();return i.util.hexToBytes(B.subjectKeyIdentifier)===D}}return!1},c},a.certificateFromAsn1=function(c,n){var r={},B=[];if(!e.validate(c,h,r,B)){var D=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw D.errors=B,D}var V=e.derToOid(r.publicKeyOid);if(V!==a.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var L=a.createCertificate();L.version=r.certVersion?r.certVersion.charCodeAt(0):0;var O=i.util.createBuffer(r.certSerialNumber);L.serialNumber=O.toHex(),L.signatureOid=i.asn1.derToOid(r.certSignatureOid),L.signatureParameters=k(L.signatureOid,r.certSignatureParams,!0),L.siginfo.algorithmOid=i.asn1.derToOid(r.certinfoSignatureOid),L.siginfo.parameters=k(L.siginfo.algorithmOid,r.certinfoSignatureParams,!1),L.signature=r.certSignature;var q=[];if(r.certValidity1UTCTime!==void 0&&q.push(e.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&q.push(e.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&q.push(e.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&q.push(e.generalizedTimeToDate(r.certValidity4GeneralizedTime)),q.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(q.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(L.validity.notBefore=q[0],L.validity.notAfter=q[1],L.tbsCertificate=r.tbsCertificate,n){L.md=E({signatureOid:L.signatureOid,type:"certificate"});var M=e.toDer(L.tbsCertificate);L.md.update(M.getBytes())}var H=i.md.sha1.create(),Y=e.toDer(r.certIssuer);H.update(Y.getBytes()),L.issuer.getField=function(ie){return x(L.issuer,ie)},L.issuer.addField=function(ie){m([ie]),L.issuer.attributes.push(ie)},L.issuer.attributes=a.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(L.issuer.uniqueId=r.certIssuerUniqueId),L.issuer.hash=H.digest().toHex();var W=i.md.sha1.create(),$=e.toDer(r.certSubject);return W.update($.getBytes()),L.subject.getField=function(ie){return x(L.subject,ie)},L.subject.addField=function(ie){m([ie]),L.subject.attributes.push(ie)},L.subject.attributes=a.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(L.subject.uniqueId=r.certSubjectUniqueId),L.subject.hash=W.digest().toHex(),r.certExtensions?L.extensions=a.certificateExtensionsFromAsn1(r.certExtensions):L.extensions=[],L.publicKey=a.publicKeyFromAsn1(r.subjectPublicKeyInfo),L},a.certificateExtensionsFromAsn1=function(c){for(var n=[],r=0;r<c.value.length;++r)for(var B=c.value[r],D=0;D<B.value.length;++D)n.push(a.certificateExtensionFromAsn1(B.value[D]));return n},a.certificateExtensionFromAsn1=function(c){var n={};if(n.id=e.derToOid(c.value[0].value),n.critical=!1,c.value[1].type===e.Type.BOOLEAN?(n.critical=c.value[1].value.charCodeAt(0)!==0,n.value=c.value[2].value):n.value=c.value[1].value,n.id in y){if(n.name=y[n.id],n.name==="keyUsage"){var r=e.fromDer(n.value),B=0,D=0;r.value.length>1&&(B=r.value.charCodeAt(1),D=r.value.length>2?r.value.charCodeAt(2):0),n.digitalSignature=(B&128)===128,n.nonRepudiation=(B&64)===64,n.keyEncipherment=(B&32)===32,n.dataEncipherment=(B&16)===16,n.keyAgreement=(B&8)===8,n.keyCertSign=(B&4)===4,n.cRLSign=(B&2)===2,n.encipherOnly=(B&1)===1,n.decipherOnly=(D&128)===128}else if(n.name==="basicConstraints"){var r=e.fromDer(n.value);r.value.length>0&&r.value[0].type===e.Type.BOOLEAN?n.cA=r.value[0].value.charCodeAt(0)!==0:n.cA=!1;var V=null;r.value.length>0&&r.value[0].type===e.Type.INTEGER?V=r.value[0].value:r.value.length>1&&(V=r.value[1].value),V!==null&&(n.pathLenConstraint=e.derToInteger(V))}else if(n.name==="extKeyUsage")for(var r=e.fromDer(n.value),L=0;L<r.value.length;++L){var O=e.derToOid(r.value[L].value);O in y?n[y[O]]=!0:n[O]=!0}else if(n.name==="nsCertType"){var r=e.fromDer(n.value),B=0;r.value.length>1&&(B=r.value.charCodeAt(1)),n.client=(B&128)===128,n.server=(B&64)===64,n.email=(B&32)===32,n.objsign=(B&16)===16,n.reserved=(B&8)===8,n.sslCA=(B&4)===4,n.emailCA=(B&2)===2,n.objCA=(B&1)===1}else if(n.name==="subjectAltName"||n.name==="issuerAltName"){n.altNames=[];for(var q,r=e.fromDer(n.value),M=0;M<r.value.length;++M){q=r.value[M];var H={type:q.type,value:q.value};switch(n.altNames.push(H),q.type){case 1:case 2:case 6:break;case 7:H.ip=i.util.bytesToIP(q.value);break;case 8:H.oid=e.derToOid(q.value);break}}}else if(n.name==="subjectKeyIdentifier"){var r=e.fromDer(n.value);n.subjectKeyIdentifier=i.util.bytesToHex(r.value)}}return n},a.certificationRequestFromAsn1=function(c,n){var r={},B=[];if(!e.validate(c,l,r,B)){var D=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw D.errors=B,D}var V=e.derToOid(r.publicKeyOid);if(V!==a.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var L=a.createCertificationRequest();if(L.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,L.signatureOid=i.asn1.derToOid(r.csrSignatureOid),L.signatureParameters=k(L.signatureOid,r.csrSignatureParams,!0),L.siginfo.algorithmOid=i.asn1.derToOid(r.csrSignatureOid),L.siginfo.parameters=k(L.siginfo.algorithmOid,r.csrSignatureParams,!1),L.signature=r.csrSignature,L.certificationRequestInfo=r.certificationRequestInfo,n){L.md=E({signatureOid:L.signatureOid,type:"certification request"});var O=e.toDer(L.certificationRequestInfo);L.md.update(O.getBytes())}var q=i.md.sha1.create();return L.subject.getField=function(M){return x(L.subject,M)},L.subject.addField=function(M){m([M]),L.subject.attributes.push(M)},L.subject.attributes=a.RDNAttributesAsArray(r.certificationRequestInfoSubject,q),L.subject.hash=q.digest().toHex(),L.publicKey=a.publicKeyFromAsn1(r.subjectPublicKeyInfo),L.getAttribute=function(M){return x(L,M)},L.addAttribute=function(M){m([M]),L.attributes.push(M)},L.attributes=a.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),L},a.createCertificationRequest=function(){var c={};return c.version=0,c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.subject={},c.subject.getField=function(n){return x(c.subject,n)},c.subject.addField=function(n){m([n]),c.subject.attributes.push(n)},c.subject.attributes=[],c.subject.hash=null,c.publicKey=null,c.attributes=[],c.getAttribute=function(n){return x(c,n)},c.addAttribute=function(n){m([n]),c.attributes.push(n)},c.md=null,c.setSubject=function(n){m(n),c.subject.attributes=n,c.subject.hash=null},c.setAttributes=function(n){m(n),c.attributes=n},c.sign=function(n,r){c.md=r||i.md.sha1.create();var B=y[c.md.algorithm+"WithRSAEncryption"];if(!B){var D=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw D.algorithm=c.md.algorithm,D}c.signatureOid=c.siginfo.algorithmOid=B,c.certificationRequestInfo=a.getCertificationRequestInfo(c);var V=e.toDer(c.certificationRequestInfo);c.md.update(V.getBytes()),c.signature=n.sign(c.md)},c.verify=function(){var n=!1,r=c.md;if(r===null){r=E({signatureOid:c.signatureOid,type:"certification request"});var B=c.certificationRequestInfo||a.getCertificationRequestInfo(c),D=e.toDer(B);r.update(D.getBytes())}return r!==null&&(n=u({certificate:c,md:r,signature:c.signature})),n},c};function v(c){for(var n=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),r,B,D=c.attributes,V=0;V<D.length;++V){r=D[V];var L=r.value,O=e.Type.PRINTABLESTRING;"valueTagClass"in r&&(O=r.valueTagClass,O===e.Type.UTF8&&(L=i.util.encodeUtf8(L))),B=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.type).getBytes()),e.create(e.Class.UNIVERSAL,O,!1,L)])]),n.value.push(B)}return n}function m(c){for(var n,r=0;r<c.length;++r){if(n=c[r],typeof n.name>"u"&&(n.type&&n.type in a.oids?n.name=a.oids[n.type]:n.shortName&&n.shortName in N&&(n.name=a.oids[N[n.shortName]])),typeof n.type>"u")if(n.name&&n.name in a.oids)n.type=a.oids[n.name];else{var B=new Error("Attribute type not specified.");throw B.attribute=n,B}if(typeof n.shortName>"u"&&n.name&&n.name in N&&(n.shortName=N[n.name]),n.type===y.extensionRequest&&(n.valueConstructed=!0,n.valueTagClass=e.Type.SEQUENCE,!n.value&&n.extensions)){n.value=[];for(var D=0;D<n.extensions.length;++D)n.value.push(a.certificateExtensionToAsn1(g(n.extensions[D])))}if(typeof n.value>"u"){var B=new Error("Attribute value not specified.");throw B.attribute=n,B}}}function g(c,n){if(n=n||{},typeof c.name>"u"&&c.id&&c.id in a.oids&&(c.name=a.oids[c.id]),typeof c.id>"u")if(c.name&&c.name in a.oids)c.id=a.oids[c.name];else{var r=new Error("Extension ID not specified.");throw r.extension=c,r}if(typeof c.value<"u")return c;if(c.name==="keyUsage"){var B=0,D=0,V=0;c.digitalSignature&&(D|=128,B=7),c.nonRepudiation&&(D|=64,B=6),c.keyEncipherment&&(D|=32,B=5),c.dataEncipherment&&(D|=16,B=4),c.keyAgreement&&(D|=8,B=3),c.keyCertSign&&(D|=4,B=2),c.cRLSign&&(D|=2,B=1),c.encipherOnly&&(D|=1,B=0),c.decipherOnly&&(V|=128,B=7);var L=String.fromCharCode(B);V!==0?L+=String.fromCharCode(D)+String.fromCharCode(V):D!==0&&(L+=String.fromCharCode(D)),c.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,L)}else if(c.name==="basicConstraints")c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),c.cA&&c.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"")),"pathLenConstraint"in c&&c.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.pathLenConstraint).getBytes()));else if(c.name==="extKeyUsage"){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var O=c.value.value;for(var q in c)c[q]===!0&&(q in y?O.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(y[q]).getBytes())):q.indexOf(".")!==-1&&O.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(q).getBytes())))}else if(c.name==="nsCertType"){var B=0,D=0;c.client&&(D|=128,B=7),c.server&&(D|=64,B=6),c.email&&(D|=32,B=5),c.objsign&&(D|=16,B=4),c.reserved&&(D|=8,B=3),c.sslCA&&(D|=4,B=2),c.emailCA&&(D|=2,B=1),c.objCA&&(D|=1,B=0);var L=String.fromCharCode(B);D!==0&&(L+=String.fromCharCode(D)),c.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,L)}else if(c.name==="subjectAltName"||c.name==="issuerAltName"){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var M,H=0;H<c.altNames.length;++H){M=c.altNames[H];var L=M.value;if(M.type===7&&M.ip){if(L=i.util.bytesFromIP(M.ip),L===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=c,r}}else M.type===8&&(M.oid?L=e.oidToDer(e.oidToDer(M.oid)):L=e.oidToDer(L));c.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,M.type,!1,L))}}else if(c.name==="nsComment"&&n.cert){if(!/^[\x00-\x7F]*$/.test(c.comment)||c.comment.length<1||c.comment.length>128)throw new Error('Invalid "nsComment" content.');c.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,c.comment)}else if(c.name==="subjectKeyIdentifier"&&n.cert){var Y=n.cert.generateSubjectKeyIdentifier();c.subjectKeyIdentifier=Y.toHex(),c.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,Y.getBytes())}else if(c.name==="authorityKeyIdentifier"&&n.cert){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var O=c.value.value;if(c.keyIdentifier){var W=c.keyIdentifier===!0?n.cert.generateSubjectKeyIdentifier().getBytes():c.keyIdentifier;O.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,W))}if(c.authorityCertIssuer){var $=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[v(c.authorityCertIssuer===!0?n.cert.issuer:c.authorityCertIssuer)])];O.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,$))}if(c.serialNumber){var ie=i.util.hexToBytes(c.serialNumber===!0?n.cert.serialNumber:c.serialNumber);O.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,ie))}}else if(c.name==="cRLDistributionPoints"){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var O=c.value.value,se=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),he=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),M,H=0;H<c.altNames.length;++H){M=c.altNames[H];var L=M.value;if(M.type===7&&M.ip){if(L=i.util.bytesFromIP(M.ip),L===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=c,r}}else M.type===8&&(M.oid?L=e.oidToDer(e.oidToDer(M.oid)):L=e.oidToDer(L));he.value.push(e.create(e.Class.CONTEXT_SPECIFIC,M.type,!1,L))}se.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[he])),O.push(se)}if(typeof c.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=c,r}return c}function s(c,n){if(c===y["RSASSA-PSS"]){var r=[];return n.hash.algorithmOid!==void 0&&r.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),n.mgf.algorithmOid!==void 0&&r.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),n.saltLength!==void 0&&r.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(n.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,r)}else return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}function d(c){var n=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(c.attributes.length===0)return n;for(var r=c.attributes,B=0;B<r.length;++B){var D=r[B],V=D.value,L=e.Type.UTF8;"valueTagClass"in D&&(L=D.valueTagClass),L===e.Type.UTF8&&(V=i.util.encodeUtf8(V));var O=!1;"valueConstructed"in D&&(O=D.valueConstructed);var q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(D.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,L,O,V)])]);n.value.push(q)}return n}var p=new Date("1950-01-01T00:00:00Z"),I=new Date("2050-01-01T00:00:00Z");function R(c){return c>=p&&c<I?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(c)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(c))}return a.getTBSCertificate=function(c){var n=R(c.validity.notBefore),r=R(c.validity.notAfter),B=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,i.util.hexToBytes(c.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.siginfo.algorithmOid).getBytes()),s(c.siginfo.algorithmOid,c.siginfo.parameters)]),v(c.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[n,r]),v(c.subject),a.publicKeyToAsn1(c.publicKey)]);return c.issuer.uniqueId&&B.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.issuer.uniqueId)])),c.subject.uniqueId&&B.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.subject.uniqueId)])),c.extensions.length>0&&B.value.push(a.certificateExtensionsToAsn1(c.extensions)),B},a.getCertificationRequestInfo=function(c){var n=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.version).getBytes()),v(c.subject),a.publicKeyToAsn1(c.publicKey),d(c)]);return n},a.distinguishedNameToAsn1=function(c){return v(c)},a.certificateToAsn1=function(c){var n=c.tbsCertificate||a.getTBSCertificate(c);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[n,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.signatureOid).getBytes()),s(c.signatureOid,c.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.signature)])},a.certificateExtensionsToAsn1=function(c){var n=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),r=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);n.value.push(r);for(var B=0;B<c.length;++B)r.value.push(a.certificateExtensionToAsn1(c[B]));return n},a.certificateExtensionToAsn1=function(c){var n=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);n.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.id).getBytes())),c.critical&&n.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,""));var r=c.value;return typeof c.value!="string"&&(r=e.toDer(r).getBytes()),n.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,r)),n},a.certificationRequestToAsn1=function(c){var n=c.certificationRequestInfo||a.getCertificationRequestInfo(c);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[n,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.signatureOid).getBytes()),s(c.signatureOid,c.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.signature)])},a.createCaStore=function(c){var n={certs:{}};n.getIssuer=function(L){var O=r(L.issuer);return O},n.addCertificate=function(L){if(typeof L=="string"&&(L=i.pki.certificateFromPem(L)),B(L.subject),!n.hasCertificate(L))if(L.subject.hash in n.certs){var O=n.certs[L.subject.hash];i.util.isArray(O)||(O=[O]),O.push(L),n.certs[L.subject.hash]=O}else n.certs[L.subject.hash]=L},n.hasCertificate=function(L){typeof L=="string"&&(L=i.pki.certificateFromPem(L));var O=r(L.subject);if(!O)return!1;i.util.isArray(O)||(O=[O]);for(var q=e.toDer(a.certificateToAsn1(L)).getBytes(),M=0;M<O.length;++M){var H=e.toDer(a.certificateToAsn1(O[M])).getBytes();if(q===H)return!0}return!1},n.listAllCertificates=function(){var L=[];for(var O in n.certs)if(n.certs.hasOwnProperty(O)){var q=n.certs[O];if(!i.util.isArray(q))L.push(q);else for(var M=0;M<q.length;++M)L.push(q[M])}return L},n.removeCertificate=function(L){var O;if(typeof L=="string"&&(L=i.pki.certificateFromPem(L)),B(L.subject),!n.hasCertificate(L))return null;var q=r(L.subject);if(!i.util.isArray(q))return O=n.certs[L.subject.hash],delete n.certs[L.subject.hash],O;for(var M=e.toDer(a.certificateToAsn1(L)).getBytes(),H=0;H<q.length;++H){var Y=e.toDer(a.certificateToAsn1(q[H])).getBytes();M===Y&&(O=q[H],q.splice(H,1))}return q.length===0&&delete n.certs[L.subject.hash],O};function r(L){return B(L),n.certs[L.hash]||null}function B(L){if(!L.hash){var O=i.md.sha1.create();L.attributes=a.RDNAttributesAsArray(v(L),O),L.hash=O.digest().toHex()}}if(c)for(var D=0;D<c.length;++D){var V=c[D];n.addCertificate(V)}return n},a.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},a.verifyCertificateChain=function(c,n,r){typeof r=="function"&&(r={verify:r}),r=r||{},n=n.slice(0);var B=n.slice(0),D=r.validityCheckDate;typeof D>"u"&&(D=new Date);var V=!0,L=null,O=0;do{var q=n.shift(),M=null,H=!1;if(D&&(D<q.validity.notBefore||D>q.validity.notAfter)&&(L={message:"Certificate is not valid yet or has expired.",error:a.certificateError.certificate_expired,notBefore:q.validity.notBefore,notAfter:q.validity.notAfter,now:D}),L===null){if(M=n[0]||c.getIssuer(q),M===null&&q.isIssuer(q)&&(H=!0,M=q),M){var Y=M;i.util.isArray(Y)||(Y=[Y]);for(var W=!1;!W&&Y.length>0;){M=Y.shift();try{W=M.verify(q)}catch{}}W||(L={message:"Certificate signature is invalid.",error:a.certificateError.bad_certificate})}L===null&&(!M||H)&&!c.hasCertificate(q)&&(L={message:"Certificate is not trusted.",error:a.certificateError.unknown_ca})}if(L===null&&M&&!q.isIssuer(M)&&(L={message:"Certificate issuer is invalid.",error:a.certificateError.bad_certificate}),L===null)for(var $={keyUsage:!0,basicConstraints:!0},ie=0;L===null&&ie<q.extensions.length;++ie){var se=q.extensions[ie];se.critical&&!(se.name in $)&&(L={message:"Certificate has an unsupported critical extension.",error:a.certificateError.unsupported_certificate})}if(L===null&&(!V||n.length===0&&(!M||H))){var he=q.getExtension("basicConstraints"),ge=q.getExtension("keyUsage");if(ge!==null&&(!ge.keyCertSign||he===null)&&(L={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:a.certificateError.bad_certificate}),L===null&&he!==null&&!he.cA&&(L={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:a.certificateError.bad_certificate}),L===null&&ge!==null&&"pathLenConstraint"in he){var j=O-1;j>he.pathLenConstraint&&(L={message:"Certificate basicConstraints pathLenConstraint violated.",error:a.certificateError.bad_certificate})}}var ue=L===null?!0:L.error,Z=r.verify?r.verify(ue,O,B):ue;if(Z===!0)L=null;else throw ue===!0&&(L={message:"The application rejected the certificate.",error:a.certificateError.bad_certificate}),(Z||Z===0)&&(typeof Z=="object"&&!i.util.isArray(Z)?(Z.message&&(L.message=Z.message),Z.error&&(L.error=Z.error)):typeof Z=="string"&&(L.error=Z)),L;V=!1,++O}while(n.length>0);return!0},er.exports}var Xr;function ya(){if(Xr)return $t.exports;Xr=1;var i=fe();rt(),yt(),ct(),pa(),da(),et(),Bt(),gt(),de(),Cr();var e=i.asn1,a=i.pki,y=$t.exports=i.pkcs12=i.pkcs12||{},N={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},S={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},N,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",optional:!0,tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},h={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},t={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},C={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function l(m,g,s,d){for(var p=[],I=0;I<m.length;I++)for(var R=0;R<m[I].safeBags.length;R++){var c=m[I].safeBags[R];if(!(d!==void 0&&c.type!==d)){if(g===null){p.push(c);continue}c.attributes[g]!==void 0&&c.attributes[g].indexOf(s)>=0&&p.push(c)}}return p}y.pkcs12FromAsn1=function(m,g,s){typeof g=="string"?(s=g,g=!0):g===void 0&&(g=!0);var d={},p=[];if(!e.validate(m,S,d,p)){var I=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw I.errors=I,I}var R={version:d.version.charCodeAt(0),safeContents:[],getBags:function(M){var H={},Y;return"localKeyId"in M?Y=M.localKeyId:"localKeyIdHex"in M&&(Y=i.util.hexToBytes(M.localKeyIdHex)),Y===void 0&&!("friendlyName"in M)&&"bagType"in M&&(H[M.bagType]=l(R.safeContents,null,null,M.bagType)),Y!==void 0&&(H.localKeyId=l(R.safeContents,"localKeyId",Y,M.bagType)),"friendlyName"in M&&(H.friendlyName=l(R.safeContents,"friendlyName",M.friendlyName,M.bagType)),H},getBagsByFriendlyName:function(M,H){return l(R.safeContents,"friendlyName",M,H)},getBagsByLocalKeyId:function(M,H){return l(R.safeContents,"localKeyId",M,H)}};if(d.version.charCodeAt(0)!==3){var I=new Error("PKCS#12 PFX of version other than 3 not supported.");throw I.version=d.version.charCodeAt(0),I}if(e.derToOid(d.contentType)!==a.oids.data){var I=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw I.oid=e.derToOid(d.contentType),I}var c=d.content.value[0];if(c.tagClass!==e.Class.UNIVERSAL||c.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(c=x(c),d.mac){var n=null,r=0,B=e.derToOid(d.macAlgorithm);switch(B){case a.oids.sha1:n=i.md.sha1.create(),r=20;break;case a.oids.sha256:n=i.md.sha256.create(),r=32;break;case a.oids.sha384:n=i.md.sha384.create(),r=48;break;case a.oids.sha512:n=i.md.sha512.create(),r=64;break;case a.oids.md5:n=i.md.md5.create(),r=16;break}if(n===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+B);var D=new i.util.ByteBuffer(d.macSalt),V="macIterations"in d?parseInt(i.util.bytesToHex(d.macIterations),16):1,L=y.generateKey(s,D,3,V,r,n),O=i.hmac.create();O.start(n,L),O.update(c.value);var q=O.getMac();if(q.getBytes()!==d.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}else if(Array.isArray(m.value)&&m.value.length>2)throw new Error("Invalid PKCS#12. macData field present but MAC was not validated.");return k(R,c.value,g,s),R};function x(m){if(m.composed||m.constructed){for(var g=i.util.createBuffer(),s=0;s<m.value.length;++s)g.putBytes(m.value[s].value);m.composed=m.constructed=!1,m.value=g.getBytes()}return m}function k(m,g,s,d){if(g=e.fromDer(g,s),g.tagClass!==e.Class.UNIVERSAL||g.type!==e.Type.SEQUENCE||g.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var p=0;p<g.value.length;p++){var I=g.value[p],R={},c=[];if(!e.validate(I,N,R,c)){var n=new Error("Cannot read ContentInfo.");throw n.errors=c,n}var r={encrypted:!1},B=null,D=R.content.value[0];switch(e.derToOid(R.contentType)){case a.oids.data:if(D.tagClass!==e.Class.UNIVERSAL||D.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");B=x(D).value;break;case a.oids.encryptedData:B=E(D,d),r.encrypted=!0;break;default:var n=new Error("Unsupported PKCS#12 contentType.");throw n.contentType=e.derToOid(R.contentType),n}r.safeBags=u(B,s,d),m.safeContents.push(r)}}function E(m,g){var s={},d=[];if(!e.validate(m,i.pkcs7.asn1.encryptedDataValidator,s,d)){var p=new Error("Cannot read EncryptedContentInfo.");throw p.errors=d,p}var I=e.derToOid(s.contentType);if(I!==a.oids.data){var p=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw p.oid=I,p}I=e.derToOid(s.encAlgorithm);var R=a.pbe.getCipher(I,s.encParameter,g),c=x(s.encryptedContentAsn1),n=i.util.createBuffer(c.value);if(R.update(n),!R.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return R.output.getBytes()}function u(m,g,s){if(!g&&m.length===0)return[];if(m=e.fromDer(m,g),m.tagClass!==e.Class.UNIVERSAL||m.type!==e.Type.SEQUENCE||m.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var d=[],p=0;p<m.value.length;p++){var I=m.value[p],R={},c=[];if(!e.validate(I,h,R,c)){var n=new Error("Cannot read SafeBag.");throw n.errors=c,n}var r={type:e.derToOid(R.bagId),attributes:v(R.bagAttributes)};d.push(r);var B,D,V=R.bagValue.value[0];switch(r.type){case a.oids.pkcs8ShroudedKeyBag:if(V=a.decryptPrivateKeyInfo(V,s),V===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case a.oids.keyBag:try{r.key=a.privateKeyFromAsn1(V)}catch{r.key=null,r.asn1=V}continue;case a.oids.certBag:B=C,D=function(){if(e.derToOid(R.certId)!==a.oids.x509Certificate){var O=new Error("Unsupported certificate type, only X.509 supported.");throw O.oid=e.derToOid(R.certId),O}var q=e.fromDer(R.cert,g);try{r.cert=a.certificateFromAsn1(q,!0)}catch{r.cert=null,r.asn1=q}};break;default:var n=new Error("Unsupported PKCS#12 SafeBag type.");throw n.oid=r.type,n}if(B!==void 0&&!e.validate(V,B,R,c)){var n=new Error("Cannot read PKCS#12 "+B.name);throw n.errors=c,n}D()}return d}function v(m){var g={};if(m!==void 0)for(var s=0;s<m.length;++s){var d={},p=[];if(!e.validate(m[s],t,d,p)){var I=new Error("Cannot read PKCS#12 BagAttribute.");throw I.errors=p,I}var R=e.derToOid(d.oid);if(a.oids[R]!==void 0){g[a.oids[R]]=[];for(var c=0;c<d.values.length;++c)g[a.oids[R]].push(d.values[c].value)}}return g}return y.toPkcs12Asn1=function(m,g,s,d){d=d||{},d.saltSize=d.saltSize||8,d.count=d.count||2048,d.algorithm=d.algorithm||d.encAlgorithm||"aes128","useMac"in d||(d.useMac=!0),"localKeyId"in d||(d.localKeyId=null),"generateLocalKeyId"in d||(d.generateLocalKeyId=!0);var p=d.localKeyId,I;if(p!==null)p=i.util.hexToBytes(p);else if(d.generateLocalKeyId)if(g){var R=i.util.isArray(g)?g[0]:g;typeof R=="string"&&(R=a.certificateFromPem(R));var c=i.md.sha1.create();c.update(e.toDer(a.certificateToAsn1(R)).getBytes()),p=c.digest().getBytes()}else p=i.random.getBytes(20);var n=[];p!==null&&n.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,p)])])),"friendlyName"in d&&n.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,d.friendlyName)])])),n.length>0&&(I=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,n));var r=[],B=[];g!==null&&(i.util.isArray(g)?B=g:B=[g]);for(var D=[],V=0;V<B.length;++V){g=B[V],typeof g=="string"&&(g=a.certificateFromPem(g));var L=V===0?I:void 0,O=a.certificateToAsn1(g),q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(O).getBytes())])])]),L]);D.push(q)}if(D.length>0){var M=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,D),H=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(M).getBytes())])]);r.push(H)}var Y=null;if(m!==null){var W=a.wrapRsaPrivateKey(a.privateKeyToAsn1(m));s===null?Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[W]),I]):Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[a.encryptPrivateKeyInfo(W,s,d)]),I]);var $=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[Y]),ie=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer($).getBytes())])]);r.push(ie)}var se=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,r),he;if(d.useMac){var c=i.md.sha1.create(),ge=new i.util.ByteBuffer(i.random.getBytes(d.saltSize)),j=d.count,m=y.generateKey(s,ge,3,j,20),ue=i.hmac.create();ue.start(c,m),ue.update(e.toDer(se).getBytes());var Z=ue.getMac();he=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,Z.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ge.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(j).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(se).getBytes())])]),he])},y.generateKey=i.pbe.generatePkcs12Key,$t.exports}var Wr;function ga(){if(Wr)return Mt.exports;Wr=1;var i=fe();rt(),ct(),da(),pt(),yr(),ya(),gr(),Bt(),de(),Cr();var e=i.asn1,a=Mt.exports=i.pki=i.pki||{};return a.pemToDer=function(y){var N=i.pem.decode(y)[0];if(N.procType&&N.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return i.util.createBuffer(N.body)},a.privateKeyFromPem=function(y){var N=i.pem.decode(y)[0];if(N.type!=="PRIVATE KEY"&&N.type!=="RSA PRIVATE KEY"){var S=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw S.headerType=N.type,S}if(N.procType&&N.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var h=e.fromDer(N.body);return a.privateKeyFromAsn1(h)},a.privateKeyToPem=function(y,N){var S={type:"RSA PRIVATE KEY",body:e.toDer(a.privateKeyToAsn1(y)).getBytes()};return i.pem.encode(S,{maxline:N})},a.privateKeyInfoToPem=function(y,N){var S={type:"PRIVATE KEY",body:e.toDer(y).getBytes()};return i.pem.encode(S,{maxline:N})},Mt.exports}var ir,jr;function Ca(){if(jr)return ir;jr=1;var i=fe();rt(),yt(),vr(),pt(),ga(),et(),gt(),de();var e=function(f,w,_,o){var A=i.util.createBuffer(),F=f.length>>1,P=F+(f.length&1),z=f.substr(0,P),ee=f.substr(F,P),ae=i.util.createBuffer(),G=i.hmac.create();_=w+_;var te=Math.ceil(o/16),ne=Math.ceil(o/20);G.start("MD5",z);var ce=i.util.createBuffer();ae.putBytes(_);for(var oe=0;oe<te;++oe)G.start(null,null),G.update(ae.getBytes()),ae.putBuffer(G.digest()),G.start(null,null),G.update(ae.bytes()+_),ce.putBuffer(G.digest());G.start("SHA1",ee);var Ce=i.util.createBuffer();ae.clear(),ae.putBytes(_);for(var oe=0;oe<ne;++oe)G.start(null,null),G.update(ae.getBytes()),ae.putBuffer(G.digest()),G.start(null,null),G.update(ae.bytes()+_),Ce.putBuffer(G.digest());return A.putBytes(i.util.xorBytes(ce.getBytes(),Ce.getBytes(),o)),A},a=function(f,w,_){var o=i.hmac.create();o.start("SHA1",f);var A=i.util.createBuffer();return A.putInt32(w[0]),A.putInt32(w[1]),A.putByte(_.type),A.putByte(_.version.major),A.putByte(_.version.minor),A.putInt16(_.length),A.putBytes(_.fragment.bytes()),o.update(A.getBytes()),o.digest().getBytes()},y=function(f,w,_){var o=!1;try{var A=f.deflate(w.fragment.getBytes());w.fragment=i.util.createBuffer(A),w.length=A.length,o=!0}catch{}return o},N=function(f,w,_){var o=!1;try{var A=f.inflate(w.fragment.getBytes());w.fragment=i.util.createBuffer(A),w.length=A.length,o=!0}catch{}return o},S=function(f,w){var _=0;switch(w){case 1:_=f.getByte();break;case 2:_=f.getInt16();break;case 3:_=f.getInt24();break;case 4:_=f.getInt32();break}return i.util.createBuffer(f.getBytes(_))},h=function(f,w,_){f.putInt(_.length(),w<<3),f.putBuffer(_)},t={};t.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},t.SupportedVersions=[t.Versions.TLS_1_1,t.Versions.TLS_1_0],t.Version=t.SupportedVersions[0],t.MaxFragment=15360,t.ConnectionEnd={server:0,client:1},t.PRFAlgorithm={tls_prf_sha256:0},t.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},t.CipherType={stream:0,block:1,aead:2},t.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},t.CompressionMethod={none:0,deflate:1},t.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},t.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},t.Alert={},t.Alert.Level={warning:1,fatal:2},t.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},t.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},t.CipherSuites={},t.getCipherSuite=function(f){var w=null;for(var _ in t.CipherSuites){var o=t.CipherSuites[_];if(o.id[0]===f.charCodeAt(0)&&o.id[1]===f.charCodeAt(1)){w=o;break}}return w},t.handleUnexpected=function(f,w){var _=!f.open&&f.entity===t.ConnectionEnd.client;_||f.error(f,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unexpected_message}})},t.handleHelloRequest=function(f,w,_){!f.handshaking&&f.handshakes>0&&(t.queue(f,t.createAlert(f,{level:t.Alert.Level.warning,description:t.Alert.Description.no_renegotiation})),t.flush(f)),f.process()},t.parseHelloMessage=function(f,w,_){var o=null,A=f.entity===t.ConnectionEnd.client;if(_<38)f.error(f,{message:A?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});else{var F=w.fragment,P=F.length();if(o={version:{major:F.getByte(),minor:F.getByte()},random:i.util.createBuffer(F.getBytes(32)),session_id:S(F,1),extensions:[]},A?(o.cipher_suite=F.getBytes(2),o.compression_method=F.getByte()):(o.cipher_suites=S(F,2),o.compression_methods=S(F,1)),P=_-(P-F.length()),P>0){for(var z=S(F,2);z.length()>0;)o.extensions.push({type:[z.getByte(),z.getByte()],data:S(z,2)});if(!A)for(var ee=0;ee<o.extensions.length;++ee){var ae=o.extensions[ee];if(ae.type[0]===0&&ae.type[1]===0)for(var G=S(ae.data,2);G.length()>0;){var te=G.getByte();if(te!==0)break;f.session.extensions.server_name.serverNameList.push(S(G,2).getBytes())}}}if(f.session.version&&(o.version.major!==f.session.version.major||o.version.minor!==f.session.version.minor))return f.error(f,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.protocol_version}});if(A)f.session.cipherSuite=t.getCipherSuite(o.cipher_suite);else for(var ne=i.util.createBuffer(o.cipher_suites.bytes());ne.length()>0&&(f.session.cipherSuite=t.getCipherSuite(ne.getBytes(2)),f.session.cipherSuite===null););if(f.session.cipherSuite===null)return f.error(f,{message:"No cipher suites in common.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.handshake_failure},cipherSuite:i.util.bytesToHex(o.cipher_suite)});A?f.session.compressionMethod=o.compression_method:f.session.compressionMethod=t.CompressionMethod.none}return o},t.createSecurityParameters=function(f,w){var _=f.entity===t.ConnectionEnd.client,o=w.random.bytes(),A=_?f.session.sp.client_random:o,F=_?o:t.createRandom().getBytes();f.session.sp={entity:f.entity,prf_algorithm:t.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:f.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:A,server_random:F}},t.handleServerHello=function(f,w,_){var o=t.parseHelloMessage(f,w,_);if(!f.fail){if(o.version.minor<=f.version.minor)f.version.minor=o.version.minor;else return f.error(f,{message:"Incompatible TLS version.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.protocol_version}});f.session.version=f.version;var A=o.session_id.bytes();A.length>0&&A===f.session.id?(f.expect=u,f.session.resuming=!0,f.session.sp.server_random=o.random.bytes()):(f.expect=l,f.session.resuming=!1,t.createSecurityParameters(f,o)),f.session.id=A,f.process()}},t.handleClientHello=function(f,w,_){var o=t.parseHelloMessage(f,w,_);if(!f.fail){var A=o.session_id.bytes(),F=null;if(f.sessionCache&&(F=f.sessionCache.getSession(A),F===null?A="":(F.version.major!==o.version.major||F.version.minor>o.version.minor)&&(F=null,A="")),A.length===0&&(A=i.random.getBytes(32)),f.session.id=A,f.session.clientHelloVersion=o.version,f.session.sp={},F)f.version=f.session.version=F.version,f.session.sp=F.sp;else{for(var P,z=1;z<t.SupportedVersions.length&&(P=t.SupportedVersions[z],!(P.minor<=o.version.minor));++z);f.version={major:P.major,minor:P.minor},f.session.version=f.version}F!==null?(f.expect=R,f.session.resuming=!0,f.session.sp.client_random=o.random.bytes()):(f.expect=f.verifyClient!==!1?d:p,f.session.resuming=!1,t.createSecurityParameters(f,o)),f.open=!0,t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createServerHello(f)})),f.session.resuming?(t.queue(f,t.createRecord(f,{type:t.ContentType.change_cipher_spec,data:t.createChangeCipherSpec()})),f.state.pending=t.createConnectionState(f),f.state.current.write=f.state.pending.write,t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createFinished(f)}))):(t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createCertificate(f)})),f.fail||(t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createServerKeyExchange(f)})),f.verifyClient!==!1&&t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createCertificateRequest(f)})),t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createServerHelloDone(f)})))),t.flush(f),f.process()}},t.handleCertificate=function(f,w,_){if(_<3)return f.error(f,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var o=w.fragment,A={certificate_list:S(o,3)},F,P,z=[];try{for(;A.certificate_list.length()>0;)F=S(A.certificate_list,3),P=i.asn1.fromDer(F),F=i.pki.certificateFromAsn1(P,!0),z.push(F)}catch(ae){return f.error(f,{message:"Could not parse certificate list.",cause:ae,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.bad_certificate}})}var ee=f.entity===t.ConnectionEnd.client;(ee||f.verifyClient===!0)&&z.length===0?f.error(f,{message:ee?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}}):z.length===0?f.expect=ee?x:p:(ee?f.session.serverCertificate=z[0]:f.session.clientCertificate=z[0],t.verifyCertificateChain(f,z)&&(f.expect=ee?x:p)),f.process()},t.handleServerKeyExchange=function(f,w,_){if(_>0)return f.error(f,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unsupported_certificate}});f.expect=k,f.process()},t.handleClientKeyExchange=function(f,w,_){if(_<48)return f.error(f,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unsupported_certificate}});var o=w.fragment,A={enc_pre_master_secret:S(o,2).getBytes()},F=null;if(f.getPrivateKey)try{F=f.getPrivateKey(f,f.session.serverCertificate),F=i.pki.privateKeyFromPem(F)}catch(ee){f.error(f,{message:"Could not get private key.",cause:ee,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}})}if(F===null)return f.error(f,{message:"No private key set.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}});try{var P=f.session.sp;P.pre_master_secret=F.decrypt(A.enc_pre_master_secret);var z=f.session.clientHelloVersion;if(z.major!==P.pre_master_secret.charCodeAt(0)||z.minor!==P.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{P.pre_master_secret=i.random.getBytes(48)}f.expect=R,f.session.clientCertificate!==null&&(f.expect=I),f.process()},t.handleCertificateRequest=function(f,w,_){if(_<3)return f.error(f,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var o=w.fragment,A={certificate_types:S(o,1),certificate_authorities:S(o,2)};f.session.certificateRequest=A,f.expect=E,f.process()},t.handleCertificateVerify=function(f,w,_){if(_<2)return f.error(f,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var o=w.fragment;o.read-=4;var A=o.bytes();o.read+=4;var F={signature:S(o,2).getBytes()},P=i.util.createBuffer();P.putBuffer(f.session.md5.digest()),P.putBuffer(f.session.sha1.digest()),P=P.getBytes();try{var z=f.session.clientCertificate;if(!z.publicKey.verify(P,F.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");f.session.md5.update(A),f.session.sha1.update(A)}catch{return f.error(f,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.handshake_failure}})}f.expect=R,f.process()},t.handleServerHelloDone=function(f,w,_){if(_>0)return f.error(f,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.record_overflow}});if(f.serverCertificate===null){var o={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.insufficient_security}},A=0,F=f.verify(f,o.alert.description,A,[]);if(F!==!0)return(F||F===0)&&(typeof F=="object"&&!i.util.isArray(F)?(F.message&&(o.message=F.message),F.alert&&(o.alert.description=F.alert)):typeof F=="number"&&(o.alert.description=F)),f.error(f,o)}f.session.certificateRequest!==null&&(w=t.createRecord(f,{type:t.ContentType.handshake,data:t.createCertificate(f)}),t.queue(f,w)),w=t.createRecord(f,{type:t.ContentType.handshake,data:t.createClientKeyExchange(f)}),t.queue(f,w),f.expect=g;var P=function(z,ee){z.session.certificateRequest!==null&&z.session.clientCertificate!==null&&t.queue(z,t.createRecord(z,{type:t.ContentType.handshake,data:t.createCertificateVerify(z,ee)})),t.queue(z,t.createRecord(z,{type:t.ContentType.change_cipher_spec,data:t.createChangeCipherSpec()})),z.state.pending=t.createConnectionState(z),z.state.current.write=z.state.pending.write,t.queue(z,t.createRecord(z,{type:t.ContentType.handshake,data:t.createFinished(z)})),z.expect=u,t.flush(z),z.process()};if(f.session.certificateRequest===null||f.session.clientCertificate===null)return P(f,null);t.getClientSignature(f,P)},t.handleChangeCipherSpec=function(f,w){if(w.fragment.getByte()!==1)return f.error(f,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var _=f.entity===t.ConnectionEnd.client;(f.session.resuming&&_||!f.session.resuming&&!_)&&(f.state.pending=t.createConnectionState(f)),f.state.current.read=f.state.pending.read,(!f.session.resuming&&_||f.session.resuming&&!_)&&(f.state.pending=null),f.expect=_?v:c,f.process()},t.handleFinished=function(f,w,_){var o=w.fragment;o.read-=4;var A=o.bytes();o.read+=4;var F=w.fragment.getBytes();o=i.util.createBuffer(),o.putBuffer(f.session.md5.digest()),o.putBuffer(f.session.sha1.digest());var P=f.entity===t.ConnectionEnd.client,z=P?"server finished":"client finished",ee=f.session.sp,ae=12,G=e;if(o=G(ee.master_secret,z,o.getBytes(),ae),o.getBytes()!==F)return f.error(f,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.decrypt_error}});f.session.md5.update(A),f.session.sha1.update(A),(f.session.resuming&&P||!f.session.resuming&&!P)&&(t.queue(f,t.createRecord(f,{type:t.ContentType.change_cipher_spec,data:t.createChangeCipherSpec()})),f.state.current.write=f.state.pending.write,f.state.pending=null,t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createFinished(f)}))),f.expect=P?m:n,f.handshaking=!1,++f.handshakes,f.peerCertificate=P?f.session.serverCertificate:f.session.clientCertificate,t.flush(f),f.isConnected=!0,f.connected(f),f.process()},t.handleAlert=function(f,w){var _=w.fragment,o={level:_.getByte(),description:_.getByte()},A;switch(o.description){case t.Alert.Description.close_notify:A="Connection closed.";break;case t.Alert.Description.unexpected_message:A="Unexpected message.";break;case t.Alert.Description.bad_record_mac:A="Bad record MAC.";break;case t.Alert.Description.decryption_failed:A="Decryption failed.";break;case t.Alert.Description.record_overflow:A="Record overflow.";break;case t.Alert.Description.decompression_failure:A="Decompression failed.";break;case t.Alert.Description.handshake_failure:A="Handshake failure.";break;case t.Alert.Description.bad_certificate:A="Bad certificate.";break;case t.Alert.Description.unsupported_certificate:A="Unsupported certificate.";break;case t.Alert.Description.certificate_revoked:A="Certificate revoked.";break;case t.Alert.Description.certificate_expired:A="Certificate expired.";break;case t.Alert.Description.certificate_unknown:A="Certificate unknown.";break;case t.Alert.Description.illegal_parameter:A="Illegal parameter.";break;case t.Alert.Description.unknown_ca:A="Unknown certificate authority.";break;case t.Alert.Description.access_denied:A="Access denied.";break;case t.Alert.Description.decode_error:A="Decode error.";break;case t.Alert.Description.decrypt_error:A="Decrypt error.";break;case t.Alert.Description.export_restriction:A="Export restriction.";break;case t.Alert.Description.protocol_version:A="Unsupported protocol version.";break;case t.Alert.Description.insufficient_security:A="Insufficient security.";break;case t.Alert.Description.internal_error:A="Internal error.";break;case t.Alert.Description.user_canceled:A="User canceled.";break;case t.Alert.Description.no_renegotiation:A="Renegotiation not supported.";break;default:A="Unknown error.";break}if(o.description===t.Alert.Description.close_notify)return f.close();f.error(f,{message:A,send:!1,origin:f.entity===t.ConnectionEnd.client?"server":"client",alert:o}),f.process()},t.handleHandshake=function(f,w){var _=w.fragment,o=_.getByte(),A=_.getInt24();if(A>_.length())return f.fragmented=w,w.fragment=i.util.createBuffer(),_.read-=4,f.process();f.fragmented=null,_.read-=4;var F=_.bytes(A+4);_.read+=4,o in he[f.entity][f.expect]?(f.entity===t.ConnectionEnd.server&&!f.open&&!f.fail&&(f.handshaking=!0,f.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:i.md.md5.create(),sha1:i.md.sha1.create()}),o!==t.HandshakeType.hello_request&&o!==t.HandshakeType.certificate_verify&&o!==t.HandshakeType.finished&&(f.session.md5.update(F),f.session.sha1.update(F)),he[f.entity][f.expect][o](f,w,A)):t.handleUnexpected(f,w)},t.handleApplicationData=function(f,w){f.data.putBuffer(w.fragment),f.dataReady(f),f.process()},t.handleHeartbeat=function(f,w){var _=w.fragment,o=_.getByte(),A=_.getInt16(),F=_.getBytes(A);if(o===t.HeartbeatMessageType.heartbeat_request){if(f.handshaking||A>F.length)return f.process();t.queue(f,t.createRecord(f,{type:t.ContentType.heartbeat,data:t.createHeartbeat(t.HeartbeatMessageType.heartbeat_response,F)})),t.flush(f)}else if(o===t.HeartbeatMessageType.heartbeat_response){if(F!==f.expectedHeartbeatPayload)return f.process();f.heartbeatReceived&&f.heartbeatReceived(f,i.util.createBuffer(F))}f.process()};var C=0,l=1,x=2,k=3,E=4,u=5,v=6,m=7,g=8,s=0,d=1,p=2,I=3,R=4,c=5,n=6,r=t.handleUnexpected,B=t.handleChangeCipherSpec,D=t.handleAlert,V=t.handleHandshake,L=t.handleApplicationData,O=t.handleHeartbeat,q=[];q[t.ConnectionEnd.client]=[[r,D,V,r,O],[r,D,V,r,O],[r,D,V,r,O],[r,D,V,r,O],[r,D,V,r,O],[B,D,r,r,O],[r,D,V,r,O],[r,D,V,L,O],[r,D,V,r,O]],q[t.ConnectionEnd.server]=[[r,D,V,r,O],[r,D,V,r,O],[r,D,V,r,O],[r,D,V,r,O],[B,D,r,r,O],[r,D,V,r,O],[r,D,V,L,O],[r,D,V,r,O]];var M=t.handleHelloRequest,H=t.handleServerHello,Y=t.handleCertificate,W=t.handleServerKeyExchange,$=t.handleCertificateRequest,ie=t.handleServerHelloDone,se=t.handleFinished,he=[];he[t.ConnectionEnd.client]=[[r,r,H,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,Y,W,$,ie,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,W,$,ie,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,$,ie,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,ie,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,se],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]];var ge=t.handleClientHello,j=t.handleClientKeyExchange,ue=t.handleCertificateVerify;he[t.ConnectionEnd.server]=[[r,ge,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,Y,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,j,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,ue,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,se],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]],t.generateKeys=function(f,w){var _=e,o=w.client_random+w.server_random;f.session.resuming||(w.master_secret=_(w.pre_master_secret,"master secret",o,48).bytes(),w.pre_master_secret=null),o=w.server_random+w.client_random;var A=2*w.mac_key_length+2*w.enc_key_length,F=f.version.major===t.Versions.TLS_1_0.major&&f.version.minor===t.Versions.TLS_1_0.minor;F&&(A+=2*w.fixed_iv_length);var P=_(w.master_secret,"key expansion",o,A),z={client_write_MAC_key:P.getBytes(w.mac_key_length),server_write_MAC_key:P.getBytes(w.mac_key_length),client_write_key:P.getBytes(w.enc_key_length),server_write_key:P.getBytes(w.enc_key_length)};return F&&(z.client_write_IV=P.getBytes(w.fixed_iv_length),z.server_write_IV=P.getBytes(w.fixed_iv_length)),z},t.createConnectionState=function(f){var w=f.entity===t.ConnectionEnd.client,_=function(){var F={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(P){return!0},compressionState:null,compressFunction:function(P){return!0},updateSequenceNumber:function(){F.sequenceNumber[1]===4294967295?(F.sequenceNumber[1]=0,++F.sequenceNumber[0]):++F.sequenceNumber[1]}};return F},o={read:_(),write:_()};if(o.read.update=function(F,P){return o.read.cipherFunction(P,o.read)?o.read.compressFunction(F,P,o.read)||F.error(F,{message:"Could not decompress record.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.decompression_failure}}):F.error(F,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.bad_record_mac}}),!F.fail},o.write.update=function(F,P){return o.write.compressFunction(F,P,o.write)?o.write.cipherFunction(P,o.write)||F.error(F,{message:"Could not encrypt record.",send:!1,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}}):F.error(F,{message:"Could not compress record.",send:!1,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}}),!F.fail},f.session){var A=f.session.sp;switch(f.session.cipherSuite.initSecurityParameters(A),A.keys=t.generateKeys(f,A),o.read.macKey=w?A.keys.server_write_MAC_key:A.keys.client_write_MAC_key,o.write.macKey=w?A.keys.client_write_MAC_key:A.keys.server_write_MAC_key,f.session.cipherSuite.initConnectionState(o,f,A),A.compression_algorithm){case t.CompressionMethod.none:break;case t.CompressionMethod.deflate:o.read.compressFunction=N,o.write.compressFunction=y;break;default:throw new Error("Unsupported compression algorithm.")}}return o},t.createRandom=function(){var f=new Date,w=+f+f.getTimezoneOffset()*6e4,_=i.util.createBuffer();return _.putInt32(w),_.putBytes(i.random.getBytes(28)),_},t.createRecord=function(f,w){if(!w.data)return null;var _={type:w.type,version:{major:f.version.major,minor:f.version.minor},length:w.data.length(),fragment:w.data};return _},t.createAlert=function(f,w){var _=i.util.createBuffer();return _.putByte(w.level),_.putByte(w.description),t.createRecord(f,{type:t.ContentType.alert,data:_})},t.createClientHello=function(f){f.session.clientHelloVersion={major:f.version.major,minor:f.version.minor};for(var w=i.util.createBuffer(),_=0;_<f.cipherSuites.length;++_){var o=f.cipherSuites[_];w.putByte(o.id[0]),w.putByte(o.id[1])}var A=w.length(),F=i.util.createBuffer();F.putByte(t.CompressionMethod.none);var P=F.length(),z=i.util.createBuffer();if(f.virtualHost){var ee=i.util.createBuffer();ee.putByte(0),ee.putByte(0);var ae=i.util.createBuffer();ae.putByte(0),h(ae,2,i.util.createBuffer(f.virtualHost));var G=i.util.createBuffer();h(G,2,ae),h(ee,2,G),z.putBuffer(ee)}var te=z.length();te>0&&(te+=2);var ne=f.session.id,ce=ne.length+1+2+4+28+2+A+1+P+te,oe=i.util.createBuffer();return oe.putByte(t.HandshakeType.client_hello),oe.putInt24(ce),oe.putByte(f.version.major),oe.putByte(f.version.minor),oe.putBytes(f.session.sp.client_random),h(oe,1,i.util.createBuffer(ne)),h(oe,2,w),h(oe,1,F),te>0&&h(oe,2,z),oe},t.createServerHello=function(f){var w=f.session.id,_=w.length+1+2+4+28+2+1,o=i.util.createBuffer();return o.putByte(t.HandshakeType.server_hello),o.putInt24(_),o.putByte(f.version.major),o.putByte(f.version.minor),o.putBytes(f.session.sp.server_random),h(o,1,i.util.createBuffer(w)),o.putByte(f.session.cipherSuite.id[0]),o.putByte(f.session.cipherSuite.id[1]),o.putByte(f.session.compressionMethod),o},t.createCertificate=function(f){var w=f.entity===t.ConnectionEnd.client,_=null;if(f.getCertificate){var o;w?o=f.session.certificateRequest:o=f.session.extensions.server_name.serverNameList,_=f.getCertificate(f,o)}var A=i.util.createBuffer();if(_!==null)try{i.util.isArray(_)||(_=[_]);for(var F=null,P=0;P<_.length;++P){var z=i.pem.decode(_[P])[0];if(z.type!=="CERTIFICATE"&&z.type!=="X509 CERTIFICATE"&&z.type!=="TRUSTED CERTIFICATE"){var ee=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw ee.headerType=z.type,ee}if(z.procType&&z.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var ae=i.util.createBuffer(z.body);F===null&&(F=i.asn1.fromDer(ae.bytes(),!1));var G=i.util.createBuffer();h(G,3,ae),A.putBuffer(G)}_=i.pki.certificateFromAsn1(F),w?f.session.clientCertificate=_:f.session.serverCertificate=_}catch(ce){return f.error(f,{message:"Could not send certificate list.",cause:ce,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.bad_certificate}})}var te=3+A.length(),ne=i.util.createBuffer();return ne.putByte(t.HandshakeType.certificate),ne.putInt24(te),h(ne,3,A),ne},t.createClientKeyExchange=function(f){var w=i.util.createBuffer();w.putByte(f.session.clientHelloVersion.major),w.putByte(f.session.clientHelloVersion.minor),w.putBytes(i.random.getBytes(46));var _=f.session.sp;_.pre_master_secret=w.getBytes();var o=f.session.serverCertificate.publicKey;w=o.encrypt(_.pre_master_secret);var A=w.length+2,F=i.util.createBuffer();return F.putByte(t.HandshakeType.client_key_exchange),F.putInt24(A),F.putInt16(w.length),F.putBytes(w),F},t.createServerKeyExchange=function(f){var w=i.util.createBuffer();return w},t.getClientSignature=function(f,w){var _=i.util.createBuffer();_.putBuffer(f.session.md5.digest()),_.putBuffer(f.session.sha1.digest()),_=_.getBytes(),f.getSignature=f.getSignature||function(o,A,F){var P=null;if(o.getPrivateKey)try{P=o.getPrivateKey(o,o.session.clientCertificate),P=i.pki.privateKeyFromPem(P)}catch(z){o.error(o,{message:"Could not get private key.",cause:z,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}})}P===null?o.error(o,{message:"No private key set.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}}):A=P.sign(A,null),F(o,A)},f.getSignature(f,_,w)},t.createCertificateVerify=function(f,w){var _=w.length+2,o=i.util.createBuffer();return o.putByte(t.HandshakeType.certificate_verify),o.putInt24(_),o.putInt16(w.length),o.putBytes(w),o},t.createCertificateRequest=function(f){var w=i.util.createBuffer();w.putByte(1);var _=i.util.createBuffer();for(var o in f.caStore.certs){var A=f.caStore.certs[o],F=i.pki.distinguishedNameToAsn1(A.subject),P=i.asn1.toDer(F);_.putInt16(P.length()),_.putBuffer(P)}var z=1+w.length()+2+_.length(),ee=i.util.createBuffer();return ee.putByte(t.HandshakeType.certificate_request),ee.putInt24(z),h(ee,1,w),h(ee,2,_),ee},t.createServerHelloDone=function(f){var w=i.util.createBuffer();return w.putByte(t.HandshakeType.server_hello_done),w.putInt24(0),w},t.createChangeCipherSpec=function(){var f=i.util.createBuffer();return f.putByte(1),f},t.createFinished=function(f){var w=i.util.createBuffer();w.putBuffer(f.session.md5.digest()),w.putBuffer(f.session.sha1.digest());var _=f.entity===t.ConnectionEnd.client,o=f.session.sp,A=12,F=e,P=_?"client finished":"server finished";w=F(o.master_secret,P,w.getBytes(),A);var z=i.util.createBuffer();return z.putByte(t.HandshakeType.finished),z.putInt24(w.length()),z.putBuffer(w),z},t.createHeartbeat=function(f,w,_){typeof _>"u"&&(_=w.length);var o=i.util.createBuffer();o.putByte(f),o.putInt16(_),o.putBytes(w);var A=o.length(),F=Math.max(16,A-_-3);return o.putBytes(i.random.getBytes(F)),o},t.queue=function(f,w){if(w&&!(w.fragment.length()===0&&(w.type===t.ContentType.handshake||w.type===t.ContentType.alert||w.type===t.ContentType.change_cipher_spec))){if(w.type===t.ContentType.handshake){var _=w.fragment.bytes();f.session.md5.update(_),f.session.sha1.update(_),_=null}var o;if(w.fragment.length()<=t.MaxFragment)o=[w];else{o=[];for(var A=w.fragment.bytes();A.length>t.MaxFragment;)o.push(t.createRecord(f,{type:w.type,data:i.util.createBuffer(A.slice(0,t.MaxFragment))})),A=A.slice(t.MaxFragment);A.length>0&&o.push(t.createRecord(f,{type:w.type,data:i.util.createBuffer(A)}))}for(var F=0;F<o.length&&!f.fail;++F){var P=o[F],z=f.state.current.write;z.update(f,P)&&f.records.push(P)}}},t.flush=function(f){for(var w=0;w<f.records.length;++w){var _=f.records[w];f.tlsData.putByte(_.type),f.tlsData.putByte(_.version.major),f.tlsData.putByte(_.version.minor),f.tlsData.putInt16(_.fragment.length()),f.tlsData.putBuffer(f.records[w].fragment)}return f.records=[],f.tlsDataReady(f)};var Z=function(f){switch(f){case!0:return!0;case i.pki.certificateError.bad_certificate:return t.Alert.Description.bad_certificate;case i.pki.certificateError.unsupported_certificate:return t.Alert.Description.unsupported_certificate;case i.pki.certificateError.certificate_revoked:return t.Alert.Description.certificate_revoked;case i.pki.certificateError.certificate_expired:return t.Alert.Description.certificate_expired;case i.pki.certificateError.certificate_unknown:return t.Alert.Description.certificate_unknown;case i.pki.certificateError.unknown_ca:return t.Alert.Description.unknown_ca;default:return t.Alert.Description.bad_certificate}},qe=function(f){switch(f){case!0:return!0;case t.Alert.Description.bad_certificate:return i.pki.certificateError.bad_certificate;case t.Alert.Description.unsupported_certificate:return i.pki.certificateError.unsupported_certificate;case t.Alert.Description.certificate_revoked:return i.pki.certificateError.certificate_revoked;case t.Alert.Description.certificate_expired:return i.pki.certificateError.certificate_expired;case t.Alert.Description.certificate_unknown:return i.pki.certificateError.certificate_unknown;case t.Alert.Description.unknown_ca:return i.pki.certificateError.unknown_ca;default:return i.pki.certificateError.bad_certificate}};t.verifyCertificateChain=function(f,w){try{var _={};for(var o in f.verifyOptions)_[o]=f.verifyOptions[o];_.verify=function(F,P,z){var ee=Z(F),ae=f.verify(f,F,P,z);if(ae!==!0){if(typeof ae=="object"&&!i.util.isArray(ae)){var G=new Error("The application rejected the certificate.");throw G.send=!0,G.alert={level:t.Alert.Level.fatal,description:t.Alert.Description.bad_certificate},ae.message&&(G.message=ae.message),ae.alert&&(G.alert.description=ae.alert),G}ae!==F&&(ae=qe(ae))}return ae},i.pki.verifyCertificateChain(f.caStore,w,_)}catch(F){var A=F;(typeof A!="object"||i.util.isArray(A))&&(A={send:!0,alert:{level:t.Alert.Level.fatal,description:Z(F)}}),"send"in A||(A.send=!0),"alert"in A||(A.alert={level:t.Alert.Level.fatal,description:Z(A.error)}),f.error(f,A)}return!f.fail},t.createSessionCache=function(f,w){var _=null;if(f&&f.getSession&&f.setSession&&f.order)_=f;else{_={},_.cache=f||{},_.capacity=Math.max(w||100,1),_.order=[];for(var o in f)_.order.length<=w?_.order.push(o):delete f[o];_.getSession=function(A){var F=null,P=null;if(A?P=i.util.bytesToHex(A):_.order.length>0&&(P=_.order[0]),P!==null&&P in _.cache){F=_.cache[P],delete _.cache[P];for(var z in _.order)if(_.order[z]===P){_.order.splice(z,1);break}}return F},_.setSession=function(A,F){if(_.order.length===_.capacity){var P=_.order.shift();delete _.cache[P]}var P=i.util.bytesToHex(A);_.order.push(P),_.cache[P]=F}}return _},t.createConnection=function(f){var w=null;f.caStore?i.util.isArray(f.caStore)?w=i.pki.createCaStore(f.caStore):w=f.caStore:w=i.pki.createCaStore();var _=f.cipherSuites||null;if(_===null){_=[];for(var o in t.CipherSuites)_.push(t.CipherSuites[o])}var A=f.server?t.ConnectionEnd.server:t.ConnectionEnd.client,F=f.sessionCache?t.createSessionCache(f.sessionCache):null,P={version:{major:t.Version.major,minor:t.Version.minor},entity:A,sessionId:f.sessionId,caStore:w,sessionCache:F,cipherSuites:_,connected:f.connected,virtualHost:f.virtualHost||null,verifyClient:f.verifyClient||!1,verify:f.verify||function(G,te,ne,ce){return te},verifyOptions:f.verifyOptions||{},getCertificate:f.getCertificate||null,getPrivateKey:f.getPrivateKey||null,getSignature:f.getSignature||null,input:i.util.createBuffer(),tlsData:i.util.createBuffer(),data:i.util.createBuffer(),tlsDataReady:f.tlsDataReady,dataReady:f.dataReady,heartbeatReceived:f.heartbeatReceived,closed:f.closed,error:function(G,te){te.origin=te.origin||(G.entity===t.ConnectionEnd.client?"client":"server"),te.send&&(t.queue(G,t.createAlert(G,te.alert)),t.flush(G));var ne=te.fatal!==!1;ne&&(G.fail=!0),f.error(G,te),ne&&G.close(!1)},deflate:f.deflate||null,inflate:f.inflate||null};P.reset=function(G){P.version={major:t.Version.major,minor:t.Version.minor},P.record=null,P.session=null,P.peerCertificate=null,P.state={pending:null,current:null},P.expect=P.entity===t.ConnectionEnd.client?C:s,P.fragmented=null,P.records=[],P.open=!1,P.handshakes=0,P.handshaking=!1,P.isConnected=!1,P.fail=!(G||typeof G>"u"),P.input.clear(),P.tlsData.clear(),P.data.clear(),P.state.current=t.createConnectionState(P)},P.reset();var z=function(G,te){var ne=te.type-t.ContentType.change_cipher_spec,ce=q[G.entity][G.expect];ne in ce?ce[ne](G,te):t.handleUnexpected(G,te)},ee=function(G){var te=0,ne=G.input,ce=ne.length();if(ce<5)te=5-ce;else{G.record={type:ne.getByte(),version:{major:ne.getByte(),minor:ne.getByte()},length:ne.getInt16(),fragment:i.util.createBuffer(),ready:!1};var oe=G.record.version.major===G.version.major;oe&&G.session&&G.session.version&&(oe=G.record.version.minor===G.version.minor),oe||G.error(G,{message:"Incompatible TLS version.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.protocol_version}})}return te},ae=function(G){var te=0,ne=G.input,ce=ne.length();if(ce<G.record.length)te=G.record.length-ce;else{G.record.fragment.putBytes(ne.getBytes(G.record.length)),ne.compact();var oe=G.state.current.read;oe.update(G,G.record)&&(G.fragmented!==null&&(G.fragmented.type===G.record.type?(G.fragmented.fragment.putBuffer(G.record.fragment),G.record=G.fragmented):G.error(G,{message:"Invalid fragmented record.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unexpected_message}})),G.record.ready=!0)}return te};return P.handshake=function(G){if(P.entity!==t.ConnectionEnd.client)P.error(P,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(P.handshaking)P.error(P,{message:"Handshake already in progress.",fatal:!1});else{P.fail&&!P.open&&P.handshakes===0&&(P.fail=!1),P.handshaking=!0,G=G||"";var te=null;G.length>0&&(P.sessionCache&&(te=P.sessionCache.getSession(G)),te===null&&(G="")),G.length===0&&P.sessionCache&&(te=P.sessionCache.getSession(),te!==null&&(G=te.id)),P.session={id:G,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:i.md.md5.create(),sha1:i.md.sha1.create()},te&&(P.version=te.version,P.session.sp=te.sp),P.session.sp.client_random=t.createRandom().getBytes(),P.open=!0,t.queue(P,t.createRecord(P,{type:t.ContentType.handshake,data:t.createClientHello(P)})),t.flush(P)}},P.process=function(G){var te=0;return G&&P.input.putBytes(G),P.fail||(P.record!==null&&P.record.ready&&P.record.fragment.isEmpty()&&(P.record=null),P.record===null&&(te=ee(P)),!P.fail&&P.record!==null&&!P.record.ready&&(te=ae(P)),!P.fail&&P.record!==null&&P.record.ready&&z(P,P.record)),te},P.prepare=function(G){return t.queue(P,t.createRecord(P,{type:t.ContentType.application_data,data:i.util.createBuffer(G)})),t.flush(P)},P.prepareHeartbeatRequest=function(G,te){return G instanceof i.util.ByteBuffer&&(G=G.bytes()),typeof te>"u"&&(te=G.length),P.expectedHeartbeatPayload=G,t.queue(P,t.createRecord(P,{type:t.ContentType.heartbeat,data:t.createHeartbeat(t.HeartbeatMessageType.heartbeat_request,G,te)})),t.flush(P)},P.close=function(G){if(!P.fail&&P.sessionCache&&P.session){var te={id:P.session.id,version:P.session.version,sp:P.session.sp};te.sp.keys=null,P.sessionCache.setSession(te.id,te)}P.open&&(P.open=!1,P.input.clear(),(P.isConnected||P.handshaking)&&(P.isConnected=P.handshaking=!1,t.queue(P,t.createAlert(P,{level:t.Alert.Level.warning,description:t.Alert.Description.close_notify})),t.flush(P)),P.closed(P)),P.reset(G)},P},ir=i.tls=i.tls||{};for(var le in t)typeof t[le]!="function"&&(i.tls[le]=t[le]);return i.tls.prf_tls1=e,i.tls.hmac_sha1=a,i.tls.createSessionCache=t.createSessionCache,i.tls.createConnection=t.createConnection,ir}var Zr;function Ka(){if(Zr)return kt.exports;Zr=1;var i=fe();lt(),Ca();var e=kt.exports=i.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(C){C.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,C.cipher_type=e.CipherType.block,C.enc_key_length=16,C.block_length=16,C.fixed_iv_length=16,C.record_iv_length=16,C.mac_algorithm=e.MACAlgorithm.hmac_sha1,C.mac_length=20,C.mac_key_length=20},initConnectionState:a},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(C){C.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,C.cipher_type=e.CipherType.block,C.enc_key_length=32,C.block_length=16,C.fixed_iv_length=16,C.record_iv_length=16,C.mac_algorithm=e.MACAlgorithm.hmac_sha1,C.mac_length=20,C.mac_key_length=20},initConnectionState:a};function a(C,l,x){var k=l.entity===i.tls.ConnectionEnd.client;C.read.cipherState={init:!1,cipher:i.cipher.createDecipher("AES-CBC",k?x.keys.server_write_key:x.keys.client_write_key),iv:k?x.keys.server_write_IV:x.keys.client_write_IV},C.write.cipherState={init:!1,cipher:i.cipher.createCipher("AES-CBC",k?x.keys.client_write_key:x.keys.server_write_key),iv:k?x.keys.client_write_IV:x.keys.server_write_IV},C.read.cipherFunction=h,C.write.cipherFunction=y,C.read.macLength=C.write.macLength=x.mac_length,C.read.macFunction=C.write.macFunction=e.hmac_sha1}function y(C,l){var x=!1,k=l.macFunction(l.macKey,l.sequenceNumber,C);C.fragment.putBytes(k),l.updateSequenceNumber();var E;C.version.minor===e.Versions.TLS_1_0.minor?E=l.cipherState.init?null:l.cipherState.iv:E=i.random.getBytesSync(16),l.cipherState.init=!0;var u=l.cipherState.cipher;return u.start({iv:E}),C.version.minor>=e.Versions.TLS_1_1.minor&&u.output.putBytes(E),u.update(C.fragment),u.finish(N)&&(C.fragment=u.output,C.length=C.fragment.length(),x=!0),x}function N(C,l,x){if(!x){var k=C-l.length()%C;l.fillWithByte(k-1,k)}return!0}function S(C,l,x){var k=!0;if(x){for(var E=l.length(),u=l.last(),v=E-1-u;v<E-1;++v)k=k&&l.at(v)==u;k&&l.truncate(u+1)}return k}function h(C,l){var x=!1,k;C.version.minor===e.Versions.TLS_1_0.minor?k=l.cipherState.init?null:l.cipherState.iv:k=C.fragment.getBytes(16),l.cipherState.init=!0;var E=l.cipherState.cipher;E.start({iv:k}),E.update(C.fragment),x=E.finish(S);var u=l.macLength,v=i.random.getBytesSync(u),m=E.output.length();m>=u?(C.fragment=E.output.getBytes(m-u),v=E.output.getBytes(u)):C.fragment=E.output.getBytes(),C.fragment=i.util.createBuffer(C.fragment),C.length=C.fragment.length();var g=l.macFunction(l.macKey,l.sequenceNumber,C);return l.updateSequenceNumber(),x=t(l.macKey,v,g)&&x,x}function t(C,l,x){var k=i.hmac.create();return k.start("SHA1",C),k.update(l),l=k.digest().getBytes(),k.start(null,null),k.update(x),x=k.digest().getBytes(),l===x}return kt.exports}var nr={exports:{}},$r;function ma(){if($r)return nr.exports;$r=1;var i=fe();nt(),de();var e=nr.exports=i.sha512=i.sha512||{};i.md.sha512=i.md.algorithms.sha512=e;var a=i.sha384=i.sha512.sha384=i.sha512.sha384||{};a.create=function(){return e.create("SHA-384")},i.md.sha384=i.md.algorithms.sha384=a,i.sha512.sha256=i.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},i.md["sha512/256"]=i.md.algorithms["sha512/256"]=i.sha512.sha256,i.sha512.sha224=i.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},i.md["sha512/224"]=i.md.algorithms["sha512/224"]=i.sha512.sha224,e.create=function(l){if(N||t(),typeof l>"u"&&(l="SHA-512"),!(l in h))throw new Error("Invalid SHA-512 algorithm: "+l);for(var x=h[l],k=null,E=i.util.createBuffer(),u=new Array(80),v=0;v<80;++v)u[v]=new Array(2);var m=64;switch(l){case"SHA-384":m=48;break;case"SHA-512/256":m=32;break;case"SHA-512/224":m=28;break}var g={algorithm:l.replace("-","").toLowerCase(),blockLength:128,digestLength:m,messageLength:0,fullMessageLength:null,messageLengthSize:16};return g.start=function(){g.messageLength=0,g.fullMessageLength=g.messageLength128=[];for(var s=g.messageLengthSize/4,d=0;d<s;++d)g.fullMessageLength.push(0);E=i.util.createBuffer(),k=new Array(x.length);for(var d=0;d<x.length;++d)k[d]=x[d].slice(0);return g},g.start(),g.update=function(s,d){d==="utf8"&&(s=i.util.encodeUtf8(s));var p=s.length;g.messageLength+=p,p=[p/4294967296>>>0,p>>>0];for(var I=g.fullMessageLength.length-1;I>=0;--I)g.fullMessageLength[I]+=p[1],p[1]=p[0]+(g.fullMessageLength[I]/4294967296>>>0),g.fullMessageLength[I]=g.fullMessageLength[I]>>>0,p[0]=p[1]/4294967296>>>0;return E.putBytes(s),C(k,u,E),(E.read>2048||E.length()===0)&&E.compact(),g},g.digest=function(){var s=i.util.createBuffer();s.putBytes(E.bytes());var d=g.fullMessageLength[g.fullMessageLength.length-1]+g.messageLengthSize,p=d&g.blockLength-1;s.putBytes(y.substr(0,g.blockLength-p));for(var I,R,c=g.fullMessageLength[0]*8,n=0;n<g.fullMessageLength.length-1;++n)I=g.fullMessageLength[n+1]*8,R=I/4294967296>>>0,c+=R,s.putInt32(c>>>0),c=I>>>0;s.putInt32(c);for(var r=new Array(k.length),n=0;n<k.length;++n)r[n]=k[n].slice(0);C(r,u,s);var B=i.util.createBuffer(),D;l==="SHA-512"?D=r.length:l==="SHA-384"?D=r.length-2:D=r.length-4;for(var n=0;n<D;++n)B.putInt32(r[n][0]),(n!==D-1||l!=="SHA-512/224")&&B.putInt32(r[n][1]);return B},g};var y=null,N=!1,S=null,h=null;function t(){y="",y+=i.util.fillString("\0",128),S=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],h={},h["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],h["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],h["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],h["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],N=!0}function C(l,x,k){for(var E,u,v,m,g,s,d,p,I,R,c,n,r,B,D,V,L,O,q,M,H,Y,W,$,ie,se,he,ge,j,ue,Z,qe,le,f,w,_=k.length();_>=128;){for(j=0;j<16;++j)x[j][0]=k.getInt32()>>>0,x[j][1]=k.getInt32()>>>0;for(;j<80;++j)qe=x[j-2],ue=qe[0],Z=qe[1],E=((ue>>>19|Z<<13)^(Z>>>29|ue<<3)^ue>>>6)>>>0,u=((ue<<13|Z>>>19)^(Z<<3|ue>>>29)^(ue<<26|Z>>>6))>>>0,f=x[j-15],ue=f[0],Z=f[1],v=((ue>>>1|Z<<31)^(ue>>>8|Z<<24)^ue>>>7)>>>0,m=((ue<<31|Z>>>1)^(ue<<24|Z>>>8)^(ue<<25|Z>>>7))>>>0,le=x[j-7],w=x[j-16],Z=u+le[1]+m+w[1],x[j][0]=E+le[0]+v+w[0]+(Z/4294967296>>>0)>>>0,x[j][1]=Z>>>0;for(r=l[0][0],B=l[0][1],D=l[1][0],V=l[1][1],L=l[2][0],O=l[2][1],q=l[3][0],M=l[3][1],H=l[4][0],Y=l[4][1],W=l[5][0],$=l[5][1],ie=l[6][0],se=l[6][1],he=l[7][0],ge=l[7][1],j=0;j<80;++j)d=((H>>>14|Y<<18)^(H>>>18|Y<<14)^(Y>>>9|H<<23))>>>0,p=((H<<18|Y>>>14)^(H<<14|Y>>>18)^(Y<<23|H>>>9))>>>0,I=(ie^H&(W^ie))>>>0,R=(se^Y&($^se))>>>0,g=((r>>>28|B<<4)^(B>>>2|r<<30)^(B>>>7|r<<25))>>>0,s=((r<<4|B>>>28)^(B<<30|r>>>2)^(B<<25|r>>>7))>>>0,c=(r&D|L&(r^D))>>>0,n=(B&V|O&(B^V))>>>0,Z=ge+p+R+S[j][1]+x[j][1],E=he+d+I+S[j][0]+x[j][0]+(Z/4294967296>>>0)>>>0,u=Z>>>0,Z=s+n,v=g+c+(Z/4294967296>>>0)>>>0,m=Z>>>0,he=ie,ge=se,ie=W,se=$,W=H,$=Y,Z=M+u,H=q+E+(Z/4294967296>>>0)>>>0,Y=Z>>>0,q=L,M=O,L=D,O=V,D=r,V=B,Z=u+m,r=E+v+(Z/4294967296>>>0)>>>0,B=Z>>>0;Z=l[0][1]+B,l[0][0]=l[0][0]+r+(Z/4294967296>>>0)>>>0,l[0][1]=Z>>>0,Z=l[1][1]+V,l[1][0]=l[1][0]+D+(Z/4294967296>>>0)>>>0,l[1][1]=Z>>>0,Z=l[2][1]+O,l[2][0]=l[2][0]+L+(Z/4294967296>>>0)>>>0,l[2][1]=Z>>>0,Z=l[3][1]+M,l[3][0]=l[3][0]+q+(Z/4294967296>>>0)>>>0,l[3][1]=Z>>>0,Z=l[4][1]+Y,l[4][0]=l[4][0]+H+(Z/4294967296>>>0)>>>0,l[4][1]=Z>>>0,Z=l[5][1]+$,l[5][0]=l[5][0]+W+(Z/4294967296>>>0)>>>0,l[5][1]=Z>>>0,Z=l[6][1]+se,l[6][0]=l[6][0]+ie+(Z/4294967296>>>0)>>>0,l[6][1]=Z>>>0,Z=l[7][1]+ge,l[7][0]=l[7][0]+he+(Z/4294967296>>>0)>>>0,l[7][1]=Z>>>0,_-=128}}return nr.exports}var Tt={},Jr;function Ma(){if(Jr)return Tt;Jr=1;var i=fe();rt();var e=i.asn1;return Tt.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Tt.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]},Tt}var sr,ea;function qa(){if(ea)return sr;ea=1;var i=fe();At(),et(),ma(),de();var e=Ma(),a=e.publicKeyValidator,y=e.privateKeyValidator;if(typeof N>"u")var N=i.jsbn.BigInteger;var S=i.util.ByteBuffer,h=typeof We>"u"?Uint8Array:We;i.pki=i.pki||{},sr=i.pki.ed25519=i.ed25519=i.ed25519||{};var t=i.ed25519;t.constants={},t.constants.PUBLIC_KEY_BYTE_LENGTH=32,t.constants.PRIVATE_KEY_BYTE_LENGTH=64,t.constants.SEED_BYTE_LENGTH=32,t.constants.SIGN_BYTE_LENGTH=64,t.constants.HASH_BYTE_LENGTH=64,t.generateKeyPair=function(f){f=f||{};var w=f.seed;if(w===void 0)w=i.random.getBytesSync(t.constants.SEED_BYTE_LENGTH);else if(typeof w=="string"){if(w.length!==t.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+t.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(w instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');w=C({message:w,encoding:"binary"});for(var _=new h(t.constants.PUBLIC_KEY_BYTE_LENGTH),o=new h(t.constants.PRIVATE_KEY_BYTE_LENGTH),A=0;A<32;++A)o[A]=w[A];return d(_,o),{publicKey:_,privateKey:o}},t.privateKeyFromAsn1=function(f){var w={},_=[],o=i.asn1.validate(f,y,w,_);if(!o){var A=new Error("Invalid Key.");throw A.errors=_,A}var F=i.asn1.derToOid(w.privateKeyOid),P=i.oids.EdDSA25519;if(F!==P)throw new Error('Invalid OID "'+F+'"; OID must be "'+P+'".');var z=w.privateKey,ee=C({message:i.asn1.fromDer(z).value,encoding:"binary"});return{privateKeyBytes:ee}},t.publicKeyFromAsn1=function(f){var w={},_=[],o=i.asn1.validate(f,a,w,_);if(!o){var A=new Error("Invalid Key.");throw A.errors=_,A}var F=i.asn1.derToOid(w.publicKeyOid),P=i.oids.EdDSA25519;if(F!==P)throw new Error('Invalid OID "'+F+'"; OID must be "'+P+'".');var z=w.ed25519PublicKey;if(z.length!==t.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return C({message:z,encoding:"binary"})},t.publicKeyFromPrivateKey=function(f){f=f||{};var w=C({message:f.privateKey,encoding:"binary"});if(w.length!==t.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+t.constants.PRIVATE_KEY_BYTE_LENGTH);for(var _=new h(t.constants.PUBLIC_KEY_BYTE_LENGTH),o=0;o<_.length;++o)_[o]=w[32+o];return _},t.sign=function(f){f=f||{};var w=C(f),_=C({message:f.privateKey,encoding:"binary"});if(_.length===t.constants.SEED_BYTE_LENGTH){var o=t.generateKeyPair({seed:_});_=o.privateKey}else if(_.length!==t.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+t.constants.SEED_BYTE_LENGTH+" or "+t.constants.PRIVATE_KEY_BYTE_LENGTH);var A=new h(t.constants.SIGN_BYTE_LENGTH+w.length);p(A,w,w.length,_);for(var F=new h(t.constants.SIGN_BYTE_LENGTH),P=0;P<F.length;++P)F[P]=A[P];return F},t.verify=function(f){f=f||{};var w=C(f);if(f.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var _=C({message:f.signature,encoding:"binary"});if(_.length!==t.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+t.constants.SIGN_BYTE_LENGTH);var o=C({message:f.publicKey,encoding:"binary"});if(o.length!==t.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+t.constants.PUBLIC_KEY_BYTE_LENGTH);var A=new h(t.constants.SIGN_BYTE_LENGTH+w.length),F=new h(t.constants.SIGN_BYTE_LENGTH+w.length),P;for(P=0;P<t.constants.SIGN_BYTE_LENGTH;++P)A[P]=_[P];for(P=0;P<w.length;++P)A[P+t.constants.SIGN_BYTE_LENGTH]=w[P];return I(F,A,A.length,o)>=0};function C(f){var w=f.message;if(w instanceof Uint8Array||w instanceof h)return w;var _=f.encoding;if(w===void 0)if(f.md)w=f.md.digest().getBytes(),_="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof w=="string"&&!_)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof w=="string"){if(typeof We<"u")return We.from(w,_);w=new S(w,_)}else if(!(w instanceof S))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var o=new h(w.length()),A=0;A<o.length;++A)o[A]=w.at(A);return o}var l=j(),x=j([1]),k=j([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),E=j([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=j([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),v=j([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),m=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),g=j([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function s(f,w){var _=i.md.sha512.create(),o=new S(f);_.update(o.getBytes(w),"binary");var A=_.digest().getBytes();if(typeof We<"u")return We.from(A,"binary");for(var F=new h(t.constants.HASH_BYTE_LENGTH),P=0;P<64;++P)F[P]=A.charCodeAt(P);return F}function d(f,w){var _=[j(),j(),j(),j()],o,A=s(w,32);for(A[0]&=248,A[31]&=127,A[31]|=64,$(_,A),B(f,_),o=0;o<32;++o)w[o+32]=f[o];return 0}function p(f,w,_,o){var A,F,P=new Float64Array(64),z=[j(),j(),j(),j()],ee=s(o,32);ee[0]&=248,ee[31]&=127,ee[31]|=64;var ae=_+64;for(A=0;A<_;++A)f[64+A]=w[A];for(A=0;A<32;++A)f[32+A]=ee[32+A];var G=s(f.subarray(32),_+32);for(c(G),$(z,G),B(f,z),A=32;A<64;++A)f[A]=o[A];var te=s(f,_+64);for(c(te),A=32;A<64;++A)P[A]=0;for(A=0;A<32;++A)P[A]=G[A];for(A=0;A<32;++A)for(F=0;F<32;F++)P[A+F]+=te[A]*ee[F];return R(f.subarray(32),P),ae}function I(f,w,_,o){var A,F,P=new h(32),z=[j(),j(),j(),j()],ee=[j(),j(),j(),j()];if(F=-1,_<64||V(ee,o))return-1;for(A=0;A<_;++A)f[A]=w[A];for(A=0;A<32;++A)f[A+32]=o[A];var ae=s(f,_);if(c(ae),W(z,ee,ae),$(ee,w.subarray(32)),n(z,ee),B(P,z),_-=64,M(w,0,P,0)){for(A=0;A<_;++A)f[A]=0;return-1}for(A=0;A<_;++A)f[A]=w[A+64];return F=_,F}function R(f,w){var _,o,A,F;for(o=63;o>=32;--o){for(_=0,A=o-32,F=o-12;A<F;++A)w[A]+=_-16*w[o]*m[A-(o-32)],_=w[A]+128>>8,w[A]-=_*256;w[A]+=_,w[o]=0}for(_=0,A=0;A<32;++A)w[A]+=_-(w[31]>>4)*m[A],_=w[A]>>8,w[A]&=255;for(A=0;A<32;++A)w[A]-=_*m[A];for(o=0;o<32;++o)w[o+1]+=w[o]>>8,f[o]=w[o]&255}function c(f){for(var w=new Float64Array(64),_=0;_<64;++_)w[_]=f[_],f[_]=0;R(f,w)}function n(f,w){var _=j(),o=j(),A=j(),F=j(),P=j(),z=j(),ee=j(),ae=j(),G=j();Z(_,f[1],f[0]),Z(G,w[1],w[0]),le(_,_,G),ue(o,f[0],f[1]),ue(G,w[0],w[1]),le(o,o,G),le(A,f[3],w[3]),le(A,A,E),le(F,f[2],w[2]),ue(F,F,F),Z(P,o,_),Z(z,F,A),ue(ee,F,A),ue(ae,o,_),le(f[0],P,z),le(f[1],ae,ee),le(f[2],ee,z),le(f[3],P,ae)}function r(f,w,_){for(var o=0;o<4;++o)ge(f[o],w[o],_)}function B(f,w){var _=j(),o=j(),A=j();se(A,w[2]),le(_,w[0],A),le(o,w[1],A),D(f,o),f[31]^=Y(_)<<7}function D(f,w){var _,o,A,F=j(),P=j();for(_=0;_<16;++_)P[_]=w[_];for(he(P),he(P),he(P),o=0;o<2;++o){for(F[0]=P[0]-65517,_=1;_<15;++_)F[_]=P[_]-65535-(F[_-1]>>16&1),F[_-1]&=65535;F[15]=P[15]-32767-(F[14]>>16&1),A=F[15]>>16&1,F[14]&=65535,ge(P,F,1-A)}for(_=0;_<16;_++)f[2*_]=P[_]&255,f[2*_+1]=P[_]>>8}function V(f,w){var _=j(),o=j(),A=j(),F=j(),P=j(),z=j(),ee=j();return ie(f[2],x),L(f[1],w),qe(A,f[1]),le(F,A,k),Z(A,A,f[2]),ue(F,f[2],F),qe(P,F),qe(z,P),le(ee,z,P),le(_,ee,A),le(_,_,F),O(_,_),le(_,_,A),le(_,_,F),le(_,_,F),le(f[0],_,F),qe(o,f[0]),le(o,o,F),q(o,A)&&le(f[0],f[0],g),qe(o,f[0]),le(o,o,F),q(o,A)?-1:(Y(f[0])===w[31]>>7&&Z(f[0],l,f[0]),le(f[3],f[0],f[1]),0)}function L(f,w){var _;for(_=0;_<16;++_)f[_]=w[2*_]+(w[2*_+1]<<8);f[15]&=32767}function O(f,w){var _=j(),o;for(o=0;o<16;++o)_[o]=w[o];for(o=250;o>=0;--o)qe(_,_),o!==1&&le(_,_,w);for(o=0;o<16;++o)f[o]=_[o]}function q(f,w){var _=new h(32),o=new h(32);return D(_,f),D(o,w),M(_,0,o,0)}function M(f,w,_,o){return H(f,w,_,o,32)}function H(f,w,_,o,A){var F,P=0;for(F=0;F<A;++F)P|=f[w+F]^_[o+F];return(1&P-1>>>8)-1}function Y(f){var w=new h(32);return D(w,f),w[0]&1}function W(f,w,_){var o,A;for(ie(f[0],l),ie(f[1],x),ie(f[2],x),ie(f[3],l),A=255;A>=0;--A)o=_[A/8|0]>>(A&7)&1,r(f,w,o),n(w,f),n(f,f),r(f,w,o)}function $(f,w){var _=[j(),j(),j(),j()];ie(_[0],u),ie(_[1],v),ie(_[2],x),le(_[3],u,v),W(f,_,w)}function ie(f,w){var _;for(_=0;_<16;_++)f[_]=w[_]|0}function se(f,w){var _=j(),o;for(o=0;o<16;++o)_[o]=w[o];for(o=253;o>=0;--o)qe(_,_),o!==2&&o!==4&&le(_,_,w);for(o=0;o<16;++o)f[o]=_[o]}function he(f){var w,_,o=1;for(w=0;w<16;++w)_=f[w]+o+65535,o=Math.floor(_/65536),f[w]=_-o*65536;f[0]+=o-1+37*(o-1)}function ge(f,w,_){for(var o,A=~(_-1),F=0;F<16;++F)o=A&(f[F]^w[F]),f[F]^=o,w[F]^=o}function j(f){var w,_=new Float64Array(16);if(f)for(w=0;w<f.length;++w)_[w]=f[w];return _}function ue(f,w,_){for(var o=0;o<16;++o)f[o]=w[o]+_[o]}function Z(f,w,_){for(var o=0;o<16;++o)f[o]=w[o]-_[o]}function qe(f,w){le(f,w,w)}function le(f,w,_){var o,A,F=0,P=0,z=0,ee=0,ae=0,G=0,te=0,ne=0,ce=0,oe=0,Ce=0,Se=0,xe=0,me=0,ve=0,ye=0,Te=0,Ke=0,Me=0,He=0,Ge=0,Qe=0,Ye=0,je=0,tt=0,at=0,st=0,ft=0,ht=0,vt=0,Ct=0,Ae=_[0],Be=_[1],be=_[2],_e=_[3],Ne=_[4],Re=_[5],we=_[6],Le=_[7],De=_[8],ke=_[9],Ue=_[10],Pe=_[11],Ee=_[12],Ie=_[13],Ve=_[14],Oe=_[15];o=w[0],F+=o*Ae,P+=o*Be,z+=o*be,ee+=o*_e,ae+=o*Ne,G+=o*Re,te+=o*we,ne+=o*Le,ce+=o*De,oe+=o*ke,Ce+=o*Ue,Se+=o*Pe,xe+=o*Ee,me+=o*Ie,ve+=o*Ve,ye+=o*Oe,o=w[1],P+=o*Ae,z+=o*Be,ee+=o*be,ae+=o*_e,G+=o*Ne,te+=o*Re,ne+=o*we,ce+=o*Le,oe+=o*De,Ce+=o*ke,Se+=o*Ue,xe+=o*Pe,me+=o*Ee,ve+=o*Ie,ye+=o*Ve,Te+=o*Oe,o=w[2],z+=o*Ae,ee+=o*Be,ae+=o*be,G+=o*_e,te+=o*Ne,ne+=o*Re,ce+=o*we,oe+=o*Le,Ce+=o*De,Se+=o*ke,xe+=o*Ue,me+=o*Pe,ve+=o*Ee,ye+=o*Ie,Te+=o*Ve,Ke+=o*Oe,o=w[3],ee+=o*Ae,ae+=o*Be,G+=o*be,te+=o*_e,ne+=o*Ne,ce+=o*Re,oe+=o*we,Ce+=o*Le,Se+=o*De,xe+=o*ke,me+=o*Ue,ve+=o*Pe,ye+=o*Ee,Te+=o*Ie,Ke+=o*Ve,Me+=o*Oe,o=w[4],ae+=o*Ae,G+=o*Be,te+=o*be,ne+=o*_e,ce+=o*Ne,oe+=o*Re,Ce+=o*we,Se+=o*Le,xe+=o*De,me+=o*ke,ve+=o*Ue,ye+=o*Pe,Te+=o*Ee,Ke+=o*Ie,Me+=o*Ve,He+=o*Oe,o=w[5],G+=o*Ae,te+=o*Be,ne+=o*be,ce+=o*_e,oe+=o*Ne,Ce+=o*Re,Se+=o*we,xe+=o*Le,me+=o*De,ve+=o*ke,ye+=o*Ue,Te+=o*Pe,Ke+=o*Ee,Me+=o*Ie,He+=o*Ve,Ge+=o*Oe,o=w[6],te+=o*Ae,ne+=o*Be,ce+=o*be,oe+=o*_e,Ce+=o*Ne,Se+=o*Re,xe+=o*we,me+=o*Le,ve+=o*De,ye+=o*ke,Te+=o*Ue,Ke+=o*Pe,Me+=o*Ee,He+=o*Ie,Ge+=o*Ve,Qe+=o*Oe,o=w[7],ne+=o*Ae,ce+=o*Be,oe+=o*be,Ce+=o*_e,Se+=o*Ne,xe+=o*Re,me+=o*we,ve+=o*Le,ye+=o*De,Te+=o*ke,Ke+=o*Ue,Me+=o*Pe,He+=o*Ee,Ge+=o*Ie,Qe+=o*Ve,Ye+=o*Oe,o=w[8],ce+=o*Ae,oe+=o*Be,Ce+=o*be,Se+=o*_e,xe+=o*Ne,me+=o*Re,ve+=o*we,ye+=o*Le,Te+=o*De,Ke+=o*ke,Me+=o*Ue,He+=o*Pe,Ge+=o*Ee,Qe+=o*Ie,Ye+=o*Ve,je+=o*Oe,o=w[9],oe+=o*Ae,Ce+=o*Be,Se+=o*be,xe+=o*_e,me+=o*Ne,ve+=o*Re,ye+=o*we,Te+=o*Le,Ke+=o*De,Me+=o*ke,He+=o*Ue,Ge+=o*Pe,Qe+=o*Ee,Ye+=o*Ie,je+=o*Ve,tt+=o*Oe,o=w[10],Ce+=o*Ae,Se+=o*Be,xe+=o*be,me+=o*_e,ve+=o*Ne,ye+=o*Re,Te+=o*we,Ke+=o*Le,Me+=o*De,He+=o*ke,Ge+=o*Ue,Qe+=o*Pe,Ye+=o*Ee,je+=o*Ie,tt+=o*Ve,at+=o*Oe,o=w[11],Se+=o*Ae,xe+=o*Be,me+=o*be,ve+=o*_e,ye+=o*Ne,Te+=o*Re,Ke+=o*we,Me+=o*Le,He+=o*De,Ge+=o*ke,Qe+=o*Ue,Ye+=o*Pe,je+=o*Ee,tt+=o*Ie,at+=o*Ve,st+=o*Oe,o=w[12],xe+=o*Ae,me+=o*Be,ve+=o*be,ye+=o*_e,Te+=o*Ne,Ke+=o*Re,Me+=o*we,He+=o*Le,Ge+=o*De,Qe+=o*ke,Ye+=o*Ue,je+=o*Pe,tt+=o*Ee,at+=o*Ie,st+=o*Ve,ft+=o*Oe,o=w[13],me+=o*Ae,ve+=o*Be,ye+=o*be,Te+=o*_e,Ke+=o*Ne,Me+=o*Re,He+=o*we,Ge+=o*Le,Qe+=o*De,Ye+=o*ke,je+=o*Ue,tt+=o*Pe,at+=o*Ee,st+=o*Ie,ft+=o*Ve,ht+=o*Oe,o=w[14],ve+=o*Ae,ye+=o*Be,Te+=o*be,Ke+=o*_e,Me+=o*Ne,He+=o*Re,Ge+=o*we,Qe+=o*Le,Ye+=o*De,je+=o*ke,tt+=o*Ue,at+=o*Pe,st+=o*Ee,ft+=o*Ie,ht+=o*Ve,vt+=o*Oe,o=w[15],ye+=o*Ae,Te+=o*Be,Ke+=o*be,Me+=o*_e,He+=o*Ne,Ge+=o*Re,Qe+=o*we,Ye+=o*Le,je+=o*De,tt+=o*ke,at+=o*Ue,st+=o*Pe,ft+=o*Ee,ht+=o*Ie,vt+=o*Ve,Ct+=o*Oe,F+=38*Te,P+=38*Ke,z+=38*Me,ee+=38*He,ae+=38*Ge,G+=38*Qe,te+=38*Ye,ne+=38*je,ce+=38*tt,oe+=38*at,Ce+=38*st,Se+=38*ft,xe+=38*ht,me+=38*vt,ve+=38*Ct,A=1,o=F+A+65535,A=Math.floor(o/65536),F=o-A*65536,o=P+A+65535,A=Math.floor(o/65536),P=o-A*65536,o=z+A+65535,A=Math.floor(o/65536),z=o-A*65536,o=ee+A+65535,A=Math.floor(o/65536),ee=o-A*65536,o=ae+A+65535,A=Math.floor(o/65536),ae=o-A*65536,o=G+A+65535,A=Math.floor(o/65536),G=o-A*65536,o=te+A+65535,A=Math.floor(o/65536),te=o-A*65536,o=ne+A+65535,A=Math.floor(o/65536),ne=o-A*65536,o=ce+A+65535,A=Math.floor(o/65536),ce=o-A*65536,o=oe+A+65535,A=Math.floor(o/65536),oe=o-A*65536,o=Ce+A+65535,A=Math.floor(o/65536),Ce=o-A*65536,o=Se+A+65535,A=Math.floor(o/65536),Se=o-A*65536,o=xe+A+65535,A=Math.floor(o/65536),xe=o-A*65536,o=me+A+65535,A=Math.floor(o/65536),me=o-A*65536,o=ve+A+65535,A=Math.floor(o/65536),ve=o-A*65536,o=ye+A+65535,A=Math.floor(o/65536),ye=o-A*65536,F+=A-1+37*(A-1),A=1,o=F+A+65535,A=Math.floor(o/65536),F=o-A*65536,o=P+A+65535,A=Math.floor(o/65536),P=o-A*65536,o=z+A+65535,A=Math.floor(o/65536),z=o-A*65536,o=ee+A+65535,A=Math.floor(o/65536),ee=o-A*65536,o=ae+A+65535,A=Math.floor(o/65536),ae=o-A*65536,o=G+A+65535,A=Math.floor(o/65536),G=o-A*65536,o=te+A+65535,A=Math.floor(o/65536),te=o-A*65536,o=ne+A+65535,A=Math.floor(o/65536),ne=o-A*65536,o=ce+A+65535,A=Math.floor(o/65536),ce=o-A*65536,o=oe+A+65535,A=Math.floor(o/65536),oe=o-A*65536,o=Ce+A+65535,A=Math.floor(o/65536),Ce=o-A*65536,o=Se+A+65535,A=Math.floor(o/65536),Se=o-A*65536,o=xe+A+65535,A=Math.floor(o/65536),xe=o-A*65536,o=me+A+65535,A=Math.floor(o/65536),me=o-A*65536,o=ve+A+65535,A=Math.floor(o/65536),ve=o-A*65536,o=ye+A+65535,A=Math.floor(o/65536),ye=o-A*65536,F+=A-1+37*(A-1),f[0]=F,f[1]=P,f[2]=z,f[3]=ee,f[4]=ae,f[5]=G,f[6]=te,f[7]=ne,f[8]=ce,f[9]=oe,f[10]=Ce,f[11]=Se,f[12]=xe,f[13]=me,f[14]=ve,f[15]=ye}return sr}var or,ta;function Ha(){if(ta)return or;ta=1;var i=fe();de(),et(),At(),or=i.kem=i.kem||{};var e=i.jsbn.BigInteger;i.kem.rsa={},i.kem.rsa.create=function(y,N){N=N||{};var S=N.prng||i.random,h={};return h.encrypt=function(t,C){var l=Math.ceil(t.n.bitLength()/8),x;do x=new e(i.util.bytesToHex(S.getBytesSync(l)),16).mod(t.n);while(x.compareTo(e.ONE)<=0);x=i.util.hexToBytes(x.toString(16));var k=l-x.length;k>0&&(x=i.util.fillString("\0",k)+x);var E=t.encrypt(x,"NONE"),u=y.generate(x,C);return{encapsulation:E,key:u}},h.decrypt=function(t,C,l){var x=t.decrypt(C,"NONE");return y.generate(x,l)},h},i.kem.kdf1=function(y,N){a(this,y,0,N||y.digestLength)},i.kem.kdf2=function(y,N){a(this,y,1,N||y.digestLength)};function a(y,N,S,h){y.generate=function(t,C){for(var l=new i.util.ByteBuffer,x=Math.ceil(C/h)+S,k=new i.util.ByteBuffer,E=S;E<x;++E){k.putInt32(E),N.start(),N.update(t+k.getBytes());var u=N.digest();l.putBytes(u.getBytes(h))}return l.truncate(l.length()-C),l.getBytes()}}return or}var ur,ra;function Ga(){if(ra)return ur;ra=1;var i=fe();de(),ur=i.log=i.log||{},i.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},a=[],y=null;i.log.LEVEL_LOCKED=2,i.log.NO_LEVEL_CHECK=4,i.log.INTERPOLATE=8;for(var N=0;N<i.log.levels.length;++N){var S=i.log.levels[N];e[S]={index:N,name:S.toUpperCase()}}i.log.logMessage=function(E){for(var u=e[E.level].index,v=0;v<a.length;++v){var m=a[v];if(m.flags&i.log.NO_LEVEL_CHECK)m.f(E);else{var g=e[m.level].index;u<=g&&m.f(m,E)}}},i.log.prepareStandard=function(E){"standard"in E||(E.standard=e[E.level].name+" ["+E.category+"] "+E.message)},i.log.prepareFull=function(E){if(!("full"in E)){var u=[E.message];u=u.concat([]),E.full=i.util.format.apply(this,u)}},i.log.prepareStandardFull=function(E){"standardFull"in E||(i.log.prepareStandard(E),E.standardFull=E.standard)};for(var h=["error","warning","info","debug","verbose"],N=0;N<h.length;++N)(function(u){i.log[u]=function(v,m){var g=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:u,category:v,message:m,arguments:g};i.log.logMessage(s)}})(h[N]);if(i.log.makeLogger=function(E){var u={flags:0,f:E};return i.log.setLevel(u,"none"),u},i.log.setLevel=function(E,u){var v=!1;if(E&&!(E.flags&i.log.LEVEL_LOCKED))for(var m=0;m<i.log.levels.length;++m){var g=i.log.levels[m];if(u==g){E.level=u,v=!0;break}}return v},i.log.lock=function(E,u){typeof u>"u"||u?E.flags|=i.log.LEVEL_LOCKED:E.flags&=~i.log.LEVEL_LOCKED},i.log.addLogger=function(E){a.push(E)},typeof console<"u"&&"log"in console){var t;if(console.error&&console.warn&&console.info&&console.debug){var C={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},l=function(E,u){i.log.prepareStandard(u);var v=C[u.level],m=[u.standard];m=m.concat(u.arguments.slice()),v.apply(console,m)};t=i.log.makeLogger(l)}else{var l=function(u,v){i.log.prepareStandardFull(v),console.log(v.standardFull)};t=i.log.makeLogger(l)}i.log.setLevel(t,"debug"),i.log.addLogger(t),y=t}else console={log:function(){}};if(y!==null&&typeof window<"u"&&window.location){var x=new URL(window.location.href).searchParams;if(x.has("console.level")&&i.log.setLevel(y,x.get("console.level").slice(-1)[0]),x.has("console.lock")){var k=x.get("console.lock").slice(-1)[0];k=="true"&&i.log.lock(y)}}return i.log.consoleLogger=y,ur}var fr,aa;function Qa(){return aa||(aa=1,fr=nt(),vr(),gt(),ua(),ma()),fr}var lr={exports:{}},ia;function za(){if(ia)return lr.exports;ia=1;var i=fe();lt(),rt(),It(),ct(),pt(),pa(),et(),de(),Cr();var e=i.asn1,a=lr.exports=i.pkcs7=i.pkcs7||{};a.messageFromPem=function(u){var v=i.pem.decode(u)[0];if(v.type!=="PKCS7"){var m=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw m.headerType=v.type,m}if(v.procType&&v.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var g=e.fromDer(v.body);return a.messageFromAsn1(g)},a.messageToPem=function(u,v){var m={type:"PKCS7",body:e.toDer(u.toAsn1()).getBytes()};return i.pem.encode(m,{maxline:v})},a.messageFromAsn1=function(u){var v={},m=[];if(!e.validate(u,a.asn1.contentInfoValidator,v,m)){var g=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw g.errors=m,g}var s=e.derToOid(v.contentType),d;switch(s){case i.pki.oids.envelopedData:d=a.createEnvelopedData();break;case i.pki.oids.encryptedData:d=a.createEncryptedData();break;case i.pki.oids.signedData:d=a.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+s+" is not (yet) supported.")}return d.fromAsn1(v.content.value[0]),d},a.createSignedData=function(){var u=null;return u={type:i.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(g){if(k(u,g,a.asn1.signedDataValidator),u.certificates=[],u.crls=[],u.digestAlgorithmIdentifiers=[],u.contentInfo=null,u.signerInfos=[],u.rawCapture.certificates)for(var s=u.rawCapture.certificates.value,d=0;d<s.length;++d)u.certificates.push(i.pki.certificateFromAsn1(s[d]))},toAsn1:function(){u.contentInfo||u.sign();for(var g=[],s=0;s<u.certificates.length;++s)g.push(i.pki.certificateToAsn1(u.certificates[s]));var d=[],p=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,u.digestAlgorithmIdentifiers),u.contentInfo])]);return g.length>0&&p.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,g)),d.length>0&&p.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,d)),p.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,u.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.type).getBytes()),p])},addSigner:function(g){var s=g.issuer,d=g.serialNumber;if(g.certificate){var p=g.certificate;typeof p=="string"&&(p=i.pki.certificateFromPem(p)),s=p.issuer.attributes,d=p.serialNumber}var I=g.key;if(!I)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof I=="string"&&(I=i.pki.privateKeyFromPem(I));var R=g.digestAlgorithm||i.pki.oids.sha1;switch(R){case i.pki.oids.sha1:case i.pki.oids.sha256:case i.pki.oids.sha384:case i.pki.oids.sha512:case i.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+R)}var c=g.authenticatedAttributes||[];if(c.length>0){for(var n=!1,r=!1,B=0;B<c.length;++B){var D=c[B];if(!n&&D.type===i.pki.oids.contentType){if(n=!0,r)break;continue}if(!r&&D.type===i.pki.oids.messageDigest){if(r=!0,n)break;continue}}if(!n||!r)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}u.signers.push({key:I,version:1,issuer:s,serialNumber:d,digestAlgorithm:R,signatureAlgorithm:i.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(g){if(g=g||{},(typeof u.content!="object"||u.contentInfo===null)&&(u.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.pki.oids.data).getBytes())]),"content"in u)){var s;u.content instanceof i.util.ByteBuffer?s=u.content.bytes():typeof u.content=="string"&&(s=i.util.encodeUtf8(u.content)),g.detached?u.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s):u.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s)]))}if(u.signers.length!==0){var d=v();m(d)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(g){typeof g=="string"&&(g=i.pki.certificateFromPem(g)),u.certificates.push(g)},addCertificateRevokationList:function(g){throw new Error("PKCS#7 CRL support not yet implemented.")}},u;function v(){for(var g={},s=0;s<u.signers.length;++s){var d=u.signers[s],p=d.digestAlgorithm;p in g||(g[p]=i.md[i.pki.oids[p]].create()),d.authenticatedAttributes.length===0?d.md=g[p]:d.md=i.md[i.pki.oids[p]].create()}u.digestAlgorithmIdentifiers=[];for(var p in g)u.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(p).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return g}function m(g){var s;if(u.detachedContent?s=u.detachedContent:(s=u.contentInfo.value[1],s=s.value[0]),!s)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var d=e.derToOid(u.contentInfo.value[0].value),p=e.toDer(s);p.getByte(),e.getBerValueLength(p),p=p.getBytes();for(var I in g)g[I].start().update(p);for(var R=new Date,c=0;c<u.signers.length;++c){var n=u.signers[c];if(n.authenticatedAttributes.length===0){if(d!==i.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{n.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var r=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),B=0;B<n.authenticatedAttributes.length;++B){var D=n.authenticatedAttributes[B];D.type===i.pki.oids.messageDigest?D.value=g[n.digestAlgorithm].digest():D.type===i.pki.oids.signingTime&&(D.value||(D.value=R)),r.value.push(l(D)),n.authenticatedAttributesAsn1.value.push(l(D))}p=e.toDer(r).getBytes(),n.md.start().update(p)}n.signature=n.key.sign(n.md,"RSASSA-PKCS1-V1_5")}u.signerInfos=C(u.signers)}},a.createEncryptedData=function(){var u=null;return u={type:i.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:i.pki.oids["aes256-CBC"]},fromAsn1:function(v){k(u,v,a.asn1.encryptedDataValidator)},decrypt:function(v){v!==void 0&&(u.encryptedContent.key=v),E(u)}},u},a.createEnvelopedData=function(){var u=null;return u={type:i.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:i.pki.oids["aes256-CBC"]},fromAsn1:function(v){var m=k(u,v,a.asn1.envelopedDataValidator);u.recipients=S(m.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,h(u.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,x(u.encryptedContent))])])])},findRecipient:function(v){for(var m=v.issuer.attributes,g=0;g<u.recipients.length;++g){var s=u.recipients[g],d=s.issuer;if(s.serialNumber===v.serialNumber&&d.length===m.length){for(var p=!0,I=0;I<m.length;++I)if(d[I].type!==m[I].type||d[I].value!==m[I].value){p=!1;break}if(p)return s}}return null},decrypt:function(v,m){if(u.encryptedContent.key===void 0&&v!==void 0&&m!==void 0)switch(v.encryptedContent.algorithm){case i.pki.oids.rsaEncryption:case i.pki.oids.desCBC:var g=m.decrypt(v.encryptedContent.content);u.encryptedContent.key=i.util.createBuffer(g);break;default:throw new Error("Unsupported asymmetric cipher, OID "+v.encryptedContent.algorithm)}E(u)},addRecipient:function(v){u.recipients.push({version:0,issuer:v.issuer.attributes,serialNumber:v.serialNumber,encryptedContent:{algorithm:i.pki.oids.rsaEncryption,key:v.publicKey}})},encrypt:function(v,m){if(u.encryptedContent.content===void 0){m=m||u.encryptedContent.algorithm,v=v||u.encryptedContent.key;var g,s,d;switch(m){case i.pki.oids["aes128-CBC"]:g=16,s=16,d=i.aes.createEncryptionCipher;break;case i.pki.oids["aes192-CBC"]:g=24,s=16,d=i.aes.createEncryptionCipher;break;case i.pki.oids["aes256-CBC"]:g=32,s=16,d=i.aes.createEncryptionCipher;break;case i.pki.oids["des-EDE3-CBC"]:g=24,s=8,d=i.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+m)}if(v===void 0)v=i.util.createBuffer(i.random.getBytes(g));else if(v.length()!=g)throw new Error("Symmetric key has wrong length; got "+v.length()+" bytes, expected "+g+".");u.encryptedContent.algorithm=m,u.encryptedContent.key=v,u.encryptedContent.parameter=i.util.createBuffer(i.random.getBytes(s));var p=d(v);if(p.start(u.encryptedContent.parameter.copy()),p.update(u.content),!p.finish())throw new Error("Symmetric encryption failed.");u.encryptedContent.content=p.output}for(var I=0;I<u.recipients.length;++I){var R=u.recipients[I];if(R.encryptedContent.content===void 0)if(R.encryptedContent.algorithm===i.pki.oids.rsaEncryption)R.encryptedContent.content=R.encryptedContent.key.encrypt(u.encryptedContent.key.data);else throw new Error("Unsupported asymmetric cipher, OID "+R.encryptedContent.algorithm)}}},u};function y(u){var v={},m=[];if(!e.validate(u,a.asn1.recipientInfoValidator,v,m)){var g=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw g.errors=m,g}return{version:v.version.charCodeAt(0),issuer:i.pki.RDNAttributesAsArray(v.issuer),serialNumber:i.util.createBuffer(v.serial).toHex(),encryptedContent:{algorithm:e.derToOid(v.encAlgorithm),parameter:v.encParameter?v.encParameter.value:void 0,content:v.encKey}}}function N(u){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[i.pki.distinguishedNameToAsn1({attributes:u.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,i.util.hexToBytes(u.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.encryptedContent.content)])}function S(u){for(var v=[],m=0;m<u.length;++m)v.push(y(u[m]));return v}function h(u){for(var v=[],m=0;m<u.length;++m)v.push(N(u[m]));return v}function t(u){var v=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[i.pki.distinguishedNameToAsn1({attributes:u.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,i.util.hexToBytes(u.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(u.authenticatedAttributesAsn1&&v.value.push(u.authenticatedAttributesAsn1),v.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),v.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.signature)),u.unauthenticatedAttributes.length>0){for(var m=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),g=0;g<u.unauthenticatedAttributes.length;++g){var s=u.unauthenticatedAttributes[g];m.values.push(l(s))}v.value.push(m)}return v}function C(u){for(var v=[],m=0;m<u.length;++m)v.push(t(u[m]));return v}function l(u){var v;if(u.type===i.pki.oids.contentType)v=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.value).getBytes());else if(u.type===i.pki.oids.messageDigest)v=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.value.bytes());else if(u.type===i.pki.oids.signingTime){var m=new Date("1950-01-01T00:00:00Z"),g=new Date("2050-01-01T00:00:00Z"),s=u.value;if(typeof s=="string"){var d=Date.parse(s);isNaN(d)?s.length===13?s=e.utcTimeToDate(s):s=e.generalizedTimeToDate(s):s=new Date(d)}s>=m&&s<g?v=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(s)):v=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(s))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[v])])}function x(u){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.algorithm).getBytes()),u.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.content.getBytes())])]}function k(u,v,m){var g={},s=[];if(!e.validate(v,m,g,s)){var d=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw d.errors=d,d}var p=e.derToOid(g.contentType);if(p!==i.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(g.encryptedContent){var I="";if(i.util.isArray(g.encryptedContent))for(var R=0;R<g.encryptedContent.length;++R){if(g.encryptedContent[R].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");I+=g.encryptedContent[R].value}else I=g.encryptedContent;u.encryptedContent={algorithm:e.derToOid(g.encAlgorithm),parameter:i.util.createBuffer(g.encParameter.value),content:i.util.createBuffer(I)}}if(g.content){var I="";if(i.util.isArray(g.content))for(var R=0;R<g.content.length;++R){if(g.content[R].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");I+=g.content[R].value}else I=g.content;u.content=i.util.createBuffer(I)}return u.version=g.version.charCodeAt(0),u.rawCapture=g,g}function E(u){if(u.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(u.content===void 0){var v;switch(u.encryptedContent.algorithm){case i.pki.oids["aes128-CBC"]:case i.pki.oids["aes192-CBC"]:case i.pki.oids["aes256-CBC"]:v=i.aes.createDecryptionCipher(u.encryptedContent.key);break;case i.pki.oids.desCBC:case i.pki.oids["des-EDE3-CBC"]:v=i.des.createDecryptionCipher(u.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+u.encryptedContent.algorithm)}if(v.start(u.encryptedContent.parameter),v.update(u.encryptedContent.content),!v.finish())throw new Error("Symmetric decryption failed.");u.content=v.output}}return lr.exports}var cr={exports:{}},na;function Ya(){if(na)return cr.exports;na=1;var i=fe();lt(),yt(),vr(),gt(),de();var e=cr.exports=i.ssh=i.ssh||{};e.privateKeyToPutty=function(S,h,t){t=t||"",h=h||"";var C="ssh-rsa",l=h===""?"none":"aes256-cbc",x="PuTTY-User-Key-File-2: "+C+`\r
`;x+="Encryption: "+l+`\r
`,x+="Comment: "+t+`\r
`;var k=i.util.createBuffer();y(k,C),a(k,S.e),a(k,S.n);var E=i.util.encode64(k.bytes(),64),u=Math.floor(E.length/66)+1;x+="Public-Lines: "+u+`\r
`,x+=E;var v=i.util.createBuffer();a(v,S.d),a(v,S.p),a(v,S.q),a(v,S.qInv);var m;if(!h)m=i.util.encode64(v.bytes(),64);else{var g=v.length()+16-1;g-=g%16;var s=N(v.bytes());s.truncate(s.length()-g+v.length()),v.putBuffer(s);var d=i.util.createBuffer();d.putBuffer(N("\0\0\0\0",h)),d.putBuffer(N("\0\0\0",h));var p=i.aes.createEncryptionCipher(d.truncate(8),"CBC");p.start(i.util.createBuffer().fillWithByte(0,16)),p.update(v.copy()),p.finish();var I=p.output;I.truncate(16),m=i.util.encode64(I.bytes(),64)}u=Math.floor(m.length/66)+1,x+=`\r
Private-Lines: `+u+`\r
`,x+=m;var R=N("putty-private-key-file-mac-key",h),c=i.util.createBuffer();y(c,C),y(c,l),y(c,t),c.putInt32(k.length()),c.putBuffer(k),c.putInt32(v.length()),c.putBuffer(v);var n=i.hmac.create();return n.start("sha1",R),n.update(c.bytes()),x+=`\r
Private-MAC: `+n.digest().toHex()+`\r
`,x},e.publicKeyToOpenSSH=function(S,h){var t="ssh-rsa";h=h||"";var C=i.util.createBuffer();return y(C,t),a(C,S.e),a(C,S.n),t+" "+i.util.encode64(C.bytes())+" "+h},e.privateKeyToOpenSSH=function(S,h){return h?i.pki.encryptRsaPrivateKey(S,h,{legacy:!0,algorithm:"aes128"}):i.pki.privateKeyToPem(S)},e.getPublicKeyFingerprint=function(S,h){h=h||{};var t=h.md||i.md.md5.create(),C="ssh-rsa",l=i.util.createBuffer();y(l,C),a(l,S.e),a(l,S.n),t.start(),t.update(l.getBytes());var x=t.digest();if(h.encoding==="hex"){var k=x.toHex();return h.delimiter?k.match(/.{2}/g).join(h.delimiter):k}else{if(h.encoding==="binary")return x.getBytes();if(h.encoding)throw new Error('Unknown encoding "'+h.encoding+'".')}return x};function a(S,h){var t=h.toString(16);t[0]>="8"&&(t="00"+t);var C=i.util.hexToBytes(t);S.putInt32(C.length),S.putBytes(C)}function y(S,h){S.putInt32(h.length),S.putString(h)}function N(){for(var S=i.md.sha1.create(),h=arguments.length,t=0;t<h;++t)S.update(arguments[t]);return S.digest()}return cr.exports}var hr,sa;function Xa(){return sa||(sa=1,hr=fe(),lt(),Ka(),rt(),pr(),It(),qa(),yt(),Ha(),Ga(),Qa(),va(),yr(),pt(),ca(),ya(),za(),ga(),ha(),fa(),gr(),et(),la(),Ya(),Ca(),de()),hr}var Wa=Xa();const Za=Va(Wa);export{Za as f,Xa as r};
