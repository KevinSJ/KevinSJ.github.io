const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jszip.min-DQhFtpFI.js","assets/main-Da82M_MD.js","assets/style-D1FQfXNQ.js","assets/style-D0-w46sZ.css","assets/_commonjs-dynamic-modules-TDtrdbi3.js"])))=>i.map(i=>d[i]);
import{c as F,i as _}from"./style-D1FQfXNQ.js";import"./version-Dw8ZKLCV.js";import"./simple-mode-footer-D78rH_WB.js";import{s as i,a as L,b as C,d as B,h as S,_ as D,f as T}from"./main-Da82M_MD.js";import{E as k,a as N}from"./jspdf.plugin.autotable-DMDiiRYr.js";import"./mobileMenu-BoMunYmR.js";import"./browser-QlFDU36Z.js";async function A(o,t){const{onProgress:n}=t||{};n?.(10,"Reading XML file...");const a=await o.text();n?.(30,"Parsing XML structure...");const u=new DOMParser().parseFromString(a,"text/xml"),h=u.querySelector("parsererror");if(h)throw new Error("Invalid XML: "+h.textContent);n?.(50,"Analyzing data structure...");const r=new k({orientation:"landscape",unit:"mm",format:"a4"}),v=r.internal.pageSize.getWidth();let c=20;const E=u.documentElement,x=b(E.tagName);r.setFontSize(18),r.setFont("helvetica","bold"),r.text(x,v/2,c,{align:"center"}),c+=15,n?.(60,"Generating formatted content...");const e=Array.from(E.children);if(e.length>0){const l=I(e);for(const[s,f]of Object.entries(l)){const{headers:g,rows:p}=$(f);g.length>0&&p.length>0&&(Object.keys(l).length>1&&(r.setFontSize(14),r.setFont("helvetica","bold"),r.text(b(s),14,c),c+=8),N(r,{head:[g.map(y=>b(y))],body:p,startY:c,styles:{fontSize:9,cellPadding:4,overflow:"linebreak"},headStyles:{fillColor:[79,70,229],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[243,244,246]},margin:{top:20,left:14,right:14},theme:"striped",didDrawPage:y=>{c=(y.cursor?.y||c)+10}}),c=(r.lastAutoTable?.finalY||c)+15)}}else{const l=z(E);l.length>0&&N(r,{head:[["Property","Value"]],body:l,startY:c,styles:{fontSize:10,cellPadding:5},headStyles:{fillColor:[79,70,229],textColor:255,fontStyle:"bold"},columnStyles:{0:{fontStyle:"bold",cellWidth:60},1:{cellWidth:"auto"}},margin:{left:14,right:14},theme:"striped"})}n?.(90,"Finalizing PDF...");const d=r.output("blob");return n?.(100,"Complete!"),d}function I(o){const t={};for(const n of o){const a=n.tagName;t[a]||(t[a]=[]),t[a].push(n)}return t}function $(o){if(o.length===0)return{headers:[],rows:[]};const t=new Set;for(const m of o)for(const u of Array.from(m.children))t.add(u.tagName);const n=Array.from(t),a=[];for(const m of o){const u=[];for(const h of n){const r=m.querySelector(h);u.push(r?.textContent?.trim()||"")}a.push(u)}return{headers:n,rows:a}}function z(o){const t=[];for(const n of Array.from(o.children)){const a=n.tagName,m=n.textContent?.trim()||"";m&&t.push([b(a),m])}for(const n of Array.from(o.attributes))t.push([b(n.name),n.value]);return t}function b(o){return o.replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" ")}const M=[".xml"],P="XML";document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("file-input"),t=document.getElementById("drop-zone"),n=document.getElementById("process-btn"),a=document.getElementById("file-display-area"),m=document.getElementById("file-controls"),u=document.getElementById("add-more-btn"),h=document.getElementById("clear-files-btn"),r=document.getElementById("back-to-tools");r&&r.addEventListener("click",()=>{window.location.href="/"});const v=async()=>{if(!(!a||!n||!m))if(i.files.length>0){a.innerHTML="";for(let e=0;e<i.files.length;e++){const d=i.files[e],l=document.createElement("div");l.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const s=document.createElement("div");s.className="flex flex-col overflow-hidden";const f=document.createElement("div");f.className="truncate font-medium text-gray-200 text-sm mb-1",f.textContent=d.name;const g=document.createElement("div");g.className="text-xs text-gray-400",g.textContent=T(d.size),s.append(f,g);const p=document.createElement("button");p.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",p.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',p.onclick=()=>{i.files=i.files.filter((y,w)=>w!==e),v()},l.append(s,p),a.appendChild(l)}F({icons:_}),m.classList.remove("hidden"),n.classList.remove("hidden")}else a.innerHTML="",m.classList.add("hidden"),n.classList.add("hidden")},c=()=>{i.files=[],v()},E=async()=>{if(i.files.length===0){L("No Files",`Please select at least one ${P} file.`);return}try{if(i.files.length===1){const e=i.files[0],d=await A(e,{onProgress:(s,f)=>{C(f,s)}}),l=e.name.replace(/\.[^/.]+$/,"");B(d,`${l}.pdf`),S(),L("Conversion Complete",`Successfully converted ${e.name} to PDF.`,"success",()=>c())}else{C("Converting multiple files...");const e=(await D(async()=>{const{default:s}=await import("./jszip.min-DQhFtpFI.js").then(f=>f.j);return{default:s}},__vite__mapDeps([0,1,2,3,4]))).default,d=new e;for(let s=0;s<i.files.length;s++){const f=i.files[s],g=await A(f,{onProgress:(y,w)=>{C(`File ${s+1}/${i.files.length}: ${w}`,y)}}),p=f.name.replace(/\.[^/.]+$/,"");d.file(`${p}.pdf`,g)}const l=await d.generateAsync({type:"blob"});B(l,`${P.toLowerCase()}-to-pdf.zip`),S(),L("Conversion Complete",`Successfully converted ${i.files.length} files to PDF.`,"success",()=>c())}}catch(e){S();const d=e instanceof Error?e.message:"Unknown error";console.error(`[${P}ToPDF] Error:`,e),L("Error",`An error occurred during conversion. Error: ${d}`)}},x=e=>{if(e&&e.length>0){const d=Array.from(e).filter(l=>{const s="."+l.name.split(".").pop()?.toLowerCase();return M.includes(s)});d.length>0&&(i.files=[...i.files,...d],v())}};o&&t&&(o.addEventListener("change",e=>{x(e.target.files)}),t.addEventListener("dragover",e=>{e.preventDefault(),t.classList.add("bg-gray-700")}),t.addEventListener("dragleave",e=>{e.preventDefault(),t.classList.remove("bg-gray-700")}),t.addEventListener("drop",e=>{e.preventDefault(),t.classList.remove("bg-gray-700"),x(e.dataTransfer?.files??null)}),o.addEventListener("click",()=>{o.value=""})),u&&u.addEventListener("click",()=>o.click()),h&&h.addEventListener("click",c),n&&n.addEventListener("click",E)});
