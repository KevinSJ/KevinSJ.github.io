import{c as u0,i as f0}from"./style-CNx3HTbi.js";import"./version-D4ympJL5.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-ODFatrFN.js";import{U as w0,p as _0,M as p0,G as E0,a as e0,b as g0,e as h0,r as d0,d as D0,h as B0,f as n0}from"./main-Dqs2Ohqn.js";import{J as y0}from"./jszip.min-DMkQATzN.js";import{c as A0}from"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./mobileMenu-BoMunYmR.js";var t0={exports:{}},c0;function k0(){return c0||(c0=1,(function(Y){(function(){var K={};Y.exports=K;var Z;typeof A0=="function"?Z=w0():Z=self.pako;function R(){typeof _0>"u"&&console.log.apply(console,arguments)}(function(p,m){(function(){var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},e=(function(){function d(h){this.message="JPEG error: "+h}return d.prototype=Error(),d.prototype.name="JpegError",d.constructor=d})(),a=(function(){function d(h,l){this.message=h,this.g=l}return d.prototype=Error(),d.prototype.name="DNLMarkerError",d.constructor=d})();(function(){function d(){this.M=null,this.B=-1}function h(n,o){for(var v=0,t=[],r,c,f=16;0<f&&!n[f-1];)f--;t.push({children:[],index:0});var w=t[0],B;for(r=0;r<f;r++){for(c=0;c<n[r];c++){for(w=t.pop(),w.children[w.index]=o[v];0<w.index;)w=t.pop();for(w.index++,t.push(w);t.length<=r;)t.push(B={children:[],index:0}),w.children[w.index]=B.children,w=B;v++}r+1<f&&(t.push(B={children:[],index:0}),w.children[w.index]=B.children,w=B)}return t[0].children}function l(n,o,v,t,r,c,f,w,B){function E(){if(0<G)return G--,j>>G&1;if(j=n[o++],j===255){var J=n[o++];if(J){if(J===220&&O){o+=2;var H=n[o++]<<8|n[o++];if(0<H&&H!==v.g)throw new a("Found DNL marker (0xFFDC) while parsing scan data",H)}throw new e("unexpected marker "+(j<<8|J).toString(16))}}return G=7,j>>>7}function y(J){for(;;){if(J=J[E()],typeof J=="number")return J;if((typeof J>"u"?"undefined":i(J))!=="object")throw new e("invalid huffman sequence")}}function D(J){for(var H=0;0<J;)H=H<<1|E(),J--;return H}function g(J){if(J===1)return E()===1?1:-1;var H=D(J);return H>=1<<J-1?H:H+(-1<<J)+1}function M(J,H){var $=y(J.D);for($=$===0?0:g($),J.a[H]=J.m+=$,$=1;64>$;){var Q=y(J.o),V=Q&15;if(Q>>=4,V===0){if(15>Q)break;$+=16}else $+=Q,J.a[H+_[$]]=g(V),$++}}function P(J,H){var $=y(J.D);$=$===0?0:g($)<<B,J.a[H]=J.m+=$}function b(J,H){J.a[H]|=E()<<B}function L(J,H){if(0<x)x--;else for(var $=c;$<=f;){var Q=y(J.o),V=Q&15;if(Q>>=4,V===0){if(15>Q){x=D(Q)+(1<<Q)-1;break}$+=16}else $+=Q,J.a[H+_[$]]=g(V)*(1<<B),$++}}function S(J,H){for(var $=c,Q=0,V;$<=f;){V=H+_[$];var i0=0>J.a[V]?-1:1;switch(N){case 0:if(Q=y(J.o),V=Q&15,Q>>=4,V===0)15>Q?(x=D(Q)+(1<<Q),N=4):(Q=16,N=1);else{if(V!==1)throw new e("invalid ACn encoding");X=g(V),N=Q?2:3}continue;case 1:case 2:J.a[V]?J.a[V]+=i0*(E()<<B):(Q--,Q===0&&(N=N===2?3:0));break;case 3:J.a[V]?J.a[V]+=i0*(E()<<B):(J.a[V]=X<<B,N=0);break;case 4:J.a[V]&&(J.a[V]+=i0*(E()<<B))}$++}N===4&&(x--,x===0&&(N=0))}for(var O=9<arguments.length&&arguments[9]!==void 0?arguments[9]:!1,A=v.P,k=o,j=0,G=0,x=0,N=0,X,C=t.length,z,q,T,F,s0=v.S?c===0?w===0?P:b:w===0?L:S:M,I=0,r0=C===1?t[0].c*t[0].l:A*v.O,o0,l0;I<r0;){var v0=r?Math.min(r0-I,r):r0;for(z=0;z<C;z++)t[z].m=0;if(x=0,C===1){var W=t[0];for(F=0;F<v0;F++)s0(W,64*((W.c+1)*(I/W.c|0)+I%W.c)),I++}else for(F=0;F<v0;F++){for(z=0;z<C;z++)for(W=t[z],o0=W.h,l0=W.j,q=0;q<l0;q++)for(T=0;T<o0;T++)s0(W,64*((W.c+1)*((I/A|0)*W.j+q)+(I%A*W.h+T)));I++}if(G=0,(W=u(n,o))&&W.f&&((0,_util.warn)("decodeScan - unexpected MCU data, current marker is: "+W.f),o=W.offset),W=W&&W.F,!W||65280>=W)throw new e("marker was not found");if(65488<=W&&65495>=W)o+=2;else break}return(W=u(n,o))&&W.f&&((0,_util.warn)("decodeScan - unexpected Scan data, current marker is: "+W.f),o=W.offset),o-k}function s(n,o){for(var v=o.c,t=o.l,r=new Int16Array(64),c=0;c<t;c++)for(var f=0;f<v;f++){var w=64*((o.c+1)*c+f),B=r,E=o.G,y=o.a;if(!E)throw new e("missing required Quantization Table.");for(var D=0;64>D;D+=8){var g=y[w+D],M=y[w+D+1],P=y[w+D+2],b=y[w+D+3],L=y[w+D+4],S=y[w+D+5],O=y[w+D+6],A=y[w+D+7];if(g*=E[D],(M|P|b|L|S|O|A)===0)g=5793*g+512>>10,B[D]=g,B[D+1]=g,B[D+2]=g,B[D+3]=g,B[D+4]=g,B[D+5]=g,B[D+6]=g,B[D+7]=g;else{M*=E[D+1],P*=E[D+2],b*=E[D+3],L*=E[D+4],S*=E[D+5],O*=E[D+6],A*=E[D+7];var k=5793*g+128>>8,j=5793*L+128>>8,G=P,x=O;L=2896*(M-A)+128>>8,A=2896*(M+A)+128>>8,b<<=4,S<<=4,k=k+j+1>>1,j=k-j,g=3784*G+1567*x+128>>8,G=1567*G-3784*x+128>>8,x=g,L=L+S+1>>1,S=L-S,A=A+b+1>>1,b=A-b,k=k+x+1>>1,x=k-x,j=j+G+1>>1,G=j-G,g=2276*L+3406*A+2048>>12,L=3406*L-2276*A+2048>>12,A=g,g=799*b+4017*S+2048>>12,b=4017*b-799*S+2048>>12,S=g,B[D]=k+A,B[D+7]=k-A,B[D+1]=j+S,B[D+6]=j-S,B[D+2]=G+b,B[D+5]=G-b,B[D+3]=x+L,B[D+4]=x-L}}for(E=0;8>E;++E)g=B[E],M=B[E+8],P=B[E+16],b=B[E+24],L=B[E+32],S=B[E+40],O=B[E+48],A=B[E+56],(M|P|b|L|S|O|A)===0?(g=5793*g+8192>>14,g=-2040>g?0:2024<=g?255:g+2056>>4,y[w+E]=g,y[w+E+8]=g,y[w+E+16]=g,y[w+E+24]=g,y[w+E+32]=g,y[w+E+40]=g,y[w+E+48]=g,y[w+E+56]=g):(k=5793*g+2048>>12,j=5793*L+2048>>12,G=P,x=O,L=2896*(M-A)+2048>>12,A=2896*(M+A)+2048>>12,k=(k+j+1>>1)+4112,j=k-j,g=3784*G+1567*x+2048>>12,G=1567*G-3784*x+2048>>12,x=g,L=L+S+1>>1,S=L-S,A=A+b+1>>1,b=A-b,k=k+x+1>>1,x=k-x,j=j+G+1>>1,G=j-G,g=2276*L+3406*A+2048>>12,L=3406*L-2276*A+2048>>12,A=g,g=799*b+4017*S+2048>>12,b=4017*b-799*S+2048>>12,S=g,g=k+A,A=k-A,M=j+S,O=j-S,P=G+b,S=G-b,b=x+L,L=x-L,g=16>g?0:4080<=g?255:g>>4,M=16>M?0:4080<=M?255:M>>4,P=16>P?0:4080<=P?255:P>>4,b=16>b?0:4080<=b?255:b>>4,L=16>L?0:4080<=L?255:L>>4,S=16>S?0:4080<=S?255:S>>4,O=16>O?0:4080<=O?255:O>>4,A=16>A?0:4080<=A?255:A>>4,y[w+E]=g,y[w+E+8]=M,y[w+E+16]=P,y[w+E+24]=b,y[w+E+32]=L,y[w+E+40]=S,y[w+E+48]=O,y[w+E+56]=A)}return o.a}function u(n,o){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:o,t=n.length-1;if(v=v<o?v:o,o>=t)return null;var r=n[o]<<8|n[o+1];if(65472<=r&&65534>=r)return{f:null,F:r,offset:o};for(var c=n[v]<<8|n[v+1];!(65472<=c&&65534>=c);){if(++v>=t)return null;c=n[v]<<8|n[v+1]}return{f:r.toString(16),F:c,offset:v}}var _=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);d.prototype={parse:function(n){function o(){var G=n[f]<<8|n[f+1];return f+=2,G}function v(){var G=o();G=f+G-2;var x=u(n,G,f);return x&&x.f&&((0,_util.warn)("readDataBlock - incorrect length, current marker is: "+x.f),G=x.offset),G=n.subarray(f,G),f+=G.length,G}function t(G){for(var x=Math.ceil(G.v/8/G.s),N=Math.ceil(G.g/8/G.u),X=0;X<G.b.length;X++){k=G.b[X];var C=Math.ceil(Math.ceil(G.v/8)*k.h/G.s),z=Math.ceil(Math.ceil(G.g/8)*k.j/G.u);k.a=new Int16Array(64*N*k.j*(x*k.h+1)),k.c=C,k.l=z}G.P=x,G.O=N}var r=(1<arguments.length&&arguments[1]!==void 0?arguments[1]:{}).N,c=r===void 0?null:r,f=0,w=null,B=0;r=[];var E=[],y=[],D=o();if(D!==65496)throw new e("SOI not found");for(D=o();D!==65497;){switch(D){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var g=v();D===65518&&g[0]===65&&g[1]===100&&g[2]===111&&g[3]===98&&g[4]===101&&(w={version:g[5]<<8|g[6],Y:g[7]<<8|g[8],Z:g[9]<<8|g[10],W:g[11]});break;case 65499:D=o()+f-2;for(var M;f<D;){var P=n[f++],b=new Uint16Array(64);if(P>>4===0)for(g=0;64>g;g++)M=_[g],b[M]=n[f++];else if(P>>4===1)for(g=0;64>g;g++)M=_[g],b[M]=o();else throw new e("DQT - invalid table spec");r[P&15]=b}break;case 65472:case 65473:case 65474:if(L)throw new e("Only single frame JPEGs supported");o();var L={};for(L.X=D===65473,L.S=D===65474,L.precision=n[f++],D=o(),L.g=c||D,L.v=o(),L.b=[],L.C={},g=n[f++],D=b=P=0;D<g;D++){M=n[f];var S=n[f+1]>>4,O=n[f+1]&15;P<S&&(P=S),b<O&&(b=O),S=L.b.push({h:S,j:O,T:n[f+2],G:null}),L.C[M]=S-1,f+=3}L.s=P,L.u=b,t(L);break;case 65476:for(M=o(),D=2;D<M;){for(P=n[f++],b=new Uint8Array(16),g=S=0;16>g;g++,f++)S+=b[g]=n[f];for(O=new Uint8Array(S),g=0;g<S;g++,f++)O[g]=n[f];D+=17+S,(P>>4===0?y:E)[P&15]=h(b,O)}break;case 65501:o();var A=o();break;case 65498:for(g=++B===1&&!c,o(),P=n[f++],M=[],D=0;D<P;D++){b=L.C[n[f++]];var k=L.b[b];b=n[f++],k.D=y[b>>4],k.o=E[b&15],M.push(k)}D=n[f++],P=n[f++],b=n[f++];try{var j=l(n,f,L,M,A,D,P,b>>4,b&15,g);f+=j}catch(G){if(G instanceof a)return(0,_util.warn)('Attempting to re-parse JPEG image using "scanLines" parameter found in DNL marker (0xFFDC) segment.'),this.parse(n,{N:G.g});throw G}break;case 65500:f+=4;break;case 65535:n[f]!==255&&f--;break;default:if(n[f-3]===255&&192<=n[f-2]&&254>=n[f-2])f-=3;else if((g=u(n,f-2))&&g.f)(0,_util.warn)("JpegImage.parse - unexpected data, current marker is: "+g.f),f=g.offset;else throw new e("unknown marker "+D.toString(16))}D=o()}for(this.width=L.v,this.height=L.g,this.A=w,this.b=[],D=0;D<L.b.length;D++)k=L.b[D],(A=r[k.T])&&(k.G=A),this.b.push({R:s(L,k),U:k.h/L.s,V:k.j/L.u,c:k.c,l:k.l});this.i=this.b.length},L:function(n,o){var v=this.width/n,t=this.height/o,r,c,f=this.b.length,w=n*o*f,B=new Uint8ClampedArray(w),E=new Uint32Array(n);for(c=0;c<f;c++){var y=this.b[c],D=y.U*v,g=y.V*t,M=c,P=y.R,b=y.c+1<<3;for(r=0;r<n;r++)y=0|r*D,E[r]=(y&4294967288)<<3|y&7;for(D=0;D<o;D++)for(y=0|D*g,y=b*(y&4294967288)|(y&7)<<3,r=0;r<n;r++)B[M]=P[y+E[r]],M+=f}if(t=this.M)for(c=0;c<w;)for(v=y=0;y<f;y++,c++,v+=2)B[c]=(B[c]*t[v]>>8)+t[v+1];return B},w:function(){return this.A?!!this.A.W:this.i===3?this.B!==0:this.B===1},I:function(n){for(var o,v,t,r=0,c=n.length;r<c;r+=3)o=n[r],v=n[r+1],t=n[r+2],n[r]=o-179.456+1.402*t,n[r+1]=o+135.459-.344*v-.714*t,n[r+2]=o-226.816+1.772*v;return n},K:function(n){for(var o,v,t,r,c=0,f=0,w=n.length;f<w;f+=4)o=n[f],v=n[f+1],t=n[f+2],r=n[f+3],n[c++]=-122.67195406894+v*(-660635669420364e-19*v+.000437130475926232*t-54080610064599e-18*o+.00048449797120281*r-.154362151871126)+t*(-.000957964378445773*t+.000817076911346625*o-.00477271405408747*r+1.53380253221734)+o*(.000961250184130688*o-.00266257332283933*r+.48357088451265)+r*(-.000336197177618394*r+.484791561490776),n[c++]=107.268039397724+v*(219927104525741e-19*v-.000640992018297945*t+.000659397001245577*o+.000426105652938837*r-.176491792462875)+t*(-.000778269941513683*t+.00130872261408275*o+.000770482631801132*r-.151051492775562)+o*(.00126935368114843*o-.00265090189010898*r+.25802910206845)+r*(-.000318913117588328*r-.213742400323665),n[c++]=-20.810012546947+v*(-.000570115196973677*v-263409051004589e-19*t+.0020741088115012*o-.00288260236853442*r+.814272968359295)+t*(-153496057440975e-19*t-.000132689043961446*o+.000560833691242812*r-.195152027534049)+o*(.00174418132927582*o-.00255243321439347*r+.116935020465145)+r*(-.000343531996510555*r+.24165260232407);return n.subarray(0,c)},J:function(n){for(var o,v,t,r=0,c=n.length;r<c;r+=4)o=n[r],v=n[r+1],t=n[r+2],n[r]=434.456-o-1.402*t,n[r+1]=119.541-o+.344*v+.714*t,n[r+2]=481.816-o-1.772*v;return n},H:function(n){for(var o,v,t,r,c=0,f=1/255,w=0,B=n.length;w<B;w+=4)o=n[w]*f,v=n[w+1]*f,t=n[w+2]*f,r=n[w+3]*f,n[c++]=255+o*(-4.387332384609988*o+54.48615194189176*v+18.82290502165302*t+212.25662451639585*r-285.2331026137004)+v*(1.7149763477362134*v-5.6096736904047315*t-17.873870861415444*r-5.497006427196366)+t*(-2.5217340131683033*t-21.248923337353073*r+17.5119270841813)-r*(21.86122147463605*r+189.48180835922747),n[c++]=255+o*(8.841041422036149*o+60.118027045597366*v+6.871425592049007*t+31.159100130055922*r-79.2970844816548)+v*(-15.310361306967817*v+17.575251261109482*t+131.35250912493976*r-190.9453302588951)+t*(4.444339102852739*t+9.8632861493405*r-24.86741582555878)-r*(20.737325471181034*r+187.80453709719578),n[c++]=255+o*(.8842522430003296*o+8.078677503112928*v+30.89978309703729*t-.23883238689178934*r-14.183576799673286)+v*(10.49593273432072*v+63.02378494754052*t+50.606957656360734*r-112.23884253719248)+t*(.03296041114873217*t+115.60384449646641*r-193.58209356861505)-r*(22.33816807309886*r+180.12613974708367);return n.subarray(0,c)},getData:function(n,o,v){if(4<this.i)throw new e("Unsupported color mode");if(n=this.L(n,o),this.i===1&&v){v=n.length,o=new Uint8ClampedArray(3*v);for(var t=0,r=0;r<v;r++){var c=n[r];o[t++]=c,o[t++]=c,o[t++]=c}return o}if(this.i===3&&this.w())return this.I(n);if(this.i===4){if(this.w())return v?this.K(n):this.J(n);if(v)return this.H(n)}return n}},p.JpegDecoder=d})()})(),p.encodeImage=function(i,e,a,d){var h={t256:[e],t257:[a],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[a],t279:[e*a*4],t282:[1],t283:[1],t284:[1],t286:[0],t287:[0],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(d)for(var l in d)h[l]=d[l];for(var s=new Uint8Array(p.encode([h])),u=new Uint8Array(i),_=new Uint8Array(1e3+e*a*4),l=0;l<s.length;l++)_[l]=s[l];for(var l=0;l<u.length;l++)_[1e3+l]=u[l];return _.buffer},p.encode=function(i){var e=new Uint8Array(2e4),a=4,d=p._binBE;e[0]=77,e[1]=77,e[3]=42;var h=8;d.writeUint(e,a,h),a+=4;for(var l=0;l<i.length;l++){var s=p._writeIFD(d,e,h,i[l]);h=s[1],l<i.length-1&&d.writeUint(e,s[0],h)}return e.slice(0,h).buffer},p.decode=function(i){p.decode._decodeG3.allow2D=null;var e=new Uint8Array(i),a=0,d=p._binBE.readASCII(e,a,2);a+=2;var h=d=="II"?p._binLE:p._binBE;h.readUshort(e,a),a+=2;var l=h.readUint(e,a);a+=4;for(var s=[];;){var u=p._readIFD(h,e,l,s,0,!1);if(l=h.readUint(e,u),l==0)break}return s},p.decodeImage=function(i,e,a){var d=new Uint8Array(i),h=p._binBE.readASCII(d,0,2);if(e.t256!=null){e.isLE=h=="II",e.width=e.t256[0],e.height=e.t257[0];var l=e.t259?e.t259[0]:1,s=e.t266?e.t266[0]:1;e.t284&&e.t284[0]==2&&R("PlanarConfiguration 2 should not be used!");var u;e.t258?u=Math.min(32,e.t258[0])*e.t258.length:u=e.t277?e.t277[0]:1,l==1&&e.t279!=null&&e.t278&&e.t262[0]==32803&&(u=Math.round(e.t279[0]*8/(e.width*e.t278[0])));var _=Math.ceil(e.width*u/8)*8,n=e.t273;n==null&&(n=e.t324);var o=e.t279;l==1&&n.length==1&&(o=[e.height*(_>>>3)]),o==null&&(o=e.t325);var v=new Uint8Array(e.height*(_>>>3)),t=0;if(e.t322!=null){for(var r=e.t322[0],c=e.t323[0],f=Math.floor((e.width+r-1)/r),w=Math.floor((e.height+c-1)/c),B=new Uint8Array(Math.ceil(r*c*u/8)|0),E=0;E<w;E++)for(var y=0;y<f;y++){for(var D=E*f+y,g=0;g<B.length;g++)B[g]=0;p.decode._decompress(e,a,d,n[D],o[D],l,B,0,s),l==6?v=B:p._copyTile(B,Math.ceil(r*u/8)|0,c,v,Math.ceil(e.width*u/8)|0,e.height,Math.ceil(y*r*u/8)|0,E*c)}t=v.length*8}else{var M=e.t278?e.t278[0]:e.height;M=Math.min(M,e.height);for(var D=0;D<n.length;D++)p.decode._decompress(e,a,d,n[D],o[D],l,v,Math.ceil(t/8)|0,s),t+=_*M;t=Math.min(t,v.length*8)}e.data=new Uint8Array(v.buffer,0,Math.ceil(t/8)|0)}},p.decode._decompress=function(i,e,a,d,h,l,s,u,_){if(l==1||h==s.length&&l!=32767)for(var n=0;n<h;n++)s[u+n]=a[d+n];else if(l==3)p.decode._decodeG3(a,d,h,s,u,i.width,_);else if(l==4)p.decode._decodeG4(a,d,h,s,u,i.width,_);else if(l==5)p.decode._decodeLZW(a,d,s,u);else if(l==6)p.decode._decodeOldJPEG(i,a,d,h,s,u);else if(l==7)p.decode._decodeNewJPEG(i,a,d,h,s,u);else if(l==8)for(var o=new Uint8Array(a.buffer,d,h),v=m.inflate(o),t=0;t<v.length;t++)s[u+t]=v[t];else l==32767?p.decode._decodeARW(i,a,d,h,s,u):l==32773?p.decode._decodePackBits(a,d,h,s,u):l==32809?p.decode._decodeThunder(a,d,h,s,u):l==34713?p.decode._decodeNikon(i,e,a,d,h,s,u):R("Unknown compression",l);var r=i.t258?Math.min(32,i.t258[0]):1,c=i.t277?i.t277[0]:1,f=r*c>>>3,w=i.t278?i.t278[0]:i.height,B=Math.ceil(r*c*i.width/8);if(r==16&&!i.isLE&&i.t33422==null)for(var E=0;E<w;E++)for(var y=u+E*B,D=1;D<B;D+=2){var g=s[y+D];s[y+D]=s[y+D-1],s[y+D-1]=g}if(i.t317&&i.t317[0]==2)for(var E=0;E<w;E++){var M=u+E*B;if(r==16)for(var n=f;n<B;n+=2){var P=(s[M+n+1]<<8|s[M+n])+(s[M+n-f+1]<<8|s[M+n-f]);s[M+n]=P&255,s[M+n+1]=P>>>8&255}else if(c==3)for(var n=3;n<B;n+=3)s[M+n]=s[M+n]+s[M+n-3]&255,s[M+n+1]=s[M+n+1]+s[M+n-2]&255,s[M+n+2]=s[M+n+2]+s[M+n-1]&255;else for(var n=f;n<B;n++)s[M+n]=s[M+n]+s[M+n-f]&255}},p.decode._ljpeg_diff=function(i,e,a){var d=p.decode._getbithuff,h,l;return h=d(i,e,a[0],a),l=d(i,e,h,0),(l&1<<h-1)==0&&(l-=(1<<h)-1),l},p.decode._decodeARW=function(i,e,a,d,h,l){var s=i.t256[0],u=i.t257[0],_=i.t258[0],n=i.isLE?p._binLE:p._binBE,o=s*u==d||s*u*1.5==d;if(!o){u+=8;var v=[a,0,0,0],t=new Uint16Array(32770),r=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],N,c,f,L,b,w=0,B=p.decode._ljpeg_diff;for(t[0]=15,f=N=0;N<18;N++)for(var E=32768>>>(r[N]>>>8),c=0;c<E;c++)t[++f]=r[N];for(L=s;L--;)for(b=0;b<u+1;b+=2)if(b==u&&(b=1),w+=B(e,v,t),b<u){var y=w&4095;p.decode._putsF(h,(b*s+L)*_,y<<16-_)}return}if(s*u*1.5==d){for(var N=0;N<d;N+=3){var D=e[a+N+0],g=e[a+N+1],M=e[a+N+2];h[l+N]=g<<4|D>>>4,h[l+N+1]=D<<4|M>>>4,h[l+N+2]=M<<4|g>>>4}return}var P=new Uint16Array(16),b,L,S,O,A,k,j,G,x,N,X,C=new Uint8Array(s+1);for(b=0;b<u;b++){for(var z=0;z<s;z++)C[z]=e[a++];for(X=0,L=0;L<s-30;X+=16){for(O=2047&(S=n.readUint(C,X)),A=2047&S>>>11,k=15&S>>>22,j=15&S>>>26,G=0;G<4&&128<<G<=O-A;G++);for(x=30,N=0;N<16;N++)N==k?P[N]=O:N==j?P[N]=A:(P[N]=((n.readUshort(C,X+(x>>3))>>>(x&7)&127)<<G)+A,P[N]>2047&&(P[N]=2047),x+=7);for(N=0;N<16;N++,L+=2){var y=P[N]<<1;p.decode._putsF(h,(b*s+L)*_,y<<16-_)}L-=L&1?1:31}}},p.decode._decodeNikon=function(i,e,a,d,h,l,s){var u=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],_=i.t256[0],n=i.t257[0],o=i.t258[0],v=0,t=0,r=p.decode._make_decoder,c=p.decode._getbithuff,f=e[0].exifIFD.makerNote,w=f.t150?f.t150:f.t140,B=0,E=w[B++],y=w[B++];(E==73||y==88)&&(B+=2110),E==70&&(v=2),o==14&&(v+=3);for(var D=[[0,0],[0,0]],g=i.isLE?p._binLE:p._binBE,S=0;S<2;S++)for(var M=0;M<2;M++)D[S][M]=g.readShort(w,B),B+=2;var P=1<<o&32767,b=0,L=g.readShort(w,B);B+=2,L>1&&(b=Math.floor(P/(L-1))),E==68&&y==32&&b>0&&(t=g.readShort(w,562));var S,O,A,k,j,G,x=[0,0],N=r(u[v]),X=[d,0,0,0];for(O=0;O<n;O++)for(t&&O==t&&(N=r(u[v+1])),A=0;A<_;A++){S=c(a,X,N[0],N),k=S&15,j=S>>>4,G=(c(a,X,k-j,0)<<1)+1<<j>>>1,(G&1<<k-1)==0&&(G-=(1<<k)-(j==0?1:0)),A<2?x[A]=D[O&1][A]+=G:x[A&1]+=G;var C=Math.min(Math.max(x[A&1],0),(1<<o)-1),z=(O*_+A)*o;p.decode._putsF(l,z,C<<16-o)}},p.decode._putsF=function(i,e,a){a=a<<8-(e&7);var d=e>>>3;i[d]|=a>>>16,i[d+1]|=a>>>8,i[d+2]|=a},p.decode._getbithuff=function(i,e,a,d){var h=0;p.decode._get_byte;var l,s=e[0],u=e[1],_=e[2],n=e[3];if(a==0||_<0)return 0;for(;!n&&_<a&&(l=i[s++])!=-1&&!(n=h);)u=(u<<8)+l,_+=8;if(l=u<<32-_>>>32-a,d?(_-=d[l+1]>>>8,l=d[l+1]&255):_-=a,_<0)throw"e";return e[0]=s,e[1]=u,e[2]=_,e[3]=n,l},p.decode._make_decoder=function(i){var e,a,d,h,l,s=[];for(e=16;e!=0&&!i[e];e--);var u=17;for(s[0]=e,d=a=1;a<=e;a++)for(h=0;h<i[a];h++,++u)for(l=0;l<1<<e-a;l++)d<=1<<e&&(s[d++]=a<<8|i[u]);return s},p.decode._decodeNewJPEG=function(i,e,a,d,h,l){var s=i.t347,u=s?s.length:0,_=new Uint8Array(u+d);if(s){for(var n=216,o=217,v=0,t=0;t<u-1&&!(s[t]==255&&s[t+1]==o);t++)_[v++]=s[t];var r=e[a],c=e[a+1];(r!=255||c!=n)&&(_[v++]=r,_[v++]=c);for(var t=2;t<d;t++)_[v++]=e[a+t]}else for(var t=0;t<d;t++)_[t]=e[a+t];if(i.t262[0]==32803||i.t262[0]==34892){var f=i.t258[0],w=p.LosslessJpegDecode(_),B=w.length;if(f==16)if(i.isLE)for(var t=0;t<B;t++)h[l+(t<<1)]=w[t]&255,h[l+(t<<1)+1]=w[t]>>>8;else for(var t=0;t<B;t++)h[l+(t<<1)]=w[t]>>>8,h[l+(t<<1)+1]=w[t]&255;else if(f==14||f==12)for(var E=16-f,t=0;t<B;t++)p.decode._putsF(h,t*f,w[t]<<E);else throw new Error("unsupported bit depth "+f)}else{var y=new p.JpegDecoder;y.parse(_);for(var D=y.getData(y.width,y.height),t=0;t<D.length;t++)h[l+t]=D[t]}i.t262[0]==6&&(i.t262[0]=2)},p.decode._decodeOldJPEGInit=function(i,e,a,d){var h=216,l=219,s=196,u=221,_=192,n=218,o=0,v=0,t,r,c=!1,f,w,B,E=i.t513,y=E?E[0]:0,D=i.t514,g=D?D[0]:0,M=i.t324||i.t273||E,P=i.t530,b=0,L=0,S=i.t277?i.t277[0]:1,O=i.t515;if(M&&(v=M[0],c=M.length>1),!c){if(e[a]==255&&e[a+1]==h)return{jpegOffset:a};if(E!=null&&(e[a+y]==255&&e[a+y+1]==h?o=a+y:R("JPEGInterchangeFormat does not point to SOI"),D==null?R("JPEGInterchangeFormatLength field is missing"):(y>=v||y+g<=v)&&R("JPEGInterchangeFormatLength field value is invalid"),o!=null))return{jpegOffset:o}}if(P!=null&&(b=P[0],L=P[1]),E!=null&&D!=null)if(g>=2&&y+g<=v){for(e[a+y+g-2]==255&&e[a+y+g-1]==h?t=new Uint8Array(g-2):t=new Uint8Array(g),f=0;f<t.length;f++)t[f]=e[a+y+f];R("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else R("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(t==null){var A=0,k=[];k[A++]=255,k[A++]=h;var j=i.t519;if(j==null)throw new Error("JPEGQTables tag is missing");for(f=0;f<j.length;f++)for(k[A++]=255,k[A++]=l,k[A++]=0,k[A++]=67,k[A++]=f,w=0;w<64;w++)k[A++]=e[a+j[f]+w];for(B=0;B<2;B++){var G=i[B==0?"t520":"t521"];if(G==null)throw new Error((B==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(f=0;f<G.length;f++){k[A++]=255,k[A++]=s;var x=19;for(w=0;w<16;w++)x+=e[a+G[f]+w];for(k[A++]=x>>>8,k[A++]=x&255,k[A++]=f|B<<4,w=0;w<16;w++)k[A++]=e[a+G[f]+w];for(w=0;w<x;w++)k[A++]=e[a+G[f]+16+w]}}if(k[A++]=255,k[A++]=_,k[A++]=0,k[A++]=8+3*S,k[A++]=8,k[A++]=i.height>>>8&255,k[A++]=i.height&255,k[A++]=i.width>>>8&255,k[A++]=i.width&255,k[A++]=S,S==1)k[A++]=1,k[A++]=17,k[A++]=0;else for(f=0;f<3;f++)k[A++]=f+1,k[A++]=f!=0?17:(b&15)<<4|L&15,k[A++]=f;O!=null&&O[0]!=0&&(k[A++]=255,k[A++]=u,k[A++]=0,k[A++]=4,k[A++]=O[0]>>>8&255,k[A++]=O[0]&255),t=new Uint8Array(k)}var N=-1;for(f=0;f<t.length-1;){if(t[f]==255&&t[f+1]==_){N=f;break}f++}if(N==-1){var X=new Uint8Array(t.length+10+3*S);X.set(t);var C=t.length;if(N=t.length,t=X,t[C++]=255,t[C++]=_,t[C++]=0,t[C++]=8+3*S,t[C++]=8,t[C++]=i.height>>>8&255,t[C++]=i.height&255,t[C++]=i.width>>>8&255,t[C++]=i.width&255,t[C++]=S,S==1)t[C++]=1,t[C++]=17,t[C++]=0;else for(f=0;f<3;f++)t[C++]=f+1,t[C++]=f!=0?17:(b&15)<<4|L&15,t[C++]=f}if(e[v]==255&&e[v+1]==n){var z=e[v+2]<<8|e[v+3];for(r=new Uint8Array(z+2),r[0]=e[v],r[1]=e[v+1],r[2]=e[v+2],r[3]=e[v+3],f=0;f<z-2;f++)r[f+4]=e[v+f+4]}else{r=new Uint8Array(8+2*S);var q=0;if(r[q++]=255,r[q++]=n,r[q++]=0,r[q++]=6+2*S,r[q++]=S,S==1)r[q++]=1,r[q++]=0;else for(f=0;f<3;f++)r[q++]=f+1,r[q++]=f<<4|f;r[q++]=0,r[q++]=63,r[q++]=0}return{jpegOffset:a,tables:t,sosMarker:r,sofPosition:N}},p.decode._decodeOldJPEG=function(i,e,a,d,h,l){var s,u,_,n,o,v=p.decode._decodeOldJPEGInit(i,e,a,d);if(v.jpegOffset!=null)for(u=a+d-v.jpegOffset,n=new Uint8Array(u),s=0;s<u;s++)n[s]=e[v.jpegOffset+s];else{for(_=v.tables.length,n=new Uint8Array(_+v.sosMarker.length+d+2),n.set(v.tables),o=_,n[v.sofPosition+5]=i.height>>>8&255,n[v.sofPosition+6]=i.height&255,n[v.sofPosition+7]=i.width>>>8&255,n[v.sofPosition+8]=i.width&255,(e[a]!=255||e[a+1]!=SOS)&&(n.set(v.sosMarker,o),o+=sosMarker.length),s=0;s<d;s++)n[o++]=e[a+s];n[o++]=255,n[o++]=EOI}var t=new p.JpegDecoder;t.parse(n);for(var r=t.getData(t.width,t.height),s=0;s<r.length;s++)h[l+s]=r[s];i.t262&&i.t262[0]==6&&(i.t262[0]=2)},p.decode._decodePackBits=function(i,e,a,d,h){for(var l=new Int8Array(i.buffer),s=new Int8Array(d.buffer),u=e+a;e<u;){var _=l[e];if(e++,_>=0&&_<128)for(var n=0;n<_+1;n++)s[h]=l[e],h++,e++;if(_>=-127&&_<0){for(var n=0;n<-_+1;n++)s[h]=l[e],h++;e++}}},p.decode._decodeThunder=function(i,e,a,d,h){for(var l=[0,1,0,-1],s=[0,1,2,3,0,-3,-2,-1],u=e+a,_=h*2,n=0;e<u;){var o=i[e],v=o>>>6,t=o&63;if(e++,v==3&&(n=t&15,d[_>>>1]|=n<<4*(1-_&1),_++),v==0)for(var r=0;r<t;r++)d[_>>>1]|=n<<4*(1-_&1),_++;if(v==2)for(var r=0;r<2;r++){var c=t>>>3*(1-r)&7;c!=4&&(n+=s[c],d[_>>>1]|=n<<4*(1-_&1),_++)}if(v==1)for(var r=0;r<3;r++){var c=t>>>2*(2-r)&3;c!=2&&(n+=l[c],d[_>>>1]|=n<<4*(1-_&1),_++)}}},p.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},p.decode._lens=(function(){var i=function(_,n,o,v){for(var t=0;t<n.length;t++)_[n[t]]=o+t*v},e="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",a="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",d="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",h="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",l="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";e=e.split(","),a=a.split(","),d=d.split(","),h=h.split(","),l=l.split(",");var s={},u={};return i(s,e,0,1),i(s,d,64,64),i(s,l,1792,64),i(u,a,0,1),i(u,h,64,64),i(u,l,1792,64),[s,u]})(),p.decode._decodeG4=function(i,e,a,d,h,l,s){for(var u=p.decode,_=e<<3,n=0,o="",v=[],t=[],r=0;r<l;r++)t.push(0);t=u._makeDiff(t);for(var c=0,f=0,w=0,B=0,E=0,y=0,D="",g=0,M=Math.ceil(l/8)*8;_>>>3<e+a;){w=u._findDiff(t,c+(c==0?0:1),1-E),B=u._findDiff(t,w,E);var P=0;if(s==1&&(P=i[_>>>3]>>>7-(_&7)&1),s==2&&(P=i[_>>>3]>>>(_&7)&1),_++,o+=P,D=="H"){if(u._lens[E][o]!=null){var b=u._lens[E][o];o="",n+=b,b<64&&(u._addNtimes(v,n,E),c+=n,E=1-E,n=0,g--,g==0&&(D=""))}}else o=="0001"&&(o="",u._addNtimes(v,B-c,E),c=B),o=="001"&&(o="",D="H",g=2),u._dmap[o]!=null&&(f=w+u._dmap[o],u._addNtimes(v,f-c,E),c=f,o="",E=1-E);v.length==l&&D==""&&(u._writeBits(v,d,h*8+y*M),E=0,y++,c=0,t=u._makeDiff(v),v=[])}},p.decode._findDiff=function(i,e,a){for(var d=0;d<i.length;d+=2)if(i[d]>=e&&i[d+1]==a)return i[d]},p.decode._makeDiff=function(i){var e=[];i[0]==1&&e.push(0,1);for(var a=1;a<i.length;a++)i[a-1]!=i[a]&&e.push(a,i[a]);return e.push(i.length,0,i.length,1),e},p.decode._decodeG3=function(i,e,a,d,h,l,s){for(var u=p.decode,_=e<<3,n=0,o="",v=[],t=[],r=0;r<l;r++)v.push(0);for(var c=0,f=0,w=0,B=0,E=0,y=-1,D="",g=0,M=!1,P=Math.ceil(l/8)*8;_>>>3<e+a;){w=u._findDiff(t,c+(c==0?0:1),1-E),B=u._findDiff(t,w,E);var b=0;if(s==1&&(b=i[_>>>3]>>>7-(_&7)&1),s==2&&(b=i[_>>>3]>>>(_&7)&1),_++,o+=b,M){if(u._lens[E][o]!=null){var L=u._lens[E][o];o="",n+=L,L<64&&(u._addNtimes(v,n,E),E=1-E,n=0)}}else if(D=="H"){if(u._lens[E][o]!=null){var L=u._lens[E][o];o="",n+=L,L<64&&(u._addNtimes(v,n,E),c+=n,E=1-E,n=0,g--,g==0&&(D=""))}}else o=="0001"&&(o="",u._addNtimes(v,B-c,E),c=B),o=="001"&&(o="",D="H",g=2),u._dmap[o]!=null&&(f=w+u._dmap[o],u._addNtimes(v,f-c,E),c=f,o="",E=1-E);o.endsWith("000000000001")&&(y>=0&&u._writeBits(v,d,h*8+y*P),s==1&&(M=(i[_>>>3]>>>7-(_&7)&1)==1),s==2&&(M=(i[_>>>3]>>>(_&7)&1)==1),_++,u._decodeG3.allow2D==null&&(u._decodeG3.allow2D=M),u._decodeG3.allow2D||(M=!0,_--),o="",E=0,y++,c=0,t=u._makeDiff(v),v=[])}v.length==l&&u._writeBits(v,d,h*8+y*P)},p.decode._addNtimes=function(i,e,a){for(var d=0;d<e;d++)i.push(a)},p.decode._writeBits=function(i,e,a){for(var d=0;d<i.length;d++)e[a+d>>>3]|=i[d]<<7-(a+d&7)},p.decode._decodeLZW=function(i,e,a,d){if(p.decode._lzwTab==null){for(var h=new Uint32Array(65535),l=new Uint16Array(65535),o=new Uint8Array(2e6),s=0;s<256;s++)o[s<<2]=s,h[s]=s<<2,l[s]=1;p.decode._lzwTab=[h,l,o]}for(var u=p.decode._copyData,_=p.decode._lzwTab[0],n=p.decode._lzwTab[1],o=p.decode._lzwTab[2],v=258,t=1032,r=9,c=e<<3,f=256,w=257,B=0,E=0,y=0;B=i[c>>>3]<<16|i[c+8>>>3]<<8|i[c+16>>>3],E=B>>24-(c&7)-r&(1<<r)-1,c+=r,E!=w;){if(E==f){if(r=9,v=258,t=1032,B=i[c>>>3]<<16|i[c+8>>>3]<<8|i[c+16>>>3],E=B>>24-(c&7)-r&(1<<r)-1,c+=r,E==w)break;a[d]=E,d++}else if(E<v){var D=_[E],g=n[E];if(u(o,D,a,d,g),d+=g,y>=v)_[v]=t,o[_[v]]=D[0],n[v]=1,t=t+1+3&-4,v++;else{_[v]=t;var M=_[y],P=n[y];u(o,M,o,t,P),o[t+P]=o[D],P++,n[v]=P,v++,t=t+P+3&-4}v+1==1<<r&&r++}else{if(y>=v)_[v]=t,n[v]=0,v++;else{_[v]=t;var M=_[y],P=n[y];u(o,M,o,t,P),o[t+P]=o[t],P++,n[v]=P,v++,u(o,t,a,d,P),d+=P,t=t+P+3&-4}v+1==1<<r&&r++}y=E}},p.decode._copyData=function(i,e,a,d,h){for(var l=0;l<h;l+=4)a[d+l]=i[e+l],a[d+l+1]=i[e+l+1],a[d+l+2]=i[e+l+2],a[d+l+3]=i[e+l+3]},p.tags={},p.ttypes={256:3,257:3,258:3,259:3,262:3,273:4,274:3,277:3,278:4,279:4,282:5,283:5,284:3,286:5,287:5,296:3,305:2,306:2,338:3,513:4,514:4,34665:4},p._readIFD=function(i,e,a,d,h,l){var s=i.readUshort(e,a);a+=2;var u={};d.push(u),l&&R("   ".repeat(h),d.length-1,">>>----------------");for(var _=0;_<s;_++){var n=i.readUshort(e,a);a+=2;var o=i.readUshort(e,a);a+=2;var v=i.readUint(e,a);a+=4;var t=i.readUint(e,a);a+=4;var r=[];if((o==1||o==7)&&(r=new Uint8Array(e.buffer,v<5?a-4:t,v)),o==2){var c=v<5?a-4:t,f=e[c];f<128?r.push(i.readASCII(e,c,v-1)):r=new Uint8Array(e.buffer,c,v-1)}if(o==3)for(var w=0;w<v;w++)r.push(i.readUshort(e,(v<3?a-4:t)+2*w));if(o==4)for(var w=0;w<v;w++)r.push(i.readUint(e,(v<2?a-4:t)+4*w));if(o==5)for(var w=0;w<v;w++)r.push(i.readUint(e,t+w*8)/i.readUint(e,t+w*8+4));if(o==8)for(var w=0;w<v;w++)r.push(i.readShort(e,(v<3?a-4:t)+2*w));if(o==9)for(var w=0;w<v;w++)r.push(i.readInt(e,(v<2?a-4:t)+4*w));if(o==10)for(var w=0;w<v;w++)r.push(i.readInt(e,t+w*8)/i.readInt(e,t+w*8+4));if(o==11)for(var w=0;w<v;w++)r.push(i.readFloat(e,t+w*4));if(o==12)for(var w=0;w<v;w++)r.push(i.readDouble(e,t+w*8));if(u["t"+n]=r,v!=0&&r.length==0&&R("unknown TIFF tag type: ",o,"num:",v),l&&R("   ".repeat(h),n,o,p.tags[n],r),!(n==330&&u.t272&&u.t272[0]=="DSLR-A100")){if(n==330||n==34665||n==50740&&i.readUshort(e,i.readUint(r,0))<300){for(var B=n==50740?[i.readUint(r,0)]:r,E=[],w=0;w<B.length;w++)p._readIFD(i,e,B[w],E,h+1,l);n==330&&(u.subIFD=E),n==34665&&(u.exifIFD=E[0]),n==50740&&(u.dngPrvt=E[0])}}if(n==37500){var y=r;if(i.readASCII(y,0,5)=="Nikon")u.makerNote=p.decode(y.slice(10).buffer)[0];else if(i.readUshort(e,t)<300){var D=[];p._readIFD(i,e,t,D,h+1,l),u.makerNote=D[0]}}}return l&&R("   ".repeat(h),"<<<---------------"),a},p._writeIFD=function(i,e,a,d){var h=Object.keys(d);i.writeUshort(e,a,h.length),a+=2;for(var l=a+h.length*12+4,s=0;s<h.length;s++){var u=h[s],_=parseInt(u.slice(1)),n=p.ttypes[_];if(n==null)throw new Error("unknown type of tag: "+_);var o=d[u];n==2&&(o=o[0]+"\0");var v=o.length;i.writeUshort(e,a,_),a+=2,i.writeUshort(e,a,n),a+=2,i.writeUint(e,a,v),a+=4;var t=[-1,1,1,2,4,8,0,0,0,0,0,0,8][n]*v,r=a;if(t>4&&(i.writeUint(e,a,l),r=l),n==2&&i.writeASCII(e,r,o),n==3)for(var c=0;c<v;c++)i.writeUshort(e,r+2*c,o[c]);if(n==4)for(var c=0;c<v;c++)i.writeUint(e,r+4*c,o[c]);if(n==5)for(var c=0;c<v;c++)i.writeUint(e,r+8*c,Math.round(o[c]*1e4)),i.writeUint(e,r+8*c+4,1e4);if(n==12)for(var c=0;c<v;c++)i.writeDouble(e,r+8*c,o[c]);t>4&&(t+=t&1,l+=t),a+=4}return[a,l]},p.toRGBA8=function(i){var e=i.width,a=i.height,d=e*a,h=d*4,l=i.data,s=new Uint8Array(d*4),u=i.t262?i.t262[0]:2,_=i.t258?Math.min(32,i.t258[0]):1;if(u==0)for(var n=Math.ceil(_*e/8),o=0;o<a;o++){var v=o*n,t=o*e;if(_==1)for(var r=0;r<e;r++){var c=t+r<<2,f=l[v+(r>>3)]>>7-(r&7)&1;s[c]=s[c+1]=s[c+2]=(1-f)*255,s[c+3]=255}if(_==4)for(var r=0;r<e;r++){var c=t+r<<2,f=l[v+(r>>1)]>>4-4*(r&1)&15;s[c]=s[c+1]=s[c+2]=(15-f)*17,s[c+3]=255}if(_==8)for(var r=0;r<e;r++){var c=t+r<<2,f=l[v+r];s[c]=s[c+1]=s[c+2]=255-f,s[c+3]=255}}else if(u==1)for(var n=Math.ceil(_*e/8),o=0;o<a;o++){var v=o*n,t=o*e;if(_==1)for(var r=0;r<e;r++){var c=t+r<<2,f=l[v+(r>>3)]>>7-(r&7)&1;s[c]=s[c+1]=s[c+2]=f*255,s[c+3]=255}if(_==2)for(var r=0;r<e;r++){var c=t+r<<2,f=l[v+(r>>2)]>>6-2*(r&3)&3;s[c]=s[c+1]=s[c+2]=f*85,s[c+3]=255}if(_==8)for(var r=0;r<e;r++){var c=t+r<<2,f=l[v+r];s[c]=s[c+1]=s[c+2]=f,s[c+3]=255}if(_==16)for(var r=0;r<e;r++){var c=t+r<<2,f=l[v+(2*r+1)];s[c]=s[c+1]=s[c+2]=Math.min(255,f),s[c+3]=255}}else if(u==2){var w=i.t258?i.t258.length:3;if(_==8){if(w==4)for(var r=0;r<h;r++)s[r]=l[r];if(w==3)for(var r=0;r<d;r++){var c=r<<2,B=r*3;s[c]=l[B],s[c+1]=l[B+1],s[c+2]=l[B+2],s[c+3]=255}}else{if(w==4)for(var r=0;r<d;r++){var c=r<<2,B=r*8+1;s[c]=l[B],s[c+1]=l[B+2],s[c+2]=l[B+4],s[c+3]=l[B+6]}if(w==3)for(var r=0;r<d;r++){var c=r<<2,B=r*6+1;s[c]=l[B],s[c+1]=l[B+2],s[c+2]=l[B+4],s[c+3]=255}}}else if(u==3)for(var E=i.t320,r=0;r<d;r++){var c=r<<2,y=l[r];s[c]=E[y]>>8,s[c+1]=E[256+y]>>8,s[c+2]=E[512+y]>>8,s[c+3]=255}else if(u==5)for(var w=i.t258?i.t258.length:4,D=w>4?1:0,r=0;r<d;r++){var c=r<<2,g=r*w,M=255-l[g],P=255-l[g+1],b=255-l[g+2],L=(255-l[g+3])*(1/255);s[c]=~~(M*L+.5),s[c+1]=~~(P*L+.5),s[c+2]=~~(b*L+.5),s[c+3]=255*(1-D)+l[g+4]*D}else R("Unknown Photometric interpretation: "+u);return s},p.replaceIMG=function(i){i==null&&(i=document.getElementsByTagName("img"));for(var e=["tif","tiff","dng","cr2","nef"],a=0;a<i.length;a++){var d=i[a],h=d.getAttribute("src");if(h!=null){var l=h.split(".").pop().toLowerCase();if(e.indexOf(l)!=-1){var s=new XMLHttpRequest;p._xhrs.push(s),p._imgs.push(d),s.open("GET",h),s.responseType="arraybuffer",s.onload=p._imgLoaded,s.send()}}}},p._xhrs=[],p._imgs=[],p._imgLoaded=function(i){var e=i.target.response,a=p.decode(e),d=a,h=0,l=d[0];a[0].subIFD&&(d=d.concat(a[0].subIFD));for(var s=0;s<d.length;s++){var t=d[s];if(!(t.t258==null||t.t258.length<3)){var u=t.t256*t.t257;u>h&&(h=u,l=t)}}p.decodeImage(e,l,a);var _=p.toRGBA8(l),n=l.width,o=l.height,v=p._xhrs.indexOf(i.target),t=p._imgs[v];p._xhrs.splice(v,1),p._imgs.splice(v,1);var r=document.createElement("canvas");r.width=n,r.height=o;for(var c=r.getContext("2d"),f=c.createImageData(n,o),s=0;s<_.length;s++)f.data[s]=_[s];c.putImageData(f,0,0),t.setAttribute("src",r.toDataURL())},p._binBE={nextZero:function(i,e){for(;i[e]!=0;)e++;return e},readUshort:function(i,e){return i[e]<<8|i[e+1]},readShort:function(i,e){var a=p._binBE.ui8;return a[0]=i[e+1],a[1]=i[e+0],p._binBE.i16[0]},readInt:function(i,e){var a=p._binBE.ui8;return a[0]=i[e+3],a[1]=i[e+2],a[2]=i[e+1],a[3]=i[e+0],p._binBE.i32[0]},readUint:function(i,e){var a=p._binBE.ui8;return a[0]=i[e+3],a[1]=i[e+2],a[2]=i[e+1],a[3]=i[e+0],p._binBE.ui32[0]},readASCII:function(i,e,a){for(var d="",h=0;h<a;h++)d+=String.fromCharCode(i[e+h]);return d},readFloat:function(i,e){for(var a=p._binBE.ui8,d=0;d<4;d++)a[d]=i[e+3-d];return p._binBE.fl32[0]},readDouble:function(i,e){for(var a=p._binBE.ui8,d=0;d<8;d++)a[d]=i[e+7-d];return p._binBE.fl64[0]},writeUshort:function(i,e,a){i[e]=a>>8&255,i[e+1]=a&255},writeUint:function(i,e,a){i[e]=a>>24&255,i[e+1]=a>>16&255,i[e+2]=a>>8&255,i[e+3]=a>>0&255},writeASCII:function(i,e,a){for(var d=0;d<a.length;d++)i[e+d]=a.charCodeAt(d)},writeDouble:function(i,e,a){p._binBE.fl64[0]=a;for(var d=0;d<8;d++)i[e+d]=p._binBE.ui8[7-d]}},p._binBE.ui8=new Uint8Array(8),p._binBE.i16=new Int16Array(p._binBE.ui8.buffer),p._binBE.i32=new Int32Array(p._binBE.ui8.buffer),p._binBE.ui32=new Uint32Array(p._binBE.ui8.buffer),p._binBE.fl32=new Float32Array(p._binBE.ui8.buffer),p._binBE.fl64=new Float64Array(p._binBE.ui8.buffer),p._binLE={nextZero:p._binBE.nextZero,readUshort:function(i,e){return i[e+1]<<8|i[e]},readShort:function(i,e){var a=p._binBE.ui8;return a[0]=i[e+0],a[1]=i[e+1],p._binBE.i16[0]},readInt:function(i,e){var a=p._binBE.ui8;return a[0]=i[e+0],a[1]=i[e+1],a[2]=i[e+2],a[3]=i[e+3],p._binBE.i32[0]},readUint:function(i,e){var a=p._binBE.ui8;return a[0]=i[e+0],a[1]=i[e+1],a[2]=i[e+2],a[3]=i[e+3],p._binBE.ui32[0]},readASCII:p._binBE.readASCII,readFloat:function(i,e){for(var a=p._binBE.ui8,d=0;d<4;d++)a[d]=i[e+d];return p._binBE.fl32[0]},readDouble:function(i,e){for(var a=p._binBE.ui8,d=0;d<8;d++)a[d]=i[e+d];return p._binBE.fl64[0]}},p._copyTile=function(i,e,a,d,h,l,s,u){for(var _=Math.min(e,h-s),n=Math.min(a,l-u),o=0;o<n;o++)for(var v=(u+o)*h+s,t=o*e,r=0;r<_;r++)d[v+r]=i[t+r]},p.LosslessJpegDecode=(function(){function i(h){this.w=h,this.N=0,this._=0,this.G=0}i.prototype={t:function(h){this.N=Math.max(0,Math.min(this.w.length,h))},i:function(){return this.w[this.N++]},l:function(){var h=this.N;return this.N+=2,this.w[h]<<8|this.w[h+1]},J:function(){return this._==0&&(this.G=this.w[this.N],this.N+=1+(this.G+1>>>8),this._=8),this.G>>>--this._&1},Z:function(h){var l=this._,s=this.G,u=Math.min(l,h);h-=u,l-=u;for(var _=s>>>l&(1<<u)-1;h>0;)s=this.w[this.N],this.N+=1+(s+1>>>8),u=Math.min(8,h),h-=u,l=8-u,_<<=u,_|=s>>>l&(1<<u)-1;return this._=l,this.G=s,_}};var e={};e.X=function(){return[0,0,-1]},e.s=function(h,l,s){h[e.Y(h,0,s)+2]=l},e.Y=function(h,l,s){if(h[l+2]!=-1)return 0;if(s==0)return l;for(var u=0;u<2;u++){h[l+u]==0&&(h[l+u]=h.length,h.push(0),h.push(0),h.push(-1));var _=e.Y(h,h[l+u],s-1);if(_!=0)return _}return 0},e.B=function(h,l){for(var s=0,u=0,_=0,n=l._,o=l.G,v=l.N;;)if(n==0&&(o=l.w[v],v+=1+(o+1>>>8),n=8),_=o>>>--n&1,s=h[s+_],u=h[s+2],u!=-1)return l._=n,l.G=o,l.N=v,u;return-1};function a(h){this.z=new i(h),this.D(this.z)}a.prototype={$:function(h,l){this.Q=h.i(),this.F=h.l(),this.o=h.l();var s=this.O=h.i();this.L=[];for(var u=0;u<s;u++){var _=h.i();h.i(),h.i(),this.L[_]=u}h.t(h.N+l-(6+s*3))},e:function(){var h=0,l=this.z.i();this.H==null&&(this.H={});for(var s=this.H[l]=e.X(),u=[],_=0;_<16;_++)u[_]=this.z.i(),h+=u[_];for(var _=0;_<16;_++)for(var n=0;n<u[_];n++)e.s(s,this.z.i(),_+1);return h+17},W:function(h){for(;h>0;)h-=this.e()},p:function(h,l){var s=h.i();this.U||(this.U=[]);for(var u=0;u<s;u++){var _=h.i(),n=h.i();this.U[this.L[_]]=this.H[n>>>4]}this.g=h.i(),h.t(h.N+l-(2+s*2))},D:function(h){var l=!1,s=h.l();if(s===a.q)do{var s=h.l(),u=h.l()-2;switch(s){case a.m:this.$(h,u);break;case a.K:this.W(u);break;case a.V:this.p(h,u),l=!0;break;default:h.t(h.N+u);break}}while(!l)},I:function(h,l){var s=e.B(l,h);if(s==16)return-32768;var u=h.Z(s);return(u&1<<s-1)==0&&(u-=(1<<s)-1),u},B:function(h,l){for(var s=this.z,u=this.O,_=this.F,n=this.I,o=this.g,v=this.o*u,t=this.U,r=0;r<u;r++)h[r]=n(s,t[r])+(1<<this.Q-1);for(var c=u;c<v;c+=u)for(var r=0;r<u;r++)h[c+r]=n(s,t[r])+h[c+r-u];for(var f=l,w=1;w<_;w++){for(var r=0;r<u;r++)h[f+r]=n(s,t[r])+h[f+r-l];for(var c=u;c<v;c+=u)for(var r=0;r<u;r++){var B=f+c+r,E=h[B-u];o==6&&(E=h[B-l]+(E-h[B-u-l]>>>1)),h[B]=E+n(s,t[r])}f+=l}}},a.m=65475,a.K=65476,a.q=65496,a.V=65498;function d(h){var l=new a(h),s=l.Q>8?Uint16Array:Uint8Array,u=new s(l.o*l.F*l.O),_=l.o*l.O;return l.B(u,_),u}return d})()})(K,Z)})()})(t0)),t0.exports}var L0=k0();const M0=p0(L0);E0.workerSrc=new URL("/bentopdf/assets/pdf.worker.min-LyOxJPrg.mjs",import.meta.url).toString();let U=[];const a0=()=>{const Y=document.getElementById("file-display-area"),K=document.getElementById("options-panel"),Z=document.getElementById("drop-zone");!Y||!K||!Z||(Y.innerHTML="",U.length>0?(K.classList.remove("hidden"),U.forEach(R=>{const p=document.createElement("div");p.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const m=document.createElement("div");m.className="flex flex-col overflow-hidden";const i=document.createElement("div");i.className="truncate font-medium text-gray-200 text-sm mb-1",i.textContent=R.name;const e=document.createElement("div");e.className="text-xs text-gray-400",e.textContent=`${n0(R.size)} • Loading pages...`,m.append(i,e);const a=document.createElement("button");a.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",a.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',a.onclick=()=>{U=[],a0()},p.append(m,a),Y.appendChild(p),d0(R).then(d=>h0(d).promise).then(d=>{e.textContent=`${n0(R.size)} • ${d.numPages} page${d.numPages!==1?"s":""}`}).catch(d=>{console.warn("Error loading PDF page count:",d),e.textContent=n0(R.size)})}),u0({icons:f0})):K.classList.add("hidden"))},b0=()=>{U=[];const Y=document.getElementById("file-input");Y&&(Y.value=""),a0()};async function P0(){if(U.length===0){e0("No File","Please upload a PDF file first.");return}g0("Converting to TIFF...");try{const Y=await h0(await d0(U[0])).promise,K=new y0;for(let R=1;R<=Y.numPages;R++){const p=await Y.getPage(R),m=p.getViewport({scale:2}),i=document.createElement("canvas"),e=i.getContext("2d");i.height=m.height,i.width=m.width,await p.render({canvasContext:e,viewport:m,canvas:i}).promise;const d=e.getImageData(0,0,i.width,i.height).data;try{const h=M0.encodeImage(new Uint8Array(d),i.width,i.height),l=new Blob([h],{type:"image/tiff"});K.file(`page_${R}.tiff`,l)}catch(h){console.warn(`TIFF encoding failed for page ${R}, using PNG fallback:`,h);const l=await new Promise(s=>i.toBlob(s,"image/png"));l&&K.file(`page_${R}.png`,l)}}const Z=await K.generateAsync({type:"blob"});D0(Z,"converted_images.zip"),e0("Success","PDF converted to TIFFs successfully!","success",()=>{b0()})}catch(Y){console.error(Y),e0("Error","Failed to convert PDF to TIFF. The file might be corrupted.")}finally{B0()}}document.addEventListener("DOMContentLoaded",()=>{const Y=document.getElementById("file-input"),K=document.getElementById("drop-zone"),Z=document.getElementById("process-btn"),R=document.getElementById("back-to-tools");R&&R.addEventListener("click",()=>{window.location.href="/bentopdf/"});const p=m=>{if(!m||m.length===0)return;const i=Array.from(m).filter(e=>e.type==="application/pdf");if(i.length===0){e0("Invalid File","Please upload a PDF file.");return}U=[i[0]],a0()};Y&&K&&(Y.addEventListener("change",m=>{p(m.target.files)}),K.addEventListener("dragover",m=>{m.preventDefault(),K.classList.add("bg-gray-700")}),K.addEventListener("dragleave",m=>{m.preventDefault(),K.classList.remove("bg-gray-700")}),K.addEventListener("drop",m=>{m.preventDefault(),K.classList.remove("bg-gray-700"),p(m.dataTransfer?.files??null)}),Y.addEventListener("click",()=>{Y.value=""})),Z&&Z.addEventListener("click",P0)});
