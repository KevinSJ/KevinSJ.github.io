import{c as y,i as b}from"./style-CNx3HTbi.js";import"./version-D4ympJL5.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-ODFatrFN.js";import{a as f,d as v,f as p}from"./main-Dqs2Ohqn.js";import{J as E}from"./jszip.min-DMkQATzN.js";import"./mobileMenu-BoMunYmR.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";const m=new Worker("/bentopdf/workers/extract-attachments.worker.js"),a={files:[]};function l(){a.files=[];const t=document.getElementById("file-display-area");t&&(t.innerHTML="");const e=document.getElementById("tool-options");e&&e.classList.add("hidden");const n=document.getElementById("status-message");n&&n.classList.add("hidden");const r=document.getElementById("file-input");r&&(r.value="");const s=document.getElementById("process-btn");s&&(s.classList.remove("opacity-50","cursor-not-allowed"),s.removeAttribute("disabled"))}function c(t,e="info"){const n=document.getElementById("status-message");n&&(n.textContent=t,n.className=`mt-4 p-3 rounded-lg text-sm ${e==="success"?"bg-green-900 text-green-200":e==="error"?"bg-red-900 text-red-200":"bg-blue-900 text-blue-200"}`,n.classList.remove("hidden"))}m.onmessage=function(t){const e=document.getElementById("process-btn");if(e&&(e.classList.remove("opacity-50","cursor-not-allowed"),e.removeAttribute("disabled")),t.data.status==="success"){const n=t.data.attachments;if(n.length===0){f("No Attachments","The PDF file(s) do not contain any attachments to extract."),l();return}const r=new E;let s=0;for(const o of n)r.file(o.name,new Uint8Array(o.data)),s+=o.data.byteLength;r.generateAsync({type:"blob"}).then(function(o){v(o,"extracted-attachments.zip"),f("Success",`${n.length} attachment(s) extracted successfully!`),c(`Extraction completed! ${n.length} attachment(s) in zip file (${p(s)}). Download started.`,"success"),l()})}else if(t.data.status==="error"){const n=t.data.message||"Unknown error occurred in worker.";console.error("Worker Error:",n),n.includes("No attachments were found")?(f("No Attachments","The PDF file(s) do not contain any attachments to extract."),l()):c(`Error: ${n}`,"error")}};m.onerror=function(t){console.error("Worker error:",t),c("Worker error occurred. Check console for details.","error");const e=document.getElementById("process-btn");e&&(e.classList.remove("opacity-50","cursor-not-allowed"),e.removeAttribute("disabled"))};async function x(){const t=document.getElementById("file-display-area"),e=document.getElementById("tool-options");if(t)if(t.innerHTML="",a.files.length>0){const n=document.createElement("div");n.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const r=document.createElement("div");r.className="flex flex-col overflow-hidden";const s=document.createElement("div");s.className="font-medium text-gray-200 text-sm mb-1",s.textContent=`${a.files.length} PDF file(s) selected`;const o=document.createElement("div");o.className="text-xs text-gray-400";const d=a.files.reduce(function(g,h){return g+h.size},0);o.textContent=p(d),r.append(s,o);const i=document.createElement("button");i.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",i.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',i.onclick=function(){l()},n.append(r,i),t.appendChild(n),y({icons:b}),e&&e.classList.remove("hidden")}else e&&e.classList.add("hidden")}async function L(){if(a.files.length===0){c("No Files","error");return}const t=document.getElementById("process-btn");t&&(t.classList.add("opacity-50","cursor-not-allowed"),t.setAttribute("disabled","true")),c("Reading files...","info");try{const e=[],n=[];for(const o of a.files){const d=await o.arrayBuffer();e.push(d),n.push(o.name)}c(`Extracting attachments from ${a.files.length} file(s)...`,"info");const r={command:"extract-attachments",fileBuffers:e,fileNames:n},s=e.map(function(o){return o});m.postMessage(r,s)}catch(e){console.error("Error reading files:",e),c(`Error reading files: ${e instanceof Error?e.message:"Unknown error occurred"}`,"error"),t&&(t.classList.remove("opacity-50","cursor-not-allowed"),t.removeAttribute("disabled"))}}function u(t){if(t&&t.length>0){const e=Array.from(t).filter(function(n){return n.type==="application/pdf"||n.name.toLowerCase().endsWith(".pdf")});e.length>0&&(a.files=e,x())}}document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("file-input"),e=document.getElementById("drop-zone"),n=document.getElementById("process-btn"),r=document.getElementById("back-to-tools");r&&r.addEventListener("click",function(){window.location.href="/bentopdf/"}),t&&e&&(t.addEventListener("change",function(s){u(s.target.files)}),e.addEventListener("dragover",function(s){s.preventDefault(),e.classList.add("bg-gray-700")}),e.addEventListener("dragleave",function(s){s.preventDefault(),e.classList.remove("bg-gray-700")}),e.addEventListener("drop",function(s){s.preventDefault(),e.classList.remove("bg-gray-700");const o=s.dataTransfer?.files;o&&o.length>0&&u(o)}),t.addEventListener("click",function(){t.value=""})),n&&n.addEventListener("click",L)});
