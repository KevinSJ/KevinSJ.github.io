import{c as g,i as v}from"./style-D1FQfXNQ.js";import"./version-Dw8ZKLCV.js";import"./simple-mode-footer-D78rH_WB.js";import{m as y,n as E,a as c,b as i,d as h,h as b,f as L}from"./main-Da82M_MD.js";import"./mobileMenu-BoMunYmR.js";const m=new y(E("pymupdf"));let r=null;const u=()=>{const e=document.getElementById("file-display-area"),t=document.getElementById("options-panel");if(!(!e||!t))if(e.innerHTML="",r){t.classList.remove("hidden");const o=document.createElement("div");o.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const a=document.createElement("div");a.className="flex flex-col overflow-hidden";const l=document.createElement("div");l.className="truncate font-medium text-gray-200 text-sm mb-1",l.textContent=r.name;const n=document.createElement("div");n.className="text-xs text-gray-400",n.textContent=L(r.size),a.append(l,n);const s=document.createElement("button");s.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",s.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',s.onclick=f,o.append(a,s),e.appendChild(o),g({icons:v})}else t.classList.add("hidden")},f=()=>{r=null;const e=document.getElementById("file-input");e&&(e.value=""),u()};function x(e){return e.map(t=>t.map(o=>{const a=o??"";return a.includes(",")||a.includes('"')||a.includes(`
`)?`"${a.replace(/"/g,'""')}"`:a}).join(",")).join(`
`)}async function w(){if(!r){c("No File","Please upload a PDF file first.");return}i("Loading Engine...");try{await m.load(),i("Extracting tables...");const e=await m.open(r),t=e.pageCount,o=r.name.replace(/\.[^/.]+$/,""),a=[];for(let s=0;s<t;s++)i(`Scanning page ${s+1} of ${t}...`),e.getPage(s).findTables().forEach(p=>{a.push(...p.rows),a.push([])});if(a.length===0){c("No Tables Found","No tables were detected in this PDF.");return}const l=x(a.filter(s=>s.length>0)),n=new Blob([l],{type:"text/csv;charset=utf-8;"});h(n,`${o}.csv`),c("Success","PDF converted to CSV successfully!","success",f)}catch(e){console.error(e);const t=e instanceof Error?e.message:"Unknown error";c("Error",`Failed to convert PDF to CSV. ${t}`)}finally{b()}}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("file-input"),t=document.getElementById("drop-zone"),o=document.getElementById("process-btn"),a=document.getElementById("back-to-tools");a&&a.addEventListener("click",()=>{window.location.href="/"});const l=n=>{if(!n||n.length===0)return;const s=Array.from(n).find(d=>d.type==="application/pdf");if(!s){c("Invalid File","Please upload a PDF file.");return}r=s,u()};e&&t&&(e.addEventListener("change",n=>{l(n.target.files)}),t.addEventListener("dragover",n=>{n.preventDefault(),t.classList.add("bg-gray-700")}),t.addEventListener("dragleave",n=>{n.preventDefault(),t.classList.remove("bg-gray-700")}),t.addEventListener("drop",n=>{n.preventDefault(),t.classList.remove("bg-gray-700"),l(n.dataTransfer?.files??null)}),e.addEventListener("click",()=>{e.value=""})),o&&o.addEventListener("click",w)});
