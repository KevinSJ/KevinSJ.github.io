import{c as K,i as X}from"./style-CYUbkObH.js";import"./version-BHeJdyYx.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-Q5E4PlzL.js";import{a as v,f as W,b as I,P as M,h as P,t as Y,z as Z,v as _,d as q}from"./main-DWubsKaN.js";import"./mobileMenu-BoMunYmR.js";const o={file:null,pdfDoc:null};function x(){o.file=null,o.pdfDoc=null;const e=document.getElementById("file-display-area");e&&(e.innerHTML="");const t=document.getElementById("tool-options");t&&t.classList.add("hidden");const a=document.getElementById("file-input");a&&(a.value="")}async function G(){const e=document.getElementById("file-display-area"),t=document.getElementById("tool-options");if(e)if(e.innerHTML="",o.file){const a=document.createElement("div");a.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const s=document.createElement("div");s.className="flex flex-col overflow-hidden";const r=document.createElement("div");r.className="truncate font-medium text-gray-200 text-sm mb-1",r.textContent=o.file.name;const c=document.createElement("div");c.className="text-xs text-gray-400",c.textContent=`${W(o.file.size)} • Loading...`,s.append(r,c);const n=document.createElement("button");n.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",n.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',n.onclick=function(){x()},a.append(s,n),e.appendChild(a),K({icons:X});try{I("Loading PDF...");const i=await o.file.arrayBuffer();o.pdfDoc=await M.load(i,{ignoreEncryption:!0,throwOnInvalidObject:!1}),P();const d=o.pdfDoc.getPageCount();c.textContent=`${W(o.file.size)} • ${d} pages`,t&&t.classList.remove("hidden")}catch(i){console.error("Error loading PDF:",i),P(),v("Error","Failed to load PDF file."),x()}}else t&&t.classList.add("hidden")}async function J(){if(!o.pdfDoc||!o.file){v("Error","Please upload a PDF first.");return}const e=parseInt(document.getElementById("pages-per-sheet").value),t=document.getElementById("output-page-size").value;let a=document.getElementById("output-orientation").value;const s=document.getElementById("add-margins").checked,r=document.getElementById("add-border").checked,c=Y(document.getElementById("border-color").value);I("Creating N-Up PDF...");try{const n=o.pdfDoc,i=await M.create(),d=n.getPages(),l={2:[2,1],4:[2,2],9:[3,3],16:[4,4]}[e];let[p,g]=Z[t];if(a==="auto"){const f=d[0];a=f.getWidth()>f.getHeight()&&l[0]>l[1]?"landscape":"portrait"}a==="landscape"&&p<g&&([p,g]=[g,p]);const y=s?36:0,E=s?10:0,T=p-y*2,z=g-y*2;for(let f=0;f<d.length;f+=e){I(`Processing sheet ${Math.floor(f/e)+1}...`);const b=d.slice(f,f+e),C=i.addPage([p,g]),w=(T-E*(l[0]-1))/l[0],L=(z-E*(l[1]-1))/l[1];for(let m=0;m<b.length;m++){const U=b[m],h=await i.embedPage(U),k=Math.min(w/h.width,L/h.height),B=h.width*k,D=h.height*k,F=Math.floor(m/l[0]),O=m%l[0],j=y+O*(w+E),R=g-y-(F+1)*L-F*E,S=j+(w-B)/2,N=R+(L-D)/2;C.drawPage(h,{x:S,y:N,width:B,height:D}),r&&C.drawRectangle({x:S,y:N,width:B,height:D,borderColor:_(c.r,c.g,c.b),borderWidth:1})}}const $=await i.save(),A=o.file.name.replace(/\.pdf$/i,"");q(new Blob([new Uint8Array($)],{type:"application/pdf"}),`${A}_${e}-up.pdf`),v("Success","N-Up PDF created successfully!","success",function(){x()})}catch(n){console.error(n),v("Error","An error occurred while creating the N-Up PDF.")}finally{P()}}function H(e){if(e&&e.length>0){const t=e[0];(t.type==="application/pdf"||t.name.toLowerCase().endsWith(".pdf"))&&(o.file=t,G())}}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("file-input"),t=document.getElementById("drop-zone"),a=document.getElementById("process-btn"),s=document.getElementById("back-to-tools"),r=document.getElementById("add-border"),c=document.getElementById("border-color-wrapper");s&&s.addEventListener("click",function(){window.location.href="/bentopdf/"}),r&&c&&r.addEventListener("change",function(){c.classList.toggle("hidden",!r.checked)}),e&&t&&(e.addEventListener("change",function(n){H(n.target.files)}),t.addEventListener("dragover",function(n){n.preventDefault(),t.classList.add("bg-gray-700")}),t.addEventListener("dragleave",function(n){n.preventDefault(),t.classList.remove("bg-gray-700")}),t.addEventListener("drop",function(n){n.preventDefault(),t.classList.remove("bg-gray-700");const i=n.dataTransfer?.files;if(i&&i.length>0){const d=Array.from(i).filter(function(u){return u.type==="application/pdf"||u.name.toLowerCase().endsWith(".pdf")});if(d.length>0){const u=new DataTransfer;u.items.add(d[0]),H(u.files)}}}),e.addEventListener("click",function(){e.value=""})),a&&a.addEventListener("click",J)});
