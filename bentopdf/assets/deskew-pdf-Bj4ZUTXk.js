import{c as u,i as g}from"./style-D1FQfXNQ.js";import"./version-Dw8ZKLCV.js";import"./simple-mode-footer-D78rH_WB.js";import{d as v,m as h}from"./main-Da82M_MD.js";import"./mobileMenu-BoMunYmR.js";let o=[],m=null;function x(){return m||(m=new h({assetPath:"/pymupdf-wasm/"})),m}function y(e){const t=document.getElementById("loader-modal"),s=document.getElementById("loader-text");t&&s&&(s.textContent=e,t.classList.remove("hidden"))}function E(){const e=document.getElementById("loader-modal");e&&e.classList.add("hidden")}function f(e,t){const s=document.getElementById("alert-modal"),d=document.getElementById("alert-title"),n=document.getElementById("alert-message");s&&d&&n&&(d.textContent=e,n.textContent=t,s.classList.remove("hidden"))}function c(){const e=document.getElementById("file-display-area"),t=document.getElementById("file-controls"),s=document.getElementById("deskew-options"),d=document.getElementById("results-area");if(!(!e||!t||!s||!d)){if(d.classList.add("hidden"),o.length===0){e.innerHTML="",t.classList.add("hidden"),s.classList.add("hidden");return}t.classList.remove("hidden"),s.classList.remove("hidden"),e.innerHTML=o.map((n,a)=>`
      <div class="flex items-center justify-between bg-gray-700 p-3 rounded-lg">
        <div class="flex items-center gap-3">
          <i data-lucide="file-text" class="w-5 h-5 text-indigo-400"></i>
          <span class="text-gray-200 truncate max-w-xs">${n.name}</span>
          <span class="text-gray-500 text-sm">(${(n.size/1024).toFixed(1)} KB)</span>
        </div>
        <button class="remove-file text-gray-400 hover:text-red-400" data-index="${a}">
          <i data-lucide="x" class="w-5 h-5"></i>
        </button>
      </div>
    `).join(""),u({icons:g}),e.querySelectorAll(".remove-file").forEach(n=>{n.addEventListener("click",a=>{const i=parseInt(a.currentTarget.dataset.index||"0",10);o.splice(i,1),c()})})}}function L(e){const t=document.getElementById("results-area"),s=document.getElementById("result-total"),d=document.getElementById("result-corrected"),n=document.getElementById("angles-list");!t||!s||!d||!n||(t.classList.remove("hidden"),s.textContent=e.totalPages.toString(),d.textContent=e.correctedPages.toString(),n.innerHTML=e.angles.map((a,i)=>{const l=e.corrected[i],r=l?"text-green-400":"text-gray-400";return`
        <div class="flex items-center gap-2 text-sm py-1">
          <i data-lucide="${l?"check":"minus"}" class="w-4 h-4 ${r}"></i>
          <span class="text-gray-300">Page ${i+1}:</span>
          <span class="${r}">${a.toFixed(2)}Â°</span>
          ${l?'<span class="text-green-400 text-xs">(corrected)</span>':""}
        </div>
      `}).join(""),u({icons:g}))}async function B(){if(o.length===0){f("No Files","Please select at least one PDF file.");return}const e=document.getElementById("deskew-threshold"),t=document.getElementById("deskew-dpi"),s=parseFloat(e?.value||"0.5"),d=parseInt(t?.value||"150",10);y("Initializing PyMuPDF...");try{const n=x();await n.load();for(const a of o){y(`Deskewing ${a.name}...`);const{pdf:i,result:l}=await n.deskewPdf(a,{threshold:s,dpi:d});L(l);const r=a.name.replace(".pdf","_deskewed.pdf");v(i,r)}E(),f("Success",`Deskewed ${o.length} file(s). ${o.length>1?"Downloads started for all files.":""}`)}catch(n){E(),console.error("Deskew error:",n),f("Error",`Failed to deskew PDF: ${n instanceof Error?n.message:"Unknown error"}`)}}function I(){const e=document.getElementById("file-input"),t=document.getElementById("drop-zone"),s=document.getElementById("add-more-btn"),d=document.getElementById("clear-files-btn"),n=document.getElementById("process-btn"),a=document.getElementById("alert-ok"),i=document.getElementById("back-to-tools");e&&e.addEventListener("change",()=>{e.files&&(o=[...o,...Array.from(e.files)],c(),e.value="")}),t&&(t.addEventListener("dragover",l=>{l.preventDefault(),t.classList.add("bg-gray-700")}),t.addEventListener("dragleave",()=>{t.classList.remove("bg-gray-700")}),t.addEventListener("drop",l=>{if(l.preventDefault(),t.classList.remove("bg-gray-700"),l.dataTransfer?.files){const r=Array.from(l.dataTransfer.files).filter(p=>p.type==="application/pdf");o=[...o,...r],c()}})),s&&s.addEventListener("click",()=>e?.click()),d&&d.addEventListener("click",()=>{o=[],c()}),n&&n.addEventListener("click",B),a&&a.addEventListener("click",()=>{document.getElementById("alert-modal")?.classList.add("hidden")}),i&&i.addEventListener("click",()=>{window.location.href="/"}),u({icons:g})}document.addEventListener("DOMContentLoaded",I);
