import{c as w,i as g}from"./style-CYUbkObH.js";import"./version-BHeJdyYx.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-Q5E4PlzL.js";import{e as y}from"./main-DWubsKaN.js";import"./mobileMenu-BoMunYmR.js";let a=null,f=!1,l=null;function v(e="Processing..."){const t=document.getElementById("loader-modal"),o=document.getElementById("loader-text");t&&t.classList.remove("hidden"),o&&(o.textContent=e)}function m(){const e=document.getElementById("loader-modal");e&&e.classList.add("hidden")}function s(e,t,o="error",i){const n=document.getElementById("alert-modal"),r=document.getElementById("alert-title"),d=document.getElementById("alert-message"),c=document.getElementById("alert-ok");if(r&&(r.textContent=e),d&&(d.textContent=t),n&&n.classList.remove("hidden"),c){const u=c.cloneNode(!0);c.replaceWith(u),u.addEventListener("click",()=>{n?.classList.add("hidden")})}}function h(){const e=document.getElementById("file-display-area");if(!e||!l)return;const t=l.size<1024*1024?`${(l.size/1024).toFixed(1)} KB`:`${(l.size/1024/1024).toFixed(2)} MB`;e.innerHTML=`
        <div class="bg-gray-700 p-3 rounded-lg border border-gray-600 hover:border-indigo-500 transition-colors">
            <div class="flex items-center justify-between">
                <div class="flex-1 min-w-0">
                    <p class="truncate font-medium text-white">${l.name}</p>
                    <p class="text-gray-400 text-sm">${t}</p>
                </div>
                <button id="remove-file" class="text-red-400 hover:text-red-300 p-2 flex-shrink-0 ml-2" title="Remove file">
                    <i data-lucide="trash-2" class="w-4 h-4"></i>
                </button>
            </div>
        </div>
    `,w({icons:g}),document.getElementById("remove-file")?.addEventListener("click",()=>b())}function b(){a=null,f=!1,l=null;const e=document.getElementById("file-display-area");e&&(e.innerHTML=""),document.getElementById("form-filler-options")?.classList.add("hidden");const t=document.getElementById("file-input");t&&(t.value="");const o=document.getElementById("pdf-viewer-container");o&&(o.innerHTML="",o.style.height="",o.style.aspectRatio="");const i=document.getElementById("tool-uploader"),n=localStorage.getItem("fullWidthMode")!=="false";i&&!n&&(i.classList.remove("max-w-6xl"),i.classList.add("max-w-2xl"))}async function p(e){if(!e||e.type!=="application/pdf"){s("Error","Please upload a valid PDF file.");return}l=e,h(),await E()}async function B(e){const t=document.getElementById("pdf-viewer-container");if(t)try{const o=await e.arrayBuffer(),d=(await(await y({data:o}).promise).getPage(1)).getViewport({scale:1}),c=d.width/(d.height+50);t.style.height="auto",t.style.aspectRatio=`${c}`}catch(o){console.error("Error adjusting viewer height:",o),t.style.height="80vh"}}async function E(){if(!l)return;v("Loading PDF form...");const e=document.getElementById("pdf-viewer-container");if(!e){console.error("PDF viewer container not found"),m();return}const t=document.getElementById("tool-uploader"),o=localStorage.getItem("fullWidthMode")!=="false";t&&!o&&(t.classList.remove("max-w-2xl"),t.classList.add("max-w-6xl"));try{await B(l),e.innerHTML="";const i=await l.arrayBuffer(),n=new Blob([i],{type:"application/pdf"}),r=URL.createObjectURL(n);a=document.createElement("iframe"),a.src=`/bentopdf/pdfjs-viewer/viewer.html?file=${encodeURIComponent(r)}`,a.style.width="100%",a.style.height="100%",a.style.border="none",a.onload=()=>{f=!0,m()},e.appendChild(a);const d=document.getElementById("form-filler-options");d&&d.classList.remove("hidden")}catch(i){console.error("Critical error setting up form filler:",i),s("Error","Failed to load PDF form viewer."),m()}}async function L(){if(!a||!f){s("Viewer not ready","Please wait for the form to finish loading.");return}try{const e=a.contentWindow;if(!e){console.error("Cannot access iframe window"),s("Download","Please use the Download button in the PDF viewer toolbar above.");return}const t=e.document;if(!t){console.error("Cannot access iframe document"),s("Download","Please use the Download button in the PDF viewer toolbar above.");return}const o=t.getElementById("downloadButton");if(o)console.log("Clicking download button..."),o.click();else{console.error("Download button not found in viewer");const i=t.getElementById("secondaryDownload");i?(console.log("Clicking secondary download button..."),i.click()):s("Download","Please use the Download button in the PDF viewer toolbar above.")}}catch(e){console.error("Failed to trigger download:",e),s("Download","Cannot access viewer controls. Please use the Download button in the PDF viewer toolbar above.")}}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("file-input"),t=document.getElementById("drop-zone"),o=document.getElementById("process-btn"),i=document.getElementById("back-to-tools");e?.addEventListener("change",n=>{const r=n.target.files?.[0];r&&p(r)}),t?.addEventListener("dragover",n=>{n.preventDefault(),t.classList.add("border-indigo-500")}),t?.addEventListener("dragleave",()=>{t.classList.remove("border-indigo-500")}),t?.addEventListener("drop",n=>{n.preventDefault(),t.classList.remove("border-indigo-500");const r=n.dataTransfer?.files[0];r&&p(r)}),o?.addEventListener("click",L),i?.addEventListener("click",()=>{window.location.href="../../index.html"})});
