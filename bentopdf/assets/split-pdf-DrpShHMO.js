import{c as Y,i as ee}from"./style-CYUbkObH.js";import"./version-BHeJdyYx.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-Q5E4PlzL.js";import{G as me,s as a,l as fe,b as x,r as te,P,e as ge,m as ue,a as L,h as S,d as C,_ as he,f as ne}from"./main-DWubsKaN.js";import{J as _}from"./jszip.min-3IPKxw9h.js";import"./mobileMenu-BoMunYmR.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";me.workerSrc=new URL("/bentopdf/assets/pdf.worker.min-LyOxJPrg.mjs",import.meta.url).toString();document.addEventListener("DOMContentLoaded",()=>{let b=!1;const A=document.getElementById("file-input"),w=document.getElementById("drop-zone"),W=document.getElementById("process-btn"),F=document.getElementById("file-display-area"),$=document.getElementById("split-options"),q=document.getElementById("back-to-tools"),B=document.getElementById("split-mode"),G=document.getElementById("range-panel"),H=document.getElementById("visual-select-panel"),U=document.getElementById("even-odd-panel"),z=document.getElementById("zip-option-wrapper"),V=document.getElementById("all-pages-panel"),Z=document.getElementById("bookmarks-panel"),J=document.getElementById("n-times-panel"),k=document.getElementById("n-times-warning");q&&q.addEventListener("click",()=>{window.location.href="/bentopdf/"});const T=async()=>{if(a.files.length>0){const t=a.files[0];if(F){F.innerHTML="";const r=document.createElement("div");r.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const n=document.createElement("div");n.className="flex flex-col overflow-hidden";const s=document.createElement("div");s.className="truncate font-medium text-gray-200 text-sm mb-1",s.textContent=t.name;const c=document.createElement("div");c.className="text-xs text-gray-400",c.textContent=`${ne(t.size)} • Loading pages...`,n.append(s,c);const o=document.createElement("button");o.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",o.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',o.onclick=()=>{a.files=[],a.pdfDoc=null,T()},r.append(n,o),F.appendChild(r),Y({icons:ee});try{if(!a.pdfDoc){x("Loading PDF...");const i=await te(t);a.pdfDoc=await P.load(i),S()}c.textContent=`${ne(t.size)} • ${a.pdfDoc.getPageCount()} pages`}catch(i){console.error("Error loading PDF:",i),L("Error","Failed to load PDF file."),a.files=[],T();return}}$&&$.classList.remove("hidden")}else F&&(F.innerHTML=""),$&&$.classList.add("hidden"),a.pdfDoc=null},ae=async()=>{if(b)return;const t=document.getElementById("page-selector-grid");if(t){b=!0,t.textContent="",fe(),x("Rendering page previews...");try{if(!a.pdfDoc)if(a.files.length>0){const c=a.files[0],o=await te(c);a.pdfDoc=await P.load(o)}else throw new Error("No PDF document loaded");const r=await a.pdfDoc.save(),n=await ge({data:r}).promise;await ue(n,t,(c,o)=>{const i=document.createElement("div");i.className="page-thumbnail-wrapper p-1 border-2 border-transparent rounded-lg cursor-pointer hover:border-indigo-500 relative",i.dataset.pageIndex=(o-1).toString();const m=document.createElement("img");m.src=c.toDataURL(),m.className="rounded-md w-full h-auto";const g=document.createElement("p");g.className="text-center text-xs mt-1 text-gray-300",g.textContent=`Page ${o}`,i.append(m,g);const E=h=>{h.preventDefault(),h.stopPropagation(),i.classList.contains("selected")?(i.classList.remove("selected","border-indigo-500"),i.classList.add("border-transparent")):(i.classList.add("selected","border-indigo-500"),i.classList.remove("border-transparent"))};return i.addEventListener("click",E),i.addEventListener("touchend",E),i.addEventListener("touchstart",h=>{h.preventDefault()}),i},{batchSize:8,useLazyLoading:!0,lazyLoadMargin:"400px",onProgress:(c,o)=>{x(`Rendering page previews: ${c}/${o}`)},onBatchComplete:()=>{Y({icons:ee})}})}catch(r){console.error("Error rendering visual selector:",r),L("Error","Failed to render page previews."),b=!1}finally{S()}}},M=()=>{a.files=[],a.pdfDoc=null,document.querySelectorAll(".page-thumbnail-wrapper.selected").forEach(c=>{c.classList.remove("selected","border-indigo-500"),c.classList.add("border-transparent")}),b=!1;const t=document.getElementById("page-selector-grid");t&&(t.innerHTML="");const r=document.getElementById("page-range");r&&(r.value="");const n=document.getElementById("split-n-value");n&&(n.value="5");const s=document.querySelector('input[name="split-mode"][value="range"]');s&&(s.checked=!0,s.dispatchEvent(new Event("change"))),B&&(B.value="range",B.dispatchEvent(new Event("change"))),T()},se=async()=>{const t=B.value,r=document.getElementById("download-as-zip")?.checked||!1;x("Splitting PDF...");try{if(!a.pdfDoc)throw new Error("No PDF document loaded.");const n=a.pdfDoc.getPageCount();let s=[];switch(t){case"range":const o=document.getElementById("page-range").value;if(!o)throw new Error("Choose a valid page range.");const i=o.split(","),m=[];for(const e of i){const d=e.trim();if(!d)continue;const p=[];if(d.includes("-")){const[l,f]=d.split("-").map(Number);if(isNaN(l)||isNaN(f)||l<1||f>n||l>f)continue;for(let D=l;D<=f;D++)p.push(D-1)}else{const l=Number(d);if(isNaN(l)||l<1||l>n)continue;p.push(l-1)}p.length>0&&(m.push(p),s.push(...p))}if(m.length>1){x("Creating separate PDFs for each range...");const e=new _;for(let p=0;p<m.length;p++){const l=m[p],f=await P.create();(await f.copyPages(a.pdfDoc,l)).forEach(pe=>f.addPage(pe));const N=await f.save(),u=Math.min(...l)+1,I=Math.max(...l)+1,le=u===I?`page-${u}.pdf`:`pages-${u}-${I}.pdf`;e.file(le,N)}const d=await e.generateAsync({type:"blob"});C(d,"split-pages.zip"),S(),L("Success",`PDF split into ${m.length} files successfully!`,"success",()=>{M()});return}break;case"even-odd":const g=document.querySelector('input[name="even-odd-choice"]:checked');if(!g)throw new Error("Please select even or odd pages.");const E=g.value;for(let e=0;e<n;e++)E==="even"&&(e+1)%2===0&&s.push(e),E==="odd"&&(e+1)%2!==0&&s.push(e);break;case"all":s=Array.from({length:n},(e,d)=>d);break;case"visual":s=Array.from(document.querySelectorAll(".page-thumbnail-wrapper.selected")).map(e=>parseInt(e.dataset.pageIndex||"0"));break;case"bookmarks":const{getCpdf:h}=await he(async()=>{const{getCpdf:e}=await import("./cpdf-helper-CytYNWnN.js");return{getCpdf:e}},[]),v=await h(),oe=await a.pdfDoc.save(),O=v.fromMemory(new Uint8Array(oe),"");v.startGetBookmarkInfo(O);const ie=v.numberBookmarks(),K=document.getElementById("bookmark-level")?.value,y=[];for(let e=0;e<ie;e++){const d=v.getBookmarkLevel(e),p=v.getBookmarkPage(O,e);(K==="all"||d===parseInt(K))&&p>1&&!y.includes(p-1)&&y.push(p-1)}if(v.endGetBookmarkInfo(),v.deletePdf(O),y.length===0)throw new Error("No bookmarks found at the selected level.");y.sort((e,d)=>e-d);const Q=new _;for(let e=0;e<y.length;e++){const d=e===0?0:y[e],p=e<y.length-1?y[e+1]-1:n-1,l=await P.create(),f=Array.from({length:p-d+1},(u,I)=>d+I);(await l.copyPages(a.pdfDoc,f)).forEach(u=>l.addPage(u));const N=await l.save();Q.file(`split-${e+1}.pdf`,N)}const re=await Q.generateAsync({type:"blob"});C(re,"split-by-bookmarks.zip"),S(),L("Success","PDF split successfully!","success",()=>{M()});return;case"n-times":const R=parseInt(document.getElementById("split-n-value")?.value||"5");if(R<1)throw new Error("N must be at least 1.");const X=new _,ce=Math.ceil(n/R);for(let e=0;e<ce;e++){const d=e*R,p=Math.min(d+R-1,n-1),l=Array.from({length:p-d+1},(u,I)=>d+I),f=await P.create();(await f.copyPages(a.pdfDoc,l)).forEach(u=>f.addPage(u));const N=await f.save();X.file(`split-${e+1}.pdf`,N)}const de=await X.generateAsync({type:"blob"});C(de,"split-n-times.zip"),S(),L("Success","PDF split successfully!","success",()=>{M()});return}const c=[...new Set(s)];if(c.length===0&&t!=="bookmarks"&&t!=="n-times")throw new Error("No pages were selected for splitting.");if(t==="all"||["range","visual"].includes(t)&&r){x("Creating ZIP file...");const o=new _;for(const m of c){const g=await P.create(),[E]=await g.copyPages(a.pdfDoc,[m]);g.addPage(E);const h=await g.save();o.file(`page-${m+1}.pdf`,h)}const i=await o.generateAsync({type:"blob"});C(i,"split-pages.zip")}else{const o=await P.create();(await o.copyPages(a.pdfDoc,c)).forEach(g=>o.addPage(g));const m=await o.save();C(new Blob([new Uint8Array(m)],{type:"application/pdf"}),"split-document.pdf")}t==="visual"&&(b=!1),L("Success","PDF split successfully!","success",()=>{M()})}catch(n){console.error(n),L("Error",n.message||"Failed to split PDF. Please check your selection.")}finally{S()}},j=async t=>{t&&t.length>0&&(a.files=[t[0]],await T())};A&&w&&(A.addEventListener("change",t=>{j(t.target.files)}),w.addEventListener("dragover",t=>{t.preventDefault(),w.classList.add("bg-gray-700")}),w.addEventListener("dragleave",t=>{t.preventDefault(),w.classList.remove("bg-gray-700")}),w.addEventListener("drop",t=>{t.preventDefault(),w.classList.remove("bg-gray-700");const r=t.dataTransfer?.files;if(r){const n=Array.from(r).filter(s=>s.type==="application/pdf"||s.name.toLowerCase().endsWith(".pdf"));if(n.length>0){const s=new DataTransfer;s.items.add(n[0]),j(s.files)}}}),A.addEventListener("click",()=>{A.value=""})),B&&B.addEventListener("change",t=>{const r=t.target.value;if(r!=="visual"){b=!1;const n=document.getElementById("page-selector-grid");n&&(n.innerHTML="")}if(G?.classList.add("hidden"),H?.classList.add("hidden"),U?.classList.add("hidden"),V?.classList.add("hidden"),Z?.classList.add("hidden"),J?.classList.add("hidden"),z?.classList.add("hidden"),k&&k.classList.add("hidden"),r==="range")G?.classList.remove("hidden"),z?.classList.remove("hidden");else if(r==="visual")H?.classList.remove("hidden"),z?.classList.remove("hidden"),ae();else if(r==="even-odd")U?.classList.remove("hidden");else if(r==="all")V?.classList.remove("hidden");else if(r==="bookmarks")Z?.classList.remove("hidden"),z?.classList.remove("hidden");else if(r==="n-times"){J?.classList.remove("hidden"),z?.classList.remove("hidden");const n=()=>{if(!a.pdfDoc)return;const s=a.pdfDoc.getPageCount(),c=parseInt(document.getElementById("split-n-value")?.value||"5"),o=s%c;if(o!==0&&k){k.classList.remove("hidden");const i=document.getElementById("n-times-warning-text");i&&(i.textContent=`The PDF has ${s} pages, which is not evenly divisible by ${c}. The last PDF will contain ${o} page(s).`)}else k&&k.classList.add("hidden")};n(),document.getElementById("split-n-value")?.addEventListener("input",n)}}),W&&W.addEventListener("click",se)});
