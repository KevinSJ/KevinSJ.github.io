import{c as x,i as L}from"./style-CYUbkObH.js";import"./version-BHeJdyYx.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-Q5E4PlzL.js";import{G as B,a as f,b,r as D,P as E,e as P,d as I,h as F,f as h}from"./main-DWubsKaN.js";import"./mobileMenu-BoMunYmR.js";B.workerSrc=new URL("/bentopdf/assets/pdf.worker.min-LyOxJPrg.mjs",import.meta.url).toString();let m=[];const y=()=>{const t=document.getElementById("file-display-area"),a=document.getElementById("options-panel"),g=document.getElementById("drop-zone");!t||!a||!g||(t.innerHTML="",m.length>0?(a.classList.remove("hidden"),m.forEach(r=>{const i=document.createElement("div");i.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const e=document.createElement("div");e.className="flex flex-col overflow-hidden";const c=document.createElement("div");c.className="truncate font-medium text-gray-200 text-sm mb-1",c.textContent=r.name;const d=document.createElement("div");d.className="text-xs text-gray-400",d.textContent=`${h(r.size)} • Loading pages...`,e.append(c,d);const o=document.createElement("button");o.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",o.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',o.onclick=()=>{m=[],y()},i.append(e,o),t.appendChild(i),D(r).then(n=>P(n).promise).then(n=>{d.textContent=`${h(r.size)} • ${n.numPages} page${n.numPages!==1?"s":""}`}).catch(n=>{console.warn("Error loading PDF page count:",n),d.textContent=h(r.size)})}),x({icons:L})):a.classList.add("hidden"))},k=()=>{m=[];const t=document.getElementById("file-input");t&&(t.value=""),y()};async function C(){if(m.length===0){f("No File","Please upload a PDF file first.");return}b("Converting to greyscale...");try{const t=await D(m[0]),g=(await E.load(t)).getPages(),r=await P({data:t}).promise,i=await E.create();for(let c=1;c<=r.numPages;c++){const d=await r.getPage(c),o=d.getViewport({scale:2}),n=document.createElement("canvas"),u=n.getContext("2d");n.height=o.height,n.width=o.width,await d.render({canvasContext:u,viewport:o,canvas:n}).promise;const v=u.getImageData(0,0,n.width,n.height),l=v.data;for(let s=0;s<l.length;s+=4){const p=Math.round(.299*l[s]+.587*l[s+1]+.114*l[s+2]);l[s]=p,l[s+1]=p,l[s+2]=p}u.putImageData(v,0,0);const w=await new Promise(s=>n.toBlob(s,"image/jpeg",.9));if(w){const s=await w.arrayBuffer(),p=await i.embedJpg(s);i.addPage([o.width,o.height]).drawImage(p,{x:0,y:0,width:o.width,height:o.height})}}const e=await i.save();I(new Blob([new Uint8Array(e)],{type:"application/pdf"}),"greyscale.pdf"),f("Success","PDF converted to greyscale successfully!","success",()=>{k()})}catch(t){console.error(t),f("Error","Failed to convert PDF to greyscale. The file might be corrupted.")}finally{F()}}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("file-input"),a=document.getElementById("drop-zone"),g=document.getElementById("process-btn"),r=document.getElementById("back-to-tools");r&&r.addEventListener("click",()=>{window.location.href="/bentopdf/"});const i=e=>{if(!e||e.length===0)return;const c=Array.from(e).filter(d=>d.type==="application/pdf");if(c.length===0){f("Invalid File","Please upload a PDF file.");return}m=[c[0]],y()};t&&a&&(t.addEventListener("change",e=>{i(e.target.files)}),a.addEventListener("dragover",e=>{e.preventDefault(),a.classList.add("bg-gray-700")}),a.addEventListener("dragleave",e=>{e.preventDefault(),a.classList.remove("bg-gray-700")}),a.addEventListener("drop",e=>{e.preventDefault(),a.classList.remove("bg-gray-700"),i(e.dataTransfer?.files??null)}),t.addEventListener("click",()=>{t.value=""})),g&&g.addEventListener("click",C)});
