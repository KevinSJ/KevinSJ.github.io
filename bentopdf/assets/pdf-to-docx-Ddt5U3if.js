const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jszip.min-3IPKxw9h.js","assets/main-DWubsKaN.js","assets/style-CYUbkObH.js","assets/style-BSB0ervv.css","assets/_commonjs-dynamic-modules-TDtrdbi3.js"])))=>i.map(i=>d[i]);
import{c as $,i as F}from"./style-CYUbkObH.js";import"./version-BHeJdyYx.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-Q5E4PlzL.js";import{n as P,o as k,s as n,a as u,b as m,d as I,h as L,_ as A,f as x,r as N,e as z}from"./main-DWubsKaN.js";import"./mobileMenu-BoMunYmR.js";const B=new P(k("pymupdf"));document.addEventListener("DOMContentLoaded",()=>{const c=document.getElementById("file-input"),i=document.getElementById("drop-zone"),d=document.getElementById("process-btn"),p=document.getElementById("file-display-area"),g=document.getElementById("convert-options"),v=document.getElementById("file-controls"),b=document.getElementById("add-more-btn"),w=document.getElementById("clear-files-btn"),C=document.getElementById("back-to-tools");C&&C.addEventListener("click",()=>{window.location.href="/bentopdf/"});const y=async()=>{if(!(!p||!g||!d||!v))if(n.files.length>0){p.innerHTML="";for(let e=0;e<n.files.length;e++){const t=n.files[e],s=document.createElement("div");s.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const a=document.createElement("div");a.className="flex flex-col overflow-hidden";const o=document.createElement("div");o.className="truncate font-medium text-gray-200 text-sm mb-1",o.textContent=t.name;const r=document.createElement("div");r.className="text-xs text-gray-400",r.textContent=`${x(t.size)} • Loading pages...`,a.append(o,r);const l=document.createElement("button");l.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",l.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',l.onclick=()=>{n.files=n.files.filter((f,E)=>E!==e),y()},s.append(a,l),p.appendChild(s);try{const f=await N(t),E=await z({data:f}).promise;r.textContent=`${x(t.size)} • ${E.numPages} pages`}catch{r.textContent=`${x(t.size)} • Could not load page count`}}$({icons:F}),v.classList.remove("hidden"),g.classList.remove("hidden"),d.disabled=!1}else p.innerHTML="",v.classList.add("hidden"),g.classList.add("hidden"),d.disabled=!0},h=()=>{n.files=[],n.pdfDoc=null,y()},_=async()=>{try{if(n.files.length===0){u("No Files","Please select at least one PDF file.");return}if(m("Loading PDF converter..."),await B.load(),n.files.length===1){const e=n.files[0];m(`Converting ${e.name}...`);const t=await B.pdfToDocx(e),s=e.name.replace(/\.pdf$/i,"")+".docx";I(t,s),L(),u("Conversion Complete",`Successfully converted ${e.name} to DOCX.`,"success",()=>h())}else{m("Converting multiple PDFs...");const e=(await A(async()=>{const{default:a}=await import("./jszip.min-3IPKxw9h.js").then(o=>o.j);return{default:a}},__vite__mapDeps([0,1,2,3,4]))).default,t=new e;for(let a=0;a<n.files.length;a++){const o=n.files[a];m(`Converting ${a+1}/${n.files.length}: ${o.name}...`);const r=await B.pdfToDocx(o),l=o.name.replace(/\.pdf$/i,""),f=await r.arrayBuffer();t.file(`${l}.docx`,f)}m("Creating ZIP archive...");const s=await t.generateAsync({type:"blob"});I(s,"converted-documents.zip"),L(),u("Conversion Complete",`Successfully converted ${n.files.length} PDF(s) to DOCX.`,"success",()=>h())}}catch(e){L(),u("Error",`An error occurred during conversion. Error: ${e.message}`)}},D=e=>{if(e&&e.length>0){const t=Array.from(e).filter(s=>s.type==="application/pdf"||s.name.toLowerCase().endsWith(".pdf"));n.files=[...n.files,...t],y()}};c&&i&&(c.addEventListener("change",e=>{D(e.target.files)}),i.addEventListener("dragover",e=>{e.preventDefault(),i.classList.add("bg-gray-700")}),i.addEventListener("dragleave",e=>{e.preventDefault(),i.classList.remove("bg-gray-700")}),i.addEventListener("drop",e=>{e.preventDefault(),i.classList.remove("bg-gray-700");const t=e.dataTransfer?.files;t&&t.length>0&&D(t)}),c.addEventListener("click",()=>{c.value=""})),b&&b.addEventListener("click",()=>{c.click()}),w&&w.addEventListener("click",()=>{h()}),d&&d.addEventListener("click",_)});
