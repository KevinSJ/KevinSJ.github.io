const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jszip.min-3IPKxw9h.js","assets/main-DWubsKaN.js","assets/style-CYUbkObH.js","assets/style-BSB0ervv.css","assets/_commonjs-dynamic-modules-TDtrdbi3.js"])))=>i.map(i=>d[i]);
import{c as $,i as D}from"./style-CYUbkObH.js";import"./version-BHeJdyYx.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-Q5E4PlzL.js";import{s as t,a as u,b as f,d as x,h as E,_ as N,f as P}from"./main-DWubsKaN.js";import{g as T}from"./libreoffice-loader-CCIf03AR.js";import"./mobileMenu-BoMunYmR.js";const k=[".wps"],L="WPS";document.addEventListener("DOMContentLoaded",()=>{t.files=[];const c=document.getElementById("file-input"),l=document.getElementById("drop-zone"),v=document.getElementById("convert-options"),d=document.getElementById("file-display-area"),m=document.getElementById("file-controls"),h=document.getElementById("add-more-btn"),y=document.getElementById("clear-files-btn"),b=document.getElementById("back-to-tools"),w=document.getElementById("process-btn");b&&b.addEventListener("click",()=>{window.location.href="/bentopdf/"});const p=async()=>{if(v)if(t.files.length>0){if(d){d.innerHTML="";for(let e=0;e<t.files.length;e++){const n=t.files[e],s=document.createElement("div");s.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const i=document.createElement("div");i.className="flex flex-col overflow-hidden";const o=document.createElement("div");o.className="truncate font-medium text-gray-200 text-sm mb-1",o.textContent=n.name;const a=document.createElement("div");a.className="text-xs text-gray-400",a.textContent=P(n.size),i.append(o,a);const r=document.createElement("button");r.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",r.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',r.onclick=()=>{t.files=t.files.filter((C,I)=>I!==e),p()},s.append(i,r),d.appendChild(s)}$({icons:D})}m&&m.classList.remove("hidden"),v.classList.remove("hidden")}else d&&(d.innerHTML=""),m&&m.classList.add("hidden"),v.classList.add("hidden")},g=()=>{t.files=[],p()},_=async()=>{if(t.files.length===0){u("No Files",`Please select at least one ${L} file.`);return}try{const e=T();if(f("Loading engine..."),await e.initialize(n=>{f(n.message,n.percent)}),t.files.length===1){const n=t.files[0];f(`Converting ${n.name}...`);const s=await e.convertToPdf(n),i=n.name.replace(/\.[^/.]+$/,"");x(s,`${i}.pdf`),E(),u("Conversion Complete",`Successfully converted ${n.name} to PDF.`,"success",()=>g())}else{f("Converting multiple files...");const n=(await N(async()=>{const{default:o}=await import("./jszip.min-3IPKxw9h.js").then(a=>a.j);return{default:o}},__vite__mapDeps([0,1,2,3,4]))).default,s=new n;for(let o=0;o<t.files.length;o++){const a=t.files[o];f(`Converting ${o+1}/${t.files.length}: ${a.name}...`);const r=await e.convertToPdf(a),C=a.name.replace(/\.[^/.]+$/,"");s.file(`${C}.pdf`,r)}const i=await s.generateAsync({type:"blob"});x(i,`${L.toLowerCase()}-to-pdf.zip`),E(),u("Conversion Complete",`Successfully converted ${t.files.length} files to PDF.`,"success",()=>g())}}catch(e){E(),console.error(`[${L}ToPDF] Error:`,e),u("Error",`An error occurred during conversion. Error: ${e.message}`)}},B=e=>{if(e&&e.length>0){const n=Array.from(e).filter(s=>{const i="."+s.name.split(".").pop()?.toLowerCase();return k.includes(i)});n.length>0&&(t.files=[...t.files,...n],p())}};c&&l&&(c.addEventListener("change",e=>{B(e.target.files)}),l.addEventListener("dragover",e=>{e.preventDefault(),l.classList.add("bg-gray-700")}),l.addEventListener("dragleave",e=>{e.preventDefault(),l.classList.remove("bg-gray-700")}),l.addEventListener("drop",e=>{e.preventDefault(),l.classList.remove("bg-gray-700"),B(e.dataTransfer?.files??null)}),c.addEventListener("click",()=>{c.value=""})),h&&h.addEventListener("click",()=>c.click()),y&&y.addEventListener("click",g),w&&w.addEventListener("click",_),p()});
