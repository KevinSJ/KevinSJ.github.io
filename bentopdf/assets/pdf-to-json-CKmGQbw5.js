import"./style-CNx3HTbi.js";import{J as h}from"./jszip.min-DMkQATzN.js";import{d as b,f as y,r as E}from"./main-Dqs2Ohqn.js";import{i as w}from"./shortcuts-init-C3Q6CKFj.js";import"./version-D4ympJL5.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-ODFatrFN.js";import"./mobileMenu-BoMunYmR.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";const d=new Worker("/bentopdf/workers/pdf-to-json.worker.js");let n=[];const f=document.getElementById("pdfFiles"),a=document.getElementById("convertBtn"),l=document.getElementById("status-message"),o=document.getElementById("fileList"),c=document.getElementById("back-to-tools");function r(t,e="info"){l.textContent=t,l.className=`mt-4 p-3 rounded-lg text-sm ${e==="success"?"bg-green-900 text-green-200":e==="error"?"bg-red-900 text-red-200":"bg-blue-900 text-blue-200"}`,l.classList.remove("hidden")}function v(){l.classList.add("hidden")}function k(){if(o.innerHTML="",n.length===0){o.classList.add("hidden");return}o.classList.remove("hidden"),n.forEach(t=>{const e=document.createElement("div");e.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm mb-2";const s=document.createElement("span");s.className="truncate font-medium text-gray-200",s.textContent=t.name;const i=document.createElement("span");i.className="flex-shrink-0 ml-4 text-gray-400",i.textContent=y(t.size),e.append(s,i),o.appendChild(e)})}f.addEventListener("change",t=>{const e=t.target;e.files&&e.files.length>0&&(n=Array.from(e.files),a.disabled=n.length===0,k(),n.length===0?r("Please select at least 1 PDF file","info"):r(`${n.length} file(s) selected. Ready to convert!`,"info"))});async function F(){if(n.length===0){r("Please select at least 1 PDF file","error");return}try{a.disabled=!0,r("Reading files (Main Thread)...","info");const t=await Promise.all(n.map(e=>E(e)));r("Converting PDFs to JSON..","info"),d.postMessage({command:"convert",fileBuffers:t,fileNames:n.map(e=>e.name)},t)}catch(t){console.error("Error reading files:",t),r(`❌ Error reading files: ${t instanceof Error?t.message:"Unknown error"}`,"error"),a.disabled=!1}}d.onmessage=async t=>{if(a.disabled=!1,t.data.status==="success"){const e=t.data.jsonFiles;try{r("Creating ZIP file...","info");const s=new h;e.forEach(({name:m,data:u})=>{const g=m.replace(/\.pdf$/i,".json"),p=new Uint8Array(u);s.file(g,p)});const i=await s.generateAsync({type:"blob"});b(i,"pdfs-to-json.zip"),r("✅ PDFs converted to JSON successfully! ZIP download started.","success"),n=[],f.value="",o.innerHTML="",o.classList.add("hidden"),a.disabled=!0,setTimeout(()=>{v()},3e3)}catch(s){console.error("Error creating ZIP:",s),r(`❌ Error creating ZIP: ${s instanceof Error?s.message:"Unknown error"}`,"error")}}else if(t.data.status==="error"){const e=t.data.message||"Unknown error occurred in worker.";console.error("Worker Error:",e),r(`❌ Worker Error: ${e}`,"error")}};c&&c.addEventListener("click",()=>{window.location.href="/bentopdf/"});a.addEventListener("click",F);r("Select PDF files to get started","info");w();
