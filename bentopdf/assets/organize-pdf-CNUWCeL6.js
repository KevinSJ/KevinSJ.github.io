import{c as m,i as p}from"./style-CYUbkObH.js";import"./version-BHeJdyYx.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-Q5E4PlzL.js";import{G as B,a as l,b as x,r as C,P as L,e as F,h as g,f as S,k as N,d as k}from"./main-DWubsKaN.js";import"./mobileMenu-BoMunYmR.js";B.workerSrc=new URL("/bentopdf/assets/pdf.worker.min-LyOxJPrg.mjs",import.meta.url).toString();const n={file:null,pdfDoc:null,pdfJsDoc:null,totalPages:0,sortableInstance:null};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",E):E();function E(){m({icons:p});const e=document.getElementById("file-input"),t=document.getElementById("drop-zone"),o=document.getElementById("process-btn");e&&e.addEventListener("change",T),t&&(t.addEventListener("dragover",a=>{a.preventDefault(),t.classList.add("bg-gray-700")}),t.addEventListener("dragleave",()=>{t.classList.remove("bg-gray-700")}),t.addEventListener("drop",a=>{a.preventDefault(),t.classList.remove("bg-gray-700");const r=a.dataTransfer?.files;r&&r.length>0&&P(r[0])}),e?.addEventListener("click",()=>{e&&(e.value="")})),o&&o.addEventListener("click",M),document.getElementById("back-to-tools")?.addEventListener("click",()=>{window.location.href="/bentopdf/"})}function T(e){const t=e.target;t.files&&t.files.length>0&&P(t.files[0])}async function P(e){if(e.type!=="application/pdf"&&!e.name.toLowerCase().endsWith(".pdf")){l("Invalid File","Please select a PDF file.");return}x("Loading PDF..."),n.file=e;try{const t=await C(e);n.pdfDoc=await L.load(t,{ignoreEncryption:!0,throwOnInvalidObject:!1}),n.pdfJsDoc=await F({data:t.slice(0)}).promise,n.totalPages=n.pdfDoc.getPageCount(),j(),await A(),g()}catch(t){console.error("Error loading PDF:",t),g(),l("Error","Failed to load PDF file.")}}function j(){const e=document.getElementById("file-display-area");if(!e||!n.file)return;e.innerHTML="";const t=document.createElement("div");t.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg";const o=document.createElement("div");o.className="flex flex-col flex-1 min-w-0";const a=document.createElement("div");a.className="truncate font-medium text-gray-200 text-sm mb-1",a.textContent=n.file.name;const r=document.createElement("div");r.className="text-xs text-gray-400",r.textContent=`${S(n.file.size)} â€¢ ${n.totalPages} pages`,o.append(a,r);const i=document.createElement("button");i.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",i.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',i.onclick=()=>I(),t.append(o,i),e.appendChild(t),m({icons:p})}function w(){const e=document.getElementById("page-grid");if(!e)return;e.querySelectorAll(".page-number").forEach((o,a)=>{o.textContent=(a+1).toString()})}function D(e){const t=e.querySelector(".duplicate-btn"),o=e.querySelector(".delete-btn");t?.addEventListener("click",a=>{a.stopPropagation();const r=e.cloneNode(!0);e.after(r),D(r),w(),m({icons:p}),v()}),o?.addEventListener("click",a=>{a.stopPropagation();const r=document.getElementById("page-grid");r&&r.children.length>1?(e.remove(),w(),v()):l("Cannot Delete","You cannot delete the last page of the document.")})}async function A(){const e=document.getElementById("page-grid"),t=document.getElementById("process-btn");if(e){e.innerHTML="",e.classList.remove("hidden"),t?.classList.remove("hidden");for(let o=1;o<=n.totalPages;o++){const a=await n.pdfJsDoc.getPage(o),r=a.getViewport({scale:.5}),i=document.createElement("canvas");i.width=r.width,i.height=r.height;const u=i.getContext("2d");await a.render({canvasContext:u,viewport:r}).promise;const s=document.createElement("div");s.className="page-thumbnail relative cursor-move flex flex-col items-center gap-2",s.dataset.originalPageIndex=(o-1).toString();const f=document.createElement("div");f.className="w-full h-36 bg-gray-900 rounded-lg flex items-center justify-center overflow-hidden border-2 border-gray-600";const y=document.createElement("img");y.src=i.toDataURL(),y.className="max-w-full max-h-full object-contain",f.appendChild(y);const h=document.createElement("span");h.className="page-number absolute top-1 left-1 bg-gray-900 bg-opacity-75 text-white text-xs rounded-full px-2 py-1",h.textContent=o.toString();const b=document.createElement("div");b.className="flex items-center justify-center gap-4";const c=document.createElement("button");c.className="duplicate-btn bg-green-600 hover:bg-green-700 text-white rounded-full w-8 h-8 flex items-center justify-center",c.title="Duplicate Page",c.innerHTML='<i data-lucide="copy-plus" class="w-5 h-5"></i>';const d=document.createElement("button");d.className="delete-btn bg-red-600 hover:bg-red-700 text-white rounded-full w-8 h-8 flex items-center justify-center",d.title="Delete Page",d.innerHTML='<i data-lucide="x-circle" class="w-5 h-5"></i>',b.append(c,d),s.append(f,h,b),e.appendChild(s),D(s)}m({icons:p}),v()}}function v(){const e=document.getElementById("page-grid");e&&(n.sortableInstance&&n.sortableInstance.destroy(),n.sortableInstance=N.create(e,{animation:150,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",filter:".duplicate-btn, .delete-btn",preventOnFilter:!0,onStart:t=>{t.item&&(t.item.style.opacity="0.5")},onEnd:t=>{t.item&&(t.item.style.opacity="1")}}))}async function M(){x("Building new PDF...");try{const e=document.getElementById("page-grid");if(!e)return;const t=e.querySelectorAll(".page-thumbnail"),o=Array.from(t).map(s=>parseInt(s.dataset.originalPageIndex||"",10)).filter(s=>!isNaN(s)&&s>=0);if(o.length===0){l("Error","No valid pages to save.");return}const a=await L.create();(await a.copyPages(n.pdfDoc,o)).forEach(s=>a.addPage(s));const i=await a.save(),u=n.file?.name.replace(".pdf","")||"document";k(new Blob([i],{type:"application/pdf"}),`${u}_organized.pdf`),g(),l("Success","PDF organized successfully!","success",()=>I())}catch(e){console.error("Error saving changes:",e),g(),l("Error","Failed to save changes.")}}function I(){n.sortableInstance&&(n.sortableInstance.destroy(),n.sortableInstance=null),n.file=null,n.pdfDoc=null,n.pdfJsDoc=null,n.totalPages=0;const e=document.getElementById("page-grid");e&&(e.innerHTML="",e.classList.add("hidden")),document.getElementById("process-btn")?.classList.add("hidden");const t=document.getElementById("file-display-area");t&&(t.innerHTML="")}
