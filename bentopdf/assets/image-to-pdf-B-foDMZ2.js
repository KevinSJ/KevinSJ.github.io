import{c as h,i as v}from"./style-CYUbkObH.js";import"./version-BHeJdyYx.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-Q5E4PlzL.js";import{a as p,f as L,b as g,d as b,h as F,n as x,o as I}from"./main-DWubsKaN.js";import{h as B}from"./heic2any-DMuJvAhl.js";import"./mobileMenu-BoMunYmR.js";const y=".jpg,.jpeg,.png,.bmp,.gif,.tiff,.tif,.pnm,.pgm,.pbm,.ppm,.pam,.jxr,.jpx,.jp2,.psd,.svg,.heic,.heif,.webp",D="JPG, PNG, BMP, GIF, TIFF, PNM, PGM, PBM, PPM, PAM, JXR, JPX, JP2, PSD, SVG, HEIC, WebP";let c=[],m=null;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u();function u(){h({icons:v});const e=document.getElementById("file-input"),t=document.getElementById("drop-zone"),n=document.getElementById("add-more-btn"),a=document.getElementById("clear-files-btn"),o=document.getElementById("process-btn"),i=document.getElementById("supported-formats");i&&(i.textContent=D),e&&(e.accept=y,e.addEventListener("change",C)),t&&(t.addEventListener("dragover",s=>{s.preventDefault(),t.classList.add("bg-gray-700")}),t.addEventListener("dragleave",()=>{t.classList.remove("bg-gray-700")}),t.addEventListener("drop",s=>{s.preventDefault(),t.classList.remove("bg-gray-700");const r=s.dataTransfer?.files;r&&r.length>0&&w(r)}),e?.addEventListener("click",()=>{e&&(e.value="")})),n&&n.addEventListener("click",()=>{e?.click()}),a&&a.addEventListener("click",()=>{c=[],f()}),o&&o.addEventListener("click",U),document.getElementById("back-to-tools")?.addEventListener("click",()=>{window.location.href="/bentopdf/"})}function C(e){const t=e.target;t.files&&t.files.length>0&&w(t.files)}function E(e){return"."+e.split(".").pop()?.toLowerCase()||""}function k(e){const t=E(e.name);return y.split(",").includes(t)||e.type.startsWith("image/")}function w(e){const t=Array.from(e).filter(k);t.length<e.length&&p("Invalid Files","Some files were skipped. Only supported image formats are allowed."),t.length>0&&(c=[...c,...t],f())}const M=()=>{c=[],f()};function f(){const e=document.getElementById("file-display-area"),t=document.getElementById("file-controls"),n=document.getElementById("jpg-to-pdf-options");!e||!t||!n||(e.innerHTML="",c.length>0?(t.classList.remove("hidden"),n.classList.remove("hidden"),c.forEach((a,o)=>{const i=document.createElement("div");i.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const s=document.createElement("div");s.className="flex items-center gap-2 overflow-hidden";const r=document.createElement("span");r.className="truncate font-medium text-gray-200",r.textContent=a.name;const d=document.createElement("span");d.className="flex-shrink-0 text-gray-400 text-xs",d.textContent=`(${L(a.size)})`,s.append(r,d);const l=document.createElement("button");l.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",l.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',l.onclick=()=>{c=c.filter((T,P)=>P!==o),f()},i.append(s,l),e.appendChild(i)}),h({icons:v})):(t.classList.add("hidden"),n.classList.add("hidden")))}async function R(){return m||(m=new x(I("pymupdf")),await m.load()),m}async function S(e){const t=E(e.name);if(t===".heic"||t===".heif")try{const n=await B({blob:e,toType:"image/png",quality:.9}),a=Array.isArray(n)?n[0]:n;return new File([a],e.name.replace(/\.(heic|heif)$/i,".png"),{type:"image/png"})}catch(n){throw console.error(`Failed to convert HEIC: ${e.name}`,n),new Error(`Failed to process HEIC file: ${e.name}`)}if(t===".webp")try{return await new Promise((n,a)=>{const o=new Image,i=URL.createObjectURL(e);o.onload=()=>{const s=document.createElement("canvas");s.width=o.width,s.height=o.height;const r=s.getContext("2d");if(!r){URL.revokeObjectURL(i),a(new Error("Canvas context failed"));return}r.drawImage(o,0,0),s.toBlob(d=>{URL.revokeObjectURL(i),d?n(new File([d],e.name.replace(/\.webp$/i,".png"),{type:"image/png"})):a(new Error("Canvas toBlob failed"))},"image/png")},o.onerror=()=>{URL.revokeObjectURL(i),a(new Error("Failed to load WebP image"))},o.src=i})}catch(n){throw console.error(`Failed to convert WebP: ${e.name}`,n),new Error(`Failed to process WebP file: ${e.name}`)}return e}async function U(){if(c.length===0){p("No Files","Please select at least one image file.");return}g("Processing images...");try{const e=[];for(const a of c)try{const o=await S(a);e.push(o)}catch(o){throw console.warn(o),o}g("Loading engine...");const t=await R();g("Converting images to PDF...");const n=await t.imagesToPdf(e);b(n,"images_to_pdf.pdf"),p("Success","PDF created successfully!","success",()=>{M()})}catch(e){console.error("[ImageToPDF]",e),p("Conversion Error",e.message||"Failed to convert images to PDF.")}finally{F()}}
