<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 8.1.1">
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="9g-E_K0GEppNWOItj0YYJV_1UbSLdVFrKOhHSPLkJcM">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"jiangsc.me","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.26.0","exturl":true,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="In the context of this article, both Android and iOS project means native iOS and Android project, written in Swift or Kotlin. It may work with Flutter or similar technology with some tuning, but the">
<meta property="og:type" content="blog">
<meta property="og:title" content="Building and Deploying Apps From CLI">
<meta property="og:url" content="https://jiangsc.me/2025/02/08/mobile-dev-cli-tips-2/index.html">
<meta property="og:site_name" content="Kevin Jiang&#39;s Technical Blog">
<meta property="og:description" content="In the context of this article, both Android and iOS project means native iOS and Android project, written in Swift or Kotlin. It may work with Flutter or similar technology with some tuning, but the">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-02-08T04:33:58.000Z">
<meta property="article:modified_time" content="2025-12-20T02:47:45.461Z">
<meta property="article:author" content="Kevin Jiang">
<meta property="article:tag" content="Android">
<meta property="article:tag" content="CLI">
<meta property="article:tag" content="Command line">
<meta property="article:tag" content="Moible App Development">
<meta property="article:tag" content="iOS">
<meta property="article:tag" content="tips">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://jiangsc.me/2025/02/08/mobile-dev-cli-tips-2/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://jiangsc.me/2025/02/08/mobile-dev-cli-tips-2/","path":"2025/02/08/mobile-dev-cli-tips-2/","title":"Building and Deploying Apps From CLI"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Building and Deploying Apps From CLI | Kevin Jiang's Technical Blog</title>
  






  <script async defer data-website-id="c4ed80eb-6e46-4603-a114-34b3a0f3eb10" src="https://u-a.jiangsc.me/script.js"></script>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  
  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.3.1/pdfobject.min.js","integrity":"sha256-jI72I8ZLVflVOisZIOaLvRew3tyvzeu6aZXFm7P7dEo="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js" defer></script>

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.10.1/mermaid.min.js","integrity":"sha256-BmQmdWDS8X2OTbrwELWK366LV6escyWhHHe0XCTU/Hk="}}</script>
  <script src="/js/third-party/tags/mermaid.js" defer></script>





  

  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/12.2.1/firebase-app-compat.js" integrity="sha256-d21UgtIcA6c6qwr8nWk6lxs/KrpbWhknQN7qBjWA2Kk=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/12.2.1/firebase-firestore-compat.js" integrity="sha256-leHatffkFuVGIg7ABaA5BDsqsEUtktL4tftb3OdQfg0=" crossorigin="anonymous" defer></script>
  <script class="next-config" data-name="firestore" type="application/json">{"enable":true,"collection":"blog_view","apiKey":"AIzaSyAwkI10aTDM2430EyQhtAz5X04hk16ozRc","projectId":"blog-269be"}</script>
  <script src="/js/third-party/statistics/firestore.js" defer></script>




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Kevin Jiang's Technical Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Kevin Jiang's Technical Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-gallery"><a href="/gallery/" rel="section"><i class="fa fa-image fa-fw"></i>Gallery</a></li><li class="menu-item menu-item-notes"><a href="/notes/" rel="section"><i class="fa fa-book fa-fw"></i>Notes</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#What"><span class="nav-number">1.</span> <span class="nav-text">What?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#How"><span class="nav-number">2.</span> <span class="nav-text">How?</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Detect-the-project-type-based-on-certain-criteria"><span class="nav-number">2.1.</span> <span class="nav-text">Detect the project type based on certain criteria</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Build-the-project-from-source"><span class="nav-number">2.2.</span> <span class="nav-text">Build the project from source</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Run-a-Simulator-Emulator"><span class="nav-number">2.3.</span> <span class="nav-text">Run a Simulator&#x2F;Emulator</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Deploy-and-launch-the-app-to-the-running-Simulator-Emulator"><span class="nav-number">2.4.</span> <span class="nav-text">Deploy and launch the app to the running Simulator&#x2F;Emulator</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Put-it-all-together"><span class="nav-number">3.</span> <span class="nav-text">Put it all together</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Kevin Jiang</p>
  <div class="site-description" itemprop="description">A blog about all things tech.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">50</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">123</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tldmluc2o=" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kevinsj"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL2tldnNq" title="LinkedIn → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;kevsj"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRsYWIuY29tL2tldmluc2o=" title="GitLab → https:&#x2F;&#x2F;gitlab.com&#x2F;kevinsj"><i class="fab fa-gitlab fa-fw"></i>GitLab</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jiangsc.me/2025/02/08/mobile-dev-cli-tips-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Kevin Jiang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kevin Jiang's Technical Blog">
      <meta itemprop="description" content="A blog about all things tech.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Building and Deploying Apps From CLI | Kevin Jiang's Technical Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Building and Deploying Apps From CLI
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 02-08-2025 17:33:58" itemprop="dateCreated datePublished" datetime="2025-02-08T17:33:58+13:00">02-08-2025</time>
    </span>

  
    <span class="post-meta-item" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="firestore-visitors-count"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><div class="note info"><p>In the context of this article, both Android and iOS project means native iOS and Android project, written in Swift or Kotlin. It may work with Flutter or similar technology with some tuning, but the author had no working experience no technology working with those technology at the time of writing.</p>
</div>

<p>Quite often in my daily work, I need to run both the iOS simulator and Android emulator at the same time. This would normally mean I would have to have both XCode and Android Studio open and running. Though I&#39;m on a MacBook Pro with M1 Pro chip, the fact I need to open <strong>two very heavy IDEs</strong> at the same time plus two simulators is something I would rather not do. What&#39;s worse, I need to interact with both IDE to rebuild and redeploy the application to the simulator every time I switch the branch. Eventually, I decided to spend time and investigate how to automate this process.</p>
<span id="more"></span>

<h3 id="What"><a href="#What" class="headerlink" title="What?"></a>What?</h3><p>Before we go into the investigation, it is important to define the goal first. The goal here, is <strong>automate the process of building iOS&#x2F;Android app from source using command line and deploy the application to the iOS&#x2F;Android simulator separately</strong>.</p>
<p>To break it down to smaller steps, the automation we want to create, should</p>
<ol>
<li>Detect the project type based on certain criteria;</li>
<li>Build the project from source;</li>
<li>Turn on a Simulator&#x2F;Emulator;</li>
<li>Deploy the project to the running Simulator&#x2F;Emulator;</li>
<li>Launch the running program;</li>
</ol>
<p>This looks like an ambitious project, but it is achievable. However, I have to admit I spent quite a lot of time optimizing and rewriting what I created in order to achieve what I outlined above.</p>
<h3 id="How"><a href="#How" class="headerlink" title="How?"></a>How?</h3><p>For clarity, in this section, I would go through each of the smaller steps I outlined, and how I achieved them.</p>
<h4 id="Detect-the-project-type-based-on-certain-criteria"><a href="#Detect-the-project-type-based-on-certain-criteria" class="headerlink" title="Detect the project type based on certain criteria"></a>Detect the project type based on certain criteria</h4><p>Assuming one have no prior knowledge of Android or iOS development, they could still tell the two projects apart easily -- they can simply determine the projects based on files that exists in the project. Here are a few ways I could think about:</p>
<ul>
<li>iOS project almost always uses Swift or Objective C, this means, there must be files in the projects that use <code>.swift</code> as extension; Android project almost always uses Kotlin or Java, so <code>.kt</code> or <code>.java</code> would be the file extension to determine the project as Android.</li>
<li>iOS project usually uses CocoaPod to manage its dependencies -- you would almost always see a Podfile for an iOS project; Android projects would always have some kind of gradle file.</li>
</ul>
<p>There are countless other ways, I opt to use gradle file and Podfile to determine the project type.</p>
<p>So the script would begin with a function to determine the project type, I named this <code>run_mobile_platform</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">run_mobile_platform</span></span>() &#123;</span><br><span class="line">  <span class="keyword">if</span> [ -f <span class="string">&quot;Podfile&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Detected iOS project (Podfile found).&quot;</span></span><br><span class="line">    build_and_run_ios</span><br><span class="line">  <span class="keyword">elif</span> [ -f <span class="string">&quot;build.gradle&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Detected Android project (build.gradle found).&quot;</span></span><br><span class="line">    build_and_run_android</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Error: Unable to detect project platform. Make sure either Podfile or build.gradle exists.&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Build-the-project-from-source"><a href="#Build-the-project-from-source" class="headerlink" title="Build the project from source"></a>Build the project from source</h4><p>As you can see from the previous step, I have given away what we need to do next. We would need to complete <code>build_and_run_ios</code> and <code>build_and_run_android</code>.<br>The first step would be build, this would be assemble the app to binary format from source.</p>
<div class="tabs" id="build-from-source"><ul class="nav-tabs"><li class="tab active"><a href="#build-from-source-1">Build iOS app from source</a></li><li class="tab"><a href="#build-from-source-2">Build Android app from source</a></li></ul><div class="tab-content"><div class="tab-pane active" id="build-from-source-1"><p>To build iOS source code from command line, you need to use xcodebuild. To read more about xcodebuild, you can refer to this <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2xpYnJhcnkvYXJjaGl2ZS90ZWNobm90ZXMvdG4yMzM5L19pbmRleC5odG1s">link from Apple<i class="fa fa-external-link-alt"></i></span>, or <span class="exturl" data-url="aHR0cHM6Ly9rZWl0aC5naXRodWIuaW8veGNvZGUtbWFuLXBhZ2VzL3hjb2RlYnVpbGQuMS5odG1s">this online man page<i class="fa fa-external-link-alt"></i></span>. In short, this tool is Apple&#39;s proprietary tool to build, run tests, etc. from the command line. It&#39;s meant to be used for CI&#x2F;CD, or even automated testing. In this case, we are utilizing it to get gather information on a project as well as building it.</p>
<p>To run xcodebuild and build the project, you would at least need to provide</p>
<ul>
<li><code>configuration</code> which can only be either <code>Debug</code> or <code>Release</code>.</li>
<li><code>workspace</code> which is the xcode workspace file.</li>
<li><code>scheme</code> which is <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2RvY3VtZW50YXRpb24veGNvZGUvY3VzdG9taXppbmctdGhlLWJ1aWxkLXNjaGVtZXMtZm9yLWEtcHJvamVjdCM6fjp0ZXh0PUElMjBidWlsZCUyMHNjaGVtZSUyMGNvbnRhaW5zJTIwYSUyMGxpc3QlMjBvZiUyMHRhcmdldHMlMjB0byUyMGJ1aWxkJTJDJTIwYW5kJTIwYW55JTIwY29uZmlndXJhdGlvbiUyMGFuZCUyMGVudmlyb25tZW50JTIwZGV0YWlscyUyMHRoYXQlMjBhZmZlY3QlMjB0aGUlMjBzZWxlY3RlZCUyMGFjdGlvbi4=">defined by Apple<i class="fa fa-external-link-alt"></i></span> as<blockquote>
<p>... a list of targets to build, and any configuration and environment details that affect the selected action ...</p>
</blockquote>
</li>
<li><code>target</code> which is <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2RvY3VtZW50YXRpb24veGNvZGUvY29uZmlndXJpbmctYS1uZXctdGFyZ2V0LWluLXlvdXItcHJvamVjdCM6fjp0ZXh0PUElMjB0YXJnZXQlMjBzcGVjaWZpZXMlMjBhJTIwcHJvZHVjdCUyMHRvJTIwYnVpbGQlMkMlMjBzdWNoJTIwYXMlMjBhbiUyMGFwcCUyQyUyMGZyYW1ld29yayUyQyUyMGFwcCUyMGV4dGVuc2lvbiUyQyUyMG9yJTIwdW5pdCUyMHRlc3QuJTIwQSUyMHByb2plY3QlMjBjYW4lMjBjb250YWluJTIwbXVsdGlwbGUlMjB0YXJnZXRzJTJDJTIwdXN1YWxseSUyMHJlcHJlc2VudGluZyUyMHJlbGF0ZWQlMjBwYXJ0cyUyMG9mJTIwYSUyMHNpbmdsZSUyMHByb2R1Y3Q=">defined by Apple<i class="fa fa-external-link-alt"></i></span> as<blockquote>
<p>... specifies a product to build, such as an app, framework, app extension, or unit test. A project can contain multiple targets, usually representing related parts of a single product ...</p>
</blockquote>
</li>
</ul>
<p>I&#39;m by no means an iOS developer, so I wouldn&#39;t go in-depth on any of these things. All you need to know is you can build an iOS project from command line with something like the following</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xcodebuild -quiet -configuration Debug -scheme SCHEME_NAME \</span><br><span class="line">   -workspace WORK_SPACE_NAME \</span><br><span class="line">   -sdk <span class="string">&quot;iphonesimulator&quot;</span></span><br></pre></td></tr></table></figure>

<p>To do this without hard coding, you can extract things from build settings using <code>xcodebuild -showBuildSettings</code>. As an example:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">build_ios_app</span></span>()&#123;</span><br><span class="line">  build_settings=$(xcodebuild -showBuildSettings -quiet -json)</span><br><span class="line"></span><br><span class="line">  PRODUCT_BUNDLE_IDENTIFIER=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$build_settings</span>&quot;</span>|jq -r <span class="string">&quot;.[]|.buildSettings|.PRODUCT_BUNDLE_IDENTIFIER&quot;</span>)</span><br><span class="line">  BUNDLE_IDENTIFIER=<span class="variable">$PRODUCT_BUNDLE_IDENTIFIER</span><span class="string">&quot;.Debug&quot;</span></span><br><span class="line">  BUILD_DIR=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$build_settings</span>&quot;</span>|jq -r <span class="string">&quot;.[]|.buildSettings|.BUILD_DIR&quot;</span>)</span><br><span class="line">  TARGET=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$build_settings</span>&quot;</span>|jq -r <span class="string">&quot;.[]|.target&quot;</span>)</span><br><span class="line">  APP_PATH=<span class="string">&quot;<span class="variable">$BUILD_DIR</span>&quot;</span>/Debug-iphonesimulator/<span class="string">&quot;<span class="variable">$TARGET</span>&quot;</span>.app</span><br><span class="line"></span><br><span class="line">  <span class="comment"># COMPILER_INDEX_STORE_ENABLE=NO is added to disable indexing which is only useful for XCode</span></span><br><span class="line">  COMPILER_INDEX_STORE_ENABLE=NO xcodebuild -quiet -configuration Debug -scheme <span class="string">&quot;<span class="variable">$TARGET</span>&quot;</span><span class="string">&#x27; (Dev)&#x27;</span> \</span><br><span class="line">  -workspace <span class="string">&quot;<span class="variable">$TARGET</span>&quot;</span>.xcworkspace \</span><br><span class="line">  -sdk <span class="string">&quot;iphonesimulator&quot;</span> build | <span class="built_in">tee</span> xcodebuild.log &gt; /dev/null 2&gt;&amp;1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As you can see, the function intentionally avoided hard coding things, and attempt to extract most things from <code>xcodebuild -showBuildSettings</code></p></div><div class="tab-pane" id="build-from-source-2"><p>Building Android from source is a different story, I haven&#39;t found a good way to achieve what I wanted without any hard coding yet.</p></div></div></div>

<h4 id="Run-a-Simulator-Emulator"><a href="#Run-a-Simulator-Emulator" class="headerlink" title="Run a Simulator&#x2F;Emulator"></a>Run a Simulator&#x2F;Emulator</h4><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><a href="#-1">Run iOS simulator</a></li><li class="tab"><a href="#-2">Run android emulator</a></li></ul><div class="tab-content"><div class="tab-pane active" id="-1"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IOS_SIM_UDID=$(xcrun simctl list -je|jq -r <span class="string">&quot;.devices|to_entries[0]|.value[]|.name+\&quot;,\&quot;+.udid&quot;</span>|fzf --prompt <span class="string">&quot;Choose a simulator from the list: &quot;</span>|awk -F <span class="string">&#x27;,&#x27;</span> <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>The command above will use <code>simctl</code> program to list and <code>fzf</code> to prompt for a simulator to choose from, the UDID of the iOS simulator will be assigned to IOS_SIM_UDID</p></div><div class="tab-pane" id="-2"><p>Similar tricks can be applied for running Android emulator, we would use <code>emulator</code> program which sits under the Android SDK directory. You would first need to make sure you have it in your $PATH variable, so do something like <code>export PATH=YOUR_ANDROID_SDK_ROUTE:$PATH</code> <em>BEFORE</em> you run the command below</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ANDROID_AVD=$(emulator -list-avds | fzf --prompt <span class="string">&quot;Choose an Android Emulator: &quot;</span>)</span><br><span class="line"></span><br><span class="line">emulator -avd <span class="string">&quot;<span class="variable">$ANDROID_AVD</span>&quot;</span> \</span><br><span class="line">    -logcat <span class="string">&#x27;*:silent&#x27;</span> \</span><br><span class="line">    -partition-size 4096 \</span><br><span class="line">    -writable-system \</span><br><span class="line">    -no-boot-anim &gt; /dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure></div></div></div>

<h4 id="Deploy-and-launch-the-app-to-the-running-Simulator-Emulator"><a href="#Deploy-and-launch-the-app-to-the-running-Simulator-Emulator" class="headerlink" title="Deploy and launch the app to the running Simulator&#x2F;Emulator"></a>Deploy and launch the app to the running Simulator&#x2F;Emulator</h4><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><a href="#-1">Deploy to iOS simulator</a></li><li class="tab"><a href="#-2">Deploy to Android emulator</a></li></ul><div class="tab-content"><div class="tab-pane active" id="-1"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Installing app at path <span class="variable">$APP_PATH</span>&quot;</span></span><br><span class="line">xcrun simctl install booted <span class="variable">$APP_PATH</span></span><br></pre></td></tr></table></figure>

<p>The command above will use <code>simctl</code> program to install the app at <code>$APP_PATH</code></p></div><div class="tab-pane" id="-2"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GRADLE_BUILD_OUTPUT=<span class="string">&quot;&quot;</span></span><br><span class="line">regex=<span class="string">&quot;BUILD SUCCESSFUL&quot;</span></span><br><span class="line"><span class="keyword">until</span> [[ <span class="string">&quot;<span class="variable">$&#123;GRADLE_BUILD_OUTPUT&#125;</span>&quot;</span> =~ <span class="variable">$regex</span> ]]; <span class="keyword">do</span></span><br><span class="line">  GRADLE_BUILD_OUTPUT=$(./gradlew installDevelopment 2&gt;&amp;1 &amp;)</span><br><span class="line">  <span class="built_in">echo</span> -e <span class="string">&quot;\nWaiting for gradle build to succeed..&quot;</span></span><br><span class="line">  <span class="built_in">sleep</span> 2</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Launching app...&quot;</span></span><br><span class="line">adb shell monkey -p <span class="variable">$PACKAGE_NAME</span> 1</span><br></pre></td></tr></table></figure>
<p>The command above will build and launch the app on the android emulator.</p></div></div></div>

<h3 id="Put-it-all-together"><a href="#Put-it-all-together" class="headerlink" title="Put it all together"></a>Put it all together</h3><p>Putting all the steps together, I created the following script, feel free to tailor to your need.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">run_mobile_platform</span></span>() &#123;</span><br><span class="line">  <span class="keyword">if</span> [ -f <span class="string">&quot;Podfile&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Detected iOS project (Podfile found).&quot;</span></span><br><span class="line">    build_and_run_ios</span><br><span class="line">  <span class="keyword">elif</span> [ -f <span class="string">&quot;build.gradle&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Detected Android project (build.gradle found).&quot;</span></span><br><span class="line">    build_and_run_android</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Error: Unable to detect project platform. Make sure either Podfile or build.gradle exists.&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Android-specific functions</span></span><br><span class="line"><span class="function"><span class="title">build_and_run_android</span></span>() &#123;</span><br><span class="line">  <span class="comment">#ANDROID_APP=&quot;app/build/outputs/apk/development/app-development.apk&quot;</span></span><br><span class="line">  PACKAGE_NAME=<span class="string">&quot;PKG_NAME&quot;</span></span><br><span class="line">  BOOT_ANIMATION=<span class="string">&quot;&quot;</span></span><br><span class="line">  FAIL_COUNTER=0</span><br><span class="line">  SECONDS_UNTIL_TIMEOUT=60</span><br><span class="line">  LINE=<span class="string">&quot;<span class="subst">$(printf %<span class="string">&quot;<span class="subst">$(tput cols)</span>&quot;</span>s | tr <span class="string">&quot; &quot;</span> <span class="string">&quot;-&quot;</span>)</span>&quot;</span></span><br><span class="line">  <span class="comment">#AVD_ARGS=&quot; -wipe-data -no-snapshot&quot;</span></span><br><span class="line"></span><br><span class="line">  select_and_launch_emulator</span><br><span class="line">  wait_for_emulator_to_start</span><br><span class="line">  wait_for_build_and_install</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">select_and_launch_emulator</span></span>() &#123;</span><br><span class="line">  emulator -avd <span class="string">&quot;<span class="subst">$(emulator -list-avds | head -1)</span>&quot;</span> \</span><br><span class="line">    -logcat <span class="string">&#x27;*:silent&#x27;</span> \</span><br><span class="line">    -partition-size 4096 \</span><br><span class="line">    -change-country nz \</span><br><span class="line">    -writable-system \</span><br><span class="line">    -icc-profile iccprofile_for_sim0.xml \</span><br><span class="line">    -no-boot-anim &gt; /dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">wait_for_emulator_to_start</span></span>() &#123;</span><br><span class="line">  <span class="keyword">until</span> [[ <span class="string">&quot;<span class="variable">$BOOT_ANIMATION</span>&quot;</span> =~ <span class="string">&quot;stopped&quot;</span> ]]; <span class="keyword">do</span></span><br><span class="line">    BOOT_ANIMATION=$(adb -e shell getprop init.svc.bootanim 2&gt;&amp;1 &amp;)</span><br><span class="line">    <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$BOOT_ANIMATION</span>&quot;</span> =~ <span class="string">&quot;device not found&quot;</span> || <span class="string">&quot;<span class="variable">$BOOT_ANIMATION</span>&quot;</span> =~ <span class="string">&quot;device offline&quot;</span> || <span class="string">&quot;<span class="variable">$BOOT_ANIMATION</span>&quot;</span> =~ <span class="string">&quot;running&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">      ((FAIL_COUNTER += <span class="number">1</span>))</span><br><span class="line">      <span class="built_in">echo</span> -e <span class="string">&quot;\nWaiting for emulator to start.. <span class="variable">$FAIL_COUNTER</span>&quot;</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;Boot Animation State: <span class="variable">$BOOT_ANIMATION</span>&quot;</span></span><br><span class="line">      <span class="keyword">if</span> [[ <span class="variable">$&#123;FAIL_COUNTER&#125;</span> -gt <span class="variable">$&#123;SECONDS_UNTIL_TIMEOUT&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;\nTimeout of <span class="variable">$SECONDS_UNTIL_TIMEOUT</span> seconds reached; failed to start emulator&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">      <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">sleep</span> 1</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">  <span class="built_in">echo</span> -e <span class="string">&quot;\n<span class="variable">$&#123;LINE&#125;</span>&quot;</span></span><br><span class="line">  <span class="built_in">echo</span> -e <span class="string">&quot;\nEmulator is ready!&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">wait_for_build_and_install</span></span>() &#123;</span><br><span class="line">  GRADLE_BUILD_OUTPUT=<span class="string">&quot;&quot;</span></span><br><span class="line">  regex=<span class="string">&quot;BUILD SUCCESSFUL&quot;</span></span><br><span class="line">  <span class="keyword">until</span> [[ <span class="string">&quot;<span class="variable">$&#123;GRADLE_BUILD_OUTPUT&#125;</span>&quot;</span> =~ <span class="variable">$regex</span> ]]; <span class="keyword">do</span></span><br><span class="line">    GRADLE_BUILD_OUTPUT=$(./gradlew installDevelopment 2&gt;&amp;1 &amp;)</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\nWaiting for gradle build to succeed..&quot;</span></span><br><span class="line">    <span class="built_in">sleep</span> 2</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Launching app...&quot;</span></span><br><span class="line">  adb shell monkey -p <span class="variable">$PACKAGE_NAME</span> 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># iOS-specific functions</span></span><br><span class="line"><span class="function"><span class="title">build_and_run_ios</span></span>() &#123;</span><br><span class="line">  build_settings=$(xcodebuild -showBuildSettings -quiet -json)</span><br><span class="line">  <span class="comment">#PRODUCT_BUNDLE_IDENTIFIER=$(xcodebuild -showBuildSettings -quiet | grep PRODUCT_BUNDLE_IDENTIFIER | awk -F &#x27; = &#x27; &#x27;&#123;print $2&#125;&#x27;)</span></span><br><span class="line">  PRODUCT_BUNDLE_IDENTIFIER=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$build_settings</span>&quot;</span>|jq -r <span class="string">&quot;.[]|.buildSettings|.PRODUCT_BUNDLE_IDENTIFIER&quot;</span>)</span><br><span class="line">  BUNDLE_IDENTIFIER=<span class="variable">$PRODUCT_BUNDLE_IDENTIFIER</span><span class="string">&quot;.Debug&quot;</span></span><br><span class="line">  BUILD_DIR=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$build_settings</span>&quot;</span>|jq -r <span class="string">&quot;.[]|.buildSettings|.BUILD_DIR&quot;</span>)</span><br><span class="line">  TARGET=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$build_settings</span>&quot;</span>|jq -r <span class="string">&quot;.[]|.target&quot;</span>)</span><br><span class="line">  APP_PATH=<span class="string">&quot;<span class="variable">$BUILD_DIR</span>&quot;</span>/Debug-iphonesimulator/<span class="string">&quot;<span class="variable">$TARGET</span>&quot;</span>.app</span><br><span class="line">  BUILD_SUCCEED=<span class="string">&#x27;** BUILD SUCCEEDED **&#x27;</span></span><br><span class="line">  APP_NAME=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_PATH##*/&#125;</span>&quot;</span> | <span class="built_in">cut</span> -d<span class="string">&#x27;.&#x27;</span> -f1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$CLEAN_BUILD</span>&quot;</span> == <span class="string">&quot;1&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    CLEAN_BUILD_FLAG=clean</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    CLEAN_BUILD_FLAG=<span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"> COMPILER_INDEX_STORE_ENABLE=NO xcodebuild -quiet -configuration Debug -scheme <span class="string">&quot;<span class="variable">$TARGET</span>&quot;</span><span class="string">&#x27; (Dev)&#x27;</span> \</span><br><span class="line">    -workspace <span class="string">&quot;<span class="variable">$TARGET</span>&quot;</span>.xcworkspace \</span><br><span class="line">    -sdk <span class="string">&quot;iphonesimulator&quot;</span> <span class="variable">$CLEAN_BUILD_FLAG</span> build | <span class="built_in">tee</span> xcodebuild.log &gt; /dev/null 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$BUILD_SUCCEED</span>&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Running sim for <span class="variable">$APP_NAME</span> - <span class="variable">$BUNDLE_IDENTIFIER</span>&quot;</span></span><br><span class="line"></span><br><span class="line">  IOS_SIM_UDID=$(xcrun simctl list -je|jq -r <span class="string">&quot;.devices|to_entries[0]|.value[]|.name+\&quot;,\&quot;+.udid&quot;</span>|fzf --prompt <span class="string">&quot;Choose a simulator from the list&quot;</span>|awk -F <span class="string">&#x27;,&#x27;</span> <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  BOOTED_UDID=$(xcrun simctl list | grep Booted | perl -pe <span class="string">&#x27;s/.*\((.*)\).*\(.*/\1/&#x27;</span> | sed -n 1p)</span><br><span class="line">  <span class="keyword">if</span> [[ -n <span class="variable">$BOOTED_UDID</span> &amp;&amp; <span class="string">&quot;<span class="variable">$BOOTED_UDID</span>&quot;</span> != <span class="string">&quot;<span class="variable">$IOS_SIM_UDID</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="comment">#echo &quot;Detected a running simulator that&#x27;s different from selected, kill it? (Y/N): &quot;</span></span><br><span class="line">    <span class="built_in">read</span> -rp <span class="string">&quot;Detected a running simulator that&#x27;s different from selected, kill it? (Y/N): &quot;</span> kill_sim</span><br><span class="line">    <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$kill_sim</span>&quot;</span> =~ ^[Yy]$ ]]; <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;Killing current running simulator&quot;</span></span><br><span class="line">      killall <span class="string">&#x27;Simulator&#x27;</span></span><br><span class="line">      <span class="built_in">sleep</span> 1</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      IOS_SIM_UDID=<span class="variable">$BOOTED_UDID</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">  open -a <span class="string">&#x27;Simulator&#x27;</span> --args -CurrentDeviceUDID <span class="string">&quot;<span class="variable">$IOS_SIM_UDID</span>&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> [ <span class="string">&quot;<span class="subst">$(booted_sim_ct)</span>&quot;</span> -lt 1 ]; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">sleep</span> 1</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Installing app at path <span class="variable">$APP_PATH</span>&quot;</span></span><br><span class="line">  xcrun simctl install booted <span class="variable">$APP_PATH</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$DEBUGGER_ENABLED</span>&quot;</span> == <span class="string">&quot;1&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    LAUNCH_DEBUGGER_ENABLED_FLAG=--wait-for-debugger</span><br><span class="line">    USE_CONSOLE_FLAG=<span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    USE_CONSOLE_FLAG=--console</span><br><span class="line">    LAUNCH_DEBUGGER_ENABLED_FLAG=<span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">  LOG_FILE=/tmp/run_ios_sim.log</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Starting Sim for <span class="variable">$APP_PATH</span>&quot;</span> &gt; <span class="variable">$LOG_FILE</span></span><br><span class="line"></span><br><span class="line">  xcrun simctl launch <span class="variable">$LAUNCH_DEBUGGER_ENABLED_FLAG</span> <span class="variable">$USE_CONSOLE_FLAG</span> booted <span class="string">&quot;<span class="variable">$BUNDLE_IDENTIFIER</span>&quot;</span> &gt;&gt; <span class="string">&quot;<span class="variable">$LOG_FILE</span>&quot;</span> 2&gt;&amp;1 &amp;</span><br><span class="line"></span><br><span class="line">  LAUNCH_SHELL_PID=$!</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="function"><span class="title">newest_related_process</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> $(ps aux | grep <span class="string">&quot;<span class="variable">$APP_NAME</span>&quot;</span>.app/<span class="string">&quot;<span class="variable">$APP_NAME</span>&quot;</span> | grep -v -e <span class="string">&quot;*.grep&quot;</span> | <span class="built_in">sort</span> -k 4nr,4  | awk <span class="string">&#x27;&#123; print ( $2 &gt; &#x27;</span><span class="variable">$LAUNCH_SHELL_PID</span><span class="string">&#x27; ) ? $2 : &quot;&quot; &#125;&#x27;</span> | grep -v -e <span class="string">&#x27;^$&#x27;</span> | <span class="built_in">head</span> -1)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _Z=$(newest_related_process)</span><br><span class="line">  _X=0</span><br><span class="line">  <span class="keyword">while</span> [[ <span class="string">&quot;<span class="variable">$_Z</span>&quot;</span> != <span class="string">&quot;<span class="variable">$_X</span>&quot;</span> ]]</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">sleep</span> 1</span><br><span class="line">    _Z=<span class="variable">$_X</span></span><br><span class="line">    _X=$(newest_related_process)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;waiting for process..&quot;</span></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">  APP_PID=<span class="variable">$_X</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$DEBUGGER_ENABLED</span>&quot;</span> == <span class="string">&quot;1&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$APP_NAME</span> running at pid <span class="variable">$APP_PID</span>, waiting for lldb..&quot;</span></span><br><span class="line">    lldb -p <span class="string">&quot;<span class="variable">$APP_PID</span>&quot;</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$APP_NAME</span> running at pid <span class="variable">$APP_PID</span>&quot;</span></span><br><span class="line">    (<span class="built_in">tail</span> -f <span class="variable">$LOG_FILE</span>)</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">booted_sim_ct</span></span>() &#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;<span class="subst">$(xcrun simctl list | grep Booted -c | sed -e &#x27;s/ //g&#x27;)</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">run_mobile_platform <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Kevin Jiang
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://jiangsc.me/2025/02/08/mobile-dev-cli-tips-2/" title="Building and Deploying Apps From CLI">https://jiangsc.me/2025/02/08/mobile-dev-cli-tips-2/</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Android/" rel="tag"># Android</a>
              <a href="/tags/CLI/" rel="tag"># CLI</a>
              <a href="/tags/iOS/" rel="tag"># iOS</a>
              <a href="/tags/tips/" rel="tag"># tips</a>
              <a href="/tags/Command-line/" rel="tag"># Command line</a>
              <a href="/tags/Moible-App-Development/" rel="tag"># Moible App Development</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/02/08/dns-for-selfhosted-homelab/" rel="prev" title="DNS for self hosted apps in homelab">
                  <i class="fa fa-angle-left"></i> DNS for self hosted apps in homelab
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/03/09/notes-2025-03-09/" rel="next" title="Week of 2025-03-09">
                  Week of 2025-03-09 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2017 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Kevin Jiang</span>
  </div>
  <div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZw==">NexT.Gemini</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL0tldmluU0o=" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

<script src="https://unpkg.com/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false}});</script></body>
</html>
