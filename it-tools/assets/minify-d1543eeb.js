const O={content_wrap:0,ignore:[],ignore_with:"!i-£___£%_",strict:!1,tab_size:2,tag_wrap:0,trim:[]},A=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"],w={checked_html:!1,config:{...O},ignored:!1,constants:{CONTENT_IGNORE_PLACEHOLDER:`${O.ignore_with}_`,SELF_CLOSING_PLACEHOLDER:`${O.ignore_with}/_>`,ATTRIBUTE_IGNORE_PLACEHOLDER:`${O.ignore_with}=_`}},_=()=>w,u=e=>Object.assign(w,e),T=e=>(u({checked_html:!0}),/<(?:[A-Za-z]+[A-Za-z0-9]*)(?:\s+.*?)*?\/{0,1}>/.test(e)||/<(?<Element>(?:[A-Za-z]+[A-Za-z0-9]*:)?(?:[A-Za-z]+[A-Za-z0-9]*))(?:\s+.*?)*?>(?:.|\n)*?<\/{1}\k<Element>>/.test(e)||/<(?<Element>(?:[a-z][a-z0-9._]*:)?[a-z][a-z0-9._]*-[a-z0-9._-]+)(?:\s+.*?)*?>(?:.|\n)*?<\/{1}\k<Element>>/.test(e)),f=(e,t)=>{if(!e||!t)throw new Error("Both 'current' and 'updates' must be passed-in to mergeObjects()");let r;if(Array.isArray(e))r=structuredClone(e).concat(t);else if(typeof e=="object"){r={...e};for(let n of Object.keys(t))typeof t[n]!="object"?r[n]=t[n]:r[n]=f(r[n]||{},t[n])}return r},b=(e,t)=>{const r=f(e,t);return u({config:r,constants:{CONTENT_IGNORE_PLACEHOLDER:`${r.ignore_with}_`,SELF_CLOSING_PLACEHOLDER:`${r.ignore_with}/_>`,ATTRIBUTE_IGNORE_PLACEHOLDER:`${r.ignore_with}=_`}}),r},z=e=>{const{constants:t}=_();return e=e.replace(/<[\w:\-]+([^>]*[^\/])>/g,(r,n)=>r.replace(n,a=>a.replace(/\n/g,t.ATTRIBUTE_IGNORE_PLACEHOLDER+"nl!").replace(/\r/g,t.ATTRIBUTE_IGNORE_PLACEHOLDER+"cr!").replace(/\s/g,t.ATTRIBUTE_IGNORE_PLACEHOLDER+"ws!"))),e},L=e=>{const{constants:t}=_();return e.replace(/\n/g,t.CONTENT_IGNORE_PLACEHOLDER+"nl!").replace(/\r/g,t.CONTENT_IGNORE_PLACEHOLDER+"cr!").replace(/\s/g,t.CONTENT_IGNORE_PLACEHOLDER+"ws!")},d=e=>{const t=/\s*<([a-zA-Z0-9:-]+)[^>]*>\n\s*<\/\1>(?=\n[ ]*[^\n]*__!i-£___£%__[^\n]*\n)(\n[ ]*\S[^\n]*\n)|<([a-zA-Z0-9:-]+)[^>]*>(?=\n[ ]*[^\n]*__!i-£___£%__[^\n]*\n)(\n[ ]*\S[^\n]*\n\s*)<\/\3>/g,{constants:r}=_();return e.replace(t,(n,a,s,g,p)=>{const c=s||p;if(!c)return n;const o=c.replace(/\n/g,r.CONTENT_IGNORE_PLACEHOLDER+"nl!").replace(/\r/g,r.CONTENT_IGNORE_PLACEHOLDER+"cr!").replace(/\s/g,r.CONTENT_IGNORE_PLACEHOLDER+"ws!");return n.replace(c,o)})},y=e=>{const t=/<([A-Za-z][A-Za-z0-9]*|[a-z][a-z0-9._]*-[a-z0-9._-]+)((?:\s+[A-Za-z0-9_-]+="[^"]*"|\s*[a-z]*)*)>/g,{constants:r}=_();return e=e.replace(t,(n,a,s)=>n.replace(s,g=>g.replace(/</g,r.ATTRIBUTE_IGNORE_PLACEHOLDER+"lt!").replace(/>/g,r.ATTRIBUTE_IGNORE_PLACEHOLDER+"gt!"))),e},D=(e,t)=>{for(let r=0;r<t.length;r++){const n=new RegExp(`(<${t[r]}[^>]*>)\\s+`,"g"),a=new RegExp(`\\s+(</${t[r]}>)`,"g");e=e.replace(n,"$1").replace(a,"$1")}return e},G=e=>{const{constants:t}=_();return e=e.replace(/<[\w:\-]+([^>]*[^\/])>/g,(r,n)=>r.replace(n,a=>a.replace(new RegExp(t.ATTRIBUTE_IGNORE_PLACEHOLDER+"nl!","g"),`
`).replace(new RegExp(t.ATTRIBUTE_IGNORE_PLACEHOLDER+"cr!","g"),"\r").replace(new RegExp(t.ATTRIBUTE_IGNORE_PLACEHOLDER+"ws!","g")," "))),e},H=e=>{const{constants:t}=_();return e=e.replace(new RegExp(`.*${t.CONTENT_IGNORE_PLACEHOLDER}[a-z]{2}!.*`,"g"),r=>r.replace(new RegExp(`${t.CONTENT_IGNORE_PLACEHOLDER}[a-z]{2}!`,"g"),n=>n.replace(new RegExp(t.CONTENT_IGNORE_PLACEHOLDER+"nl!","g"),`
`).replace(new RegExp(t.CONTENT_IGNORE_PLACEHOLDER+"cr!","g"),"\r").replace(new RegExp(t.CONTENT_IGNORE_PLACEHOLDER+"ws!","g")," "))),e},S=e=>{const t=/<([\w:\-]+)([^>]*)>/g,{constants:r}=_(),n=r.ATTRIBUTE_IGNORE_PLACEHOLDER.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),a=new RegExp(n+"lt!","g"),s=new RegExp(n+"gt!","g");return e.replace(t,(g,p,c)=>{const o=c.replace(a,"<").replace(s,">");return`<${p}${o}>`})},C=e=>{if(typeof e!="object")throw new Error("Config must be an object.");const t={...O};if(!(Object.hasOwn(e,"content_wrap")||Object.hasOwn(e,"ignore")||Object.hasOwn(e,"ignore_with")||Object.hasOwn(e,"strict")||Object.hasOwn(e,"tab_size")||Object.hasOwn(e,"tag_wrap")||Object.hasOwn(e,"trim")))return u({config:t}),t;let n=e.tab_size;if(n){if(typeof n!="number")throw new Error(`tab_size must be a number, not ${typeof e.tab_size}.`);if(!Number.isSafeInteger(n))throw new Error(`Tab size ${n} is not safe. See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isSafeInteger for more info.`);if(n=Math.floor(n),n<1||n>16)throw new Error("Tab size out of range. Expecting 1 to 16.");e.tab_size=n}if(Object.hasOwn(e,"content_wrap")&&typeof e.content_wrap!="number")throw new Error(`content_wrap config must be a number, not ${typeof e.content_wrap}.`);if(Object.hasOwn(e,"ignore")&&(!Array.isArray(e.ignore)||!e.ignore?.every(a=>typeof a=="string")))throw new Error("Ignore config must be an array of strings.");if(Object.hasOwn(e,"ignore_with")){if(typeof e.ignore_with!="string")throw new Error(`ignore_with must be a string, not ${typeof e.ignore_with}.`);if(e.ignore_with.startsWith("_"))throw new Error("ignore_with cannot start with an underscore.")}if(Object.hasOwn(e,"strict")&&typeof e.strict!="boolean")throw new Error(`Strict config must be a boolean, not ${typeof e.strict}.`);if(Object.hasOwn(e,"tag_wrap")&&typeof e.tag_wrap!="number")throw new Error(`tag_wrap config must be a number, not ${typeof e.tag_wrap}.`);if(Object.hasOwn(e,"trim")&&(!Array.isArray(e.trim)||!e.trim?.every(a=>typeof a=="string")))throw new Error("Trim config must be an array of strings.");return b(t,e)},h=(e,t,r)=>{const n=e.trim().split(/\s+/);if(n.length===0||n.length===1&&n[0]==="")return"";const a=[];let s="";const g=r;n.forEach(c=>{if(c==="")return;if(c.length>=t){s!==""&&a.push(a.length===0?r+s:g+s),a.push(a.length===0?r+c:g+c),s="";return}const o=s===""?c:s+" "+c;o.length<=t?s=o:(s!==""&&a.push(a.length===0?r+s:g+s),s=c)}),s!==""&&a.push(a.length===0?r+s:g+s);const p=a.join(`
`);return L(p)};function N(e){u({ignored:!0});const t=_().config;let r=e;const n=new Map;let a=0;const s="___HTMLFY_SPECIAL_IGNORE_MARKER_";for(const g of t.ignore){const p=g.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),c=new RegExp(`(<\\s*${p}[^>]*>)(.*?)(<\\s*/\\s*${p}\\s*>)`,"gs");let o;const E=[];for(;(o=c.exec(r))!==null;){const i=`${s}${a++}___`;n.set(i,o[2]),E.push({start:o.index+o[1].length,end:o.index+o[1].length+o[2].length,marker:i})}for(let i=E.length-1;i>=0;i--){const l=E[i];r=r.substring(0,l.start)+l.marker+r.substring(l.end)}}return{html_with_markers:r,extracted_map:n}}function I(e,t){u({ignored:!1});let r=e;for(const[n,a]of t)r=r.split(n).join(a);return r}const $=new RegExp(`<(${A.join("|")})(?:\\s(?:[^/>]|/(?!>))*)*>`,"g");function j(e){const{constants:t}=_();return e.replace($,r=>r.replace(/>$/,t.SELF_CLOSING_PLACEHOLDER))}function k(e){const{constants:t}=_();return e.replace(t.SELF_CLOSING_PLACEHOLDER,">")}const x=(e,t=!1)=>(e=e.replace(/<\s*textarea[^>]*>((.|\n)*?)<s*\/\s*textarea\s*>/g,(r,n)=>r.replace(n,a=>a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\n/g,"&#10;").replace(/\r/g,"&#13;").replace(/\s/g,"&nbsp;"))),t&&(e=e.replace(/<\s*textarea[^>]*>(.|\n)*?<\s*\/\s*textarea\s*>/g,r=>r.replace(/\s+/g," ").replace(/\s>/g,">").replace(/>\s/g,">").replace(/\s</g,"<").replace(/<\s/g,"<").replace(/<\/\s/g,"</").replace(/class=["']\s/g,n=>n.replace(/\s/g,"")).replace(/(class=.*)\s(["'])/g,"$1$2"))),e),P=e=>e=e.replace(/<textarea[^>]*>((.|\n)*?)<\/textarea>/g,(t,r)=>t.replace(r,n=>(n=n.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&#10;/g,`
`).replace(/&#13;/g,"\r").replace(/&nbsp;/g," ").replace(/\s+/g," "),n)));let R;const Z=(e,t)=>{let r=!1;const{checked_html:n,ignored:a,constants:s}=_();if(!n&&!T(e))return e;const p=(t?C(t):_().config).ignore.length>0;if(!a&&p){const{html_with_markers:c,extracted_map:o}=N(e);e=c,R=o,r=!0}return e=x(e,!0),e=e.replace(/\n|\t/g,""),e=e.replace(/>\s+</g,"><"),e=e.replace(/ {2,}/g," "),e=e.replace(/(\S) (<[a-zA-Z][a-zA-Z0-9_:-]*)/g,"$1___MINIFY-PROTECTED-SPACE___$2"),e=e.replace(/(<\/[a-zA-Z][a-zA-Z0-9_:-]*>) (\S)/g,"$1___MINIFY-PROTECTED-SPACE___$2"),e=e.replace(/ >/g,">"),e=e.replace(/ </g,"<"),e=e.replace(/> /g,">"),e=e.replace(/< /g,"<"),e=e.replace(/<\s+\//g,"</"),e=e.replace(/<\/\s+/g,"</"),e=e.replace(new RegExp("___MINIFY-PROTECTED-SPACE___","g")," "),e=e.replace(/ = /g,"="),e=e.replace(/([a-zA-Z0-9_-]+)=(['"])(.*?)\2/g,(c,o,E,i)=>{const l=i.trim();return`${o}=${E}${l}${E}`}),e=e.trim(),e=P(e),r&&(e=I(e,R)),e};export{A as V,j as a,k as b,H as c,G as d,N as e,d as f,_ as g,T as i,Z as m,z as p,I as r,y as s,D as t,S as u,C as v,h as w};
