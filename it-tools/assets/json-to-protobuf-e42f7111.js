import{b as $,d as q,a0 as F,r as O,aX as g,o as A,c as D,k as E,l as u,m as S,a7 as I,x as M}from"./index-0c1fde36.js";import{s as z}from"./index-4ec0ff91.js";import{_ as C}from"./FormatTransformer-bc7b3ed5.js";import"./index-a6f01dde.js";import"./TextareaCopyable-59231e95.js";import"./base64-ae7cf34b.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";var h={exports:{}},B=function(r){var e=function(n){var a=n.indexOf("//");return a>-1?n.slice(0,a):n},i=function(){var n=!1;return function(a){return a==="/*"?(n=!0,!1):a==="*/"?(n=!1,!1):!n}},t=function(n){return n.trim()};return r.replace(/([;,{}\(\)=\:\[\]<>]|\/\*|\*\/)/g," $1 ").split(/\n/).map(t).filter(Boolean).map(e).map(t).filter(Boolean).join(`
`).split(/\s+|\n+/gm).filter(i())},R=B,P=536870911,J=function(r){for(var e={};r.length;)switch(r[0]){case"[":case",":r.shift();var i=r.shift();if(i==="("&&(i=r.shift(),r.shift()),r[0]!=="=")throw new Error("Unexpected token in field options: "+r[0]);if(r.shift(),r[0]==="]")throw new Error("Unexpected ] in field option");e[i]=r.shift();break;case"]":return r.shift(),e;default:throw new Error("Unexpected token in field options: "+r[0])}throw new Error("No closing tag for field options")},c=function(r){for(var e={name:null,type:null,tag:0,map:null,oneof:null,required:!1,repeated:!1,options:{}};r.length;)switch(r[0]){case"=":r.shift(),e.tag=Number(r.shift());break;case"map":if(e.type="map",e.map={from:null,to:null},r.shift(),r[0]!=="<")throw new Error("Unexpected token in map type: "+r[0]);if(r.shift(),e.map.from=r.shift(),r[0]!==",")throw new Error("Unexpected token in map type: "+r[0]);if(r.shift(),e.map.to=r.shift(),r[0]!==">")throw new Error("Unexpected token in map type: "+r[0]);r.shift(),e.name=r.shift();break;case"repeated":case"required":case"optional":var i=r.shift();e.required=i==="required",e.repeated=i==="repeated",e.type=r.shift(),e.name=r.shift();break;case"[":e.options=J(r);break;case";":return r.shift(),e;default:throw new Error("Unexpected token in message field: "+r[0])}throw new Error("No ; found for message field")},T=function(r){for(var e={enums:[],messages:[],fields:[],extensions:null};r.length;)switch(r[0]){case"map":case"repeated":case"optional":case"required":e.fields.push(c(r));break;case"enum":e.enums.push(x(r));break;case"message":e.messages.push(d(r));break;case"extensions":e.extensions=G(r);break;case"oneof":r.shift();var i=r.shift();if(r[0]!=="{")throw new Error("Unexpected token in oneof: "+r[0]);for(r.shift();r[0]!=="}";){r.unshift("optional");var t=c(r);t.oneof=i,e.fields.push(t)}r.shift();break;case";":r.shift();break;default:r.unshift("optional"),e.fields.push(c(r))}return e},X=function(r){var e={name:r[1],message:d(r)};return e},G=function(r){r.shift();var e=Number(r.shift());if(isNaN(e))throw new Error("Invalid from in extensions definition");if(r.shift()!=="to")throw new Error("Expected keyword 'to' in extensions definition");var i=r.shift();if(i==="max"&&(i=P),i=Number(i),isNaN(i))throw new Error("Invalid to in extensions definition");if(r.shift()!==";")throw new Error("Missing ; in extensions definition");return{from:e,to:i}},d=function(r){r.shift();var e=1,i=[],t={name:r.shift(),enums:[],messages:[],fields:[]};if(r[0]!=="{")throw new Error("Expected { but found "+r[0]);for(r.shift();r.length;){if(r[0]==="{"?e++:r[0]==="}"&&e--,!e)return r.shift(),i=T(i),t.enums=i.enums,t.messages=i.messages,t.fields=i.fields,t.extensions=i.extensions,t;i.push(r.shift())}if(e)throw new Error("No closing tag for message")},L=function(r){r.shift();var e=r.shift();if(r[0]!==";")throw new Error("Expected ; but found "+r[0]);return r.shift(),e},V=function(r){if(r.shift(),r[0]!=="=")throw new Error("Expected = but found "+r[0]);r.shift();var e=r.shift();switch(e){case'"proto2"':e=2;break;case'"proto3"':e=3;break;default:throw new Error("Expected protobuf syntax version but found "+e)}if(r[0]!==";")throw new Error("Expected ; but found "+r[0]);return r.shift(),e},Z=function(r){if(r.length<4)throw new Error("Invalid enum value: "+r.slice(0,3).join(" "));if(r[1]!=="=")throw new Error("Expected = but found "+r[1]);if(r[3]!==";")throw new Error("Expected ; but found "+r[1]);var e=r.shift();r.shift();var i=Number(r.shift());return r.shift(),{name:e,value:i}},x=function(r){r.shift();var e={name:r.shift(),values:{}};if(r[0]!=="{")throw new Error("Expected { but found "+r[0]);for(r.shift();r.length;){if(r[0]==="}")return r.shift(),r[0]===";"&&r.shift(),e;if(r[0]==="option")for(;r.shift()!==";";);var i=Z(r);e.values[i.name]=i.value}throw new Error("No closing tag for enum")},v=function(r){for(var e=null,i=null,t=function(a){return a==="true"?!0:a==="false"?!1:a.replace(/^"+|"+$/gm,"")};r.length;){if(r[0]===";")return r.shift(),{name:e,value:i};switch(r[0]){case"option":r.shift();var n=r[0]==="(";if(n&&r.shift(),e=r.shift(),n){if(r[0]!==")")throw new Error("Expected ) but found "+r[0]);r.shift()}break;case"=":if(r.shift(),e===null)throw new Error("Expected key for option with value: "+r[0]);if(i=t(r.shift()),e==="optimize_for"&&!/^(SPEED|CODE_SIZE|LITE_RUNTIME)$/.test(i))throw new Error("Unexpected value for option optimize_for: "+i);i==="{"&&(i=l(r));break;default:throw new Error("Unexpected token in option: "+r[0])}}},l=function(r){for(var e=function(o){return o==="true"?!0:o==="false"?!1:o.replace(/^"+|"+$/gm,"")},i={};r.length;){if(r[0]==="}")return r.shift(),i;var t=r[0]==="(";t&&r.shift();var n=r.shift();if(t){if(r[0]!==")")throw new Error("Expected ) but found "+r[0]);r.shift()}var a=null;switch(r[0]){case":":if(i[n]!==void 0)throw new Error("Duplicate option map key "+n);r.shift(),a=e(r.shift()),a==="{"&&(a=l(r)),i[n]=a;break;case"{":if(r.shift(),a=l(r),i[n]===void 0&&(i[n]=[]),!Array.isArray(i[n]))throw new Error("Duplicate option map key "+n);i[n].push(a);break;default:throw new Error("Unexpected token in option map: "+r[0])}}throw new Error("No closing tag for option map")},H=function(r){r.shift();var e=r.shift().replace(/^"+|"+$/gm,"");if(r[0]!==";")throw new Error("Unexpected token: "+r[0]+'. Expected ";"');return r.shift(),e},K=function(r){r.shift();var e={name:r.shift(),methods:[],options:{}};if(r[0]!=="{")throw new Error("Expected { but found "+r[0]);for(r.shift();r.length;){if(r[0]==="}")return r.shift(),r[0]===";"&&r.shift(),e;switch(r[0]){case"option":var i=v(r);if(e.options[i.name]!==void 0)throw new Error("Duplicate option "+i.name);e.options[i.name]=i.value;break;case"rpc":e.methods.push(Q(r));break;default:throw new Error("Unexpected token in service: "+r[0])}}throw new Error("No closing tag for service")},Q=function(r){r.shift();var e={name:r.shift(),input_type:null,output_type:null,client_streaming:!1,server_streaming:!1,options:{}};if(r[0]!=="(")throw new Error("Expected ( but found "+r[0]);if(r.shift(),r[0]==="stream"&&(r.shift(),e.client_streaming=!0),e.input_type=r.shift(),r[0]!==")")throw new Error("Expected ) but found "+r[0]);if(r.shift(),r[0]!=="returns")throw new Error("Expected returns but found "+r[0]);if(r.shift(),r[0]!=="(")throw new Error("Expected ( but found "+r[0]);if(r.shift(),r[0]==="stream"&&(r.shift(),e.server_streaming=!0),e.output_type=r.shift(),r[0]!==")")throw new Error("Expected ) but found "+r[0]);if(r.shift(),r[0]===";")return r.shift(),e;if(r[0]!=="{")throw new Error("Expected { but found "+r[0]);for(r.shift();r.length;){if(r[0]==="}")return r.shift(),r[0]===";"&&r.shift(),e;if(r[0]==="option"){var i=v(r);if(e.options[i.name]!==void 0)throw new Error("Duplicate option "+i.name);e.options[i.name]=i.value}else throw new Error("Unexpected token in rpc options: "+r[0])}throw new Error("No closing tag for rpc")},W=function(r){for(var e=R(r.toString()),i=0;i<e.length;i++)if(/^(\"|\')([^\'\"]*)$/.test(e[i])){var t;for(e[i].length===1?t=i+1:t=i,t;t<e.length;t++)if(/^([^\'\"]*)(\"|\')$/.test(e[t])){e=e.slice(0,i).concat(e.slice(i,t+1).join("")).concat(e.slice(t+1));break}}for(var n={syntax:3,package:null,imports:[],enums:[],messages:[],options:{},extends:[]},a=!0;e.length;){switch(e[0]){case"package":n.package=L(e);break;case"syntax":if(!a)throw new Error("Protobuf syntax version should be first thing in file");n.syntax=V(e);break;case"message":n.messages.push(d(e));break;case"enum":n.enums.push(x(e));break;case"option":var o=v(e);if(n.options[o.name])throw new Error("Duplicate option "+o.name);n.options[o.name]=o.value;break;case"import":n.imports.push(H(e));break;case"extend":n.extends.push(X(e));break;case"service":n.services||(n.services=[]),n.services.push(K(e));break;default:throw new Error("Unexpected token: "+e[0])}a=!1}return n.extends.forEach(function(s){n.messages.forEach(function(f){f.name===s.name&&s.message.fields.forEach(function(p){if(!f.extensions||p.tag<f.extensions.from||p.tag>f.extensions.to)throw new Error(f.name+" does not declare "+p.tag+" as an extension number");f.fields.push(p)})})}),n},Y=W,b=function(r,e){var i=r.repeated?"repeated":r.required?"required":"optional";r.type==="map"&&(i="map<"+r.map.from+","+r.map.to+">"),r.oneof&&(i="");var t=Object.keys(r.options||{}).map(function(n){return n+" = "+r.options[n]}).join(",");return t&&(t=" ["+t+"]"),e.push((i?i+" ":"")+(r.map==="map"?"":r.type+" ")+r.name+" = "+r.tag+t+";"),e},y=function(r,e){e.push("message "+r.name+" {"),r.enums||(r.enums=[]),r.enums.forEach(function(t){e.push(_(t,[]))}),r.messages||(r.messages=[]),r.messages.forEach(function(t){e.push(y(t,[]))});var i={};return r.fields||(r.fields=[]),r.fields.forEach(function(t){t.oneof?(i[t.oneof]||(i[t.oneof]=[]),i[t.oneof].push(b(t,[]))):e.push(b(t,[]))}),Object.keys(i).forEach(function(t){i[t].unshift("oneof "+t+" {"),i[t].push("}"),e.push(i[t])}),e.push("}",""),e},_=function(r,e){e.push("enum "+r.name+" {");var i=Object.keys(r.values).map(function(t){return t+" = "+r.values[t]+";"});return e.push(i),e.push("}",""),e},w=function(r,e){var i=Object.keys(r);return i.forEach(function(t){var n=r[t];~t.indexOf(".")&&(t="("+t+")");var a=typeof n;a==="object"?(n=m(n,[]),n.length&&e.push("option "+t+" = {",n,"};")):(a==="string"&&t!=="optimize_for"&&(n='"'+n+'"'),e.push("option "+t+" = "+n+";"))}),i.length>0&&e.push(""),e},m=function(r,e){var i=Object.keys(r);return i.forEach(function(t){var n=r[t],a=typeof n;a==="object"?Array.isArray(n)?n.forEach(function(o){o=m(o,[]),o.length&&e.push(t+" {",o,"}")}):(n=m(n,[]),n.length&&e.push(t+" {",n,"}")):(a==="string"&&(n='"'+n+'"'),e.push(t+": "+n))}),e},k=function(r,e){return e.push("service "+r.name+" {"),r.options||(r.options={}),w(r.options,e),r.methods||(r.methods=[]),r.methods.forEach(function(i){e.push(rr(i,[]))}),e.push("}",""),e},rr=function(r,e){var i="rpc "+r.name+"(";r.client_streaming&&(i+="stream "),i+=r.input_type+") returns (",r.server_streaming&&(i+="stream "),i+=r.output_type+")",r.options||(r.options={});var t=w(r.options,[]);return t.length>1?e.push(i+" {",t.slice(0,-1),"}"):e.push(i+";"),e},j=function(r){return function(e){return Array.isArray(e)?e.map(j(r+"  ")).join(`
`):r+e}},er=function(r){var e=[];return e.push('syntax = "proto'+r.syntax+'";',""),r.package&&e.push("package "+r.package+";",""),r.options||(r.options={}),w(r.options,e),r.enums||(r.enums=[]),r.enums.forEach(function(i){_(i,e)}),r.messages||(r.messages=[]),r.messages.forEach(function(i){y(i,e)}),r.services&&r.services.forEach(function(i){k(i,e)}),e.map(j("")).join(`
`)},N=Y,ir=er;h.exports=N;h.exports.parse=N;h.exports.stringify=ir;var tr=h.exports,nr=tr,ar={array:"repeated",object:"message",integer:"int32",number:"int32",string:"string",boolean:"bool"},or=function(r){typeof r=="string"&&(r=JSON.parse(r));var e={syntax:2,package:null,enums:[],messages:[]};return r.type==="object"&&e.messages.push(U(r)),nr.stringify(e)};function U(r){var e={name:r.name,enums:[],messages:[],fields:[]},i=1;for(var t in r.properties){var n=r.properties[t];n.type==="object"?(n.name=t,e.messages.push(U(n))):(n.name=t,e.fields.push(fr(n,i)),i+=1)}for(var a in r.required){var o=r.required[a];for(var a in e.fields){var n=e.fields[a];o===n.name&&(n.required=!0)}}return e}function fr(r,e){var i=ar[r.type]||r.type,t=!1;return r.type==="array"&&(t=!0,i=r.items.type),{name:r.name,type:i,tag:e,repeated:t}}const sr=$(or),br=q({__name:"json-to-protobuf",setup(r){const{t:e}=F(),i=O("RootName");function t(a){try{const o=g.parse(a),s=JSON.stringify({name:i.value,...z.json(i.value,o)});return sr(s)}catch(o){return o.toString()}}const n=[{validator:a=>a===""||g.parse(a),message:e("tools.json-to-protobuf.texts.message-provided-json-is-not-valid")}];return(a,o)=>{const s=M;return A(),D(I,null,[E(s,{value:u(i),"onUpdate:value":o[0]||(o[0]=f=>S(i)?i.value=f:null),label:u(e)("tools.json-to-protobuf.texts.label-root-name"),"label-placement":"left"},null,8,["value","label"]),E(C,{"input-label":u(e)("tools.json-to-protobuf.texts.input-label-your-json"),"input-placeholder":u(e)("tools.json-to-protobuf.texts.input-placeholder-paste-your-json-here"),"output-label":u(e)("tools.json-to-protobuf.texts.output-label-protobuf-version-of-your-json-objects"),"input-validation-rules":n,transformer:t,"output-language":"protobuf"},null,8,["input-label","input-placeholder","output-label"])],64)}}});export{br as default};
