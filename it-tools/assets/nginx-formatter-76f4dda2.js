import{_ as x}from"./FormatTransformer-bc7b3ed5.js";import{b7 as y,p as d,d as v,a0 as $,o as w,j as I,l as h}from"./index-0c1fde36.js";import{r as b}from"./_empty-e6aebf7a.js";import{w as k}from"./defaults-4d6daddf.js";import"./TextareaCopyable-59231e95.js";import"./base64-ae7cf34b.js";import"./index-a6f01dde.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";function C(o=""){return!o||!o.includes("\\")?o:o.replace(/\\/g,"/")}const O=/^[/\\](?![/\\])|^[/\\]{2}(?!\.)|^[A-Za-z]:[/\\]/;function B(){return typeof d<"u"?d.cwd().replace(/\\/g,"/"):"/"}const W=function(...o){o=o.map(e=>C(e));let i="",t=!1;for(let e=o.length-1;e>=-1&&!t;e--){const n=e>=0?o[e]:B();!n||n.length===0||(i=`${n}/${i}`,t=g(n))}return i=A(i,!t),t&&!g(i)?`/${i}`:i.length>0?i:"."};function A(o,i){let t="",e=0,n=-1,r=0,s=null;for(let l=0;l<=o.length;++l){if(l<o.length)s=o[l];else{if(s==="/")break;s="/"}if(s==="/"){if(!(n===l-1||r===1))if(r===2){if(t.length<2||e!==2||t[t.length-1]!=="."||t[t.length-2]!=="."){if(t.length>2){const a=t.lastIndexOf("/");a===-1?(t="",e=0):(t=t.slice(0,a),e=t.length-1-t.lastIndexOf("/")),n=l,r=0;continue}else if(t.length>0){t="",e=0,n=l,r=0;continue}}i&&(t+=t.length>0?"/..":"..",e=2)}else t.length>0?t+=`/${o.slice(n+1,l)}`:t=o.slice(n+1,l),e=l-n-1;n=l,r=0}else s==="."&&r!==-1?++r:r=-1}return t}const g=function(o){return O.test(o)},L={indentStyle:"space",dontJoinCurlyBracket:!1,align:!1,trailingBlankLines:!1,extension:"conf"};function R(o,i,t){var e;t===void 0&&(t=i);const n=new RegExp(i),r=new RegExp(t),s=new RegExp(i+"(.*?)"+t);return n.test(o)&&r.test(o)&&((e=o.match(s))==null?void 0:e[1])||""}function _(o,i,t){t===void 0&&(t=i);const e={};let n,r=0;const s=i.length>0?i.charCodeAt(0):"",l=t.length>0?t.charCodeAt(0):"";for(;(n=R(o,i,t))!=="";){const a="#$#%#$#placeholder"+r+s+l+"#$#%#$#";e[a]=i+n+t,o=o.replace(e[a],a),r++}return{filteredInput:o,extracted:e,getRestored:function(){let a=this.filteredInput;for(const c in e)a=a.replace(c,e[c]);return a}}}function u(o){const i=o.trim(),t=_(i,'"','"');return t.filteredInput.includes("sub_filter")||(t.filteredInput=t.filteredInput.replace(/\s\s+/g," ")),t.getRestored()}const E="	",S="    ";class j{options;indentation;constructor(i){this.options={...L,...i||{}},this.options.indentStyle==="space"?this.indentation=S:this.indentation=E}async getFilePath(i){const{globby:t}=await y(()=>import("./index-88576aa2-dd7e0ea8.js"),["assets/index-88576aa2-dd7e0ea8.js","assets/index-0c1fde36.js","assets/index-290a8ba3.css","assets/empty-c5f13335.js","assets/index-cfd4d427.js","assets/index-fdbe2ce9.js","assets/string_decoder-8ac4312e.js","assets/index-649b5bab.js","assets/index-a6f01dde.js","assets/inherits_browser-6f38ab1b.js","assets/index-0397ab6f.js","assets/browser-14dfe747.js","assets/url-f77d30c7.js","assets/index-66a21f3e.js","assets/__vite-browser-external-66d318e3.js"]);return t(i,{expandDirectories:{extensions:[this.options.extension]}})}cleanLines(i){const t=i.split(/\r\n|\r|\n/g);for(let e=0,n=0;e<t.length;e++)if(t[e]=t[e].trim(),!t[e].startsWith("#")&&t[e]!==""){n=0;let r=t[e]=u(t[e]);if(r!=="}"&&r!=="{"&&!(r.includes("('{")||r.includes("}')")||r.includes("'{'")||r.includes("'}'"))){const s=r.indexOf("#");let l=s>=0?r.slice(0,s):r;const a=_(l,'"','"');l=a.filteredInput;const c=l.indexOf("}");if(c>=0){c>0&&(t[e]=u(l.slice(0,c-1)),t.splice(e+1,0,"}"));const p=u(l.slice(c+1));p!==""&&t.splice(e+2,0,p),l=t[e]}const f=l.indexOf("{");if(f>=0){t[e]=u(l.slice(0,f)),t.splice(e+1,0,"{");const p=u(l.slice(f+1));p!==""&&t.splice(e+2,0,p)}a.filteredInput=t[e],r=a.getRestored(),t[e]=r}}else t[e]===""&&n++>=2&&(t.splice(e,1),e--);for(let e=0,n=-1,r=-1,s=-1;e<t.length;e++)/.*\{(\s*)?(#.*)?$/.test(t[e])?r=e:t[e]===""&&n===-1?n=e:t[e].trim().startsWith("}")&&(s=e),n!==-1&&(r!==-1&&n-1===r?(t.splice(n,1),s>n&&s--,n=-1,e--):s!==-1&&n<s?(t.splice(n,s-n),s>n&&(s=s-(s-n)),n=-1,e--):e>n&&t[e]!==""&&(n=-1));return t}joinOpeningBracket(i){for(let t=0;t<i.length;t++)i[t]==="{"&&t>=1&&(i[t]=i[t-1]+" {",this.options.trailingBlankLines&&i.length>t+1&&i[t+1].length>0&&i.splice(t+1,0,""),i.splice(t-1,1));return i}performIndentation(i){const t=[];let e=0;for(const n of i)!n.startsWith("#")&&/.*?\}(\s*#.*)?$/.test(n)&&e>0&&(e-=1),n!==""?t.push(this.indentation.repeat(e)+n):t.push(""),!n.startsWith("#")&&/.*?\{(\s*#.*)?$/.test(n)&&(e+=1);return t}performAlignment(i){var t;const e=[],n=[];let r=0;for(const s of i){if(s!==""&&!s.endsWith("{")&&!s.startsWith("#")&&!s.endsWith("}")&&!s.trim().startsWith("upstream")&&!s.trim().includes("location")){const l=s.match(/\S+/g);if(l&&l.length>1){n.push(s);const a=s.indexOf(l[1])+1;r<a&&(r=a)}}e.push(s)}for(let s=0;s<e.length;s++){const l=e[s];if(n.includes(l)){const a=l.match(/\S+/g),c=(t=l.match(/\s+/g))==null?void 0:t[0];a&&c&&(e[s]=c+a[0]+" ".repeat(r-a[0].length-c.length)+a.slice(1,a.length).join(" "))}}return e}formatContent(i){let t=this.cleanLines(i);return this.options.dontJoinCurlyBracket||(t=this.joinOpeningBracket(t)),t=this.performIndentation(t),this.options.align&&(t=this.performAlignment(t)),t.join(`
`)}async formatFile(i){const t=await this.getFilePath(i);for(const e of t){W(d.cwd(),e);const n=await b();await this.formatContent(n)}}}function m(o,i){return new j(i).formatContent(o)}const P=`server {
listen 80 default_server;
listen [::]:80 default_server; 
root /var/www/html;  
index index.html; 
server_name _;  
location / {
try_files $uri $uri/ =404;
}
location /api/ {
proxy_pass http://localhost:8080/;
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection 'upgrade';
proxy_set_header Host $host;
proxy_cache_bypass $http_upgrade;
}  
}`,M=v({__name:"nginx-formatter",setup(o){const{t:i}=$();function t(n){return k(()=>m(n,{indentStyle:"space",dontJoinCurlyBracket:!1,align:!0,trailingBlankLines:!1,extension:"conf"}),"")}const e=[{validator:n=>n===""||m(n),message:i("tools.nginx-formatter.texts.message-provided-nginx-config-is-not-valid")}];return(n,r)=>{const s=x;return w(),I(s,{"input-label":h(i)("tools.nginx-formatter.texts.input-label-your-nginx-config"),"input-default":P,"input-placeholder":h(i)("tools.nginx-formatter.texts.input-placeholder-paste-your-nginx-config-here"),"output-label":h(i)("tools.nginx-formatter.texts.output-label-prettified-nginx-config"),"input-validation-rules":e,transformer:t},null,8,["input-label","input-placeholder","output-label"])}}});export{M as default};
