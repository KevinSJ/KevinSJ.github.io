import{V as ge}from"./index-24bd6b84.js";import{r as Q,cB as me,D as F,g as m,m as Z}from"./index-0c1fde36.js";class v extends Error{constructor(e,r){super(`${e} at position ${r}`),this.position=r}}const x=32,we=10,ee=9,ne=13,Ce=160,Se=8192,be=8202,ve=8239,Ne=8287,$e=12288;function ke(n){return/^[0-9A-Fa-f]$/.test(n)}function w(n){return n>="0"&&n<="9"}function Oe(n){return n>=" "}function j(n){return`,:[]/{}()
+`.includes(n)}function z(n){return n>="a"&&n<="z"||n>="A"&&n<="Z"||n==="_"||n==="$"}function T(n){return n>="a"&&n<="z"||n>="A"&&n<="Z"||n==="_"||n==="$"||n>="0"&&n<="9"}const q=/^(http|https|ftp|mailto|file|data|irc):\/\/$/,H=/^[A-Za-z0-9-._~:/?#@!$&'()*+;=]$/;function P(n){return`,[]/{}
+`.includes(n)}function G(n){return B(n)||ye.test(n)}const ye=/^[[{\w-]$/;function Ae(n){return n===`
`||n==="\r"||n==="	"||n==="\b"||n==="\f"}function C(n,e){const r=n.charCodeAt(e);return r===x||r===we||r===ee||r===ne}function Ee(n,e){const r=n.charCodeAt(e);return r===x||r===ee||r===ne}function Ve(n,e){const r=n.charCodeAt(e);return r===Ce||r>=Se&&r<=be||r===ve||r===Ne||r===$e}function B(n){return re(n)||D(n)}function re(n){return n==='"'||n==="“"||n==="”"}function X(n){return n==='"'}function D(n){return n==="'"||n==="‘"||n==="’"||n==="`"||n==="´"}function Y(n){return n==="'"}function k(n,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const p=n.lastIndexOf(e);return p!==-1?n.substring(0,p)+(r?"":n.substring(p+1)):n}function l(n,e){let r=n.length;if(!C(n,r-1))return n+e;for(;C(n,r-1);)r--;return n.substring(0,r)+e+n.substring(r)}function je(n,e,r){return n.substring(0,e)+n.substring(e+r)}function Be(n){return/[,\n][ \t\r]*$/.test(n)}const Je={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},We={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function Re(n){let e=0,r="";y(["```","[```","{```"]),c()||de(),y(["```","```]","```}"]);const d=N(",");for(d&&o(),G(n[e])&&Be(r)?(d||(r=l(r,",")),oe()):d&&(r=k(r,","));n[e]==="}"||n[e]==="]";)e++,o();if(e>=n.length)return r;fe();function c(){o();const i=se()||ue()||S()||te()||ae()||L(!1)||ce();return o(),i}function o(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const s=e;let u=f(i);do u=O(),u&&(u=f(i));while(u);return e>s}function f(i){const s=i?C:Ee;let u="";for(;;)if(s(n,e))u+=n[e],e++;else if(Ve(n,e))u+=" ",e++;else break;return u.length>0?(r+=u,!0):!1}function O(){if(n[e]==="/"&&n[e+1]==="*"){for(;e<n.length&&!Ie(n,e);)e++;return e+=2,!0}if(n[e]==="/"&&n[e+1]==="/"){for(;e<n.length&&n[e]!==`
`;)e++;return!0}return!1}function y(i){if(J(i)){if(z(n[e]))for(;e<n.length&&T(n[e]);)e++;return o(),!0}return!1}function J(i){f(!0);for(const s of i){const u=e+s.length;if(n.slice(e,u)===s)return e=u,!0}return!1}function N(i){return n[e]===i?(r+=n[e],e++,!0):!1}function A(i){return n[e]===i?(e++,!0):!1}function ie(){return A("\\")}function R(){return o(),n[e]==="."&&n[e+1]==="."&&n[e+2]==="."?(e+=3,o(),A(","),!0):!1}function se(){if(n[e]==="{"){r+="{",e++,o(),A(",")&&o();let i=!0;for(;e<n.length&&n[e]!=="}";){let s;if(i?(s=!0,i=!1):(s=N(","),s||(r=l(r,",")),o()),R(),!(S()||L(!0))){n[e]==="}"||n[e]==="{"||n[e]==="]"||n[e]==="["||n[e]===void 0?r=k(r,","):he();break}o();const V=N(":"),g=e>=n.length;V||(G(n[e])||g?r=l(r,":"):U()),c()||(V||g?r+="null":U())}return n[e]==="}"?(r+="}",e++):r=l(r,"}"),!0}return!1}function ue(){if(n[e]==="["){r+="[",e++,o(),A(",")&&o();let i=!0;for(;e<n.length&&n[e]!=="]";)if(i?i=!1:N(",")||(r=l(r,",")),R(),!c()){r=k(r,",");break}return n[e]==="]"?(r+="]",e++):r=l(r,"]"),!0}return!1}function oe(){let i=!0,s=!0;for(;s;)i?i=!1:N(",")||(r=l(r,",")),s=c();s||(r=k(r,",")),r=`[
${r}
]`}function S(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,u=n[e]==="\\";if(u&&(e++,u=!0),B(n[e])){const V=X(n[e])?X:Y(n[e])?Y:D(n[e])?D:re,g=e,$=r.length;let t='"';for(e++;;){if(e>=n.length){const a=M(e-1);return!i&&j(n.charAt(a))?(e=g,r=r.substring(0,$),S(!0)):(t=l(t,'"'),r+=t,!0)}if(e===s)return t=l(t,'"'),r+=t,!0;if(V(n[e])){const a=e,I=t.length;if(t+='"',e++,r+=t,o(!1),i||e>=n.length||j(n[e])||B(n[e])||w(n[e]))return K(),!0;const h=M(a-1),_=n.charAt(h);if(_===",")return e=g,r=r.substring(0,$),S(!1,h);if(j(_))return e=g,r=r.substring(0,$),S(!0);r=r.substring(0,$),e=a+1,t=`${t.substring(0,I)}\\${t.substring(I)}`}else if(i&&P(n[e])){if(n[e-1]===":"&&q.test(n.substring(g+1,e+2)))for(;e<n.length&&H.test(n[e]);)t+=n[e],e++;return t=l(t,'"'),r+=t,K(),!0}else if(n[e]==="\\"){const a=n.charAt(e+1);if(We[a]!==void 0)t+=n.slice(e,e+2),e+=2;else if(a==="u"){let h=2;for(;h<6&&ke(n[e+h]);)h++;h===6?(t+=n.slice(e,e+6),e+=6):e+h>=n.length?e=n.length:pe()}else t+=a,e+=2}else{const a=n.charAt(e);a==='"'&&n[e-1]!=="\\"?(t+=`\\${a}`,e++):Ae(a)?(t+=Je[a],e++):(Oe(a)||le(a),t+=a,e++)}u&&ie()}}return!1}function K(){let i=!1;for(o();n[e]==="+";){i=!0,e++,o(),r=k(r,'"',!0);const s=r.length;S()?r=je(r,s,1):r=l(r,'"')}return i}function te(){const i=e;if(n[e]==="-"){if(e++,E())return W(i),!0;if(!w(n[e]))return e=i,!1}for(;w(n[e]);)e++;if(n[e]==="."){if(e++,E())return W(i),!0;if(!w(n[e]))return e=i,!1;for(;w(n[e]);)e++}if(n[e]==="e"||n[e]==="E"){if(e++,(n[e]==="-"||n[e]==="+")&&e++,E())return W(i),!0;if(!w(n[e]))return e=i,!1;for(;w(n[e]);)e++}if(!E())return e=i,!1;if(e>i){const s=n.slice(i,e),u=/^0\d/.test(s);return r+=u?`"${s}"`:s,!0}return!1}function ae(){return b("true","true")||b("false","false")||b("null","null")||b("True","true")||b("False","false")||b("None","null")}function b(i,s){return n.slice(e,e+i.length)===i?(r+=s,e+=i.length,!0):!1}function L(i){const s=e;if(z(n[e])){for(;e<n.length&&T(n[e]);)e++;let u=e;for(;C(n,u);)u++;if(n[u]==="(")return e=u+1,c(),n[e]===")"&&(e++,n[e]===";"&&e++),!0}for(;e<n.length&&!P(n[e])&&!B(n[e])&&(!i||n[e]!==":");)e++;if(n[e-1]===":"&&q.test(n.substring(s,e+2)))for(;e<n.length&&H.test(n[e]);)e++;if(e>s){for(;C(n,e-1)&&e>0;)e--;const u=n.slice(s,e);return r+=u==="undefined"?"null":JSON.stringify(u),n[e]==='"'&&e++,!0}}function ce(){if(n[e]==="/"){const i=e;for(e++;e<n.length&&(n[e]!=="/"||n[e-1]==="\\");)e++;return e++,r+=`"${n.substring(i,e)}"`,!0}}function M(i){let s=i;for(;s>0&&C(n,s);)s--;return s}function E(){return e>=n.length||j(n[e])||C(n,e)}function W(i){r+=`${n.slice(i,e)}0`}function le(i){throw new v(`Invalid character ${JSON.stringify(i)}`,e)}function fe(){throw new v(`Unexpected character ${JSON.stringify(n[e])}`,e)}function de(){throw new v("Unexpected end of json string",n.length)}function he(){throw new v("Object key expected",e)}function U(){throw new v("Colon expected",e)}function pe(){const i=n.slice(e,e+6);throw new v(`Invalid unicode character "${i}"`,e)}}function Ie(n,e){return n[e]==="*"&&n[e+1]==="/"}function Ke({json:n,schemaUrl:e,schemaData:r}){const p=Q([]),d=Q(null),c=Q([]);return me(async()=>{const f=await(await fetch("https://www.schemastore.org/api/json/catalog.json")).json();p.value=f.schemas}),F([e,r].filter(Z),async()=>{if(m(e)===""&&(d.value=null,c.value=[]),m(e)==="custom"){try{d.value=JSON.parse(m(r))}catch(o){c.value=[`Schema parsing error:${o.toString()}`]}return}if(m(e))try{const f=await(await fetch(m(e))).json();d.value=f}catch(o){c.value=[`Schema fetching error:${o.toString()}`]}},{immediate:!0}),F([n,d].filter(Z),()=>{const o=m(d),f=m(n);if(!o){c.value=[];return}if(!f){c.value=[];return}try{const y=new ge().validate(JSON.parseBigNum(f),o);c.value=y.errors.map(J=>J.stack??"")}catch(O){c.value=[`JSON validation error:${O.toString()}`]}},{immediate:!0}),{schemas:p,errors:c}}export{Re as j,Ke as u};
