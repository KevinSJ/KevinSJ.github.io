import{d as ce,a0 as de,r as F,E as W,R as Z,aX as k,o as B,c as fe,k as V,w as P,l as c,m as X,a as me,a6 as q,G as Y,j as M,ad as z,x as xe,aj as _e,af as ve,ag as be}from"./index-0c1fde36.js";import{_ as he}from"./TextareaCopyable-59231e95.js";import{w as Q,m as A,v as ye,p as le,n as ge,c as ae,d as oe,o as ne,P as re,q as se,t as we,x as je,b as ie,r as Ue,M as J,g as L,h as pe,a as Ae,T as ee,e as H,f as te,l as Ee}from"./key-f86f55cb.js";import{_ as Te}from"./Switch-a0f825a4.js";import{_ as Ve}from"./FormItem-1b9a5952.js";import{_ as Ce}from"./Space-7fc52151.js";import{_ as Ke}from"./Checkbox-ba7202eb.js";import"./base64-ae7cf34b.js";import"./index-a6f01dde.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./context-00991937.js";import"./get-slot-1efb97e5.js";const Ne=20;function $e(t,e,l){let v=1634760805,E=857760878,j=2036477234,T=1797285236,U=l[3]<<24|l[2]<<16|l[1]<<8|l[0],C=l[7]<<24|l[6]<<16|l[5]<<8|l[4],b=l[11]<<24|l[10]<<16|l[9]<<8|l[8],R=l[15]<<24|l[14]<<16|l[13]<<8|l[12],O=l[19]<<24|l[18]<<16|l[17]<<8|l[16],D=l[23]<<24|l[22]<<16|l[21]<<8|l[20],S=l[27]<<24|l[26]<<16|l[25]<<8|l[24],K=l[31]<<24|l[30]<<16|l[29]<<8|l[28],m=e[3]<<24|e[2]<<16|e[1]<<8|e[0],N=e[7]<<24|e[6]<<16|e[5]<<8|e[4],I=e[11]<<24|e[10]<<16|e[9]<<8|e[8],$=e[15]<<24|e[14]<<16|e[13]<<8|e[12],f=v,d=E,_=j,x=T,o=U,n=C,a=b,u=R,h=O,y=D,g=S,w=K,r=m,s=N,i=I,p=$;for(let G=0;G<Ne;G+=2)f=f+o|0,r^=f,r=r>>>32-16|r<<16,h=h+r|0,o^=h,o=o>>>32-12|o<<12,d=d+n|0,s^=d,s=s>>>32-16|s<<16,y=y+s|0,n^=y,n=n>>>32-12|n<<12,_=_+a|0,i^=_,i=i>>>32-16|i<<16,g=g+i|0,a^=g,a=a>>>32-12|a<<12,x=x+u|0,p^=x,p=p>>>32-16|p<<16,w=w+p|0,u^=w,u=u>>>32-12|u<<12,_=_+a|0,i^=_,i=i>>>32-8|i<<8,g=g+i|0,a^=g,a=a>>>32-7|a<<7,x=x+u|0,p^=x,p=p>>>32-8|p<<8,w=w+p|0,u^=w,u=u>>>32-7|u<<7,d=d+n|0,s^=d,s=s>>>32-8|s<<8,y=y+s|0,n^=y,n=n>>>32-7|n<<7,f=f+o|0,r^=f,r=r>>>32-8|r<<8,h=h+r|0,o^=h,o=o>>>32-7|o<<7,f=f+n|0,p^=f,p=p>>>32-16|p<<16,g=g+p|0,n^=g,n=n>>>32-12|n<<12,d=d+a|0,r^=d,r=r>>>32-16|r<<16,w=w+r|0,a^=w,a=a>>>32-12|a<<12,_=_+u|0,s^=_,s=s>>>32-16|s<<16,h=h+s|0,u^=h,u=u>>>32-12|u<<12,x=x+o|0,i^=x,i=i>>>32-16|i<<16,y=y+i|0,o^=y,o=o>>>32-12|o<<12,_=_+u|0,s^=_,s=s>>>32-8|s<<8,h=h+s|0,u^=h,u=u>>>32-7|u<<7,x=x+o|0,i^=x,i=i>>>32-8|i<<8,y=y+i|0,o^=y,o=o>>>32-7|o<<7,d=d+a|0,r^=d,r=r>>>32-8|r<<8,w=w+r|0,a^=w,a=a>>>32-7|a<<7,f=f+n|0,p^=f,p=p>>>32-8|p<<8,g=g+p|0,n^=g,n=n>>>32-7|n<<7;A(f+v|0,t,0),A(d+E|0,t,4),A(_+j|0,t,8),A(x+T|0,t,12),A(o+U|0,t,16),A(n+C|0,t,20),A(a+b|0,t,24),A(u+R|0,t,28),A(h+O|0,t,32),A(y+D|0,t,36),A(g+S|0,t,40),A(w+K|0,t,44),A(r+m|0,t,48),A(s+N|0,t,52),A(i+I|0,t,56),A(p+$|0,t,60)}function De(t,e,l,v,E=0){if(t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(v.length<l.length)throw new Error("ChaCha: destination is shorter than source");let j,T;if(E===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");j=new Uint8Array(16),T=j.length-e.length,j.set(e,T)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");j=e,T=E}const U=new Uint8Array(64);for(let C=0;C<l.length;C+=64){$e(U,j,t);for(let b=C;b<C+64&&b<l.length;b++)v[b]=l[b]^U[b-C];Se(j,0,T)}return Q(U),E===0&&Q(j),v}function Se(t,e,l){let v=1;for(;l--;)v=v+(t[e]&255)|0,t[e]=v&255,v>>>=8,e++;if(v>0)throw new Error("ChaCha: counter overflow")}const Pe=20;function ue(t,e,l,v){if(e.length!==24)throw new Error("XChaCha20 nonce must be 24 bytes");const E=Ie(t,e.subarray(0,16),new Uint8Array(32)),j=new Uint8Array(12);j.set(e.subarray(16),4);const T=De(E,j,l,v);return Q(E),T}function Ie(t,e,l){let v=1634760805,E=857760878,j=2036477234,T=1797285236,U=t[3]<<24|t[2]<<16|t[1]<<8|t[0],C=t[7]<<24|t[6]<<16|t[5]<<8|t[4],b=t[11]<<24|t[10]<<16|t[9]<<8|t[8],R=t[15]<<24|t[14]<<16|t[13]<<8|t[12],O=t[19]<<24|t[18]<<16|t[17]<<8|t[16],D=t[23]<<24|t[22]<<16|t[21]<<8|t[20],S=t[27]<<24|t[26]<<16|t[25]<<8|t[24],K=t[31]<<24|t[30]<<16|t[29]<<8|t[28],m=e[3]<<24|e[2]<<16|e[1]<<8|e[0],N=e[7]<<24|e[6]<<16|e[5]<<8|e[4],I=e[11]<<24|e[10]<<16|e[9]<<8|e[8],$=e[15]<<24|e[14]<<16|e[13]<<8|e[12],f=v,d=E,_=j,x=T,o=U,n=C,a=b,u=R,h=O,y=D,g=S,w=K,r=m,s=N,i=I,p=$;for(let G=0;G<Pe;G+=2)f=f+o|0,r^=f,r=r>>>32-16|r<<16,h=h+r|0,o^=h,o=o>>>32-12|o<<12,d=d+n|0,s^=d,s=s>>>32-16|s<<16,y=y+s|0,n^=y,n=n>>>32-12|n<<12,_=_+a|0,i^=_,i=i>>>32-16|i<<16,g=g+i|0,a^=g,a=a>>>32-12|a<<12,x=x+u|0,p^=x,p=p>>>32-16|p<<16,w=w+p|0,u^=w,u=u>>>32-12|u<<12,_=_+a|0,i^=_,i=i>>>32-8|i<<8,g=g+i|0,a^=g,a=a>>>32-7|a<<7,x=x+u|0,p^=x,p=p>>>32-8|p<<8,w=w+p|0,u^=w,u=u>>>32-7|u<<7,d=d+n|0,s^=d,s=s>>>32-8|s<<8,y=y+s|0,n^=y,n=n>>>32-7|n<<7,f=f+o|0,r^=f,r=r>>>32-8|r<<8,h=h+r|0,o^=h,o=o>>>32-7|o<<7,f=f+n|0,p^=f,p=p>>>32-16|p<<16,g=g+p|0,n^=g,n=n>>>32-12|n<<12,d=d+a|0,r^=d,r=r>>>32-16|r<<16,w=w+r|0,a^=w,a=a>>>32-12|a<<12,_=_+u|0,s^=_,s=s>>>32-16|s<<16,h=h+s|0,u^=h,u=u>>>32-12|u<<12,x=x+o|0,i^=x,i=i>>>32-16|i<<16,y=y+i|0,o^=y,o=o>>>32-12|o<<12,_=_+u|0,s^=_,s=s>>>32-8|s<<8,h=h+s|0,u^=h,u=u>>>32-7|u<<7,x=x+o|0,i^=x,i=i>>>32-8|i<<8,y=y+i|0,o^=y,o=o>>>32-7|o<<7,d=d+a|0,r^=d,r=r>>>32-8|r<<8,w=w+r|0,a^=w,a=a>>>32-7|a<<7,f=f+n|0,p^=f,p=p>>>32-8|p<<8,g=g+p|0,n^=g,n=n>>>32-7|n<<7;return A(f,l,0),A(d,l,4),A(_,l,8),A(x,l,12),A(r,l,16),A(s,l,20),A(i,l,24),A(p,l,28),l}function Re(t,e,{assertion:l=new Uint8Array(0),maxDepth:v=J,maxKeys:E=L,validatePayload:j=!0}={assertion:new Uint8Array(0),maxDepth:J,maxKeys:L,validatePayload:!0}){ye("local",e),t=le("local",t);const{nonce:T,ciphertext:U,tag:C,footer:b}=ge(e);ae(b,{maxDepth:v,maxKeys:E,validate:!!j}),l=oe(l);const{encryptionKey:R,counterNonce:O,authKey:D}=ne(t,T),S=re(pe.v4.local,T,U,b,l),K=se(S,32,{key:D});if(!we(C,K))throw new je("Decryption failed: invalid authentication tag");const m=ue(R,O,U,new Uint8Array(U.length));return{payload:ie(m,{addExp:!1,addIat:!1,validate:!!j}),footer:Ue(b)}}function Oe(t,e,{footer:l=new Uint8Array(0),assertion:v=new Uint8Array(0),addIat:E=!0,addExp:j=!0,maxDepth:T=J,maxKeys:U=L,validatePayload:C=!0,getRandomValues:b=void 0}={footer:new Uint8Array(0),assertion:new Uint8Array(0),addIat:!0,addExp:!0,maxDepth:J,maxKeys:L,validatePayload:!0,getRandomValues:void 0}){if(t=le("local",t),b=b??(typeof globalThis<"u"&&globalThis.crypto?.getRandomValues?globalThis.crypto.getRandomValues.bind(globalThis.crypto):void 0),!b)throw new Error("No compatible getRandomValues implementation detected in the global scope. Please pass a getRandomValues implementation to the options object (signature: getRandomValues<Uint8Array>(array: Uint8Array): Uint8Array)");const R=Ae(ie(e,{addExp:!!j,addIat:!!E,maxDepth:T,maxKeys:U,validate:!!C})),O=ae(l,{maxDepth:T,maxKeys:U,validate:!!C});v=oe(v);const D=b(new Uint8Array(32)),{encryptionKey:S,counterNonce:K,authKey:m}=ne(t,D),N=ue(S,K,R,new Uint8Array(R.length)),I=re(pe.v4.local,D,N,O,v),$=se(I,32,{key:m});return l.length===0?`${ee.v4.local}${H(te(D,N,$))}`:`${ee.v4.local}${H(te(D,N,$))}.${H(O)}`}const Be={flex:"","justify-center":""},lt=ce({__name:"paseto-encryption",setup(t){const{t:e}=de(),l=F(`{
  "sub": "1234567890",
  "name": "John Doe",
  "iat": "${new Date().toISOString()}"
}`),v=F("{}"),E=F(""),j=F(!0),T=F(!0),U=F(!0);function C(){E.value=Ee("local")}C();const b=W(async()=>{const K=E.value,m=l.value,N=j.value,I=T.value,$=v.value,f=U.value;try{return{token:await Oe(K,m,{addExp:N,addIat:I,footer:$,validatePayload:f}),error:""}}catch(d){return{error:d.toString(),token:""}}}),R=Z({source:l,rules:[{message:e("tools.paseto-encryption.texts.message-invalid-json-string"),validator:K=>k.parse(K)}]}),O=Z({source:v,rules:[{message:e("tools.paseto-encryption.texts.message-invalid-json-string"),validator:K=>k.parse(K)}]}),D=F(""),S=W(async()=>{const K=E.value,m=D.value,N=U.value;try{const{payload:I,footer:$}=await Re(K,m,{validatePayload:N});return{payload:I,footer:$,error:""}}catch(I){return{error:I.toString(),payload:"",footer:""}}});return(K,m)=>{const N=xe,I=_e,$=ve,f=Te,d=Ve,_=Ce,x=he,o=be,n=Ke;return B(),fe("div",null,[V($,{title:c(e)("tools.paseto-encryption.texts.title-local-key"),"mb-2":""},{default:P(()=>[V(N,{value:c(E),"onUpdate:value":m[0]||(m[0]=a=>X(E)?E.value=a:null),label:c(e)("tools.paseto-encryption.texts.label-local-key"),"label-position":"left",placeholder:c(e)("tools.paseto-encryption.texts.placeholder-paserk-local-key-k4-local-xxxx"),"mb-2":""},null,8,["value","label","placeholder"]),me("div",Be,[V(I,{onClick:m[1]||(m[1]=a=>C())},{default:P(()=>[q(Y(c(e)("tools.paseto-encryption.texts.tag-refresh-key")),1)]),_:1})])]),_:1},8,["title"]),V($,{title:c(e)("tools.paseto-encryption.texts.title-encryption"),"mb-2":""},{default:P(()=>[V(N,{value:c(l),"onUpdate:value":m[2]||(m[2]=a=>X(l)?l.value=a:null),label:c(e)("tools.paseto-encryption.texts.label-payload"),multiline:"",rows:"5",autosize:"",placeholder:c(e)("tools.paseto-encryption.texts.placeholder-json-payload"),validation:c(R)},null,8,["value","label","placeholder","validation"]),V(_,{justify:"center"},{default:P(()=>[V(d,{label:c(e)("tools.paseto-encryption.texts.label-validate-payload"),"label-placement":"left"},{default:P(()=>[V(f,{value:c(U),"onUpdate:value":m[3]||(m[3]=a=>X(U)?U.value=a:null)},null,8,["value"])]),_:1},8,["label"]),V(d,{label:c(e)("tools.paseto-encryption.texts.label-add-exp"),"label-placement":"left"},{default:P(()=>[V(f,{value:c(j),"onUpdate:value":m[4]||(m[4]=a=>X(j)?j.value=a:null)},null,8,["value"])]),_:1},8,["label"]),V(d,{label:c(e)("tools.paseto-encryption.texts.label-add-iat"),"label-placement":"left"},{default:P(()=>[V(f,{value:c(T),"onUpdate:value":m[5]||(m[5]=a=>X(T)?T.value=a:null)},null,8,["value"])]),_:1},8,["label"])]),_:1}),V(N,{value:c(v),"onUpdate:value":m[6]||(m[6]=a=>X(v)?v.value=a:null),label:c(e)("tools.paseto-encryption.texts.label-footer"),multiline:"",rows:"2",autosize:"",placeholder:c(e)("tools.paseto-encryption.texts.placeholder-json-footer"),validation:c(O),"mb-2":""},null,8,["value","label","placeholder","validation"]),c(b)?(B(),M($,{key:0,title:c(e)("tools.paseto-encryption.texts.title-generated-paserk-token"),"mb-2":""},{default:P(()=>[c(b).token?(B(),M(x,{key:0,value:c(b).token,"word-wrap":""},null,8,["value"])):z("",!0),c(b).error?(B(),M(o,{key:1},{default:P(()=>[q(Y(c(b).error),1)]),_:1})):z("",!0)]),_:1},8,["title"])):z("",!0)]),_:1},8,["title"]),V($,{title:c(e)("tools.paseto-encryption.texts.title-decryption"),"mb-2":""},{default:P(()=>[V(N,{value:c(D),"onUpdate:value":m[7]||(m[7]=a=>X(D)?D.value=a:null),label:c(e)("tools.paseto-encryption.texts.label-token"),multiline:"",rows:"5",autosize:"",placeholder:c(e)("tools.paseto-encryption.texts.placeholder-paserk-token")},null,8,["value","label","placeholder"]),V(_,{justify:"center"},{default:P(()=>[V(d,{label:c(e)("tools.paseto-encryption.texts.label-validate-payload"),"label-placement":"left"},{default:P(()=>[V(n,{checked:c(U),"onUpdate:checked":m[8]||(m[8]=a=>X(U)?U.value=a:null)},null,8,["checked"])]),_:1},8,["label"])]),_:1}),c(S)?(B(),M($,{key:0,title:c(e)("tools.paseto-encryption.texts.title-decoded-paserk"),"mb-2":""},{default:P(()=>[c(S).payload?(B(),M(d,{key:0,label:c(e)("tools.paseto-encryption.texts.label-payload")},{default:P(()=>[V(x,{value:JSON.stringify(c(S).payload,null,2),"word-wrap":""},null,8,["value"])]),_:1},8,["label"])):z("",!0),c(S).footer?(B(),M(d,{key:1,label:c(e)("tools.paseto-encryption.texts.label-footer")},{default:P(()=>[V(x,{value:JSON.stringify(c(S).footer,null,2),"word-wrap":""},null,8,["value"])]),_:1},8,["label"])):z("",!0),c(S).error?(B(),M(o,{key:2},{default:P(()=>[q(Y(c(S).error),1)]),_:1})):z("",!0)]),_:1},8,["title"])):z("",!0)]),_:1},8,["title"])])}}});export{lt as default};
