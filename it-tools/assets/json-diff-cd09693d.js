import{_ as u,dx as w,k as r,a7 as g,a6 as N,f as F,d as T,bY as S,l,r as x,F as $,bZ as L,i as h,o as v,c as b,a as I,w as V,m as k,j as M,ad as O,af as X,bq as Y,a0 as Z,aX as z,x as G}from"./index-0c1fde36.js";import{_ as H}from"./Switch-a0f825a4.js";import{_ as K}from"./FormItem-1b9a5952.js";import{w as J}from"./defaults-4d6daddf.js";import{i as P}from"./boolean-c7e7c785.js";import"./context-00991937.js";function Q(e,t,{onlyShowDifferences:s=!1}={}){return u.isArray(e)&&u.isArray(t)?{key:"",type:"array",children:D(e,t,{onlyShowDifferences:s}),oldValue:e,value:t,status:m(e,t)}:u.isObject(e)&&u.isObject(t)?{key:"",type:"object",children:j(e,t,{onlyShowDifferences:s}),oldValue:e,value:t,status:m(e,t)}:{key:"",type:"value",oldValue:e,value:t,status:m(e,t)}}function j(e,t,{onlyShowDifferences:s=!1}={}){return Object.keys({...e,...t}).map(o=>C(e?.[o],t?.[o],o,{onlyShowDifferences:s})).filter(o=>!s||o.status!=="unchanged")}function C(e,t,s,{onlyShowDifferences:a=!1}={}){const o=_(e);return o==="object"?{key:s,type:o,children:j(e,t,{onlyShowDifferences:a}),oldValue:e,value:t,status:m(e,t)}:o==="array"?{key:s,type:o,children:D(e,t,{onlyShowDifferences:a}),value:t,oldValue:e,status:m(e,t)}:{key:s,type:o,value:t,oldValue:e,status:m(e,t)}}function D(e,t,{onlyShowDifferences:s=!1}={}){const a=Math.max(0,e?.length,t?.length);return Array.from({length:a},(o,n)=>C(e?.[n],t?.[n],n,{onlyShowDifferences:s})).filter(o=>!s||o.status!=="unchanged")}function _(e){return e===null?"value":Array.isArray(e)?"array":w.isDecimal(e)?"value":typeof e=="object"?"object":"value"}function m(e,t){if(e===void 0)return"added";if(t===void 0)return"removed";const s=_(e)==="object"&&_(t)==="object",a=_(e)==="array"&&_(t)==="array";return u.isEqual(e,t)?"unchanged":s||a?"children-updated":"updated"}function W({diff:e}){return r("div",{class:"diffs-viewer"},[r("ul",null,[B({diff:e,showKeys:!1})])])}function B({diff:e,showKeys:t=!0}){const{type:s,status:a}=e;return a==="updated"?te({diff:e,showKeys:t}):s==="array"?A({diff:e,showKeys:t,showChildrenKeys:!1,openTag:"[",closeTag:"]"}):s==="object"?A({diff:e,showKeys:t,openTag:"{",closeTag:"}"}):ee({diff:e,showKeys:t})}function ee({diff:e,showKeys:t}){const{value:s,key:a,status:o,oldValue:n}=e,i=o==="removed"?n:s;return r("li",null,[r("span",{class:[o,"result"]},[t&&r(g,null,[r("span",{class:"key"},[a]),": "]),y({value:i,status:o})]),N(",")])}function te({diff:e,showKeys:t}){const{value:s,key:a,oldValue:o}=e;return r("li",{class:"updated-line"},[t&&r(g,null,[r("span",{class:"key"},[a]),": "]),y({value:o,status:"removed"}),y({value:s,status:"added"}),N(",")])}function A({diff:e,openTag:t,closeTag:s,showKeys:a,showChildrenKeys:o=!0}){const{children:n,key:i,status:c,type:d,oldValue:p}=e;return r("li",null,[r("div",{class:[d,c],style:{display:"inline-block"}},[a&&r(g,null,[r("span",{class:"key"},[i]),": "]),n.length===0&&c==="removed"&&y({value:p,status:"removed"}),n.length>0&&t,n.length>0&&r("ul",null,[n.map(f=>B({diff:f,showKeys:o}))]),n.length>0&&`${s},`])])}function se(e){return u.isNull(e)?"null":JSON.stringify(e,null,8)}function y({value:e,status:t}){const s=se(e),{copy:a}=F({source:s});return r("span",{class:["value",t],style:"word-break: break-word; white-space: pre-wrap",onClick:()=>a()},[s])}const oe={key:0},ae={flex:"","justify-center":""},re={key:0,"text-center":"","op-70":""},ne=T({__name:"diff-viewer",props:{leftJson:{},rightJson:{}},setup(e){const t=e;S(p=>({"7a613f80":l(n).text.mutedColor,ed7825ee:l(n).success.colorFaded,"31e3079f":l(n).success.color,"8956bfb8":l(n).error.colorFaded,"3a20e0b8":l(n).error.color,"29d2da8a":l(n).text.baseColor}));const s=x(!1),{leftJson:a,rightJson:o}=$(t),n=L(),i=h(()=>Q(a.value,o.value,{onlyShowDifferences:s.value})),c=h(()=>u.isEqual(a.value,o.value)),d=h(()=>!u.isUndefined(a.value)&&!u.isUndefined(o.value));return(p,f)=>{const E=H,R=K,q=X;return l(d)?(v(),b("div",oe,[I("div",ae,[r(R,{label:"Only show differences","label-placement":"left"},{default:V(()=>[r(E,{value:l(s),"onUpdate:value":f[0]||(f[0]=U=>k(s)?s.value=U:null)},null,8,["value"])]),_:1})]),r(q,{"data-test-id":"diff-result"},{default:V(()=>[l(c)?(v(),b("div",re," The provided JSONs are the same ")):(v(),M(l(W),{key:1,diff:l(i)},null,8,["diff"]))]),_:1})])):O("",!0)}}});const le=Y(ne,[["__scopeId","data-v-d84bb557"]]),me=T({__name:"json-diff",setup(e){const{t}=Z(),s=x(""),a=x(""),o=h(()=>J(()=>JSON.parseBigNum(s.value),void 0)),n=h(()=>J(()=>JSON.parseBigNum(a.value),void 0)),i=[{validator:c=>c===""||P(()=>z.parse(c)),message:t("tools.json-diff.texts.message-invalid-json-format")}];return(c,d)=>{const p=G;return v(),b(g,null,[r(p,{value:l(s),"onUpdate:value":d[0]||(d[0]=f=>k(s)?s.value=f:null),"validation-rules":i,label:l(t)("tools.json-diff.texts.label-your-first-json"),placeholder:l(t)("tools.json-diff.texts.placeholder-paste-your-first-json-here"),rows:"20",multiline:"","test-id":"leftJson","raw-text":"",monospace:""},null,8,["value","label","placeholder"]),r(p,{value:l(a),"onUpdate:value":d[1]||(d[1]=f=>k(a)?a.value=f:null),"validation-rules":i,label:l(t)("tools.json-diff.texts.label-your-json-to-compare"),placeholder:l(t)("tools.json-diff.texts.placeholder-paste-your-json-to-compare-here"),rows:"20",multiline:"","test-id":"rightJson","raw-text":"",monospace:""},null,8,["value","label","placeholder"]),r(le,{"left-json":l(o),"right-json":l(n)},null,8,["left-json","right-json"])],64)}}});export{me as default};
