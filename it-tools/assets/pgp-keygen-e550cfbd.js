import{d as R,a0 as D,r as k,al as j,R as A,o as S,c as T,a as r,j as V,w as s,a6 as x,G as p,l as e,k as l,ad as B,m as _,b8 as W,ag as q,ae as z,ak as E,ah as G,s as F}from"./index-0c1fde36.js";import{R as H,u as U}from"./openpgp.min-274e41ac.js";import{_ as P}from"./TextareaCopyable-59231e95.js";import{c as J}from"./computedRefreshable-6ca60894.js";import{_ as L}from"./a-07fc27a5.js";import{_ as M}from"./FormItem-1b9a5952.js";import"./index-a6f01dde.js";import"./index-892bd980.js";import"./browser-703720a1.js";import"./index-649b5bab.js";import"./inherits_browser-6f38ab1b.js";import"./index-0397ab6f.js";import"./index-fdbe2ce9.js";import"./string_decoder-8ac4312e.js";import"./hash-f152040d.js";import"./base64-ae7cf34b.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./context-00991937.js";const O={"mb-4":""},Q={style:{flex:"0 0 100%"}},X={"item-style":"flex: 1 1 0",style:{"max-width":"600px"},"mx-auto":"",flex:"","gap-3":""},Y={"text-center":""},he=R({__name:"pgp-keygen",setup(Z){const{t}=D();H.rejectCurves=new Set;function h(){return window.isSecureContext}const m=k(4096),v=k(""),g=k(""),y=k(""),n=j("pgp-key-pair-generator:format",h()?"curve25519":"p256"),I=h()?["rsa","curve25519","curve448","ed25519","p256","p384","p521","brainpoolP256r1","brainpoolP384r1","brainpoolP512r1","secp256k1"]:["p256","p384","p521","brainpoolP256r1","brainpoolP384r1","brainpoolP512r1","secp256k1"],{attrs:N}=A({source:m,rules:[{message:"Bits should be 256 <= bits <= 16384 and be a multiple of 8",validator:i=>i>=256&&i<=16384&&i%8===0}]}),[w,$]=J(async()=>{const i=n.value,o=y.value,f=v.value,b=g.value,C=m.value;try{if(n.value==="rsa"){const{privateKey:K,publicKey:a}=await U({type:"rsa",rsaBits:C,userIDs:[{name:f,email:b}],passphrase:o,format:"armored"});return{privateKey:K,publicKey:a,revocationCertificate:""}}const{privateKey:u,publicKey:c,revocationCertificate:d}=await U({type:n.value==="curve448"?"curve448":"ecc",curve:i,userIDs:[{name:f,email:b}],passphrase:o,format:"armored"});return{privateKey:u,publicKey:c,revocationCertificate:d}}catch(u){return{privateKey:`#${u.toString()}`,publicKey:`#${u.toString()}`,revocationCertificate:""}}},{privateKey:"",publicKey:"",revocationCertificate:""});return(i,o)=>{const f=L,b=q,C=z,u=E,c=M,d=G,K=F;return S(),T("div",null,[r("div",O,[h()?B("",!0):(S(),V(b,{key:0,"mb-2":""},{default:s(()=>[x(p(e(t)("tools.pgp-keygen.texts.tag-your-browser-is-not-in")),1),l(f,{href:"https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts",target:"_blank"},{default:s(()=>[x(p(e(t)("tools.pgp-keygen.texts.tag-secure-context-https")),1)]),_:1}),x(p(e(t)("tools.pgp-keygen.texts.tag-this-tool-may-not-work-correctly-and-require-https-to-work-fully")),1)]),_:1})),r("div",Q,[r("div",X,[l(C,{value:e(n),"onUpdate:value":o[0]||(o[0]=a=>_(n)?n.value=a:null),"label-position":"left",label:e(t)("tools.pgp-keygen.texts.label-format"),options:e(I),placeholder:e(t)("tools.pgp-keygen.texts.placeholder-select-a-key-format"),style:{"min-width":"150px"}},null,8,["value","label","options","placeholder"]),e(n)==="rsa"?(S(),V(c,W({key:0,label:e(t)("tools.pgp-keygen.texts.label-rsa-bits")},e(N),{"label-placement":"left"}),{default:s(()=>[l(u,{value:e(m),"onUpdate:value":o[1]||(o[1]=a=>_(m)?m.value=a:null),min:"256",max:"16384",step:"8"},null,8,["value"])]),_:1},16,["label"])):B("",!0)])])]),r("div",null,[l(c,{label:e(t)("tools.pgp-keygen.texts.label-user-name"),"label-placement":"left"},{default:s(()=>[l(d,{value:e(v),"onUpdate:value":o[2]||(o[2]=a=>_(v)?v.value=a:null),type:"text",placeholder:e(t)("tools.pgp-keygen.texts.placeholder-user-name")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(c,{label:e(t)("tools.pgp-keygen.texts.label-user-email"),"label-placement":"left"},{default:s(()=>[l(d,{value:e(g),"onUpdate:value":o[3]||(o[3]=a=>_(g)?g.value=a:null),"input-props":{type:"email"},placeholder:e(t)("tools.pgp-keygen.texts.placeholder-user-email")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(c,{label:e(t)("tools.pgp-keygen.texts.label-passphrase"),"label-placement":"left"},{default:s(()=>[l(d,{value:e(y),"onUpdate:value":o[4]||(o[4]=a=>_(y)?y.value=a:null),type:"password","show-password-on":"mousedown",placeholder:e(t)("tools.pgp-keygen.texts.placeholder-passphrase")},null,8,["value","placeholder"])]),_:1},8,["label"]),r("div",Y,[l(K,{onClick:e($)},{default:s(()=>[x(p(e(t)("tools.pgp-keygen.texts.tag-refresh-key-pair")),1)]),_:1},8,["onClick"])])]),r("div",null,[r("h3",null,p(e(t)("tools.pgp-keygen.texts.tag-public-key")),1),l(P,{value:e(w)?.publicKey||"","word-wrap":!0},null,8,["value"])]),r("div",null,[r("h3",null,p(e(t)("tools.pgp-keygen.texts.tag-private-key")),1),l(P,{value:e(w)?.privateKey||"","word-wrap":!0},null,8,["value"])]),r("div",null,[r("h3",null,p(e(t)("tools.pgp-keygen.texts.tag-revocation-certificate")),1),l(P,{value:e(w)?.revocationCertificate||"","word-wrap":!0},null,8,["value"])])])}}});export{he as default};
