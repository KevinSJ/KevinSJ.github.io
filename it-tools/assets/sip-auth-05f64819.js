import{_ as x}from"./FormatTransformer-bc7b3ed5.js";import{t as w,d as b,r as v,a0 as R,o as g,c as k,k as h,l as u,m as C,x as D}from"./index-0c1fde36.js";import{c as i}from"./index-e845e9df.js";import"./TextareaCopyable-59231e95.js";import"./base64-ae7cf34b.js";import"./index-a6f01dde.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./index-892bd980.js";import"./browser-703720a1.js";import"./index-649b5bab.js";import"./inherits_browser-6f38ab1b.js";import"./index-0397ab6f.js";import"./index-fdbe2ce9.js";import"./string_decoder-8ac4312e.js";import"./hash-f152040d.js";function M({message:t,password:e}){let o;const s=n("^([A-Z]+) sip",t),r=n('username="([^"]+)"',t),p=n('realm="([^"]+)"',t),c=n('uri="([^"]+)"',t),a=n('[^c]nonce="([^"]+)"',t),l=n('cnonce="([^"]+)"',t),_=n("nc=([0-9a-f]+)",t),m=n('qop="?(auth|auth-int)"?',t),d=n('response="([^"]+)"',t),f=i.MD5(`${r}:${p}:${e}`).toString(),$=i.MD5(`${s}:${c}`).toString();return m.toLowerCase()==="auth"?o=i.MD5(`${f}:${a}:${_}:${l}:${m}:${$}`).toString():o=i.MD5(`${f}:${a}:${l}`).toString(),d===o}function n(t,e){const s=new RegExp(t,"i").exec(e);return s!==null&&s.length>1?s[1]:w("tools.sip-auth.text.not-found")}const S={flex:"","flex-col":"","gap-4":""},Q=b({__name:"sip-auth",setup(t){const e=v(""),{t:o}=R();function s(r){if(r!==""&&e.value!=="")return M({message:r,password:e.value})?o("tools.sip-auth.sucess"):o("tools.sip-auth.failure")}return(r,p)=>{const c=D,a=x;return g(),k("div",S,[h(c,{value:u(e),"onUpdate:value":p[0]||(p[0]=l=>C(e)?e.value=l:null),type:"password",placeholder:r.$t("tools.sip-auth.password-tips"),autofocus:"","raw-text":"",label:r.$t("tools.sip-auth.password")},null,8,["value","placeholder","label"]),h(a,{"input-label":u(o)("tools.sip-auth.message"),"input-placeholder":u(o)("tools.sip-auth.message-tips"),"output-label":u(o)("tools.sip-auth.result"),transformer:s,autosize:""},null,8,["input-label","input-placeholder","output-label"])])}}});export{Q as default};
