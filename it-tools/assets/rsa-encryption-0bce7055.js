import{d as z,a0 as B,r as i,o as h,c as F,k as s,w as d,a as f,l as e,m as u,j as w,a6 as O,G as K,ad as k,x as G,ae as N,ag as I,af as $}from"./index-0c1fde36.js";import{l as c}from"./index-20485d98.js";import{g as V}from"./base64-ae7cf34b.js";import{c as C}from"./catchedComputed-1286d939.js";import{_ as H}from"./TextareaCopyable-59231e95.js";import{_ as j}from"./FormItem-1b9a5952.js";import"./index-a6f01dde.js";import"./index-892bd980.js";import"./browser-703720a1.js";import"./index-649b5bab.js";import"./inherits_browser-6f38ab1b.js";import"./index-0397ab6f.js";import"./index-fdbe2ce9.js";import"./string_decoder-8ac4312e.js";import"./hash-f152040d.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./context-00991937.js";const D={flex:"","flex-1":"","flex-col":"","gap-2":""},T={flex:"","flex-1":"","flex-col":"","gap-2":""},me=z({__name:"rsa-encryption",setup(q){const{t}=B(),E=[{value:"RSAES-PKCS1-V1_5",label:t("tools.rsa-encryption.texts.label-rsaes-pkcs-1-v1-5")},{value:"RSAES-OAEP",label:t("tools.rsa-encryption.texts.label-rsaes-oaep")},{value:"RSAES-OAEP/SHA-256",label:t("tools.rsa-encryption.texts.label-rsaes-oaep-sha-256")},{value:"RSAES-OAEP/SHA-256/MGF1-SHA-1",label:t("tools.rsa-encryption.texts.label-rsaes-oaep-sha-256-mgf1-sha-1-rsa-ecb-oaepwithsha-256andmgf1padding")}],v=i(""),S=i("RSAES-PKCS1-V1_5"),y=i(""),[U,g]=C(async()=>{const b=y.value,l=v.value,o=S.value,n=c.pki.publicKeyFromPem(b);let a;return o==="RSAES-PKCS1-V1_5"?a=n.encrypt(l,"RSAES-PKCS1-V1_5"):o==="RSAES-OAEP"?a=n.encrypt(l,"RSA-OAEP"):o==="RSAES-OAEP/SHA-256"?a=n.encrypt(l,"RSA-OAEP",{md:c.md.sha256.create()}):o==="RSAES-OAEP/SHA-256/MGF1-SHA-1"&&(a=n.encrypt(l,"RSA-OAEP",{md:c.md.sha256.create(),mgf1:{md:c.md.sha1.create()}})),V.encode(a||"")},{defaultValue:"",defaultErrorMessage:"Unable to encrypt your text"}),_=i(""),x=i("RSAES-PKCS1-V1_5"),m=i(""),A=i(""),[M,P]=C(async()=>{const b=m.value,l=A.value,o=V.decode(_.value),n=x.value,a=c.pki.decryptRsaPrivateKey(b,l);let p;return n==="RSAES-PKCS1-V1_5"?p=a.decrypt(o,"RSAES-PKCS1-V1_5"):n==="RSAES-OAEP"?p=a.decrypt(o,"RSA-OAEP"):n==="RSAES-OAEP/SHA-256"?p=a.decrypt(o,"RSA-OAEP",{md:c.md.sha256.create()}):n==="RSAES-OAEP/SHA-256/MGF1-SHA-1"&&(p=a.decrypt(o,"RSA-OAEP",{md:c.md.sha256.create(),mgf1:{md:c.md.sha1.create()}})),p},{defaultValue:"",defaultErrorMessage:"Unable to encrypt your text"});return(b,l)=>{const o=G,n=N,a=I,p=j,R=$;return h(),F("div",null,[s(R,{title:e(t)("tools.rsa-encryption.texts.title-encrypt")},{default:d(()=>[f("div",null,[s(o,{value:e(v),"onUpdate:value":l[0]||(l[0]=r=>u(v)?v.value=r:null),label:e(t)("tools.rsa-encryption.texts.label-your-text"),placeholder:e(t)("tools.rsa-encryption.texts.placeholder-the-string-to-encrypt"),rows:"4",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),s(n,{value:e(S),"onUpdate:value":l[1]||(l[1]=r=>u(S)?S.value=r:null),label:e(t)("tools.rsa-encryption.texts.label-scheme"),options:E,placeholder:e(t)("tools.rsa-encryption.texts.placeholder-select-the-encryption-scheme")},null,8,["value","label","placeholder"]),f("div",D,[s(o,{value:e(y),"onUpdate:value":l[2]||(l[2]=r=>u(y)?y.value=r:null),label:e(t)("tools.rsa-encryption.texts.label-target-public-key"),placeholder:e(t)("tools.rsa-encryption.texts.placeholder-target-public-key"),rows:"5",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"])])]),e(g)&&e(y)!==""?(h(),w(a,{key:0,type:"error","mt-12":"",title:e(t)("tools.rsa-encryption.texts.title-error-while-encrypting")},{default:d(()=>[O(K(e(g)),1)]),_:1},8,["title"])):k("",!0),s(p,{label:e(t)("tools.rsa-encryption.texts.label-your-text-encrypted"),"mt-3":""},{default:d(()=>[s(H,{value:e(U)||"",rows:"3",placeholder:e(t)("tools.rsa-encryption.texts.placeholder-your-string-encrypted"),multiline:"",monospace:"",readonly:"",autosize:"","mt-5":""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["title"]),s(R,{title:e(t)("tools.rsa-encryption.texts.title-decrypt")},{default:d(()=>[f("div",null,[s(o,{value:e(_),"onUpdate:value":l[3]||(l[3]=r=>u(_)?_.value=r:null),label:e(t)("tools.rsa-encryption.texts.label-your-pgp-message-to-decrypt"),placeholder:e(t)("tools.rsa-encryption.texts.placeholder-the-string-to-decrypt"),rows:"4",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),s(n,{value:e(x),"onUpdate:value":l[4]||(l[4]=r=>u(x)?x.value=r:null),label:e(t)("tools.rsa-encryption.texts.label-scheme"),options:E,placeholder:e(t)("tools.rsa-encryption.texts.placeholder-select-the-encryption-scheme")},null,8,["value","label","placeholder"]),f("div",T,[s(o,{value:e(m),"onUpdate:value":l[5]||(l[5]=r=>u(m)?m.value=r:null),label:e(t)("tools.rsa-encryption.texts.label-your-private-key"),placeholder:e(t)("tools.rsa-encryption.texts.placeholder-the-private-key-to-use-to-decrypt-message"),rows:"5",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),s(o,{value:e(A),"onUpdate:value":l[6]||(l[6]=r=>u(A)?A.value=r:null),label:e(t)("tools.rsa-encryption.texts.label-your-private-key-password"),clearable:"","raw-text":""},null,8,["value","label"])])]),e(P)&&e(m)!==""?(h(),w(a,{key:0,type:"error","mt-12":"",title:e(t)("tools.rsa-encryption.texts.title-error-while-decrypting")},{default:d(()=>[O(K(e(P)),1)]),_:1},8,["title"])):k("",!0),s(p,{label:e(t)("tools.rsa-encryption.texts.label-your-text-decrypted"),"mt-3":""},{default:d(()=>[s(H,{value:e(M)||"",rows:"3",placeholder:e(t)("tools.rsa-encryption.texts.placeholder-your-string-decrypted"),multiline:"",monospace:"",readonly:"",autosize:"","mt-5":""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["title"])])}}});export{me as default};
