import{o,c as s,a as n,i as D,r as y,dR as se,d as ie,a0 as ce,dS as le,dT as de,O as ue,cc as _e,l as e,j as m,w as i,a6 as p,G as u,k as c,m as z,ad as B,a7 as me,a8 as pe,_ as A,af as ve,ag as he,s as fe,ae as ge}from"./index-0c1fde36.js";import{_ as ke}from"./download-09c01880.js";const xe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ye=n("path",{fill:"currentColor",d:"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6zM8 9h8v10H8zm7.5-5l-1-1h-5l-1 1H5v2h14V4z"},null,-1),we=[ye];function be(v,t){return o(),s("svg",xe,we)}const Ce={name:"mdi-delete-outline",render:be},$e={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Re=n("path",{fill:"currentColor",d:"M19 12c0 3.86-3.14 7-7 7s-7-3.14-7-7s3.14-7 7-7s7 3.14 7 7"},null,-1),Me=[Re];function Be(v,t){return o(),s("svg",$e,Me)}const Ie={name:"mdi-record",render:Be},Se={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ve=n("path",{fill:"currentColor",d:"M8 5.14v14l11-7z"},null,-1),je=[Ve];function He(v,t){return o(),s("svg",Se,je)}const Ue={name:"mdi-play",render:He},ze={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ae=n("path",{fill:"currentColor",d:"M14 19h4V5h-4M6 19h4V5H6z"},null,-1),De=[Ae];function Ne(v,t){return o(),s("svg",ze,De)}const Ee={name:"mdi-pause",render:Ne},Le={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Te=n("path",{fill:"currentColor",d:"M17 10.5V7a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-3.5l4 4v-11z"},null,-1),Pe=[Te];function qe(v,t){return o(),s("svg",Le,Pe)}const Oe={name:"mdi-video",render:qe},Ge={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ye=n("path",{fill:"currentColor",d:"M4 4h3l2-2h6l2 2h3a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2m8 3a5 5 0 0 0-5 5a5 5 0 0 0 5 5a5 5 0 0 0 5-5a5 5 0 0 0-5-5m0 2a3 3 0 0 1 3 3a3 3 0 0 1-3 3a3 3 0 0 1-3-3a3 3 0 0 1 3-3"},null,-1),Fe=[Ye];function We(v,t){return o(),s("svg",Ge,Fe)}const Je={name:"mdi-camera",render:We};function Ke({stream:v}){const t=D(()=>MediaRecorder.isTypeSupported("video/webm")),r=y(null),_=y([]),I=se(),l=y("stopped"),V=()=>{const w=new Blob(_.value,{type:"video/webm"}),R=URL.createObjectURL(w);return _.value=[],R};return{isRecordingSupported:t,startRecording:()=>{t.value&&v.value&&l.value==="stopped"&&(r.value=new MediaRecorder(v.value,{mimeType:"video/webm"}),r.value.ondataavailable=w=>{w.data.size>0&&_.value.push(w.data)},r.value.onstop=()=>{I.trigger(V())},r.value.state==="inactive"&&(r.value.start(),l.value="recording"))},stopRecording:()=>{t.value&&r.value&&l.value!=="stopped"&&(r.value.stop(),l.value="stopped")},pauseRecording:()=>{t.value&&r.value&&l.value==="recording"&&(r.value.pause(),l.value="paused")},resumeRecording:()=>{t.value&&r.value&&l.value==="paused"&&(r.value.resume(),l.value="recording")},recordingState:l,onRecordAvailable:I.on}}const Qe={key:1,"mt-4":"",flex:"","justify-center":""},Xe={flex:"","flex-col":"","gap-2":""},Ze={key:0,"mt-3":"",flex:"","justify-center":""},et={key:1},tt={"my-2":""},ot={flex:"","items-center":"","justify-between":"","gap-2":""},nt={"mr-2":""},rt={key:0,flex:"","justify-center":"","gap-2":""},at={"mr-2":""},st={"mr-2":""},it={"mr-2":""},ct={"mr-2":""},lt={key:1,italic:"","op-60":""},dt={grid:"","grid-cols-2":"","mt-5":"","gap-2":""},ut=["src"],_t=["src"],mt={flex:"","items-center":"","justify-between":""},pt={"font-bold":""},vt={flex:"","gap-2":""},kt=ie({__name:"camera-recorder",setup(v){const{t}=ce(),{videoInputs:r,audioInputs:_,permissionGranted:I,isSupported:l,ensurePermissions:V}=le({requestPermissions:!0,constraints:{video:!0,audio:!0},onUpdated(){Y()}}),g=y(),C=y([]),k=y(r.value[0]?.deviceId),h=y(_.value[0]?.deviceId),w=y(!1),{stream:R,start:N,stop:E,enabled:j}=de({constraints:D(()=>({video:{deviceId:k.value},...h.value?{audio:{deviceId:h.value}}:{}})),autoSwitch:!0}),{isRecordingSupported:L,onRecordAvailable:T,startRecording:P,stopRecording:q,pauseRecording:O,recordingState:S,resumeRecording:G}=Ke({stream:R});T(a=>{C.value.unshift({type:"video",value:a,createdAt:new Date})});function Y(){(A.isNil(k)||!r.value.find(a=>a.deviceId===k.value))&&(k.value=r.value[0]?.deviceId),(A.isNil(_)||!_.value.find(a=>a.deviceId===h.value))&&(h.value=_.value[0]?.deviceId)}function F(){if(!g.value)return;const a=document.createElement("canvas");a.width=g.value.videoWidth,a.height=g.value.videoHeight,a.getContext("2d")?.drawImage(g.value,0,0);const x=a.toDataURL("image/png");C.value.unshift({type:"image",value:x,createdAt:new Date})}ue(()=>{g.value&&R.value&&(g.value.srcObject=R.value)}),_e(()=>E());async function W(){try{await V()}catch{w.value=!0}}function J({type:a,value:x,createdAt:$}){const M=document.createElement("a");M.href=x,M.download=`${a}-${$.getTime()}.${a==="image"?"png":"webm"}`,M.click()}return(a,x)=>{const $=ve,M=he,f=fe,H=ge,K=Je,Q=Oe,X=Ee,Z=Ue,ee=Ie,te=ke,oe=Ce;return o(),s("div",null,[e(l)?e(I)?(o(),m($,{key:2},{default:i(()=>[n("div",Xe,[c(H,{value:e(k),"onUpdate:value":x[0]||(x[0]=d=>z(k)?k.value=d:null),"label-position":"left","label-width":"60px",label:e(t)("tools.camera-recorder.texts.label-video"),options:e(r).map(({deviceId:d,label:b})=>({value:d,label:b})),placeholder:e(t)("tools.camera-recorder.texts.placeholder-select-camera")},null,8,["value","label","options","placeholder"]),e(h)&&e(_).length>0?(o(),m(H,{key:0,value:e(h),"onUpdate:value":x[1]||(x[1]=d=>z(h)?h.value=d:null),label:e(t)("tools.camera-recorder.texts.label-audio"),"label-position":"left","label-width":"60px",options:e(_).map(({deviceId:d,label:b})=>({value:d,label:b})),placeholder:e(t)("tools.camera-recorder.texts.placeholder-select-microphone")},null,8,["value","label","options","placeholder"])):B("",!0)]),e(j)?(o(),s("div",et,[n("div",tt,[n("video",{ref_key:"video",ref:g,autoplay:"",controls:"",playsinline:"","max-h-full":"","w-full":""},null,512)]),n("div",ot,[c(f,{disabled:!e(j),onClick:F},{default:i(()=>[n("span",nt,[c(K)]),p(u(e(t)("tools.camera-recorder.texts.tag-take-screenshot")),1)]),_:1},8,["disabled"]),e(L)?(o(),s("div",rt,[e(S)==="stopped"?(o(),m(f,{key:0,onClick:e(P)},{default:i(()=>[n("span",at,[c(Q)]),p(u(e(t)("tools.camera-recorder.texts.tag-start-recording")),1)]),_:1},8,["onClick"])):B("",!0),e(S)==="recording"?(o(),m(f,{key:1,onClick:e(O)},{default:i(()=>[n("span",st,[c(X)]),p(u(e(t)("tools.camera-recorder.texts.tag-pause")),1)]),_:1},8,["onClick"])):B("",!0),e(S)==="paused"?(o(),m(f,{key:2,onClick:e(G)},{default:i(()=>[n("span",it,[c(Z)]),p(u(e(t)("tools.camera-recorder.texts.tag-resume")),1)]),_:1},8,["onClick"])):B("",!0),e(S)!=="stopped"?(o(),m(f,{key:3,type:"error",onClick:e(q)},{default:i(()=>[n("span",ct,[c(ee)]),p(u(e(t)("tools.camera-recorder.texts.tag-stop")),1)]),_:1},8,["onClick"])):B("",!0)])):(o(),s("div",lt,u(e(t)("tools.camera-recorder.texts.tag-video-recording-is-not-supported-in-your-browser")),1))])])):(o(),s("div",Ze,[c(f,{type:"primary",onClick:e(N)},{default:i(()=>[p(u(e(t)("tools.camera-recorder.texts.tag-start-webcam")),1)]),_:1},8,["onClick"])]))]),_:1})):(o(),m($,{key:1,"text-center":""},{default:i(()=>[p(u(e(t)("tools.camera-recorder.texts.tag-you-need-to-grant-permission-to-use-your-camera-and-microphone")),1),e(w)?(o(),m(M,{key:0,"mt-4":"","text-left":""},{default:i(()=>[p(" Your browser has blocked permission request or does not support it. You need to grant permission manually in your browser settings (usually the lock icon in the address bar). ")]),_:1})):(o(),s("div",Qe,[c(f,{onClick:W},{default:i(()=>[p(u(e(t)("tools.camera-recorder.texts.tag-grant-permission")),1)]),_:1})]))]),_:1})):(o(),m($,{key:0},{default:i(()=>[p(u(e(t)("tools.camera-recorder.texts.tag-your-browser-does-not-support-recording-video-from-camera")),1)]),_:1})),n("div",dt,[(o(!0),s(me,null,pe(e(C),({type:d,value:b,createdAt:ne},U)=>(o(),m($,{key:U},{default:i(()=>[d==="image"?(o(),s("img",{key:0,src:b,"max-h-full":"","w-full":"",alt:"screenshot"},null,8,ut)):(o(),s("video",{key:1,src:b,controls:"","max-h-full":"","w-full":""},null,8,_t)),n("div",mt,[n("div",pt,u(d==="image"?"Screenshot":"Video"),1),n("div",vt,[c(f,{onClick:re=>J({type:d,value:b,createdAt:ne})},{default:i(()=>[c(te)]),_:2},1032,["onClick"]),c(f,{onClick:re=>C.value=e(C).filter((ht,ae)=>ae!==U)},{default:i(()=>[c(oe)]),_:2},1032,["onClick"])])])]),_:2},1024))),128))])])}}});export{kt as default};
