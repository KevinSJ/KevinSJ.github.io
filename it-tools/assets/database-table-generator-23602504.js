import{_ as D}from"./TextareaCopyable-59231e95.js";import{d as w,a0 as O,ac as N,aY as K,r as M,o as y,c as I,k as a,w as o,l as e,m as q,a7 as j,a8 as G,a6 as i,G as _,j as U,ad as F,ah as H,aj as P,af as Q,a as X}from"./index-0c1fde36.js";import{_ as Y}from"./Select-9917c364.js";import{_ as z}from"./FormItem-1b9a5952.js";import{_ as J}from"./Space-7fc52151.js";import{_ as W}from"./Form-a433c14f.js";import{_ as Z}from"./Divider-5fc425b0.js";import{_ as ee}from"./Checkbox-ba7202eb.js";import{_ as ae}from"./DynamicInput-1857fb62.js";import"./base64-ae7cf34b.js";import"./index-a6f01dde.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./Tag-e75b8dae.js";import"./FocusDetector-089b8822.js";import"./VirtualList-8140ffff.js";import"./Empty-ca426d71.js";import"./index-cbfaa337.js";import"./context-00991937.js";import"./get-slot-1efb97e5.js";import"./ArrowDown-6fbf6d78.js";const te={style:{display:"flex","align-items":"center",width:"100%"}},Ue=w({__name:"database-table-generator",setup(le){const{t}=O(),p=N({name:"db",storageName:"db-tbl-gen:d",defaultValue:""}),r=N({name:"type",storageName:"db-tbl-gen:t",defaultValue:"mysql"}),v=K("db-tbl-gen:tbs",[{name:"",columns:[{name:"",type:"VARCHAR(255)",nullable:!0,primaryKey:!1,unique:!1,autoIncrement:!1,defaultValue:""}]}]),g=M(""),E={mysql:["INT","BIGINT","VARCHAR(255)","TEXT","DATE","DATETIME","BOOLEAN"],postgres:["SERIAL","BIGSERIAL","INTEGER","TEXT","VARCHAR(255)","DATE","TIMESTAMP","BOOLEAN"],sqlite:["INTEGER","TEXT","REAL","BLOB"],sqlserver:["INT","BIGINT","NVARCHAR(255)","TEXT","DATE","DATETIME","BIT"]};function x(){v.value.push({name:"",columns:[{name:"",type:E[r.value][0],nullable:!0,primaryKey:!1,unique:!1,autoIncrement:!1,defaultValue:""}]})}function R(m){v.value.splice(m,1)}function C(){return{name:"",type:E[r.value][0],nullable:!0,primaryKey:!1,unique:!1,autoIncrement:!1,defaultValue:""}}function B(){if(!p.value){g.value="-- Please provide a database name";return}let m="";switch(r.value){case"mysql":case"sqlserver":m+=`CREATE DATABASE ${p.value};

USE ${p.value};

`;break;case"postgres":m+=`CREATE DATABASE ${p.value};

\\c ${p.value};

`;break;case"sqlite":m+=`-- SQLite creates DB as a file, no CREATE DATABASE needed
`;break}for(const d of v.value){if(!d.name.trim())continue;const T=d.columns.filter(n=>n.name.trim()!=="").map(n=>{let u=`${n.name} ${n.type}`;return n.nullable||(u+=" NOT NULL"),n.unique&&(u+=" UNIQUE"),n.autoIncrement&&(r.value==="mysql"?u+=" AUTO_INCREMENT":r.value==="postgres"?u=`${n.name} SERIAL`:r.value==="sqlite"?u+=" AUTOINCREMENT":r.value==="sqlserver"&&(u+=" IDENTITY(1,1)")),n.defaultValue&&(u+=` DEFAULT ${n.defaultValue}`),u}).join(`,
  `),b=d.columns.filter(n=>n.primaryKey).map(n=>n.name),f=b.length?`,
  PRIMARY KEY (${b.join(", ")})`:"";m+=`CREATE TABLE ${d.name} (
  ${T}${f}
);

`}g.value=m.trim()}return(m,d)=>{const T=Y,b=z,f=H,n=P,u=ee,V=ae,A=Q,k=J,$=W,L=Z,S=D;return y(),I("div",null,[a($,{"label-placement":"left","label-width":"130px"},{default:o(()=>[a(b,{label:e(t)("tools.database-table-generator.texts.label-database-type")},{default:o(()=>[a(T,{value:e(r),"onUpdate:value":d[0]||(d[0]=c=>q(r)?r.value=c:null),options:[{label:e(t)("tools.database-table-generator.texts.label-mysql"),value:"mysql"},{label:e(t)("tools.database-table-generator.texts.label-postgresql"),value:"postgres"},{label:e(t)("tools.database-table-generator.texts.label-sqlite"),value:"sqlite"},{label:e(t)("tools.database-table-generator.texts.label-sql-server"),value:"sqlserver"}]},null,8,["value","options"])]),_:1},8,["label"]),a(b,{label:e(t)("tools.database-table-generator.texts.label-database-name")},{default:o(()=>[a(f,{value:e(p),"onUpdate:value":d[1]||(d[1]=c=>q(p)?p.value=c:null),placeholder:e(t)("tools.database-table-generator.texts.placeholder-enter-database-name")},null,8,["value","placeholder"])]),_:1},8,["label"]),(y(!0),I(j,null,G(e(v),(c,h)=>(y(),U(A,{key:h,"mt-1":""},{default:o(()=>[a(b,{label:`Table ${h+1} Name`},{default:o(()=>[a(f,{value:c.name,"onUpdate:value":l=>c.name=l,placeholder:e(t)("tools.database-table-generator.texts.placeholder-table-name"),"mr-1":""},null,8,["value","onUpdate:value","placeholder"]),a(n,{type:"error",onClick:l=>R(h)},{default:o(()=>[i(_(e(t)("tools.database-table-generator.texts.tag-remove-table")),1)]),_:2},1032,["onClick"])]),_:2},1032,["label"]),a(V,{value:c.columns,"onUpdate:value":l=>c.columns=l,"on-create":C,"show-sort-button":""},{"create-button-default":o(()=>[i(_(e(t)("tools.database-table-generator.texts.tag-add-column")),1)]),default:o(({value:l})=>[X("div",te,[a(f,{value:l.name,"onUpdate:value":s=>l.name=s,placeholder:e(t)("tools.database-table-generator.texts.placeholder-column-name"),style:{width:"20%"},"mr-1":""},null,8,["value","onUpdate:value","placeholder"]),a(T,{value:l.type,"onUpdate:value":s=>l.type=s,options:E[e(r)].map(s=>({label:s,value:s})),style:{width:"20%"},"mr-1":""},null,8,["value","onUpdate:value","options"]),a(u,{checked:l.nullable,"onUpdate:checked":s=>l.nullable=s},{default:o(()=>[i(_(e(t)("tools.database-table-generator.texts.tag-nullable")),1)]),_:2},1032,["checked","onUpdate:checked"]),a(u,{checked:l.primaryKey,"onUpdate:checked":s=>l.primaryKey=s},{default:o(()=>[i(_(e(t)("tools.database-table-generator.texts.tag-pk")),1)]),_:2},1032,["checked","onUpdate:checked"]),a(u,{checked:l.unique,"onUpdate:checked":s=>l.unique=s},{default:o(()=>[i(_(e(t)("tools.database-table-generator.texts.tag-unique")),1)]),_:2},1032,["checked","onUpdate:checked"]),a(u,{checked:l.autoIncrement,"onUpdate:checked":s=>l.autoIncrement=s},{default:o(()=>[i(_(e(t)("tools.database-table-generator.texts.tag-autoinc")),1)]),_:2},1032,["checked","onUpdate:checked"]),a(f,{value:l.defaultValue,"onUpdate:value":s=>l.defaultValue=s,placeholder:e(t)("tools.database-table-generator.texts.placeholder-default-value"),style:{width:"20%"}},null,8,["value","onUpdate:value","placeholder"])])]),_:2},1032,["value","onUpdate:value"])]),_:2},1024))),128)),a(k,{justify:"center","mt-1":""},{default:o(()=>[a(n,{type:"info",onClick:x},{default:o(()=>[i(_(e(t)("tools.database-table-generator.texts.tag-add-table")),1)]),_:1})]),_:1})]),_:1}),a(L),a(k,{justify:"center","mt-2":""},{default:o(()=>[a(n,{type:"success",onClick:B},{default:o(()=>[i(_(e(t)("tools.database-table-generator.texts.tag-generate-sql")),1)]),_:1})]),_:1}),e(g)?(y(),U(A,{key:0,title:e(t)("tools.database-table-generator.texts.title-generated-sql"),"mt-1":""},{default:o(()=>[a(S,{value:e(g),language:"sql","download-file-name":"create-tables.sql"},null,8,["value"])]),_:1},8,["title"])):F("",!0)])}}});export{Ue as default};
