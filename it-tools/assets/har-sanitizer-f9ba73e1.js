import{d as D,a0 as J,r as x,o as h,c as v,a as C,k as A,l as m,j as P,w as g,a6 as S,G as T,ad as O,a7 as E,a8 as R,aW as W,ag as F,s as V,af as Q}from"./index-0c1fde36.js";import{_ as Z}from"./Checkbox-ba7202eb.js";import{_ as G}from"./Space-7fc52151.js";import"./get-slot-1efb97e5.js";function K(a,e){const n=new Blob([a],{type:"application/json"}),d=URL.createObjectURL(n),t=document.createElement("a");t.href=d,t.download=e,t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(d)}const z=["application/javascript","text/javascript"],X=["Authorization","SAMLRequest","SAMLResponse","access_token","appID","assertion","auth","authenticity_token","challenge","client_id","client_secret","code","code_challenge","code_verifier","email","facetID","fcParams","id_token","password","refresh_token","serverData","shdf","state","token","usg","vses2","x-client-data"],L=[...z,...X],Y=[[{regex:new RegExp("\\b(ey[A-Za-z0-9-_=]+)\\.(ey[A-Za-z0-9-_=]+)\\.[A-Za-z0-9-_.+/=]+\\b","g"),replacement:"$1.$2.redacted"}]];function I(a){return[{regex:new RegExp(`([\\s";,&?]+${a}=)([\\w+-_/=#|.%&:!*()\`~'"]+?)(&|\\\\",|",|"\\s|"}}|;){1}`,"g"),replacement:`$1[${a} redacted]$3`},{regex:new RegExp(`("name": "${a}",[\\s\\w+:"-\\%!*()\`~'.,#]*?"value": ")((?:\\\\"|[^"])*?)(")`,"g"),replacement:`$1[${a} redacted]$3`},{regex:new RegExp(`("value": ")([\\w+-_:&+=#$~/()\\\\.\\,*!|%"\\s;]+)("[,\\s}}]+)([\\s\\w+:"-\\\\%!*\`()~'#.]*"name": "${a}")`,"g"),replacement:`$1[${a} redacted]$3$4`}]}function ee(a,e){const n=JSON.parse(a),d=n.log.entries;if(!d)throw new Error("failed to find entries in HAR file");for(const t of d){const r=t.response;r&&e.includes(r.content.mimeType)&&(r.content.text=`[${r.content.mimeType} redacted]`)}return JSON.stringify(n,null,2)}function q(a){const e={headers:new Set,queryArgs:new Set,cookies:new Set,postParams:new Set,mimeTypes:new Set},d=JSON.parse(a).log.entries;if(!d)throw new Error("failed to find entries in HAR file");for(const t of d){const r=t.response;r.headers.map(o=>e.headers.add(o.name)),r.cookies.map(o=>e.cookies.add(o.name)),e.mimeTypes.add(r.content.mimeType);const l=t.request;l.headers.map(o=>e.headers.add(o.name)),l.queryString.map(o=>e.queryArgs.add(o.name)),l.cookies.map(o=>e.cookies.add(o.name)),l.postData&&l.postData.params?.map(o=>e.postParams.add(o.name))}return{headers:[...e.headers].sort((t,r)=>t.localeCompare(r)),queryArgs:[...e.queryArgs].sort((t,r)=>t.localeCompare(r)),cookies:[...e.cookies].sort((t,r)=>t.localeCompare(r)),postParams:[...e.postParams].sort((t,r)=>t.localeCompare(r)),mimeTypes:[...e.mimeTypes].sort((t,r)=>t.localeCompare(r))}}function te(a,e){return a?.allMimeTypes&&e?e.mimeTypes:a?.scrubMimetypes||z}function ae(a,e){let n=a?.scrubWords||[];return a?.allCookies&&e&&(n=n.concat(e.cookies)),a?.allHeaders&&e&&(n=n.concat(e.headers)),a?.allQueryArgs&&e&&(n=n.concat(e.queryArgs)),a?.allPostParams&&e&&(n=n.concat(e.postParams)),n||L}function re(a,e){let n;(e?.allCookies||e?.allHeaders||e?.allMimeTypes||e?.allQueryArgs||e?.allPostParams)&&(n=q(a)),a=ee(a,te(e,n));const t=ae(e,n).filter(l=>a.includes(l)).map(l=>I(l)),r=Y.concat(t);for(const l of r)for(const o of l)a=a.replace(o.regex,o.replacement);return a}const ne={style:{flex:"0 0 100%"},"mb-3":""},oe={"mx-auto":"","max-w-600px":""},se={key:1,"mt-3":"",flex:"","justify-center":""},ue=D({__name:"har-sanitizer",setup(a){const{t:e}=J(),n={cookies:"Cookies",mimeTypes:"Mime Types",headers:"Headers",postParams:"Post Body Params",queryArgs:"Query String Parameters"},d={cookies:{},headers:{},queryArgs:{},postParams:{},mimeTypes:{}},t=x(d);function r(f){const i=q(f),u={...d};return Object.entries(i).forEach(([p,s])=>(u[p]=s.reduce((c,w)=>(w&&(c[w]=L.includes(w)),c),{}),null)),u}function l(f,i){const u=new Set;Object.entries(i.cookies).forEach(([s,c])=>{c&&u.add(s)}),Object.entries(i.headers).forEach(([s,c])=>{c&&u.add(s)}),Object.entries(i.queryArgs).forEach(([s,c])=>{c&&u.add(s)}),Object.entries(i.postParams).forEach(([s,c])=>{c&&u.add(s)});const p=new Set;return Object.entries(i.mimeTypes).forEach(([s,c])=>{c&&p.add(s)}),re(f,{scrubWords:[...u],scrubMimetypes:[...p]})}const o=x(null),k=x("");function M(f){return new Promise((i,u)=>{const p=new FileReader;p.readAsText(f),p.onload=()=>i(p.result?.toString()??""),p.onerror=s=>u(s)})}const $=x("");async function N(f){o.value=f,$.value=await M(f),k.value="";try{t.value=r($.value)}catch(i){k.value=i.toString()}}function U(){K(l($.value,t.value),`sanitized-${o.value?.name}`)}return(f,i)=>{const u=W,p=F,s=Z,c=G,w=Q,H=V;return h(),v("div",null,[C("div",ne,[C("div",oe,[A(u,{title:m(e)("tools.har-sanitizer.texts.title-drag-and-drop-a-har-file-here-or-click-to-select-a-file"),accept:".har",onFileUpload:N},null,8,["title"])])]),m(k)?(h(),P(p,{key:0,title:m(e)("tools.har-sanitizer.texts.title-error")},{default:g(()=>[S(T(m(k)),1)]),_:1},8,["title"])):O("",!0),(h(),v(E,null,R(n,(b,_)=>C("div",{key:_,"mb-1":""},[Object.keys(m(t)[_]).length?(h(),P(w,{key:0,title:b},{default:g(()=>[A(s,{"font-size-5":"","onUpdate:checked":j=>Object.keys(m(t)[_]).forEach(y=>m(t)[_][y]=j)},{default:g(()=>[S(" All "+T(b),1)]),_:2},1032,["onUpdate:checked"]),A(c,{size:"large"},{default:g(()=>[(h(!0),v(E,null,R(m(t)[_],(j,y)=>(h(),P(s,{key:y,checked:m(t)[_][y],"onUpdate:checked":B=>m(t)[_][y]=B,style:{width:"150px"}},{default:g(()=>[S(T(y),1)]),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:2},1024)]),_:2},1032,["title"])):O("",!0)])),64)),m(k)?O("",!0):(h(),v("div",se,[A(H,{onClick:i[0]||(i[0]=b=>U())},{default:g(()=>[S(T(m(e)("tools.har-sanitizer.texts.tag-sanitize-and-download")),1)]),_:1})]))])}}});export{ue as default};
