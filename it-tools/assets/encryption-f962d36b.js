import{d as ze,a0 as Me,r as ct,o as St,c as Pe,k as Q,w as Bt,a as Tt,l as A,m as lt,j as Wt,a6 as ne,G as re,ad as Re,a7 as Ve,x as je,ae as $e,ag as We,af as He}from"./index-0c1fde36.js";import{a as wt}from"./index-a6f01dde.js";import{c as at}from"./index-e845e9df.js";import{a as oe}from"./catchedComputed-1286d939.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./index-892bd980.js";import"./browser-703720a1.js";import"./index-649b5bab.js";import"./inherits_browser-6f38ab1b.js";import"./index-0397ab6f.js";import"./index-fdbe2ce9.js";import"./string_decoder-8ac4312e.js";import"./hash-f152040d.js";const xt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function zt(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function ge(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function H(e,...t){if(!ge(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Et(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Yt(e,t){H(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function se(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const qt=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength),_=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),At=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Fe=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Fe)throw new Error("Non little-endian hardware is not supported");const rt={_0:48,_9:57,A:65,F:70,a:97,f:102};function ce(e){if(e>=rt._0&&e<=rt._9)return e-rt._0;if(e>=rt.A&&e<=rt.F)return e-(rt.A-10);if(e>=rt.a&&e<=rt.f)return e-(rt.a-10)}function Ze(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let o=0,s=0;o<r;o++,s+=2){const c=ce(e.charCodeAt(s)),l=ce(e.charCodeAt(s+1));if(c===void 0||l===void 0){const i=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+i+'" at index '+s)}n[o]=c*16+l}return n}function Ut(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function Ht(e){return new TextDecoder().decode(e)}function ft(e){if(typeof e=="string")e=Ut(e);else if(ge(e))e=F(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function de(e,t){return e.buffer===t.buffer&&e.byteOffset<t.byteOffset+t.byteLength&&t.byteOffset<e.byteOffset+e.byteLength}function Vt(e,t){if(de(e,t)&&e.byteOffset<t.byteOffset)throw new Error("complex overlap of input and output is not supported")}function we(...e){let t=0;for(let n=0;n<e.length;n++){const o=e[n];H(o),t+=o.length}const r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){const s=e[n];r.set(s,o),o+=s.length}return r}function Ge(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function Ct(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}const k=(e,t)=>{function r(n,...o){if(H(n),e.nonceLength!==void 0){const a=o[0];if(!a)throw new Error("nonce / iv required");e.varSizeNonce?H(a):H(a,e.nonceLength)}const s=e.tagLength;s&&o[1]!==void 0&&H(o[1]);const c=t(n,...o),l=(a,h)=>{if(h!==void 0){if(a!==2)throw new Error("cipher output not supported");H(h)}};let i=!1;return{encrypt(a,h){if(i)throw new Error("cannot encrypt() twice with same key + nonce");return i=!0,H(a),l(c.encrypt.length,h),c.encrypt(a,h)},decrypt(a,h){if(H(a),s&&a.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return l(c.decrypt.length,h),c.decrypt(a,h)}}}return Object.assign(r,e),r};function nt(e,t,r=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!J(t))throw new Error("invalid output, must be aligned");return t}function Lt(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const o=BigInt(32),s=BigInt(4294967295),c=Number(r>>o&s),l=Number(r&s),i=n?4:0,f=n?0:4;e.setUint32(t+i,c,n),e.setUint32(t+f,l,n)}function J(e){return e.byteOffset%4===0}function F(e){return Uint8Array.from(e)}function I(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function xe(e=32){if(xt&&typeof xt.getRandomValues=="function")return xt.getRandomValues(new Uint8Array(e));if(xt&&typeof xt.randomBytes=="function")return xt.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}function le(e){const{nonceLength:t}=e;return zt(t),(r,...n)=>({encrypt(o,...s){const c=xe(t),l=e(r,c,...n).encrypt(o,...s),i=we(c,l);return l.fill(0),i},decrypt(o,...s){const c=o.subarray(0,t),l=o.subarray(t);return e(r,c,...n).decrypt(l,...s)}})}const ot=16,Dt=new Uint8Array(16),tt=_(Dt),Je=225,Xe=(e,t,r,n)=>{const o=n&1;return{s3:r<<31|n>>>1,s2:t<<31|r>>>1,s1:e<<31|t>>>1,s0:e>>>1^Je<<24&-(o&1)}},D=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255|0;function Ye(e){e.reverse();const t=e[15]&1;let r=0;for(let n=0;n<e.length;n++){const o=e[n];e[n]=o>>>1|r,r=(o&1)<<7}return e[0]^=-t&225,e}const qe=e=>e>64*1024?8:e>1024?4:2;class be{constructor(t,r){this.blockLen=ot,this.outputLen=ot,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,t=ft(t),H(t,16);const n=At(t);let o=n.getUint32(0,!1),s=n.getUint32(4,!1),c=n.getUint32(8,!1),l=n.getUint32(12,!1);const i=[];for(let y=0;y<128;y++)i.push({s0:D(o),s1:D(s),s2:D(c),s3:D(l)}),{s0:o,s1:s,s2:c,s3:l}=Xe(o,s,c,l);const f=qe(r||1024);if(![1,2,4,8].includes(f))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=f;const h=128/f,d=this.windowSize=2**f,w=[];for(let y=0;y<h;y++)for(let u=0;u<d;u++){let g=0,x=0,b=0,v=0;for(let m=0;m<f;m++){if(!(u>>>f-m-1&1))continue;const{s0:S,s1:O,s2:N,s3:U}=i[f*y+m];g^=S,x^=O,b^=N,v^=U}w.push({s0:g,s1:x,s2:b,s3:v})}this.t=w}_updateBlock(t,r,n,o){t^=this.s0,r^=this.s1,n^=this.s2,o^=this.s3;const{W:s,t:c,windowSize:l}=this;let i=0,f=0,a=0,h=0;const d=(1<<s)-1;let w=0;for(const y of[t,r,n,o])for(let u=0;u<4;u++){const g=y>>>8*u&255;for(let x=8/s-1;x>=0;x--){const b=g>>>s*x&d,{s0:v,s1:m,s2:C,s3:S}=c[w*l+b];i^=v,f^=m,a^=C,h^=S,w+=1}}this.s0=i,this.s1=f,this.s2=a,this.s3=h}update(t){t=ft(t),Et(this);const r=_(t),n=Math.floor(t.length/ot),o=t.length%ot;for(let s=0;s<n;s++)this._updateBlock(r[s*4+0],r[s*4+1],r[s*4+2],r[s*4+3]);return o&&(Dt.set(t.subarray(n*ot)),this._updateBlock(tt[0],tt[1],tt[2],tt[3]),I(tt)),this}destroy(){const{t}=this;for(const r of t)r.s0=0,r.s1=0,r.s2=0,r.s3=0}digestInto(t){Et(this),Yt(t,this),this.finished=!0;const{s0:r,s1:n,s2:o,s3:s}=this,c=_(t);return c[0]=r,c[1]=n,c[2]=o,c[3]=s,t}digest(){const t=new Uint8Array(ot);return this.digestInto(t),this.destroy(),t}}class De extends be{constructor(t,r){t=ft(t);const n=Ye(F(t));super(n,r),I(n)}update(t){t=ft(t),Et(this);const r=_(t),n=t.length%ot,o=Math.floor(t.length/ot);for(let s=0;s<o;s++)this._updateBlock(D(r[s*4+3]),D(r[s*4+2]),D(r[s*4+1]),D(r[s*4+0]));return n&&(Dt.set(t.subarray(o*ot)),this._updateBlock(D(tt[3]),D(tt[2]),D(tt[1]),D(tt[0])),I(tt)),this}digestInto(t){Et(this),Yt(t,this),this.finished=!0;const{s0:r,s1:n,s2:o,s3:s}=this,c=_(t);return c[0]=r,c[1]=n,c[2]=o,c[3]=s,t.reverse()}}function me(e){const t=(n,o)=>e(o,n.length).update(ft(n)).digest(),r=e(new Uint8Array(16),0);return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=(n,o)=>e(n,o),t}const ie=me((e,t)=>new be(e,t)),Qe=me((e,t)=>new De(e,t)),X=16,Qt=4,Kt=new Uint8Array(X),ke=283;function kt(e){return e<<1^ke&-(e>>7)}function mt(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(t&1),e=kt(e);return r}const Gt=(()=>{const e=new Uint8Array(256);for(let r=0,n=1;r<256;r++,n^=kt(n))e[r]=n;const t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let n=e[255-r];n|=n<<8,t[e[r]]=(n^n>>4^n>>5^n>>6^n>>7^99)&255}return I(e),t})(),tn=Gt.map((e,t)=>Gt.indexOf(t)),en=e=>e<<24|e>>>8,Ft=e=>e<<8|e>>>24,Pt=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;function Ee(e,t){if(e.length!==256)throw new Error("Wrong sbox length");const r=new Uint32Array(256).map((f,a)=>t(e[a])),n=r.map(Ft),o=n.map(Ft),s=o.map(Ft),c=new Uint32Array(256*256),l=new Uint32Array(256*256),i=new Uint16Array(256*256);for(let f=0;f<256;f++)for(let a=0;a<256;a++){const h=f*256+a;c[h]=r[f]^n[a],l[h]=o[f]^s[a],i[h]=e[f]<<8|e[a]}return{sbox:e,sbox2:i,T0:r,T1:n,T2:o,T3:s,T01:c,T23:l}}const te=Ee(Gt,e=>mt(e,3)<<24|e<<16|e<<8|mt(e,2)),ve=Ee(tn,e=>mt(e,11)<<24|mt(e,13)<<16|mt(e,9)<<8|mt(e,14)),nn=(()=>{const e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=kt(r))e[t]=r;return e})();function st(e){H(e);const t=e.length;if(![16,24,32].includes(t))throw new Error("aes: invalid key size, should be 16, 24 or 32, got "+t);const{sbox2:r}=te,n=[];J(e)||n.push(e=F(e));const o=_(e),s=o.length,c=i=>et(r,i,i,i,i),l=new Uint32Array(t+28);l.set(o);for(let i=s;i<l.length;i++){let f=l[i-1];i%s===0?f=c(en(f))^nn[i/s-1]:s>6&&i%s===4&&(f=c(f)),l[i]=l[i-s]^f}return I(...n),l}function ee(e){const t=st(e),r=t.slice(),n=t.length,{sbox2:o}=te,{T0:s,T1:c,T2:l,T3:i}=ve;for(let f=0;f<n;f+=4)for(let a=0;a<4;a++)r[f+a]=t[n-f-4+a];I(t);for(let f=4;f<n-4;f++){const a=r[f],h=et(o,a,a,a,a);r[f]=s[h&255]^c[h>>>8&255]^l[h>>>16&255]^i[h>>>24]}return r}function it(e,t,r,n,o,s){return e[r<<8&65280|n>>>8&255]^t[o>>>8&65280|s>>>24&255]}function et(e,t,r,n,o){return e[t&255|r&65280]|e[n>>>16&255|o>>>16&65280]<<16}function Y(e,t,r,n,o){const{sbox2:s,T01:c,T23:l}=te;let i=0;t^=e[i++],r^=e[i++],n^=e[i++],o^=e[i++];const f=e.length/4-2;for(let y=0;y<f;y++){const u=e[i++]^it(c,l,t,r,n,o),g=e[i++]^it(c,l,r,n,o,t),x=e[i++]^it(c,l,n,o,t,r),b=e[i++]^it(c,l,o,t,r,n);t=u,r=g,n=x,o=b}const a=e[i++]^et(s,t,r,n,o),h=e[i++]^et(s,r,n,o,t),d=e[i++]^et(s,n,o,t,r),w=e[i++]^et(s,o,t,r,n);return{s0:a,s1:h,s2:d,s3:w}}function jt(e,t,r,n,o){const{sbox2:s,T01:c,T23:l}=ve;let i=0;t^=e[i++],r^=e[i++],n^=e[i++],o^=e[i++];const f=e.length/4-2;for(let y=0;y<f;y++){const u=e[i++]^it(c,l,t,o,n,r),g=e[i++]^it(c,l,r,t,o,n),x=e[i++]^it(c,l,n,r,t,o),b=e[i++]^it(c,l,o,n,r,t);t=u,r=g,n=x,o=b}const a=e[i++]^et(s,t,o,n,r),h=e[i++]^et(s,r,t,o,n),d=e[i++]^et(s,n,r,t,o),w=e[i++]^et(s,o,n,r,t);return{s0:a,s1:h,s2:d,s3:w}}function rn(e,t,r,n){H(t,X),H(r);const o=r.length;n=nt(o,n),Vt(r,n);const s=t,c=_(s);let{s0:l,s1:i,s2:f,s3:a}=Y(e,c[0],c[1],c[2],c[3]);const h=_(r),d=_(n);for(let y=0;y+4<=h.length;y+=4){d[y+0]=h[y+0]^l,d[y+1]=h[y+1]^i,d[y+2]=h[y+2]^f,d[y+3]=h[y+3]^a;let u=1;for(let g=s.length-1;g>=0;g--)u=u+(s[g]&255)|0,s[g]=u&255,u>>>=8;({s0:l,s1:i,s2:f,s3:a}=Y(e,c[0],c[1],c[2],c[3]))}const w=X*Math.floor(h.length/Qt);if(w<o){const y=new Uint32Array([l,i,f,a]),u=qt(y);for(let g=w,x=0;g<o;g++,x++)n[g]=r[g]^u[x];I(y)}return n}function _t(e,t,r,n,o){H(r,X),H(n),o=nt(n.length,o);const s=r,c=_(s),l=At(s),i=_(n),f=_(o),a=t?0:12,h=n.length;let d=l.getUint32(a,t),{s0:w,s1:y,s2:u,s3:g}=Y(e,c[0],c[1],c[2],c[3]);for(let b=0;b+4<=i.length;b+=4)f[b+0]=i[b+0]^w,f[b+1]=i[b+1]^y,f[b+2]=i[b+2]^u,f[b+3]=i[b+3]^g,d=d+1>>>0,l.setUint32(a,d,t),{s0:w,s1:y,s2:u,s3:g}=Y(e,c[0],c[1],c[2],c[3]);const x=X*Math.floor(i.length/Qt);if(x<h){const b=new Uint32Array([w,y,u,g]),v=qt(b);for(let m=x,C=0;m<h;m++,C++)o[m]=n[m]^v[C];I(b)}return o}const on=k({blockSize:16,nonceLength:16},function(t,r){function n(o,s){if(H(o),s!==void 0&&(H(s),!J(s)))throw new Error("unaligned destination");const c=st(t),l=F(r),i=[c,l];J(o)||i.push(o=F(o));const f=rn(c,l,o,s);return I(...i),f}return{encrypt:(o,s)=>n(o,s),decrypt:(o,s)=>n(o,s)}});function _e(e){if(H(e),e.length%X!==0)throw new Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size "+X)}function Ue(e,t,r){H(e);let n=e.length;const o=n%X;if(!t&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");J(e)||(e=F(e));const s=_(e);if(t){let l=X-o;l||(l=X),n=n+l}r=nt(n,r),Vt(e,r);const c=_(r);return{b:s,o:c,out:r}}function Le(e,t){if(!t)return e;const r=e.length;if(!r)throw new Error("aes/pcks5: empty ciphertext not allowed");const n=e[r-1];if(n<=0||n>16)throw new Error("aes/pcks5: wrong padding");const o=e.subarray(0,-n);for(let s=0;s<n;s++)if(e[r-s-1]!==n)throw new Error("aes/pcks5: wrong padding");return o}function Ae(e){const t=new Uint8Array(16),r=_(t);t.set(e);const n=X-e.length;for(let o=X-n;o<X;o++)t[o]=n;return r}const sn=k({blockSize:16},function(t,r={}){const n=!r.disablePadding;return{encrypt(o,s){const{b:c,o:l,out:i}=Ue(o,n,s),f=st(t);let a=0;for(;a+4<=c.length;){const{s0:h,s1:d,s2:w,s3:y}=Y(f,c[a+0],c[a+1],c[a+2],c[a+3]);l[a++]=h,l[a++]=d,l[a++]=w,l[a++]=y}if(n){const h=Ae(o.subarray(a*4)),{s0:d,s1:w,s2:y,s3:u}=Y(f,h[0],h[1],h[2],h[3]);l[a++]=d,l[a++]=w,l[a++]=y,l[a++]=u}return I(f),i},decrypt(o,s){_e(o);const c=ee(t);s=nt(o.length,s);const l=[c];J(o)||l.push(o=F(o)),Vt(o,s);const i=_(o),f=_(s);for(let a=0;a+4<=i.length;){const{s0:h,s1:d,s2:w,s3:y}=jt(c,i[a+0],i[a+1],i[a+2],i[a+3]);f[a++]=h,f[a++]=d,f[a++]=w,f[a++]=y}return I(...l),Le(s,n)}}}),cn=k({blockSize:16,nonceLength:16},function(t,r,n={}){const o=!n.disablePadding;return{encrypt(s,c){const l=st(t),{b:i,o:f,out:a}=Ue(s,o,c);let h=r;const d=[l];J(h)||d.push(h=F(h));const w=_(h);let y=w[0],u=w[1],g=w[2],x=w[3],b=0;for(;b+4<=i.length;)y^=i[b+0],u^=i[b+1],g^=i[b+2],x^=i[b+3],{s0:y,s1:u,s2:g,s3:x}=Y(l,y,u,g,x),f[b++]=y,f[b++]=u,f[b++]=g,f[b++]=x;if(o){const v=Ae(s.subarray(b*4));y^=v[0],u^=v[1],g^=v[2],x^=v[3],{s0:y,s1:u,s2:g,s3:x}=Y(l,y,u,g,x),f[b++]=y,f[b++]=u,f[b++]=g,f[b++]=x}return I(...d),a},decrypt(s,c){_e(s);const l=ee(t);let i=r;const f=[l];J(i)||f.push(i=F(i));const a=_(i);c=nt(s.length,c),J(s)||f.push(s=F(s)),Vt(s,c);const h=_(s),d=_(c);let w=a[0],y=a[1],u=a[2],g=a[3];for(let x=0;x+4<=h.length;){const b=w,v=y,m=u,C=g;w=h[x+0],y=h[x+1],u=h[x+2],g=h[x+3];const{s0:S,s1:O,s2:N,s3:U}=jt(l,w,y,u,g);d[x++]=S^b,d[x++]=O^v,d[x++]=N^m,d[x++]=U^C}return I(...f),Le(c,o)}}}),ln=k({blockSize:16,nonceLength:16},function(t,r){function n(o,s,c){H(o);const l=o.length;if(c=nt(l,c),de(o,c))throw new Error("overlapping src and dst not supported.");const i=st(t);let f=r;const a=[i];J(f)||a.push(f=F(f)),J(o)||a.push(o=F(o));const h=_(o),d=_(c),w=s?d:h,y=_(f);let u=y[0],g=y[1],x=y[2],b=y[3];for(let m=0;m+4<=h.length;){const{s0:C,s1:S,s2:O,s3:N}=Y(i,u,g,x,b);d[m+0]=h[m+0]^C,d[m+1]=h[m+1]^S,d[m+2]=h[m+2]^O,d[m+3]=h[m+3]^N,u=w[m++],g=w[m++],x=w[m++],b=w[m++]}const v=X*Math.floor(h.length/Qt);if(v<l){({s0:u,s1:g,s2:x,s3:b}=Y(i,u,g,x,b));const m=qt(new Uint32Array([u,g,x,b]));for(let C=v,S=0;C<l;C++,S++)c[C]=o[C]^m[S];I(m)}return I(...a),c}return{encrypt:(o,s)=>n(o,!0,s),decrypt:(o,s)=>n(o,!1,s)}});function Ce(e,t,r,n,o){const s=o==null?0:o.length,c=e.create(r,n.length+s);o&&c.update(o),c.update(n);const l=new Uint8Array(16),i=At(l);o&&Lt(i,0,BigInt(s*8),t),Lt(i,8,BigInt(n.length*8),t),c.update(l);const f=c.digest();return I(l),f}const fn=k({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(t,r,n){if(r.length<8)throw new Error("aes/gcm: invalid nonce length");const o=16;function s(l,i,f){const a=Ce(ie,!1,l,f,n);for(let h=0;h<i.length;h++)a[h]^=i[h];return a}function c(){const l=st(t),i=Kt.slice(),f=Kt.slice();if(_t(l,!1,f,f,i),r.length===12)f.set(r);else{const h=Kt.slice(),d=At(h);Lt(d,8,BigInt(r.length*8),!1);const w=ie.create(i).update(r).update(h);w.digestInto(f),w.destroy()}const a=_t(l,!1,f,Kt);return{xk:l,authKey:i,counter:f,tagMask:a}}return{encrypt(l){const{xk:i,authKey:f,counter:a,tagMask:h}=c(),d=new Uint8Array(l.length+o),w=[i,f,a,h];J(l)||w.push(l=F(l)),_t(i,!1,a,l,d.subarray(0,l.length));const y=s(f,h,d.subarray(0,d.length-o));return w.push(y),d.set(y,l.length),I(...w),d},decrypt(l){const{xk:i,authKey:f,counter:a,tagMask:h}=c(),d=[i,f,h,a];J(l)||d.push(l=F(l));const w=l.subarray(0,-o),y=l.subarray(-o),u=s(f,h,w);if(d.push(u),!Ct(u,y))throw new Error("aes/gcm: invalid ghash tag");const g=_t(i,!1,a,w);return I(...d),g}}}),It=(e,t,r)=>n=>{if(!Number.isSafeInteger(n)||t>n||n>r){const o="["+t+".."+r+"]";throw new Error(""+e+": expected value in range "+o+", got "+n)}},an=k({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(t,r,n){const s=It("AAD",0,68719476736),c=It("plaintext",0,2**36),l=It("nonce",12,12),i=It("ciphertext",16,2**36+16);H(t,16,24,32),l(r.length),n!==void 0&&s(n.length);function f(){const d=st(t),w=new Uint8Array(t.length),y=new Uint8Array(16),u=[d,w];let g=r;J(g)||u.push(g=F(g));const x=_(g);let b=0,v=x[0],m=x[1],C=x[2],S=0;for(const N of[y,w].map(_)){const U=_(N);for(let B=0;B<U.length;B+=2){const{s0:T,s1:K}=Y(d,b,v,m,C);U[B+0]=T,U[B+1]=K,b=++S}}const O={authKey:y,encKey:st(w)};return I(...u),O}function a(d,w,y){const u=Ce(Qe,!0,w,y,n);for(let C=0;C<12;C++)u[C]^=r[C];u[15]&=127;const g=_(u);let x=g[0],b=g[1],v=g[2],m=g[3];return{s0:x,s1:b,s2:v,s3:m}=Y(d,x,b,v,m),g[0]=x,g[1]=b,g[2]=v,g[3]=m,u}function h(d,w,y){let u=F(w);u[15]|=128;const g=_t(d,!0,u,y);return I(u),g}return{encrypt(d){c(d.length);const{encKey:w,authKey:y}=f(),u=a(w,y,d),g=[w,y,u];J(d)||g.push(d=F(d));const x=new Uint8Array(d.length+16);return x.set(u,d.length),x.set(h(w,u,d)),I(...g),x},decrypt(d){i(d.length);const w=d.subarray(-16),{encKey:y,authKey:u}=f(),g=[y,u];J(d)||g.push(d=F(d));const x=h(y,w,d.subarray(0,-16)),b=a(y,u,x);if(g.push(b),!Ct(w,b))throw I(...g),new Error("invalid polyval tag");return I(...g),x}}});function Se(e){return e instanceof Uint32Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint32Array"}function hn(e,t){if(H(t,16),!Se(e))throw new Error("_encryptBlock accepts result of expandKeyLE");const r=_(t);let{s0:n,s1:o,s2:s,s3:c}=Y(e,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=o,r[2]=s,r[3]=c,t}function un(e,t){if(H(t,16),!Se(e))throw new Error("_decryptBlock accepts result of expandKeyLE");const r=_(t);let{s0:n,s1:o,s2:s,s3:c}=jt(e,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=o,r[2]=s,r[3]=c,t}const Rt={encrypt(e,t){if(t.length>=2**32)throw new Error("plaintext should be less than 4gb");const r=st(e);if(t.length===16)hn(r,t);else{const n=_(t);let o=n[0],s=n[1];for(let c=0,l=1;c<6;c++)for(let i=2;i<n.length;i+=2,l++){const{s0:f,s1:a,s2:h,s3:d}=Y(r,o,s,n[i],n[i+1]);o=f,s=a^Pt(l),n[i]=h,n[i+1]=d}n[0]=o,n[1]=s}r.fill(0)},decrypt(e,t){if(t.length-8>=2**32)throw new Error("ciphertext should be less than 4gb");const r=ee(e),n=t.length/8-1;if(n===1)un(r,t);else{const o=_(t);let s=o[0],c=o[1];for(let l=0,i=n*6;l<6;l++)for(let f=n*2;f>=1;f-=2,i--){c^=Pt(i);const{s0:a,s1:h,s2:d,s3:w}=jt(r,s,c,o[f],o[f+1]);s=a,c=h,o[f]=d,o[f+1]=w}o[0]=s,o[1]=c}r.fill(0)}},fe=new Uint8Array(8).fill(166),pn=k({blockSize:8},e=>({encrypt(t){if(!t.length||t.length%8!==0)throw new Error("invalid plaintext length");if(t.length===8)throw new Error("8-byte keys not allowed in AESKW, use AESKWP instead");const r=we(fe,t);return Rt.encrypt(e,r),r},decrypt(t){if(t.length%8!==0||t.length<3*8)throw new Error("invalid ciphertext length");const r=F(t);if(Rt.decrypt(e,r),!Ct(r.subarray(0,8),fe))throw new Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8)}})),ae=2790873510,yn=k({blockSize:8},e=>({encrypt(t){if(!t.length)throw new Error("invalid plaintext length");const r=Math.ceil(t.length/8)*8,n=new Uint8Array(8+r);n.set(t,8);const o=_(n);return o[0]=ae,o[1]=Pt(t.length),Rt.encrypt(e,n),n},decrypt(t){if(t.length<16)throw new Error("invalid ciphertext length");const r=F(t),n=_(r);Rt.decrypt(e,r);const o=Pt(n[1])>>>0,s=Math.ceil(o/8)*8;if(n[0]!==ae||r.length-8!==s)throw new Error("integrity check failed");for(let c=o;c<s;c++)if(r[8+c]!==0)throw new Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8,8+o)}})),Be=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),gn=Be("expand 16-byte k"),dn=Be("expand 32-byte k"),wn=_(gn),xn=_(dn);function p(e,t){return e<<t|e>>>32-t}function Jt(e){return e.byteOffset%4===0}const Ot=64,bn=16,Te=2**32-1,he=new Uint32Array;function mn(e,t,r,n,o,s,c,l){const i=o.length,f=new Uint8Array(Ot),a=_(f),h=Jt(o)&&Jt(s),d=h?_(o):he,w=h?_(s):he;for(let y=0;y<i;c++){if(e(t,r,n,a,c,l),c>=Te)throw new Error("arx: counter overflow");const u=Math.min(Ot,i-y);if(h&&u===Ot){const g=y/4;if(y%4!==0)throw new Error("arx: invalid block position");for(let x=0,b;x<bn;x++)b=g+x,w[b]=d[b]^a[x];y+=Ot;continue}for(let g=0,x;g<u;g++)x=y+g,s[x]=o[x]^f[g];y+=u}}function vt(e,t){const{allowShortKeys:r,extendNonceFn:n,counterLength:o,counterRight:s,rounds:c}=Ge({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return zt(o),zt(c),se(s),se(r),(l,i,f,a,h=0)=>{H(l),H(i),H(f);const d=f.length;if(a===void 0&&(a=new Uint8Array(d)),H(a),zt(h),h<0||h>=Te)throw new Error("arx: counter overflow");if(a.length<d)throw new Error(`arx: output (${a.length}) is shorter than data (${d})`);const w=[];let y=l.length,u,g;if(y===32)w.push(u=F(l)),g=xn;else if(y===16&&r)u=new Uint8Array(32),u.set(l),u.set(l,16),g=wn,w.push(u);else throw new Error(`arx: invalid 32-byte key, got length=${y}`);Jt(i)||w.push(i=F(i));const x=_(u);if(n){if(i.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(g,x,_(i.subarray(0,16)),x),i=i.subarray(16)}const b=16-o;if(b!==i.length)throw new Error(`arx: nonce must be ${b} or 16 bytes`);if(b!==12){const m=new Uint8Array(12);m.set(i,s?0:12-i.length),i=m,w.push(i)}const v=_(i);return mn(e,g,x,v,f,a,h,c),I(...w),a}}const Z=(e,t)=>e[t++]&255|(e[t++]&255)<<8;class En{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=ft(t),H(t,32);const r=Z(t,0),n=Z(t,2),o=Z(t,4),s=Z(t,6),c=Z(t,8),l=Z(t,10),i=Z(t,12),f=Z(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|o<<6)&7939,this.r[3]=(o>>>7|s<<9)&8191,this.r[4]=(s>>>4|c<<12)&255,this.r[5]=c>>>1&8190,this.r[6]=(c>>>14|l<<2)&8191,this.r[7]=(l>>>11|i<<5)&8065,this.r[8]=(i>>>8|f<<8)&8191,this.r[9]=f>>>5&127;for(let a=0;a<8;a++)this.pad[a]=Z(t,16+2*a)}process(t,r,n=!1){const o=n?0:2048,{h:s,r:c}=this,l=c[0],i=c[1],f=c[2],a=c[3],h=c[4],d=c[5],w=c[6],y=c[7],u=c[8],g=c[9],x=Z(t,r+0),b=Z(t,r+2),v=Z(t,r+4),m=Z(t,r+6),C=Z(t,r+8),S=Z(t,r+10),O=Z(t,r+12),N=Z(t,r+14);let U=s[0]+(x&8191),B=s[1]+((x>>>13|b<<3)&8191),T=s[2]+((b>>>10|v<<6)&8191),K=s[3]+((v>>>7|m<<9)&8191),z=s[4]+((m>>>4|C<<12)&8191),M=s[5]+(C>>>1&8191),P=s[6]+((C>>>14|S<<2)&8191),R=s[7]+((S>>>11|O<<5)&8191),V=s[8]+((O>>>8|N<<8)&8191),j=s[9]+(N>>>5|o),E=0,$=E+U*l+B*(5*g)+T*(5*u)+K*(5*y)+z*(5*w);E=$>>>13,$&=8191,$+=M*(5*d)+P*(5*h)+R*(5*a)+V*(5*f)+j*(5*i),E+=$>>>13,$&=8191;let W=E+U*i+B*l+T*(5*g)+K*(5*u)+z*(5*y);E=W>>>13,W&=8191,W+=M*(5*w)+P*(5*d)+R*(5*h)+V*(5*a)+j*(5*f),E+=W>>>13,W&=8191;let L=E+U*f+B*i+T*l+K*(5*g)+z*(5*u);E=L>>>13,L&=8191,L+=M*(5*y)+P*(5*w)+R*(5*d)+V*(5*h)+j*(5*a),E+=L>>>13,L&=8191;let q=E+U*a+B*f+T*i+K*l+z*(5*g);E=q>>>13,q&=8191,q+=M*(5*u)+P*(5*y)+R*(5*w)+V*(5*d)+j*(5*h),E+=q>>>13,q&=8191;let ht=E+U*h+B*a+T*f+K*i+z*l;E=ht>>>13,ht&=8191,ht+=M*(5*g)+P*(5*u)+R*(5*y)+V*(5*w)+j*(5*d),E+=ht>>>13,ht&=8191;let ut=E+U*d+B*h+T*a+K*f+z*i;E=ut>>>13,ut&=8191,ut+=M*l+P*(5*g)+R*(5*u)+V*(5*y)+j*(5*w),E+=ut>>>13,ut&=8191;let pt=E+U*w+B*d+T*h+K*a+z*f;E=pt>>>13,pt&=8191,pt+=M*i+P*l+R*(5*g)+V*(5*u)+j*(5*y),E+=pt>>>13,pt&=8191;let yt=E+U*y+B*w+T*d+K*h+z*a;E=yt>>>13,yt&=8191,yt+=M*f+P*i+R*l+V*(5*g)+j*(5*u),E+=yt>>>13,yt&=8191;let gt=E+U*u+B*y+T*w+K*d+z*h;E=gt>>>13,gt&=8191,gt+=M*a+P*f+R*i+V*l+j*(5*g),E+=gt>>>13,gt&=8191;let dt=E+U*g+B*u+T*y+K*w+z*d;E=dt>>>13,dt&=8191,dt+=M*h+P*a+R*f+V*i+j*l,E+=dt>>>13,dt&=8191,E=(E<<2)+E|0,E=E+$|0,$=E&8191,E=E>>>13,W+=E,s[0]=$,s[1]=W,s[2]=L,s[3]=q,s[4]=ht,s[5]=ut,s[6]=pt,s[7]=yt,s[8]=gt,s[9]=dt}finalize(){const{h:t,pad:r}=this,n=new Uint16Array(10);let o=t[1]>>>13;t[1]&=8191;for(let l=2;l<10;l++)t[l]+=o,o=t[l]>>>13,t[l]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,n[0]=t[0]+5,o=n[0]>>>13,n[0]&=8191;for(let l=1;l<10;l++)n[l]=t[l]+o,o=n[l]>>>13,n[l]&=8191;n[9]-=8192;let s=(o^1)-1;for(let l=0;l<10;l++)n[l]&=s;s=~s;for(let l=0;l<10;l++)t[l]=t[l]&s|n[l];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let c=t[0]+r[0];t[0]=c&65535;for(let l=1;l<8;l++)c=(t[l]+r[l]|0)+(c>>>16)|0,t[l]=c&65535;I(n)}update(t){Et(this);const{buffer:r,blockLen:n}=this;t=ft(t);const o=t.length;for(let s=0;s<o;){const c=Math.min(n-this.pos,o-s);if(c===n){for(;n<=o-s;s+=n)this.process(t,s);continue}r.set(t.subarray(s,s+c),this.pos),this.pos+=c,s+=c,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){I(this.h,this.r,this.buffer,this.pad)}digestInto(t){Et(this),Yt(t,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:o}=this;if(o){for(r[o++]=1;o<16;o++)r[o]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let c=0;c<8;c++)t[s++]=n[c]>>>0,t[s++]=n[c]>>>8;return t}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}}function vn(e){const t=(n,o)=>e(o).update(ft(n)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}const Xt=vn(e=>new En(e));function Ke(e,t,r,n,o,s=20){let c=e[0],l=t[0],i=t[1],f=t[2],a=t[3],h=e[1],d=r[0],w=r[1],y=o,u=0,g=e[2],x=t[4],b=t[5],v=t[6],m=t[7],C=e[3],S=c,O=l,N=i,U=f,B=a,T=h,K=d,z=w,M=y,P=u,R=g,V=x,j=b,E=v,$=m,W=C;for(let q=0;q<s;q+=2)B^=p(S+j|0,7),M^=p(B+S|0,9),j^=p(M+B|0,13),S^=p(j+M|0,18),P^=p(T+O|0,7),E^=p(P+T|0,9),O^=p(E+P|0,13),T^=p(O+E|0,18),$^=p(R+K|0,7),N^=p($+R|0,9),K^=p(N+$|0,13),R^=p(K+N|0,18),U^=p(W+V|0,7),z^=p(U+W|0,9),V^=p(z+U|0,13),W^=p(V+z|0,18),O^=p(S+U|0,7),N^=p(O+S|0,9),U^=p(N+O|0,13),S^=p(U+N|0,18),K^=p(T+B|0,7),z^=p(K+T|0,9),B^=p(z+K|0,13),T^=p(B+z|0,18),V^=p(R+P|0,7),M^=p(V+R|0,9),P^=p(M+V|0,13),R^=p(P+M|0,18),j^=p(W+$|0,7),E^=p(j+W|0,9),$^=p(E+j|0,13),W^=p($+E|0,18);let L=0;n[L++]=c+S|0,n[L++]=l+O|0,n[L++]=i+N|0,n[L++]=f+U|0,n[L++]=a+B|0,n[L++]=h+T|0,n[L++]=d+K|0,n[L++]=w+z|0,n[L++]=y+M|0,n[L++]=u+P|0,n[L++]=g+R|0,n[L++]=x+V|0,n[L++]=b+j|0,n[L++]=v+E|0,n[L++]=m+$|0,n[L++]=C+W|0}function _n(e,t,r,n){let o=e[0],s=t[0],c=t[1],l=t[2],i=t[3],f=e[1],a=r[0],h=r[1],d=r[2],w=r[3],y=e[2],u=t[4],g=t[5],x=t[6],b=t[7],v=e[3];for(let C=0;C<20;C+=2)i^=p(o+g|0,7),d^=p(i+o|0,9),g^=p(d+i|0,13),o^=p(g+d|0,18),w^=p(f+s|0,7),x^=p(w+f|0,9),s^=p(x+w|0,13),f^=p(s+x|0,18),b^=p(y+a|0,7),c^=p(b+y|0,9),a^=p(c+b|0,13),y^=p(a+c|0,18),l^=p(v+u|0,7),h^=p(l+v|0,9),u^=p(h+l|0,13),v^=p(u+h|0,18),s^=p(o+l|0,7),c^=p(s+o|0,9),l^=p(c+s|0,13),o^=p(l+c|0,18),a^=p(f+i|0,7),h^=p(a+f|0,9),i^=p(h+a|0,13),f^=p(i+h|0,18),u^=p(y+w|0,7),d^=p(u+y|0,9),w^=p(d+u|0,13),y^=p(w+d|0,18),g^=p(v+b|0,7),x^=p(g+v|0,9),b^=p(x+g|0,13),v^=p(b+x|0,18);let m=0;n[m++]=o,n[m++]=f,n[m++]=y,n[m++]=v,n[m++]=a,n[m++]=h,n[m++]=d,n[m++]=w}const Un=vt(Ke,{allowShortKeys:!0,counterRight:!0}),Mt=vt(Ke,{counterRight:!0,extendNonceFn:_n}),Ln=k({blockSize:64,nonceLength:24,tagLength:16},(e,t)=>({encrypt(r,n){n=nt(r.length+32,n,!1);const o=n.subarray(0,32),s=n.subarray(32);n.set(r,32),I(o),Mt(e,t,n,n);const c=Xt(s,o);return n.set(c,16),I(n.subarray(0,16),c),n.subarray(16)},decrypt(r,n){H(r),n=nt(r.length+32,n,!1);const o=n.subarray(0,32),s=n.subarray(32,48),c=n.subarray(48);n.set(r,32),I(o);const l=Mt(e,t,o,o),i=Xt(c,l);if(!Ct(s,i))throw new Error("invalid tag");return Mt(e,t,n.subarray(16),n.subarray(16)),I(o,s,i),c}}));function $t(e,t,r,n,o,s=20){let c=e[0],l=e[1],i=e[2],f=e[3],a=t[0],h=t[1],d=t[2],w=t[3],y=t[4],u=t[5],g=t[6],x=t[7],b=o,v=r[0],m=r[1],C=r[2],S=c,O=l,N=i,U=f,B=a,T=h,K=d,z=w,M=y,P=u,R=g,V=x,j=b,E=v,$=m,W=C;for(let q=0;q<s;q+=2)S=S+B|0,j=p(j^S,16),M=M+j|0,B=p(B^M,12),S=S+B|0,j=p(j^S,8),M=M+j|0,B=p(B^M,7),O=O+T|0,E=p(E^O,16),P=P+E|0,T=p(T^P,12),O=O+T|0,E=p(E^O,8),P=P+E|0,T=p(T^P,7),N=N+K|0,$=p($^N,16),R=R+$|0,K=p(K^R,12),N=N+K|0,$=p($^N,8),R=R+$|0,K=p(K^R,7),U=U+z|0,W=p(W^U,16),V=V+W|0,z=p(z^V,12),U=U+z|0,W=p(W^U,8),V=V+W|0,z=p(z^V,7),S=S+T|0,W=p(W^S,16),R=R+W|0,T=p(T^R,12),S=S+T|0,W=p(W^S,8),R=R+W|0,T=p(T^R,7),O=O+K|0,j=p(j^O,16),V=V+j|0,K=p(K^V,12),O=O+K|0,j=p(j^O,8),V=V+j|0,K=p(K^V,7),N=N+z|0,E=p(E^N,16),M=M+E|0,z=p(z^M,12),N=N+z|0,E=p(E^N,8),M=M+E|0,z=p(z^M,7),U=U+B|0,$=p($^U,16),P=P+$|0,B=p(B^P,12),U=U+B|0,$=p($^U,8),P=P+$|0,B=p(B^P,7);let L=0;n[L++]=c+S|0,n[L++]=l+O|0,n[L++]=i+N|0,n[L++]=f+U|0,n[L++]=a+B|0,n[L++]=h+T|0,n[L++]=d+K|0,n[L++]=w+z|0,n[L++]=y+M|0,n[L++]=u+P|0,n[L++]=g+R|0,n[L++]=x+V|0,n[L++]=b+j|0,n[L++]=v+E|0,n[L++]=m+$|0,n[L++]=C+W|0}function An(e,t,r,n){let o=e[0],s=e[1],c=e[2],l=e[3],i=t[0],f=t[1],a=t[2],h=t[3],d=t[4],w=t[5],y=t[6],u=t[7],g=r[0],x=r[1],b=r[2],v=r[3];for(let C=0;C<20;C+=2)o=o+i|0,g=p(g^o,16),d=d+g|0,i=p(i^d,12),o=o+i|0,g=p(g^o,8),d=d+g|0,i=p(i^d,7),s=s+f|0,x=p(x^s,16),w=w+x|0,f=p(f^w,12),s=s+f|0,x=p(x^s,8),w=w+x|0,f=p(f^w,7),c=c+a|0,b=p(b^c,16),y=y+b|0,a=p(a^y,12),c=c+a|0,b=p(b^c,8),y=y+b|0,a=p(a^y,7),l=l+h|0,v=p(v^l,16),u=u+v|0,h=p(h^u,12),l=l+h|0,v=p(v^l,8),u=u+v|0,h=p(h^u,7),o=o+f|0,v=p(v^o,16),y=y+v|0,f=p(f^y,12),o=o+f|0,v=p(v^o,8),y=y+v|0,f=p(f^y,7),s=s+a|0,g=p(g^s,16),u=u+g|0,a=p(a^u,12),s=s+a|0,g=p(g^s,8),u=u+g|0,a=p(a^u,7),c=c+h|0,x=p(x^c,16),d=d+x|0,h=p(h^d,12),c=c+h|0,x=p(x^c,8),d=d+x|0,h=p(h^d,7),l=l+i|0,b=p(b^l,16),w=w+b|0,i=p(i^w,12),l=l+i|0,b=p(b^l,8),w=w+b|0,i=p(i^w,7);let m=0;n[m++]=o,n[m++]=s,n[m++]=c,n[m++]=l,n[m++]=g,n[m++]=x,n[m++]=b,n[m++]=v}const Ie=vt($t,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Oe=vt($t,{counterRight:!1,counterLength:8,extendNonceFn:An,allowShortKeys:!1}),Cn=vt($t,{counterRight:!1,counterLength:4,rounds:8}),Sn=vt($t,{counterRight:!1,counterLength:4,rounds:12}),Bn=new Uint8Array(16),ue=(e,t)=>{e.update(t);const r=t.length%16;r&&e.update(Bn.subarray(r))},Tn=new Uint8Array(32);function pe(e,t,r,n,o){const s=e(t,r,Tn),c=Xt.create(s);o&&ue(c,o),ue(c,n);const l=new Uint8Array(16),i=At(l);Lt(i,0,BigInt(o?o.length:0),!0),Lt(i,8,BigInt(n.length),!0),c.update(l);const f=c.digest();return I(s,l),f}const Ne=e=>(t,r,n)=>({encrypt(s,c){const l=s.length;c=nt(l+16,c,!1),c.set(s);const i=c.subarray(0,-16);e(t,r,i,i,1);const f=pe(e,t,r,i,n);return c.set(f,l),I(f),c},decrypt(s,c){c=nt(s.length-16,c,!1);const l=s.subarray(0,-16),i=s.subarray(-16),f=pe(e,t,r,l,n);if(!Ct(i,f))throw new Error("invalid tag");return c.set(s.subarray(0,-16)),e(t,r,c,c,1),I(f),c}}),Kn=k({blockSize:64,nonceLength:12,tagLength:16},Ne(Ie)),In=k({blockSize:64,nonceLength:24,tagLength:16},Ne(Oe));function ye(e,t){return t==="Text"?e:at.enc.Hex.parse(e)}function bt(e,t){return t==="Text"?Ut(e):Ze(e)}function Zt(e){return{encrypt:(t,r,n)=>e.encrypt(t,ye(r,n),{iv:at.enc.Hex.parse("")}).toString(),decrypt:(t,r,n)=>e.decrypt(t,ye(r,n),{iv:at.enc.Hex.parse("")}).toString(at.enc.Utf8)}}function G(e,t="auto",r=0){return{encrypt:(n,o,s)=>{if(t==="auto")return wt.from(le(e)(bt(o,s)).encrypt(Ut(n))).toString("base64");if(t==="none")return wt.from(e(bt(o,s)).encrypt(Ut(n))).toString("base64");{const c=xe(r);return wt.from(new Uint8Array([...c,...e(bt(o,s),c,Ut(n))])).toString("base64")}},decrypt:(n,o,s)=>{if(t==="auto")return Ht(le(e)(bt(o,s)).decrypt(wt.from(n,"base64")));if(t==="none")return Ht(e(bt(o,s)).decrypt(wt.from(n,"base64")));{const c=wt.from(n,"base64");return Ht(e(bt(o,s),c.subarray(0,r),c.subarray(r)))}}}}const Nt={TripleDES:Zt(at.TripleDES),Rabbit:Zt(at.Rabbit),RC4:Zt(at.RC4),"AES-GCM":G(fn),"AES-SIV":G(an),"AES-CTR":G(on),"AES-CFB":G(ln),"AES-CBC":G(cn),"AES-ECB":G(sn,"none"),"AES-KW":G(pn,"none"),"AES-KWP":G(yn,"none"),"Salsa-XSalsa20poly1305":G(Ln),"Chacha-Chacha20poly1305":G(Kn),"Chacha-XChacha20poly1305":G(In),"Salsa-Salsa20":G(Un,"manual",8),"Salsa-XSalsa20":G(Mt,"manual",24),"Chacha-Chacha20":G(Ie,"manual",12),"Chacha-XChacha20":G(Oe,"manual",24),"Chacha-Chacha8":G(Cn,"manual",12),"Chacha-Chacha12 ":G(Sn,"manual",12)},On={flex:"","gap-3":""},Nn={flex:"","flex-1":"","flex-col":"","gap-2":""},zn={flex:"","gap-3":""},Mn={flex:"","flex-1":"","flex-col":"","gap-2":""},qn=ze({__name:"encryption",setup(e){const{t}=Me(),r=ct("Lorem ipsum dolor sit amet"),n=ct("AES-CBC"),o=ct("my secret key 16"),s=ct("Text"),[c,l]=oe(()=>Nt[n.value].encrypt(r.value,o.value,s.value),{defaultValue:"",defaultErrorMessage:t("tools.encryption.defaultErrorMessage")}),i=ct("dopEIE7v5TJlhHl+0+mA4Q+BxNj4xcdTsiVGw4tmpLlkDln8lzmzavO3egJuzpCD"),f=ct("AES-CBC"),a=ct("my secret key 16"),h=ct("Text"),[d,w]=oe(()=>Nt[f.value].decrypt(i.value,a.value,h.value),{defaultValue:"",defaultErrorMessage:t("tools.encryption.defaultErrorMessage")});return(y,u)=>{const g=je,x=$e,b=We,v=He;return St(),Pe(Ve,null,[Q(v,{title:A(t)("tools.encryption.title-encrypt")},{default:Bt(()=>[Tt("div",On,[Q(g,{value:A(r),"onUpdate:value":u[0]||(u[0]=m=>lt(r)?r.value=m:null),label:A(t)("tools.encryption.texts.label-your-text"),placeholder:A(t)("tools.encryption.texts.placeholder-the-string-to-cypher"),rows:"4",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),Tt("div",Nn,[Q(g,{value:A(o),"onUpdate:value":u[1]||(u[1]=m=>lt(o)?o.value=m:null),label:A(t)("tools.encryption.texts.label-your-secret-key"),clearable:"","raw-text":""},null,8,["value","label"]),Q(x,{value:A(s),"onUpdate:value":u[2]||(u[2]=m=>lt(s)?s.value=m:null),label:A(t)("tools.encryption.texts.label-key-encoding"),"flex-1":"",placeholder:A(t)("tools.encryption.texts.placeholder-select-the-key-encoding"),options:[{label:A(t)("tools.encryption.texts.label-plain-text"),value:"Text"},{label:A(t)("tools.encryption.texts.label-hexadecimal-text"),value:"Hex"}]},null,8,["value","label","placeholder","options"]),Q(x,{value:A(n),"onUpdate:value":u[3]||(u[3]=m=>lt(n)?n.value=m:null),label:A(t)("tools.encryption.texts.label-encryption-algorithm"),options:Object.keys(A(Nt)).map(m=>({label:m,value:m}))},null,8,["value","label","options"])])]),A(l)?(St(),Wt(b,{key:0,type:"error","mt-12":"",title:A(t)("tools.encryption.texts.title-error-while-cyphering")},{default:Bt(()=>[ne(re(A(l)),1)]),_:1},8,["title"])):Re("",!0),Q(g,{label:A(t)("tools.encryption.texts.label-your-text-encrypted"),value:A(c),rows:"3",placeholder:A(t)("tools.encryption.texts.placeholder-your-string-hash"),multiline:"",monospace:"",readonly:"",autosize:"","mt-5":""},null,8,["label","value","placeholder"])]),_:1},8,["title"]),Q(v,{title:A(t)("tools.encryption.title-decrypt")},{default:Bt(()=>[Tt("div",zn,[Q(g,{value:A(i),"onUpdate:value":u[4]||(u[4]=m=>lt(i)?i.value=m:null),label:A(t)("tools.encryption.texts.label-your-encrypted-text"),placeholder:A(t)("tools.encryption.texts.placeholder-the-string-to-cypher"),rows:"4",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),Tt("div",Mn,[Q(g,{value:A(a),"onUpdate:value":u[5]||(u[5]=m=>lt(a)?a.value=m:null),label:A(t)("tools.encryption.texts.label-your-secret-key"),clearable:"","raw-text":""},null,8,["value","label"]),Q(x,{value:A(h),"onUpdate:value":u[6]||(u[6]=m=>lt(h)?h.value=m:null),label:A(t)("tools.encryption.texts.label-key-encoding"),"flex-1":"",placeholder:A(t)("tools.encryption.texts.placeholder-select-the-key-encoding"),options:[{label:A(t)("tools.encryption.texts.label-plain-text"),value:"Text"},{label:A(t)("tools.encryption.texts.label-hexadecimal-text"),value:"Hex"}]},null,8,["value","label","placeholder","options"]),Q(x,{value:A(f),"onUpdate:value":u[7]||(u[7]=m=>lt(f)?f.value=m:null),label:A(t)("tools.encryption.texts.label-encryption-algorithm"),options:Object.keys(A(Nt)).map(m=>({label:m,value:m}))},null,8,["value","label","options"])])]),A(w)?(St(),Wt(b,{key:0,type:"error","mt-12":"",title:A(t)("tools.encryption.texts.title-error-while-decrypting")},{default:Bt(()=>[ne(re(A(w)),1)]),_:1},8,["title"])):(St(),Wt(g,{key:1,label:A(t)("tools.encryption.texts.label-your-decrypted-text"),value:A(d),placeholder:A(t)("tools.encryption.texts.placeholder-your-string-hash"),rows:"3",multiline:"",monospace:"",readonly:"",autosize:"","mt-5":""},null,8,["label","value","placeholder"]))]),_:1},8,["title"])],64)}}});export{qn as default};
