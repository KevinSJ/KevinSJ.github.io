import{l as p}from"./index-20485d98.js";import{w as o}from"./prime.worker.min-a8ac05bb.js";import{s as n}from"./index-522ff296.js";function y({bits:e=2048}){return new Promise((s,m)=>p.pki.rsa.generateKeyPair({bits:e,workerScript:o},(t,r)=>{if(t){m(t);return}s(r)}))}async function P(e={}){const{privateKey:s,publicKey:m}=await y(e),t=p.pki.privateKeyToPem(s);if(e?.format==="pem")return{publicKey:p.pki.publicKeyToPem(m),privateKey:e?.password?p.pki.encryptRsaPrivateKey(s,e?.password):t};const r=n.parsePrivateKey(t);r.comment=e?.comment;const i=e.format??"ssh";let a=e.format??"ssh";return a==="ssh"&&(a="ssh-private"),{publicKey:r.toPublic().toString(i),privateKey:e?.password?r.toString(a,{passphrase:e?.password,comment:e?.comment}):r.toString(a,{comment:e?.comment})}}export{P as g};
