import{_ as Q}from"./TextareaCopyable-59231e95.js";import{d as T,a0 as V,ac as j,r as g,o as q,j as y,w as l,k as p,l as e,m as v,a6 as N,G as x,ad as b,ah as A,aj as B}from"./index-0c1fde36.js";import{_ as P}from"./FormItem-1b9a5952.js";import{_ as U}from"./p-77eb774b.js";import{_ as z}from"./DynamicInput-1857fb62.js";import{_ as k}from"./Card-7ba5ce79.js";import{_ as D}from"./Space-7fc52151.js";import{N as E}from"./Alert-a9fb131b.js";import{_ as R}from"./Form-a433c14f.js";import"./base64-ae7cf34b.js";import"./index-a6f01dde.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./context-00991937.js";import"./ArrowDown-6fbf6d78.js";import"./get-slot-1efb97e5.js";function w(t){return t==null||t.toLowerCase?.()==="null"?"NULL":!Number.isNaN(Number(t))&&t.trim()!==""?t.includes(".")?Number.parseFloat(t):Number.parseInt(t):`'${t.replace(/'/g,"''")}'`}function G(t,r){const m=new Map,u=[];let c=0;r.forEach(({key:a,value:n})=>{if(a!==""&&!/^\d+$/.test(a))m.set(a,w(n));else{const _=(c++).toString();u.push({key:_,value:n})}});let o=t,i=null;o=o.replace(/(:\w+|@\w+)/g,a=>{const n=a.slice(1);return m.has(n)?m.get(n):(i=`Missing value for named parameter "${a}"`,a)});let d=0;const s=u.filter(a=>/^\d+$/.test(a.key));return o=o.replace(/(^|[^\\])\?/g,(a,n)=>{const _=s[d++];return _?`${n}${w(_.value)}`:(i=`Missing value for positional parameter at index ${d-1}`,`${n}?`)}),o=o.replace(/\\\?/g,"?"),{sql:i?"":o,error:i}}const ie=T({__name:"sql-parameters",setup(t){const{t:r}=V(),m=j({name:"sql",storageName:"sql-params:sql",defaultValue:""}),u=g([{key:"",value:""}]),c=g(""),o=g("");function i(){const{sql:d,error:s}=G(m.value,u.value);c.value=d,o.value=s||""}return(d,s)=>{const a=A,n=P,_=U,$=z,h=k,I=B,C=D,L=Q,S=E,M=R,F=k;return q(),y(F,{title:e(r)("tools.sql-parameters.texts.title-sql-generator")},{default:l(()=>[p(M,{"label-placement":"top"},{default:l(()=>[p(n,{label:e(r)("tools.sql-parameters.texts.label-parameterized-sql-statement")},{default:l(()=>[p(a,{value:e(m),"onUpdate:value":s[0]||(s[0]=f=>v(m)?m.value=f:null),type:"textarea",placeholder:e(r)("tools.sql-parameters.texts.placeholder-e-g-select-from-users-where-name-name-and-age-and-type-type"),autosize:{minRows:3}},null,8,["value","placeholder"])]),_:1},8,["label"]),p(h,{title:e(r)("tools.sql-parameters.texts.title-parameters")},{default:l(()=>[p(_,null,{default:l(()=>[N(x(e(r)("tools.sql-parameters.texts.tag-for-positional-parameters-leave-name-empty-for-named-parameters-enter-name-without-or-prefix")),1)]),_:1}),p($,{value:e(u),"onUpdate:value":s[1]||(s[1]=f=>v(u)?u.value=f:null),min:1,preset:"pair","show-sort-button":"","key-placeholder":e(r)("tools.sql-parameters.texts.placeholder-name-e-g-name-or-type"),"value-placeholder":e(r)("tools.sql-parameters.texts.placeholder-value-e-g-alice-or-42-or-1-3")},null,8,["value","key-placeholder","value-placeholder"])]),_:1},8,["title"]),p(C,{justify:"center"},{default:l(()=>[p(I,{type:"primary",onClick:i},{default:l(()=>[N(x(e(r)("tools.sql-parameters.texts.tag-generate-sql")),1)]),_:1})]),_:1}),e(c)?(q(),y(n,{key:0,label:e(r)("tools.sql-parameters.texts.label-generated-sql"),"mt-2":""},{default:l(()=>[p(L,{value:e(c),"download-file-name":"output.sql"},null,8,["value"])]),_:1},8,["label"])):b("",!0),e(o)?(q(),y(S,{key:1,type:"error","mt-2":"",onClose:s[2]||(s[2]=f=>o.value="")},{default:l(()=>[N(x(e(o)),1)]),_:1})):b("",!0)]),_:1})]),_:1},8,["title"])}}});export{ie as default};
