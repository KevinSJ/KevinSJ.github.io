import{c as f,i as h}from"./style-ynO7IsM1.js";import"./version-BXrBJCm5.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-C6L5gDe0.js";import{G as B,P as v,y as L}from"./main-CdZmBCMR.js";import"./mobileMenu-BoMunYmR.js";B.workerSrc=new URL("/itools/assets/pdf.worker.min-LyOxJPrg.mjs",import.meta.url).toString();const o={pdfDoc:null,file:null,detectedBlankPages:[],pageThumbnails:new Map};function m(t="Processing..."){document.getElementById("loader-modal")?.classList.remove("hidden");const e=document.getElementById("loader-text");e&&(e.textContent=t)}function u(){document.getElementById("loader-modal")?.classList.add("hidden")}function c(t,e,n="error",a){const i=document.getElementById("alert-modal"),r=document.getElementById("alert-title"),s=document.getElementById("alert-message");r&&(r.textContent=t),s&&(s.textContent=e),i?.classList.remove("hidden");const d=document.getElementById("alert-ok");if(d){const l=d.cloneNode(!0);d.replaceWith(l),l.addEventListener("click",()=>{i?.classList.add("hidden"),a&&a()})}}function k(t,e){const n=URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download=e,a.click(),URL.revokeObjectURL(n)}function P(){const t=document.getElementById("file-display-area");if(!t||!o.file||!o.pdfDoc)return;const e=o.file.size<1024*1024?`${(o.file.size/1024).toFixed(1)} KB`:`${(o.file.size/1024/1024).toFixed(2)} MB`,n=o.pdfDoc.getPageCount();t.innerHTML=`
        <div class="bg-gray-700 p-3 rounded-lg border border-gray-600 hover:border-indigo-500 transition-colors">
            <div class="flex items-center justify-between">
                <div class="flex-1 min-w-0">
                    <p class="truncate font-medium text-white">${o.file.name}</p>
                    <p class="text-gray-400 text-sm">${e} â€¢ ${n} page${n!==1?"s":""}</p>
                </div>
                <button id="remove-file" class="text-red-400 hover:text-red-300 p-2 flex-shrink-0 ml-2" title="Remove file">
                    <i data-lucide="trash-2" class="w-4 h-4"></i>
                </button>
            </div>
        </div>
    `,f({icons:h}),document.getElementById("remove-file")?.addEventListener("click",y)}function y(){o.pdfDoc=null,o.file=null,o.detectedBlankPages=[],o.pageThumbnails.forEach(n=>URL.revokeObjectURL(n)),o.pageThumbnails.clear();const t=document.getElementById("file-display-area");t&&(t.innerHTML=""),document.getElementById("options-panel")?.classList.add("hidden"),document.getElementById("preview-panel")?.classList.add("hidden");const e=document.getElementById("file-input");e&&(e.value="")}async function p(t){if(!t||t.type!=="application/pdf"){c("Error","Please upload a valid PDF file.");return}m("Loading PDF...");try{const e=await t.arrayBuffer();o.pdfDoc=await v.load(e),o.file=t,o.detectedBlankPages=[],P(),document.getElementById("options-panel")?.classList.remove("hidden"),document.getElementById("preview-panel")?.classList.add("hidden")}catch(e){console.error(e),c("Error","Failed to load PDF file.")}finally{u()}}async function I(t,e=250){const n=t.getViewport({scale:.5}),a=document.createElement("canvas"),i=a.getContext("2d");if(!i)return!1;a.width=n.width,a.height=n.height,await t.render({canvasContext:i,viewport:n}).promise;const s=i.getImageData(0,0,a.width,a.height).data;let d=0;for(let g=0;g<s.length;g+=4){const w=s[g],b=s[g+1],E=s[g+2];d+=(w+b+E)/3}return d/(s.length/4)>e}async function x(t){const e=t.getViewport({scale:.3}),n=document.createElement("canvas"),a=n.getContext("2d");return a?(n.width=e.width,n.height=e.height,await t.render({canvasContext:a,viewport:e}).promise,n.toDataURL("image/jpeg",.7)):""}async function D(){if(!o.pdfDoc||!o.file)return c("Error","Please upload a PDF first.");const t=document.getElementById("sensitivity-slider"),e=parseInt(t?.value||"80"),n=Math.round(255-e*2.55);m("Detecting blank pages...");try{const a=await o.file.arrayBuffer(),i=await L({data:a}).promise,r=i.numPages;o.detectedBlankPages=[],o.pageThumbnails.forEach(s=>URL.revokeObjectURL(s)),o.pageThumbnails.clear();for(let s=1;s<=r;s++){const d=await i.getPage(s);if(await I(d,n)){o.detectedBlankPages.push(s-1);const l=await x(d);o.pageThumbnails.set(s-1,l)}}if(o.detectedBlankPages.length===0){c("Info","No blank pages detected in this PDF."),u();return}C(),document.getElementById("preview-panel")?.classList.remove("hidden"),u()}catch(a){console.error(a),c("Error","Could not detect blank pages."),u()}}function C(){const t=document.getElementById("preview-info"),e=document.getElementById("blank-pages-preview");!t||!e||(t.textContent=`Found ${o.detectedBlankPages.length} blank page(s). Click on a page to deselect it.`,e.innerHTML="",o.detectedBlankPages.forEach(n=>{const a=o.pageThumbnails.get(n)||"",i=document.createElement("div");i.className="relative cursor-pointer group",i.dataset.pageIndex=String(n),i.dataset.selected="true",i.innerHTML=`
            <div class="relative border-2 border-red-500 rounded-lg overflow-hidden transition-all">
                <img src="${a}" alt="Page ${n+1}" class="w-full h-auto">
                <div class="absolute bottom-0 left-0 right-0 bg-black/70 text-white text-xs text-center py-1">
                    Page ${n+1}
                </div>
                <div class="absolute top-1 right-1 bg-red-500 rounded-full w-5 h-5 flex items-center justify-center check-mark">
                    <i data-lucide="check" class="w-3 h-3 text-white"></i>
                </div>
            </div>
        `,i.addEventListener("click",()=>F(i)),e.appendChild(i)}),f({icons:h}))}function F(t,e){const n=t.dataset.selected==="true",a=t.querySelector(".border-2"),i=t.querySelector(".check-mark");n?(t.dataset.selected="false",a?.classList.remove("border-red-500"),a?.classList.add("border-gray-500","opacity-50"),i?.classList.add("hidden")):(t.dataset.selected="true",a?.classList.add("border-red-500"),a?.classList.remove("border-gray-500","opacity-50"),i?.classList.remove("hidden"))}async function R(){if(!o.pdfDoc||!o.file)return c("Error","Please upload a PDF first.");const t=document.getElementById("blank-pages-preview"),e=[];if(t?.querySelectorAll('[data-selected="true"]').forEach(n=>{const a=parseInt(n.dataset.pageIndex||"-1");a>=0&&e.push(a)}),e.length===0){c("Info","No pages selected for removal.");return}m(`Removing ${e.length} blank page(s)...`);try{const n=await v.create(),a=o.pdfDoc.getPages();for(let r=0;r<a.length;r++)if(!e.includes(r)){const[s]=await n.copyPages(o.pdfDoc,[r]);n.addPage(s)}const i=await n.save();k(new Blob([new Uint8Array(i)],{type:"application/pdf"}),"blank-pages-removed.pdf"),c("Success",`Removed ${e.length} blank page(s) successfully!`,"success",y)}catch(n){console.error(n),c("Error","Could not remove blank pages.")}finally{u()}}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("file-input"),e=document.getElementById("drop-zone"),n=document.getElementById("detect-btn"),a=document.getElementById("process-btn"),i=document.getElementById("sensitivity-slider"),r=document.getElementById("sensitivity-value");i?.addEventListener("input",s=>{const d=s.target.value;r&&(r.textContent=d)}),t?.addEventListener("change",s=>{const d=s.target.files?.[0];d&&p(d)}),e?.addEventListener("dragover",s=>{s.preventDefault(),e.classList.add("border-indigo-500")}),e?.addEventListener("dragleave",()=>{e.classList.remove("border-indigo-500")}),e?.addEventListener("drop",s=>{s.preventDefault(),e.classList.remove("border-indigo-500");const d=s.dataTransfer?.files[0];d&&p(d)}),n?.addEventListener("click",D),a?.addEventListener("click",R),document.getElementById("back-to-tools")?.addEventListener("click",()=>{window.location.href="../../index.html"})});
