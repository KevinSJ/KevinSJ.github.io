import{_ as $}from"./InputCopyable.vue_vue_type_script_setup_true_lang-294ac243.js";import{_ as E}from"./DataTable-8c4f965e.js";import{d as A,a0 as U,r as b,i as q,o as y,j as B,w as m,k as t,l as e,m as N,a6 as L,G as h,a as R,ad as F,ah as M,aj as V,bq as z}from"./index-0c1fde36.js";import{_ as G}from"./Switch-a0f825a4.js";import{_ as H}from"./FormItem-1b9a5952.js";import{_ as J}from"./Space-7fc52151.js";import{_ as K}from"./Divider-5fc425b0.js";import{_ as Q}from"./p-77eb774b.js";import{_ as W}from"./Card-7ba5ce79.js";import"./Checkbox-ba7202eb.js";import"./Radio-424d9905.js";import"./RadioGroup-1850ca84.js";import"./get-slot-1efb97e5.js";import"./ArrowDown-6fbf6d78.js";import"./VirtualList-8140ffff.js";import"./Empty-ca426d71.js";import"./prop-f417a2fb.js";import"./Select-9917c364.js";import"./Tag-e75b8dae.js";import"./FocusDetector-089b8822.js";import"./index-cbfaa337.js";import"./Forward-04db534f.js";import"./download-953ccaa2.js";import"./context-00991937.js";const X={href:"https://letsextract.com/fr/dnsbl-checker/",target:"_blank"},Y=A({__name:"dnsbl-checker",setup(Z){const{t:l}=U(),i=b(""),S=b(""),u=b(!1),r=b([]),_=b(!1),x=[{dnsbl:"zen.spamhaus.org",description:"Combines Spamhaus SBL, XBL, and PBL for spam and exploits"},{dnsbl:"bl.spamcop.net",description:"SpamCopâ€™s dynamic spam reporting list"},{dnsbl:"b.barracudacentral.org",description:"Barracudaâ€™s reputation-based spam blacklist"},{dnsbl:"dnsbl.sorbs.net",description:"SORBS aggregate list for spam and relays"},{dnsbl:"psbl.surriel.com",description:"Passive spam block list based on reports"},{dnsbl:"dnsbl.dronebl.org",description:"Botnet and malware source blacklist"},{dnsbl:"ubl.unsubscore.com",description:"User-based spam and unsubscribe abuse list"},{dnsbl:"cbl.abuseat.org",description:"Open proxies and spam bots (used by Spamhaus)"},{dnsbl:"dnsbl-1.uceprotect.net",description:"UCEPROTECT Level 1: direct spam sources"},{dnsbl:"dnsbl-2.uceprotect.net",description:"UCEPROTECT Level 2: spammy networks"},{dnsbl:"dnsbl-3.uceprotect.net",description:"UCEPROTECT Level 3: entire ISP blocks"},{dnsbl:"rbl.spamlab.com",description:"Spamlabâ€™s real-time spam blacklist"},{dnsbl:"dnsbl.inps.de",description:"German-based spam DNSBL"},{dnsbl:"ix.dnsbl.manitu.net",description:"Manituâ€™s spam and abuse blacklist"},{dnsbl:"hostkarma.junkemailfilter.com",description:"Multi-level DNSBL with whitelist and blacklist entries"},{dnsbl:"rbl.realtimeblacklist.com",description:"Real-time blacklist for spam and abuse"},{dnsbl:"spamrbl.imp.ch",description:"Swiss-based spam DNSBL"},{dnsbl:"dnsbl.justspam.org",description:"JustSpamâ€™s spam and phishing list"},{dnsbl:"db.wpbl.info",description:"Weighted Private Blacklist for spam sources"},{dnsbl:"dnsbl.kempt.net",description:"Kemptâ€™s spam DNSBL"},{dnsbl:"rbl.efnetrbl.org",description:"EFNetâ€™s IRC abuse and spam blacklist"},{dnsbl:"tor.dnsbl.sectoor.de",description:"TOR exit node blacklist"},{dnsbl:"short.rbl.jp",description:"Japanese short URL spam blacklist"},{dnsbl:"rbl.megarbl.net",description:"MegaRBL for spam and malware sources"},{dnsbl:"rbl.spamrats.com",description:"RATS spam and dynamic IP blacklists"},{dnsbl:"rbl.blocklist.de",description:"Blocklist.deâ€™s abuse-based blacklist"},{dnsbl:"dnsbl.cyberlogic.net",description:"Cyberlogicâ€™s spam DNSBL"},{dnsbl:"spam.dnsbl.sorbs.net",description:"SORBS spam-specific list"},{dnsbl:"smtp.dnsbl.sorbs.net",description:"SORBS SMTP open relay list"},{dnsbl:"web.dnsbl.sorbs.net",description:"SORBS web server spam list"},{dnsbl:"zombie.dnsbl.sorbs.net",description:"SORBS zombie host list"},{dnsbl:"http.dnsbl.sorbs.net",description:"SORBS HTTP spam list"},{dnsbl:"misc.dnsbl.sorbs.net",description:"SORBS miscellaneous spam sources"},{dnsbl:"dnsbl.spfbl.net",description:"SPFBLâ€™s spam and phishing blacklist"},{dnsbl:"dnsbl.suomispam.net",description:"Finnish spam DNSBL"},{dnsbl:"dnsbl.nordspam.com",description:"Nordspamâ€™s spam blacklist"},{dnsbl:"dnsbl.fabel.dk",description:"Fabelsources spam DNSBL"},{dnsbl:"dnsbl.abuse.ro",description:"Romanian abuse DNSBL"},{dnsbl:"dnsbl.antispam.or.id",description:"Indonesian anti-spam blacklist"}],C=[{title:"DNSBL",key:"dnsbl"},{title:"Description",key:"description"},{title:"Listed",key:"listed",render(s){return s.listed?"ðŸš« Listed":"âœ… Not Listed"}},{title:"Response",key:"response"}],w=q(()=>_.value?r.value.filter(s=>s.listed):r.value);function D(s){return s.split(".").reverse().join(".")}async function T(s){const o=`https://cloudflare-dns.com/dns-query?name=${s}`,d={Accept:"application/dns-json"};try{return(await(await fetch(o,{headers:d})).json()).Answer?.find(c=>c.type===1)?.data||null}catch{return null}}async function j(){if(!i.value)return;u.value=!0,r.value=[];let s=i.value.trim();if(!/^\d+\.\d+\.\d+\.\d+$/.test(s)){const n=await T(s);if(!n){r.value=[{dnsbl:"Error",description:"",listed:!1,response:"Invalid domain or no A record found"}],u.value=!1;return}s=n}S.value=s;const o=D(s),d={Accept:"application/dns-json"},f=x.map(async n=>{const c=`https://cloudflare-dns.com/dns-query?name=${`${o}.${n.dnsbl}`}`;try{const a=(await(await fetch(c,{headers:d})).json()).Answer;return a&&a[0]?.data==="127.255.255.254"&&(a[0].data="Rejected DNS Query by SpamHaus"),{dnsbl:n.dnsbl,description:n.description,listed:!!a,response:a?a.map(g=>g.data).join(", "):"No listing"}}catch(p){return{dnsbl:n.dnsbl,description:n.description,listed:!1,response:p.toString()}}});r.value=await Promise.all(f),u.value=!1}function O(s){return s.listed?"listed-row":"clean-row"}return(s,o)=>{const d=M,f=V,n=G,k=H,c=J,p=K,a=$,g=Q,I=E,P=W;return y(),B(P,{title:e(l)("tools.dnsbl-checker.texts.title-dnsbl-multi-checker")},{default:m(()=>[t(d,{value:e(i),"onUpdate:value":o[0]||(o[0]=v=>N(i)?i.value=v:null),placeholder:e(l)("tools.dnsbl-checker.texts.placeholder-enter-ip-or-domain"),clearable:"","mb-2":""},null,8,["value","placeholder"]),t(c,{justify:"center"},{default:m(()=>[t(f,{type:"primary",loading:e(u),onClick:j},{default:m(()=>[L(h(e(l)("tools.dnsbl-checker.texts.tag-check-all")),1)]),_:1},8,["loading"]),t(k,{label:e(l)("tools.dnsbl-checker.texts.label-show-listed-only"),"label-placement":"left"},{default:m(()=>[t(n,{value:e(_),"onUpdate:value":o[1]||(o[1]=v=>N(_)?_.value=v:null)},null,8,["value"])]),_:1},8,["label"])]),_:1}),t(p),t(a,{label:e(l)("tools.dnsbl-checker.texts.label-resolved-ip"),"label-position":"left",value:e(S),"mb-1":""},null,8,["label","value"]),t(g,null,{default:m(()=>[R("span",null,h(e(l)("tools.dnsbl-checker.texts.tag-want-to-understand-why-an-ip-might-be-blacklisted-check-out")),1),R("a",X,h(e(l)("tools.dnsbl-checker.texts.tag-this-dnsbl-explanation-and-removal-guide")),1),L(h(e(l)("tools.dnsbl-checker.texts.tag-")),1)]),_:1}),t(p),e(w).length?(y(),B(I,{key:0,columns:C,data:e(w),pagination:!1,bordered:!1,"row-class-name":O,style:{"margin-top":"12px"}},null,8,["data"])):F("",!0)]),_:1},8,["title"])}}});const Bs=z(Y,[["__scopeId","data-v-cfeeb302"]]);export{Bs as default};
