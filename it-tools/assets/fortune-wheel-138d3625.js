import{o as m,c as f,a as d,d as et,bY as ot,a0 as nt,ac as U,r as z,O as Y,i as st,k as p,w as C,l as e,m as Z,G as w,cb as lt,a6 as B,a7 as T,a8 as D,ch as at,bc as V,ak as it,x as ct,s as rt,bo as ut,bp as dt,cy as _t,bq as ht}from"./index-0c1fde36.js";import{_ as pt}from"./arrow-down-40c3acf5.js";import{_ as mt}from"./FormItem-1b9a5952.js";import{_ as ft}from"./Divider-5fc425b0.js";import"./context-00991937.js";const gt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},vt=d("path",{fill:"currentColor",d:"M13 20h-2V8l-5.5 5.5l-1.42-1.42L12 4.16l7.92 7.92l-1.42 1.42L13 8z"},null,-1),$t=[vt];function wt(O,$){return m(),f("svg",gt,$t)}const bt={name:"mdi-arrow-up",render:wt},xt=O=>(ut("data-v-2500ba39"),O=O(),dt(),O),yt={class:"fortune-wheel-container"},Mt={class:"wheel-controls"},St={class:"add-option-section"},Ct={class:"add-option-form"},kt={class:"options-section"},Rt={key:0,class:"empty-state"},zt={key:1,class:"options-list"},Ot={class:"option-content"},At={class:"option-text"},Et={class:"option-actions"},Nt={class:"wheel-section"},Wt={class:"wheel-container"},It=["width","height","viewBox"],Lt=["d","fill"],Vt=["x","y","fill","transform"],Pt={key:0,class:"center-result"},Bt={key:1,class:"center-placeholder"},Tt={class:"placeholder-text"},Dt=xt(()=>d("div",{class:"wheel-pointer"},null,-1)),Jt={class:"spin-controls"},Ft=et({__name:"fortune-wheel",setup(O){ot(i=>({"51b5196b":`${v.size}px`,f961f4c0:`${v.centerSize}px`,"0b782ced":`${v.mobileSize}px`}));const{t:$}=nt(),v={size:550,outerRadius:275,innerRadius:95,textRadius:185,centerSize:190,mobileSize:250},W=v.size/2,j=Math.random()*360;function I(i){const o=(i*137.508+j)%360,t=65+i%3*10,n=45+i%4*8,l=`hsl(${o}, ${t}%, ${n}%)`,u=q(o,t,n);return{bgColor:l,color:u}}function q(i,o,t){const n=i/360,l=o/100,u=t/100,c=(1-Math.abs(2*u-1))*l,_=c*(1-Math.abs(n*6%2-1)),M=u-c/2,g=Math.floor(n*6),a=[[c,_,0],[_,c,0],[0,c,_],[0,_,c],[_,0,c],[c,0,_]],[r,b,N]=a[g].map(x=>(x+M)*255);return(.299*r+.587*b+.114*N)/255<.6?"#ffffff":"#000000"}const k=U({name:"duration",storageName:"fortune-wheel:dur",defaultValue:3}),J=U({name:"options",storageName:"fortune-wheel:options",defaultValue:"[]"}),s=z([]),S=z(""),y=z(!1),P=z(0),R=z(null),G=z(null);Y(()=>{try{const i=JSON.parse(J.value);s.value=i.map((o,t)=>({id:`option-${t}`,text:o,...I(t)}))}catch{s.value=[]}}),Y(()=>{J.value=JSON.stringify(s.value.map(i=>i.text))});const A=st(()=>s.value.length>0?360/s.value.length:0);function F(){if(!S.value.trim())return;const i={id:`option-${Date.now()}`,text:S.value.trim(),...I(s.value.length)};s.value.push(i),S.value=""}function H(i){const o=s.value.findIndex(t=>t.id===i);o>-1&&(s.value.splice(o,1),s.value.forEach((t,n)=>{Object.assign(t,I(n))}))}function X(){s.value=[]}function K(i,o){if(o<0||o>=s.value.length)return;const t=s.value.splice(i,1)[0];s.value.splice(o,0,t),s.value.forEach((n,l)=>{Object.assign(n,I(l))})}function Q(){if(y.value||s.value.length===0)return;y.value=!0,R.value=null;const i=3,o=Math.max(3,Math.floor(k.value*i)),t=Math.floor(Math.random()*4),n=o+t;let l;if(s.value.length>1){const g=Array.from({length:s.value.length}).fill(1),a=JSON.parse(localStorage.getItem("fortune-wheel:recent-results")||"[]");a.forEach((h,x)=>{if(h>=0&&h<g.length){const L=x===0?.1:x===1?.3:.6;g[h]*=L}});const r=g.reduce((h,x)=>h+x,0);let b=Math.random()*r;l=0;for(let h=0;h<g.length;h++)if(b-=g[h],b<=0){l=h;break}const N=[l,...a.slice(0,2)];localStorage.setItem("fortune-wheel:recent-results",JSON.stringify(N))}else l=0;const _=360-(l*A.value+Math.random()*A.value),M=P.value+n*360+_;P.value=M,setTimeout(()=>{y.value=!1;const a=(360-M%360)%360,r=Math.floor(a/A.value)%s.value.length;R.value=s.value[r],G.value=r},k.value*1e3)}function tt(i){const o=A.value,t=v.outerRadius,n=v.innerRadius,l=W,u=W;if(s.value.length===1)return`M ${l-t} ${u} 
            A ${t} ${t} 0 1 1 ${l+t} ${u}
            A ${t} ${t} 0 1 1 ${l-t} ${u} Z
            M ${l-n} ${u}
            A ${n} ${n} 0 1 0 ${l+n} ${u}
            A ${n} ${n} 0 1 0 ${l-n} ${u} Z`;const c=(i*o-90)*Math.PI/180,_=((i+1)*o-90)*Math.PI/180,M=l+t*Math.cos(c),g=u+t*Math.sin(c),a=l+t*Math.cos(_),r=u+t*Math.sin(_),b=l+n*Math.cos(_),N=u+n*Math.sin(_),h=l+n*Math.cos(c),x=u+n*Math.sin(c),L=o>180?1:0;return`M ${h} ${x} L ${M} ${g} A ${t} ${t} 0 ${L} 1 ${a} ${r} L ${b} ${N} A ${n} ${n} 0 ${L} 0 ${h} ${x} Z`}function E(i){const o=A.value,t=v.textRadius,n=W,l=W,u=(i*o+o/2-90)*Math.PI/180,c=Math.round(n+t*Math.cos(u)),_=Math.round(l+t*Math.sin(u));return{x:c,y:_,rotation:i*o+o/2+90}}return(i,o)=>{const t=it,n=mt,l=ft,u=ct,c=rt,_=bt,M=pt,g=_t;return m(),f("div",yt,[d("div",Mt,[p(n,{label:e($)("tools.fortune-wheel.texts.label-spin-duration-seconds"),"label-placement":"left","my--5":""},{default:C(()=>[p(t,{value:e(k),"onUpdate:value":o[0]||(o[0]=a=>Z(k)?k.value=a:null),min:0,max:10},null,8,["value"])]),_:1},8,["label"]),p(l),d("div",St,[d("h3",null,w(e($)("tools.fortune-wheel.texts.tag-add-new-option")),1),d("div",Ct,[p(u,{value:e(S),"onUpdate:value":o[1]||(o[1]=a=>Z(S)?S.value=a:null),placeholder:e($)("tools.fortune-wheel.texts.placeholder-enter-wheel-option"),onKeyup:lt(F,["enter"])},null,8,["value","placeholder","onKeyup"]),p(c,{disabled:!e(S).trim(),onClick:F},{default:C(()=>[B(w(e($)("tools.fortune-wheel.texts.tag-add-option")),1)]),_:1},8,["disabled"]),p(c,{class:"clear-all-button",onClick:X},{default:C(()=>[B(w(e($)("tools.fortune-wheel.texts.tag-clear-all-options")),1)]),_:1})])]),d("div",kt,[d("h3",null,"Wheel Options ("+w(e(s).length)+")",1),e(s).length===0?(m(),f("div",Rt,w(e($)("tools.fortune-wheel.texts.tag-no-options-added-yet-add-some-options-to-start-spinning")),1)):(m(),f("div",zt,[(m(!0),f(T,null,D(e(s),(a,r)=>(m(),f("div",{key:a.id,class:"option-item",style:V({borderLeftColor:a.bgColor})},[d("div",Ot,[d("span",At,w(a.text),1),d("div",Et,[p(c,{size:"small",disabled:r===0,title:e($)("tools.fortune-wheel.texts.title-move-up"),onClick:b=>K(r,r-1)},{default:C(()=>[p(_)]),_:2},1032,["disabled","title","onClick"]),p(c,{size:"small",disabled:r===e(s).length-1,title:e($)("tools.fortune-wheel.texts.title-move-down"),onClick:b=>K(r,r+1)},{default:C(()=>[p(M)]),_:2},1032,["disabled","title","onClick"]),p(c,{size:"small",title:e($)("tools.fortune-wheel.texts.title-remove"),onClick:b=>H(a.id)},{default:C(()=>[p(g)]),_:2},1032,["title","onClick"])])])],4))),128))]))])]),p(l),d("div",Nt,[d("div",Wt,[(m(),f("svg",{class:at(["wheel",{spinning:e(y)}]),style:V({transform:`rotate(${e(P)}deg)`,transitionDuration:e(y)?`${e(k)}s`:"0s"}),width:v.size,height:v.size,viewBox:`0 0 ${v.size} ${v.size}`},[d("g",null,[(m(!0),f(T,null,D(e(s),(a,r)=>(m(),f("path",{key:a.id,d:tt(r),fill:a.bgColor,stroke:"rgba(255,255,255,0.3)","stroke-width":"2"},null,8,Lt))),128)),(m(!0),f(T,null,D(e(s),(a,r)=>(m(),f("text",{key:`text-${a.id}`,x:E(r).x,y:E(r).y,fill:a.color,transform:`rotate(${E(r).rotation}, ${E(r).x}, ${E(r).y})`,"text-anchor":"middle","dominant-baseline":"middle",class:"segment-text"},w(a.text.length>20?`${a.text.slice(0,20)}...`:a.text),9,Vt))),128))])],14,It)),d("div",{class:"wheel-center",style:V({backgroundColor:e(R)?.bgColor})},[e(R)?(m(),f("div",Pt,[d("div",{class:"result-text",style:V({color:e(R)?.color||"#ffffff"})},w(e(R).text),5)])):(m(),f("div",Bt,[d("div",Tt,w(e(y)?"Spinning...":"Spin to Win!"),1)]))],4),Dt]),d("div",Jt,[p(c,{disabled:e(y)||e(s).length===0,size:"large",onClick:Q},{default:C(()=>[B(w(e(y)?"Spinning...":"Spin the Wheel!"),1)]),_:1},8,["disabled"])])])])}}});const qt=ht(Ft,[["__scopeId","data-v-2500ba39"]]);export{qt as default};
