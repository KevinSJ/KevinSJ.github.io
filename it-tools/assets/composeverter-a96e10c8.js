import{Q as te,b as re}from"./index-0c1fde36.js";import{r as Q}from"./index-2709bfd9.js";import{r as ee,a as ie,b as se,c as oe,d as ne,e as pe}from"./ajv-53acda87.js";var H={exports:{}},K={exports:{}},X;function ae(){return X||(X=1,function(W,V){Object.defineProperty(V,"__esModule",{value:!0});const s=ee(),j=ie(),F=se(),z=oe(),k=ne(),$=pe(),v="errorMessage",x=new s.Name("emUsed"),T={required:"missingProperty",dependencies:"property",dependentRequired:"property"},I=/\$\{[^}]+\}/,Y=/\$\{([^}]+)\}/g,D=/^""\s*\+\s*|\s*\+\s*""$/g;function J(h){return{keyword:v,schemaType:["string","object"],post:!0,code(w){const{gen:l,data:N,schema:b,schemaValue:M,it:O}=w;if(O.createErrors===!1)return;const S=b,A=j.strConcat($.default.instancePath,O.errorPath);l.if(s._`${$.default.errors} > 0`,()=>{if(typeof S=="object"){const[a,m]=Z(S);m&&R(m),a&&B(a),L(U(S))}const r=typeof S=="string"?S:S._;r&&t(r),h.keepErrors||p()});function U({properties:r,items:a}){const m={};if(r){m.props={};for(const f in r)m.props[f]=[]}if(a){m.items={};for(let f=0;f<a.length;f++)m.items[f]=[]}return m}function Z(r){let a,m;for(const f in r){if(f==="properties"||f==="items")continue;const y=r[f];if(typeof y=="object"){a||(a={});const _=a[f]={};for(const u in y)_[u]=[]}else m||(m={}),m[f]=[]}return[a,m]}function R(r){const a=l.const("emErrors",s.stringify(r)),m=l.const("templates",i(r,b));l.forOf("err",$.default.vErrors,u=>l.if(e(u,a),()=>l.code(s._`${a}[${u}.keyword].push(${u})`).assign(s._`${u}.${x}`,!0)));const{singleError:f}=h;if(f){const u=l.let("message",s._`""`),g=l.let("paramsErrors",s._`[]`);y(E=>{l.if(u,()=>l.code(s._`${u} += ${typeof f=="string"?f:";"}`)),l.code(s._`${u} += ${_(E)}`),l.assign(g,s._`${g}.concat(${a}[${E}])`)}),k.reportError(w,{message:u,params:s._`{errors: ${g}}`})}else y(u=>k.reportError(w,{message:_(u),params:s._`{errors: ${a}[${u}]}`}));function y(u){l.forIn("key",a,g=>l.if(s._`${a}[${g}].length`,()=>u(g)))}function _(u){return s._`${u} in ${m} ? ${m}[${u}]() : ${M}[${u}]`}}function B(r){const a=l.const("emErrors",s.stringify(r)),m=[];for(const g in r)m.push([g,i(r[g],b[g])]);const f=l.const("templates",l.object(...m)),y=l.scopeValue("obj",{ref:T,code:s.stringify(T)}),_=l.let("emPropParams"),u=l.let("emParamsErrors");l.forOf("err",$.default.vErrors,g=>l.if(e(g,a),()=>{l.assign(_,s._`${y}[${g}.keyword]`),l.assign(u,s._`${a}[${g}.keyword][${g}.params[${_}]]`),l.if(u,()=>l.code(s._`${u}.push(${g})`).assign(s._`${g}.${x}`,!0))})),l.forIn("key",a,g=>l.forIn("keyProp",s._`${a}[${g}]`,E=>{l.assign(u,s._`${a}[${g}][${E}]`),l.if(s._`${u}.length`,()=>{const q=l.const("tmpl",s._`${f}[${g}] && ${f}[${g}][${E}]`);k.reportError(w,{message:s._`${q} ? ${q}() : ${M}[${g}][${E}]`,params:s._`{errors: ${u}}`})})}))}function L(r){const{props:a,items:m}=r;if(!a&&!m)return;const f=s._`typeof ${N} == "object"`,y=s._`Array.isArray(${N})`,_=l.let("emErrors");let u,g;const E=l.let("templates");a&&m?(u=l.let("emChildKwd"),l.if(f),l.if(y,()=>{q(m,b.items),l.assign(u,s.str`items`)},()=>{q(a,b.properties),l.assign(u,s.str`properties`)}),g=s._`[${u}]`):m?(l.if(y),q(m,b.items),g=s._`.items`):a&&(l.if(j.and(f,j.not(y))),q(a,b.properties),g=s._`.properties`),l.forOf("err",$.default.vErrors,P=>n(P,_,G=>l.code(s._`${_}[${G}].push(${P})`).assign(s._`${P}.${x}`,!0))),l.forIn("key",_,P=>l.if(s._`${_}[${P}].length`,()=>{k.reportError(w,{message:s._`${P} in ${E} ? ${E}[${P}]() : ${M}${g}[${P}]`,params:s._`{errors: ${_}[${P}]}`}),l.assign(s._`${$.default.vErrors}[${$.default.errors}-1].instancePath`,s._`${A} + "/" + ${P}.replace(/~/g, "~0").replace(/\\//g, "~1")`)})),l.endIf();function q(P,G){l.assign(_,s.stringify(P)),l.assign(E,i(P,G))}}function t(r){const a=l.const("emErrs",s._`[]`);l.forOf("err",$.default.vErrors,m=>l.if(c(m),()=>l.code(s._`${a}.push(${m})`).assign(s._`${m}.${x}`,!0))),l.if(s._`${a}.length`,()=>k.reportError(w,{message:o(r),params:s._`{errors: ${a}}`}))}function p(){const r=l.const("emErrs",s._`[]`);l.forOf("err",$.default.vErrors,a=>l.if(s._`!${a}.${x}`,()=>l.code(s._`${r}.push(${a})`))),l.assign($.default.vErrors,r).assign($.default.errors,s._`${r}.length`)}function e(r,a){return j.and(s._`${r}.keyword !== ${v}`,s._`!${r}.${x}`,s._`${r}.instancePath === ${A}`,s._`${r}.keyword in ${a}`,s._`${r}.schemaPath.indexOf(${O.errSchemaPath}) === 0`,s._`/^\\/[^\\/]*$/.test(${r}.schemaPath.slice(${O.errSchemaPath.length}))`)}function n(r,a,m){l.if(j.and(s._`${r}.keyword !== ${v}`,s._`!${r}.${x}`,s._`${r}.instancePath.indexOf(${A}) === 0`),()=>{const f=l.scopeValue("pattern",{ref:/^\/([^/]*)(?:\/|$)/,code:s._`new RegExp("^\\\/([^/]*)(?:\\\/|$)")`}),y=l.const("emMatches",s._`${f}.exec(${r}.instancePath.slice(${A}.length))`),_=l.const("emChild",s._`${y} && ${y}[1].replace(/~1/g, "/").replace(/~0/g, "~")`);l.if(s._`${_} !== undefined && ${_} in ${a}`,()=>m(_))})}function c(r){return j.and(s._`${r}.keyword !== ${v}`,s._`!${r}.${x}`,j.or(s._`${r}.instancePath === ${A}`,j.and(s._`${r}.instancePath.indexOf(${A}) === 0`,s._`${r}.instancePath[${A}.length] === "/"`)),s._`${r}.schemaPath.indexOf(${O.errSchemaPath}) === 0`,s._`${r}.schemaPath[${O.errSchemaPath}.length] === "/"`)}function i(r,a){const m=[];for(const f in r){const y=a[f];I.test(y)&&m.push([f,d(y)])}return l.object(...m)}function o(r){return I.test(r)?new F._Code(F.safeStringify(r).replace(Y,(a,m)=>`" + JSON.stringify(${z.getData(m,O)}) + "`).replace(D,"")):s.stringify(r)}function d(r){return s._`function(){return ${o(r)}}`}},metaSchema:{anyOf:[{type:"string"},{type:"object",properties:{properties:{$ref:"#/$defs/stringMap"},items:{$ref:"#/$defs/stringList"},required:{$ref:"#/$defs/stringOrMap"},dependencies:{$ref:"#/$defs/stringOrMap"}},additionalProperties:{type:"string"}}],$defs:{stringMap:{type:"object",additionalProperties:{type:"string"}},stringOrMap:{anyOf:[{type:"string"},{$ref:"#/$defs/stringMap"}]},stringList:{type:"array",items:{type:"string"}}}}}}const C=(h,w={})=>{if(!h.opts.allErrors)throw new Error("ajv-errors: Ajv option allErrors must be true");if(h.opts.jsPropertySyntax)throw new Error("ajv-errors: ajv option jsPropertySyntax is not supported");return h.addKeyword(J(w))};V.default=C,W.exports=C,W.exports.default=C}(K,K.exports)),K.exports}(function(W,V){((s,j)=>{j(V)})(te,function(s){function j(t,p,e){(p=(n=>typeof(n=((c,i)=>{if(typeof c!="object"||!c)return c;var o=c[Symbol.toPrimitive];if(o===void 0)return(i==="string"?String:Number)(c);if(typeof(o=o.call(c,i))!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")})(n,"string"))=="symbol"?n:n+"")(p))in t?Object.defineProperty(t,p,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[p]=e}function F(t,p){var e,n=Object.keys(t);return Object.getOwnPropertySymbols&&(e=Object.getOwnPropertySymbols(t),p&&(e=e.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,e)),n}function z(t,p){return(z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e})(t,p)}function k(){k=function(o,d){return new e(o,void 0,d)};var t=RegExp.prototype,p=new WeakMap;function e(o,d,r){return d=RegExp(o,d),p.set(d,r||p.get(o)),z(d,e.prototype)}function n(o,d){var r=p.get(d);return Object.keys(r).reduce(function(a,m){var f=r[m];if(typeof f=="number")a[m]=o[f];else{for(var y=0;o[f[y]]===void 0&&y+1<f.length;)y++;a[m]=o[f[y]]}return a},Object.create(null))}var c=e,i=RegExp;if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");return c.prototype=Object.create(i&&i.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),Object.defineProperty(c,"prototype",{writable:!1}),i&&z(c,i),e.prototype.exec=function(r){var d,r=t.exec.call(this,r);return r&&(r.groups=n(r,this),d=r.indices)&&(d.groups=n(d,this)),r},e.prototype[Symbol.replace]=function(o,d){var r,a;return typeof d=="string"?(r=p.get(this),t[Symbol.replace].call(this,o,d.replace(/\$<([^>]+)(>|$)/g,function(m,f,y){return y===""?m:(y=r[f],Array.isArray(y)?"$"+y.join("$"):typeof y=="number"?"$"+y:"")}))):typeof d=="function"?(a=this,t[Symbol.replace].call(this,o,function(){var m=arguments;return typeof m[m.length-1]!="object"&&(m=[].slice.call(m)).push(n(m,a)),d.apply(this,m)})):t[Symbol.replace].call(this,o,d)},k.apply(this,arguments)}let $=(t,p,e)=>{let n=t;var c=p.split("/"),i=c.length;for(let d=0;d<i-1;d+=1){var o=c[d];n[o]||(n[o]={}),n=n[o]}n[c[i-1]]=e};function v(t,p){Object.keys(t[p]||[]).forEach(e=>{e=t[p][e],e&&e.external&&e.external.name&&(e.name=e.external.name,e.external=!0)})}let x=k(/^(([A-Za-z]:\/|[A-Za-z]:\\)?.*?):(([A-Za-z]:\/|[A-Za-z]:[\\])?.*?)(?::((rw|ro|z|Z)(,(rw|ro|z|Z))*))?$/,{volume:1,container_path:3,flags:5}),T=t=>(t=t.match(x),t===null?"":t.groups.volume),I=t=>t&&!t.includes("/")&&!t.includes("\\")&&!t.includes("~")&&!t.includes(".")&&!t.includes("$"),Y=t=>{var p=t.match(x);return p===null||(t={type:I(p.groups.volume)?"volume":"bind",source:p.groups.volume,target:p.groups.container_path},(p=(p.groups.flags||"").replace(/\s+/,"").split(",")).includes("ro")&&(t.volume={nocopy:!0}),p.includes("z")?t.bind={selinux:"z"}:p.includes("Z")&&(t.bind={selinux:"Z"})),t},D=Q;class J extends Error{constructor(p,e,n){super(p),this.lines=e,this.details=n,this.name="YamlSyntaxError"}}let C=t=>{t=D.parseDocument(t,{prettyErrors:!0});let p=[],e=[];if(t.errors.forEach((n,c)=>{var i=n.message.split(`:
`)[0];e.push({line:n.linePos[0].line,message:i,pos:n.linePos}),Array.from({length:n.linePos?n.linePos[1].line-n.linePos[0].line:1},(o,d)=>n.linePos[0].line+d).forEach(o=>p.push(o))}),0<e.length)throw new J(e.map(n=>n.message).join(`
`),p,e)},h=t=>(C(t),D.parse(t,{intAsBigInt:!0})),w=k(/^((\[?([a-fA-F\d.:]+)\]?:)?([\d]*(-[\d]+)?):)?([\d]+(-[\d]+)?)(\/((udp|tcp|sctp)))?$/,{ip_part:2,ip:3,host:4,container:6,proto_part:8,proto:9}),l=t=>{let p=t.match(w);if(p===null)return[t];if(t=p.groups.container,t&&t.includes("-")){var e=t.split("-");let c=parseInt(e[0],10);var e=parseInt(e[1],10),n=p.groups.host,n=(n||t).split("-");let i=parseInt(n[0],10),o=[];return Array.from({length:e-c+1},(d,r)=>r).forEach(d=>{o=[...o,...l(`${p.groups.ip_part||""}${i+d}:`+(c+d)+(p.groups.proto_part||""))]}),o}return n={target:parseInt(t,10)},p.groups.ip&&(n.host_ip=p.groups.ip),p.groups.host&&(n.published=p.groups.host),p.groups.proto&&(n.protocol=p.groups.proto),n.mode="ingress",[n]},N=Q,b=(t,p)=>(M(t,p),N.stringify(t,{indent:(p||{}).indent||4,simpleKeys:!0,nullStr:""}).trim()),M=(t,p)=>(p&&p.expandVolumes&&Object.values(t.services).forEach(e=>{if(e.volumes)for(let n=0;n<e.volumes.length;n+=1)typeof e.volumes[n]=="string"&&(e.volumes[n]=Y(e.volumes[n]))}),p&&p.expandPorts&&Object.values(t.services).forEach(e=>{if(e.ports){let n=[];for(let c=0;c<e.ports.length;c+=1)n=typeof e.ports[c]=="string"?[...n,...l(e.ports[c])]:[...n,e.ports[c]];e.ports=n}}),t),O={$id:"compose_spec.json",type:"object",title:"Compose Specification",description:"The Compose file is a YAML file defining a multi-containers based application.",properties:{version:{type:"string",description:"declared for backward compatibility, ignored."},name:{type:"string",pattern:"^[a-z0-9][a-z0-9_-]*$",description:"define the Compose project name, until user defines one explicitly."},include:{type:"array",items:{type:"object",$ref:"#/definitions/include"},description:"compose sub-projects to be included."},services:{$id:"#/properties/services",type:"object",patternProperties:{"^[a-zA-Z0-9._-]+$":{$ref:"#/definitions/service"}},additionalProperties:!1},networks:{$id:"#/properties/networks",type:"object",patternProperties:{"^[a-zA-Z0-9._-]+$":{$ref:"#/definitions/network"}}},volumes:{$id:"#/properties/volumes",type:"object",patternProperties:{"^[a-zA-Z0-9._-]+$":{$ref:"#/definitions/volume"}},additionalProperties:!1},secrets:{$id:"#/properties/secrets",type:"object",patternProperties:{"^[a-zA-Z0-9._-]+$":{$ref:"#/definitions/secret"}},additionalProperties:!1},configs:{$id:"#/properties/configs",type:"object",patternProperties:{"^[a-zA-Z0-9._-]+$":{$ref:"#/definitions/config"}},additionalProperties:!1}},patternProperties:{"^x-":{}},additionalProperties:!1,definitions:{service:{$id:"#/definitions/service",type:"object",properties:{develop:{$ref:"#/definitions/development"},deploy:{$ref:"#/definitions/deployment"},annotations:{$ref:"#/definitions/list_or_dict"},attach:{type:"boolean"},build:{oneOf:[{type:"string"},{type:"object",properties:{context:{type:"string"},dockerfile:{type:"string"},dockerfile_inline:{type:"string"},args:{$ref:"#/definitions/list_or_dict"},ssh:{$ref:"#/definitions/list_or_dict"},labels:{$ref:"#/definitions/list_or_dict"},cache_from:{type:"array",items:{type:"string"}},cache_to:{type:"array",items:{type:"string"}},no_cache:{type:"boolean"},additional_contexts:{$ref:"#/definitions/list_or_dict"},network:{type:"string"},pull:{type:"boolean"},target:{type:"string"},shm_size:{type:["integer","string"]},extra_hosts:{$ref:"#/definitions/list_or_dict"},isolation:{type:"string"},privileged:{type:"boolean"},secrets:{$ref:"#/definitions/service_config_or_secret"},tags:{type:"array",items:{type:"string"}},ulimits:{$ref:"#/definitions/ulimits"},platforms:{type:"array",items:{type:"string"}}},additionalProperties:!1,patternProperties:{"^x-":{}}}]},blkio_config:{type:"object",properties:{device_read_bps:{type:"array",items:{$ref:"#/definitions/blkio_limit"}},device_read_iops:{type:"array",items:{$ref:"#/definitions/blkio_limit"}},device_write_bps:{type:"array",items:{$ref:"#/definitions/blkio_limit"}},device_write_iops:{type:"array",items:{$ref:"#/definitions/blkio_limit"}},weight:{type:"integer"},weight_device:{type:"array",items:{$ref:"#/definitions/blkio_weight"}}},additionalProperties:!1},cap_add:{type:"array",items:{type:"string"},uniqueItems:!0},cap_drop:{type:"array",items:{type:"string"},uniqueItems:!0},cgroup:{type:"string",enum:["host","private"]},cgroup_parent:{type:"string"},command:{$ref:"#/definitions/command"},configs:{$ref:"#/definitions/service_config_or_secret"},container_name:{type:"string"},cpu_count:{type:"integer",minimum:0},cpu_percent:{type:"integer",minimum:0,maximum:100},cpu_shares:{type:["number","string"]},cpu_quota:{type:["number","string"]},cpu_period:{type:["number","string"]},cpu_rt_period:{type:["number","string"]},cpu_rt_runtime:{type:["number","string"]},cpus:{type:["number","string"]},cpuset:{type:"string"},credential_spec:{type:"object",properties:{config:{type:"string"},file:{type:"string"},registry:{type:"string"}},additionalProperties:!1,patternProperties:{"^x-":{}}},depends_on:{oneOf:[{$ref:"#/definitions/list_of_strings"},{type:"object",additionalProperties:!1,patternProperties:{"^[a-zA-Z0-9._-]+$":{type:"object",additionalProperties:!1,properties:{restart:{type:"boolean"},required:{type:"boolean",default:!0},condition:{type:"string",enum:["service_started","service_healthy","service_completed_successfully"]}},required:["condition"]}}}]},device_cgroup_rules:{$ref:"#/definitions/list_of_strings"},devices:{type:"array",items:{type:"string"},uniqueItems:!0},dns:{$ref:"#/definitions/string_or_list"},dns_opt:{type:"array",items:{type:"string"},uniqueItems:!0},dns_search:{$ref:"#/definitions/string_or_list"},domainname:{type:"string"},entrypoint:{$ref:"#/definitions/command"},env_file:{$ref:"#/definitions/string_or_list"},environment:{$ref:"#/definitions/list_or_dict"},expose:{type:"array",items:{type:["string","number"],format:"expose"},uniqueItems:!0},extends:{oneOf:[{type:"string"},{type:"object",properties:{service:{type:"string"},file:{type:"string"}},required:["service"],additionalProperties:!1}]},external_links:{type:"array",items:{type:"string"},uniqueItems:!0},extra_hosts:{$ref:"#/definitions/list_or_dict"},group_add:{type:"array",items:{type:["string","number"]},uniqueItems:!0},healthcheck:{$ref:"#/definitions/healthcheck"},hostname:{type:"string"},image:{type:"string"},init:{type:"boolean"},ipc:{type:"string"},isolation:{type:"string"},labels:{$ref:"#/definitions/list_or_dict"},links:{type:"array",items:{type:"string"},uniqueItems:!0},logging:{type:"object",properties:{driver:{type:"string"},options:{type:"object",patternProperties:{"^.+$":{type:["string","number","null"]}}}},additionalProperties:!1,patternProperties:{"^x-":{}}},mac_address:{type:"string"},mem_limit:{type:["number","string"]},mem_reservation:{type:["string","integer"]},mem_swappiness:{type:"integer"},memswap_limit:{type:["number","string"]},network_mode:{type:"string"},networks:{oneOf:[{$ref:"#/definitions/list_of_strings"},{type:"object",patternProperties:{"^[a-zA-Z0-9._-]+$":{oneOf:[{type:"object",properties:{aliases:{$ref:"#/definitions/list_of_strings"},ipv4_address:{type:"string"},ipv6_address:{type:"string"},link_local_ips:{$ref:"#/definitions/list_of_strings"},mac_address:{type:"string"},priority:{type:"number"}},additionalProperties:!1,patternProperties:{"^x-":{}}},{type:"null"}]}},additionalProperties:!1}]},oom_kill_disable:{type:"boolean"},oom_score_adj:{type:"integer",minimum:-1e3,maximum:1e3},pid:{type:["string","null"]},pids_limit:{type:["number","string"]},platform:{type:"string"},ports:{type:"array",items:{oneOf:[{type:"number",format:"ports"},{type:"string",format:"ports"},{type:"object",properties:{mode:{type:"string"},host_ip:{type:"string"},target:{type:"integer"},published:{type:["string","integer"]},protocol:{type:"string"}},additionalProperties:!1,patternProperties:{"^x-":{}}}]},uniqueItems:!0},privileged:{type:"boolean"},profiles:{$ref:"#/definitions/list_of_strings"},pull_policy:{type:"string",enum:["always","never","if_not_present","build","missing"]},read_only:{type:"boolean"},restart:{type:"string"},runtime:{type:"string"},scale:{type:"integer"},security_opt:{type:"array",items:{type:"string"},uniqueItems:!0},shm_size:{type:["number","string"]},secrets:{$ref:"#/definitions/service_config_or_secret"},sysctls:{$ref:"#/definitions/list_or_dict"},stdin_open:{type:"boolean"},stop_grace_period:{type:"string",format:"duration"},stop_signal:{type:"string"},storage_opt:{type:"object"},tmpfs:{$ref:"#/definitions/string_or_list"},tty:{type:"boolean"},ulimits:{$ref:"#/definitions/ulimits"},user:{type:"string"},uts:{type:"string"},userns_mode:{type:"string"},volumes:{type:"array",items:{oneOf:[{type:"string",format:"volumes"},{type:"object",required:["type"],properties:{type:{type:"string"},source:{type:"string"},target:{type:"string"},read_only:{type:"boolean"},consistency:{type:"string"},bind:{type:"object",properties:{propagation:{type:"string"},create_host_path:{type:"boolean"},selinux:{type:"string",enum:["z","Z"]}},additionalProperties:!1,patternProperties:{"^x-":{}}},volume:{type:"object",properties:{nocopy:{type:"boolean"}},additionalProperties:!1,patternProperties:{"^x-":{}}},tmpfs:{type:"object",properties:{size:{oneOf:[{type:"integer",minimum:0},{type:"string"}]},mode:{type:"number"}},additionalProperties:!1,patternProperties:{"^x-":{}}}},additionalProperties:!1,patternProperties:{"^x-":{}}}]},uniqueItems:!0},volumes_from:{type:"array",items:{type:"string"},uniqueItems:!0},working_dir:{type:"string"}},patternProperties:{"^x-":{}},additionalProperties:!1},healthcheck:{$id:"#/definitions/healthcheck",type:"object",properties:{disable:{type:"boolean"},interval:{type:"string",format:"duration"},retries:{type:"number"},test:{oneOf:[{type:"string"},{type:"array",items:{type:"string"}}]},timeout:{type:"string",format:"duration"},start_period:{type:"string",format:"duration"},start_interval:{type:"string",format:"duration"}},additionalProperties:!1,patternProperties:{"^x-":{}}},development:{$id:"#/definitions/development",type:["object","null"],properties:{watch:{type:"array",items:{type:"object",properties:{ignore:{type:"array",items:{type:"string"}},path:{type:"string"},action:{type:"string",enum:["rebuild","sync","sync+restart"]},target:{type:"string"}}},required:["path","action"],additionalProperties:!1,patternProperties:{"^x-":{}}}}},deployment:{$id:"#/definitions/deployment",type:["object","null"],properties:{mode:{type:"string"},endpoint_mode:{type:"string"},replicas:{type:"integer"},labels:{$ref:"#/definitions/list_or_dict"},rollback_config:{type:"object",properties:{parallelism:{type:"integer"},delay:{type:"string",format:"duration"},failure_action:{type:"string"},monitor:{type:"string",format:"duration"},max_failure_ratio:{type:"number"},order:{type:"string",enum:["start-first","stop-first"]}},additionalProperties:!1,patternProperties:{"^x-":{}}},update_config:{type:"object",properties:{parallelism:{type:"integer"},delay:{type:"string",format:"duration"},failure_action:{type:"string"},monitor:{type:"string",format:"duration"},max_failure_ratio:{type:"number"},order:{type:"string",enum:["start-first","stop-first"]}},additionalProperties:!1,patternProperties:{"^x-":{}}},resources:{type:"object",properties:{limits:{type:"object",properties:{cpus:{type:["number","string"]},memory:{type:"string"},pids:{type:"integer"}},additionalProperties:!1,patternProperties:{"^x-":{}}},reservations:{type:"object",properties:{cpus:{type:["number","string"]},memory:{type:"string"},generic_resources:{$ref:"#/definitions/generic_resources"},devices:{$ref:"#/definitions/devices"}},additionalProperties:!1,patternProperties:{"^x-":{}}}},additionalProperties:!1,patternProperties:{"^x-":{}}},restart_policy:{type:"object",properties:{condition:{type:"string"},delay:{type:"string",format:"duration"},max_attempts:{type:"integer"},window:{type:"string",format:"duration"}},additionalProperties:!1,patternProperties:{"^x-":{}}},placement:{type:"object",properties:{constraints:{type:"array",items:{type:"string"}},preferences:{type:"array",items:{type:"object",properties:{spread:{type:"string"}},additionalProperties:!1,patternProperties:{"^x-":{}}}},max_replicas_per_node:{type:"integer"}},additionalProperties:!1,patternProperties:{"^x-":{}}}},additionalProperties:!1,patternProperties:{"^x-":{}}},generic_resources:{$id:"#/definitions/generic_resources",type:"array",items:{type:"object",properties:{discrete_resource_spec:{type:"object",properties:{kind:{type:"string"},value:{type:"number"}},additionalProperties:!1,patternProperties:{"^x-":{}}}},additionalProperties:!1,patternProperties:{"^x-":{}}}},devices:{$id:"#/definitions/devices",type:"array",items:{type:"object",properties:{capabilities:{$ref:"#/definitions/list_of_strings"},count:{type:["string","integer"]},device_ids:{$ref:"#/definitions/list_of_strings"},driver:{type:"string"},options:{$ref:"#/definitions/list_or_dict"}},additionalProperties:!1,patternProperties:{"^x-":{}}}},include:{$id:"#/definitions/include",oneOf:[{type:"string"},{type:"object",properties:{path:{$ref:"#/definitions/string_or_list"},env_file:{$ref:"#/definitions/string_or_list"},project_directory:{type:"string"}},additionalProperties:!1}]},network:{$id:"#/definitions/network",type:["object","null"],properties:{name:{type:"string"},driver:{type:"string"},driver_opts:{type:"object",patternProperties:{"^.+$":{type:["string","number"]}}},ipam:{type:"object",properties:{driver:{type:"string"},config:{type:"array",items:{type:"object",properties:{subnet:{type:"string",format:"subnet_ip_address"},ip_range:{type:"string"},gateway:{type:"string"},aux_addresses:{type:"object",additionalProperties:!1,patternProperties:{"^.+$":{type:"string"}}}},additionalProperties:!1,patternProperties:{"^x-":{}}}},options:{type:"object",additionalProperties:!1,patternProperties:{"^.+$":{type:"string"}}}},additionalProperties:!1,patternProperties:{"^x-":{}}},external:{type:["boolean","object"],properties:{name:{deprecated:!0,type:"string"}},additionalProperties:!1,patternProperties:{"^x-":{}}},internal:{type:"boolean"},enable_ipv6:{type:"boolean"},attachable:{type:"boolean"},labels:{$ref:"#/definitions/list_or_dict"}},additionalProperties:!1,patternProperties:{"^x-":{}}},volume:{$id:"#/definitions/volume",type:["object","null"],properties:{name:{type:"string"},driver:{type:"string"},driver_opts:{type:"object",patternProperties:{"^.+$":{type:["string","number"]}}},external:{type:["boolean","object"],properties:{name:{deprecated:!0,type:"string"}},additionalProperties:!1,patternProperties:{"^x-":{}}},labels:{$ref:"#/definitions/list_or_dict"}},additionalProperties:!1,patternProperties:{"^x-":{}}},secret:{$id:"#/definitions/secret",type:"object",properties:{name:{type:"string"},environment:{type:"string"},file:{type:"string"},external:{type:["boolean","object"],properties:{name:{type:"string"}}},labels:{$ref:"#/definitions/list_or_dict"},driver:{type:"string"},driver_opts:{type:"object",patternProperties:{"^.+$":{type:["string","number"]}}},template_driver:{type:"string"}},additionalProperties:!1,patternProperties:{"^x-":{}}},config:{$id:"#/definitions/config",type:"object",properties:{name:{type:"string"},content:{type:"string"},environment:{type:"string"},file:{type:"string"},external:{type:["boolean","object"],properties:{name:{deprecated:!0,type:"string"}}},labels:{$ref:"#/definitions/list_or_dict"},template_driver:{type:"string"}},additionalProperties:!1,patternProperties:{"^x-":{}}},command:{oneOf:[{type:"null"},{type:"string"},{type:"array",items:{type:"string"}}]},string_or_list:{oneOf:[{type:"string"},{$ref:"#/definitions/list_of_strings"}]},list_of_strings:{type:"array",items:{type:"string"},uniqueItems:!0},list_or_dict:{oneOf:[{type:"object",patternProperties:{".+":{type:["string","number","boolean","null"]}},additionalProperties:!1},{type:"array",items:{type:"string"},uniqueItems:!0}]},blkio_limit:{type:"object",properties:{path:{type:"string"},rate:{type:["integer","string"]}},additionalProperties:!1},blkio_weight:{type:"object",properties:{path:{type:"string"},weight:{type:"integer"}},additionalProperties:!1},service_config_or_secret:{type:"array",items:{oneOf:[{type:"string"},{type:"object",properties:{source:{type:"string"},target:{type:"string"},uid:{type:"string"},gid:{type:"string"},mode:{type:"number"}},additionalProperties:!1,patternProperties:{"^x-":{}}}]}},ulimits:{type:"object",patternProperties:{"^[a-z]+$":{oneOf:[{type:"integer"},{type:"object",properties:{hard:{type:"integer"},soft:{type:"integer"}},required:["soft","hard"],additionalProperties:!1,patternProperties:{"^x-":{}}}]}}},constraints:{service:{$id:"#/definitions/constraints/service",anyOf:[{required:["build"]},{required:["image"]}],properties:{build:{required:["context"]}}}}}},S=Q,A=ee(),U=ae(),Z={expose:/^\d+(-\d+)?(\/[a-zA-Z]+)?$/,ports:w,volumes:x,duration:/^(\d+(us|ms|s|m|h))+$/,byte:/^\d+(b|kb?|mb?|gb?)$/,subnet_ip_address:/^((\d{1,2}|1\d{2}|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d{2}|2[0-4]\d|25[0-5])\/(\d|[1-2]\d|3[0-2])$|^((([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4})|(([0-9a-fA-F]{1,4}:){1,7}:)|(([0-9a-fA-F]{1,4}:){1,6}(:[0-9a-fA-F]{1,4}){1,1})|(([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2})|(([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3})|(([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4})|(([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5})|(([0-9a-fA-F]{1,4}:){1,1}(:[0-9a-fA-F]{1,4}){1,6})|(:((:[0-9a-fA-F]{1,4}){1,7}|:))|(fe80:(:[0-9a-fA-F]{1,4}){0,4}%[0-9a-zA-Z]{1,})|(::(ffff(:0{1,4}){0,1}:){0,1}((\d{1,2}|1\d{2}|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d{2}|2[0-4]\d|25[0-5]))|(([0-9a-fA-F]{1,4}:){1,4}:((\d{1,2}|1\d{2}|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d{2}|2[0-4]\d|25[0-5])))\/(\d|[1-9]\d|1[0-1]\d|12[0-8])$/},R=t=>{if(Array.isArray(t))for(let p=0;p<t.length;p+=1)R(t[p]);else typeof t=="object"&&(t.type&&t.format&&(t.pattern=Z[t.format].toString(),delete t.format),Object.keys(t).forEach(p=>{R(t[p])}));return t};function B(t,p){var e=(n=>{let c=[];return Object.values(n).forEach(i=>(i.volumes||[]).forEach(o=>c.push(o))),n=new Set(c.map(i=>(i=T(i),I(i)?i:void 0))),Array.from(n).filter(i=>i).map(i=>({[i]:{external:!0,name:i}}))})(t.services);0<e.length&&(p(`Named volumes (${e.map(n=>JSON.stringify(n)).join(",")}) must be explicitly declared. Creating a 'volumes' section with declarations.

For backwards-compatibility, they've been declared as external. If you don't mind the volume names being prefixed with the project name, you can remove the 'external' option from each one.`),t.volumes=e)}function L(t){var p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null;let e=h(t);if(!e||typeof e=="string"||Object.prototype.hasOwnProperty.call(e,"services"))return t;let n=Object.keys(e),c=[],i=d=>c.push(d),o=(Object.keys(e).forEach(d=>{m=d,r=e[d],a=i,(r=r.links)&&a(`Service ${m} has links, which no longer create environment variables such as ${(a=r[0].split(":")[0]).toUpperCase()}_PORT. If you are using those in your application code, you should instead connect directly to the hostname, e.g. '${a}'.`),m=d,r=e[d],a=i,(r=r.external_links)&&a(`Service ${m} has external_links: ${r}, which now work slightly differently. In particular, two containers must be connected to at least one network in common to communicate, even if explicitly linked together.

Either connect the external container to your app's default network, or connect both the external container and your service's containers to a pre-existing network. See https://docs.docker.com/compose/networking/ for more on how to do this.`);var r,a=e[d],m=n;if(a.net){let u=a.net;u.startsWith("container:")&&(r=u.split(":")[1],m.includes(r))&&(u="service:"+r),a.network_mode=u,delete a.net}(m=e[d]).dockerfile&&(m.build={context:m.build,dockerfile:m.dockerfile},delete m.dockerfile),(r=e[d]).log_driver&&(r.logging={driver:r.log_driver},r.log_opt&&(r.logging.options=r.log_opt,delete r.log_opt),delete r.log_driver);var f=e[d],y=n;if(f.volumes_from)for(let u=0;u<f.volumes_from.length;u+=1){var _=f.volumes_from[u];y.includes(_.split(":")[0])||(f.volumes_from[u]="container:"+_)}}),{});return Object.keys(e).forEach(d=>{o[d]=e[d],delete e[d]}),e.version="2.4",e.services=o,B(e,i),v(e,"networks"),v(e,"volumes"),c.map(d=>"# "+d.replace(/\n/g,`
#`)).join(`
`)+(0<c.length?`
`:"")+b(e,p)}s.getDockerComposeSchemaWithoutFormats=()=>R(O),s.getVolumeNameFromVolumeSpec=T,s.isNamedVolume=I,s.migrateFromV1ToV2x=L,s.migrateFromV2xToV3x=function(t){var p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null;let e=h(t);if(!e||typeof e=="string"||!e.version||e.version.startsWith("3"))return t;let n=[],c=i=>n.push(i);return Object.keys(e.services).forEach(i=>{let o=e.services[i];o.cpus&&$(o,"deploy/resources/limits/cpus",o.cpus),o.mem_limit&&$(o,"deploy/resources/limits/memory",o.mem_limit),o.pids_limit&&$(o,"deploy/resources/limits/pids",o.pids_limit),o.mem_reservation&&$(o,"deploy/resources/reservations/memory",o.mem_reservation),o.volume_driver&&(c(`Service ${i} has volume_driver:${o.volume_driver}: Instead of setting the volume driver on the service, define a volume using the top-level volumes option (https://docs.docker.com/compose/compose-file/compose-file-v3/#volume-configuration-reference) and specify the driver there.`),delete o.volume_driver),o.volumes_from&&(c(`Service ${i} has volumes_from:${o.volumes_from} To share a volume between services, define it using the top-level volumes option (https://docs.docker.com/compose/compose-file/compose-file-v3/#volume-configuration-reference) and reference it from each service that shares it using the service-level volumes option (https://docs.docker.com/compose/compose-file/compose-file-v3/#driver).`),delete o.volumes_from),["cpu_shares","cpu_quota","cpuset","memswap_limit"].forEach(d=>{Object.prototype.hasOwnProperty.call(o,d)&&c(`Service ${i} has ${d}:${o.k} These have been replaced by the resources key under deploy (https://docs.docker.com/compose/compose-file/compose-file-v3/#resources). deploy configuration only takes effect when using docker stack deploy, and is ignored by docker-compose.`),delete o[d]}),o.extends&&(c(`Service ${i} has extends:${o.extends} This option has been removed for version: "3.x" Compose files. For more information on extends, see https://docs.docker.com/compose/multiple-compose-files/extends/.`),delete o.extends),o.group_add&&(c(`Service ${i} has group_add:${o.group_add} This option has been removed for version: "3.x" Compose files.`),delete o.group_add),delete o.cpus,delete o.mem_limit,delete o.pids_limit,delete o.mem_reservation}),e.version="3",v(e,"networks"),v(e,"volumes"),n.map(i=>"# "+i.replace(/\n/g,`
#`)).join(`
`)+(0<n.length?`
`:"")+b(e,p)},s.migrateFromV3xToV2x=function(t){var p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null;let e=h(t);return e&&typeof e!="string"&&e.version&&!e.version.startsWith("2")&&e.services?(Object.keys(e.services).forEach(i=>{var c,i=e.services[i];i.deploy&&i.deploy.resources&&(c=i.deploy.resources,c.limits&&(c.limits.cpus&&(i.cpus=c.limits.cpus),c.limits.memory&&(i.mem_limit=c.limits.memory),c.limits.pids)&&(i.pids_limit=c.limits.pids),c.reservations)&&c.reservations.memory&&(i.mem_reservation=c.reservations.memory),i.deploy&&i.deploy.restart_policy&&i.deploy.restart_policy.condition&&!i.restart&&(i.restart=i.deploy.restart_policy.condition),delete i.deploy}),e.version="2.4",v(e,"networks"),v(e,"volumes"),b(e,p)):t},s.migrateToCommonSpec=function(t){var p,e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null,n=L(t,e);let c=h(n);return!c||typeof c=="string"?t:(n=n.match(/^\s*#[^\r\n]*/gm)||[],Object.keys(c.services||[]).forEach(i=>{i=c.services[i],i.cpus&&$(i,"deploy/resources/limits/cpus",i.cpus),i.mem_limit&&$(i,"deploy/resources/limits/memory",i.mem_limit),i.pids_limit&&$(i,"deploy/resources/limits/pids",i.pids_limit),i.mem_reservation&&$(i,"deploy/resources/reservations/memory",i.mem_reservation),delete i.cpus,delete i.mem_limit,delete i.pids_limit,delete i.mem_reservation}),delete(p=function(i){for(var o=1;o<arguments.length;o++){var d=arguments[o]!=null?arguments[o]:{};o%2?F(Object(d),!0).forEach(function(r){j(i,r,d[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(d)):F(Object(d)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(d,r))})}return i}({name:"<your project name>"},c)).version,v(p,"networks"),v(p,"volumes"),n.map(i=>"# "+i.replace(/^\s*#\s+/g,"")).join(`
`)+(0<n.length?`
`:"")+b(p,e))},s.validateDockerComposeToCommonSpec=t=>{var p=h(t);let e=new A({allErrors:!0,strict:!1});U(e),Object.keys(Z).forEach(i=>e.addFormat(i,Z[i]));var n=e.compile(O);if(n(p))return[];let c=S.parseDocument(t,{prettyErrors:!0});return n.errors.map(y=>{let o=y.instancePath;y.keyword==="additionalProperties"&&(o+="/"+y.params.additionalProperty);var d=o.split("/").slice(1);let r=c.getIn(d,!0);var a=(r=r===null?c.getIn(d.slice(0,-1),!0):r)?r.range[0]+1:0,a=(t.substring(0,a).match(/\n/g)||[]).length+1;let m;m=y.keyword==="additionalProperties"?`Line ${a}(${o}): '${y.params.additionalProperty}' is unknown for '${o}'`:y.keyword==="format"?`Line ${a}(${o}): must have a valid syntax for '${y.params.format}'`:y.keyword==="oneOf"?`Line ${a}(${o}): must be either a Short Syntax (string(s)) or a Long Syntax (object(s))`:`Line ${a}(${o}): ${y.message} (${y.keyword}: ${JSON.stringify(y.params)})`,y=d[0],f="https://docs.docker.com/compose/compose-file/";var f,y=(y==="services"?f+"05-services/":y==="networks"?f+"06-networks/":y==="volumes"?f+"07-volumes/":y==="configs"?f+"08-configs/":y==="secrets"?f+"09-secrets/":f)+(d[2]?"#"+d[2]:"");return{line:a,message:m,helpLink:y}})},s.yamlCheck=C,s.yamlParse=h,s.yamlStringify=b})})(H,H.exports);var le=H.exports;const ye=re(le);export{ye as C,le as c,ae as r};
