import{_ as oe}from"./TextareaCopyable-59231e95.js";import{d as ne,a0 as le,r as m,ac as ie,i as $,D as j,O as ce,E as ue,R as de,aX as G,o as A,c as B,k as i,w as p,a as q,G as R,l as t,m as w,j as N,a6 as M,ad as U,x as pe,ag as ye,af as ve,ae as ge}from"./index-0c1fde36.js";import{h as fe}from"./hex-array-fe7b0a26.js";import{g as Q}from"./base64-ae7cf34b.js";import{y as W,z as he,A as me,B as we,a as F,C as be,D as Se,g as _e,c as ke,s as Ae,J as D,e as xe,v as He,h as Ee,m as K,l as Pe,b as Y,i as je,r as x,q as L,o as De,E as O,F as Ke,w as Je,x as Ce,G as Te,k as z}from"./jwt-parser.service-5aa748f6.js";import{_ as Re}from"./FormItem-1b9a5952.js";import{_ as Ne}from"./Divider-5fc425b0.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./index-a6f01dde.js";import"./context-00991937.js";const Ue=async r=>{if(r instanceof Uint8Array)return{kty:"oct",k:W(r)};if(!he(r))throw new TypeError(me(r,...we,"Uint8Array"));if(!r.extractable)throw new TypeError("non-extractable CryptoKey cannot be exported as a JWK");const{ext:e,key_ops:o,alg:a,use:c,...y}=await F.subtle.exportKey("jwk",r);return y},Ie=Ue;async function Z(r){return be(r)}async function ee(r){return Se(r)}async function I(r){return Ie(r)}const We=async(r,e,o)=>{const a=await _e(r,e,"sign");ke(r,a);const c=await F.subtle.sign(Ae(r,a.algorithm),a,o);return new Uint8Array(c)},Oe=We;class Ve{constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,o){if(!this._protectedHeader&&!this._unprotectedHeader)throw new D("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!xe(this._protectedHeader,this._unprotectedHeader))throw new D("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const a={...this._protectedHeader,...this._unprotectedHeader},c=He(D,new Map([["b64",!0]]),o?.crit,this._protectedHeader,a);let y=!0;if(c.has("b64")&&(y=this._protectedHeader.b64,typeof y!="boolean"))throw new D('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:f}=a;if(typeof f!="string"||!f)throw new D('JWS "alg" (Algorithm) Header Parameter missing or invalid');Ee(f,e,"sign");let h=this._payload;y&&(h=K.encode(W(h)));let v;this._protectedHeader?v=K.encode(W(JSON.stringify(this._protectedHeader))):v=K.encode("");const E=Pe(v,K.encode("."),h),V=await Oe(f,e,E),d={signature:W(V),payload:""};return y&&(d.payload=Y.decode(h)),this._unprotectedHeader&&(d.header=this._unprotectedHeader),this._protectedHeader&&(d.protected=Y.decode(v)),d}}class $e{constructor(e){this._flattened=new Ve(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,o){const a=await this._flattened.sign(e,o);if(a.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${a.protected}.${a.payload}.${a.signature}`}}function H(r,e){if(!Number.isFinite(e))throw new TypeError(`Invalid ${r} input`);return e}class Be{constructor(e={}){if(!je(e))throw new TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return typeof e=="number"?this._payload={...this._payload,nbf:H("setNotBefore",e)}:e instanceof Date?this._payload={...this._payload,nbf:H("setNotBefore",x(e))}:this._payload={...this._payload,nbf:x(new Date)+L(e)},this}setExpirationTime(e){return typeof e=="number"?this._payload={...this._payload,exp:H("setExpirationTime",e)}:e instanceof Date?this._payload={...this._payload,exp:H("setExpirationTime",x(e))}:this._payload={...this._payload,exp:x(new Date)+L(e)},this}setIssuedAt(e){return typeof e>"u"?this._payload={...this._payload,iat:x(new Date)}:e instanceof Date?this._payload={...this._payload,iat:H("setIssuedAt",x(e))}:typeof e=="string"?this._payload={...this._payload,iat:H("setIssuedAt",x(new Date)+L(e))}:this._payload={...this._payload,iat:H("setIssuedAt",e)},this}}class Me extends Be{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,o){const a=new $e(K.encode(JSON.stringify(this._payload)));if(a.setProtectedHeader(this._protectedHeader),Array.isArray(this._protectedHeader?.crit)&&this._protectedHeader.crit.includes("b64")&&this._protectedHeader.b64===!1)throw new De("JWTs MUST NOT use unencoded payload");return a.sign(e,o)}}function X(r){const e=r?.modulusLength??2048;if(typeof e!="number"||e<2048)throw new O("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return e}async function Le(r,e){let o,a;switch(r){case"PS256":case"PS384":case"PS512":o={name:"RSA-PSS",hash:`SHA-${r.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:X(e)},a=["sign","verify"];break;case"RS256":case"RS384":case"RS512":o={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${r.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:X(e)},a=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":o={name:"RSA-OAEP",hash:`SHA-${parseInt(r.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:X(e)},a=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":o={name:"ECDSA",namedCurve:"P-256"},a=["sign","verify"];break;case"ES384":o={name:"ECDSA",namedCurve:"P-384"},a=["sign","verify"];break;case"ES512":o={name:"ECDSA",namedCurve:"P-521"},a=["sign","verify"];break;case"Ed25519":o={name:"Ed25519"},a=["sign","verify"];break;case"EdDSA":{a=["sign","verify"];const c=e?.crv??"Ed25519";switch(c){case"Ed25519":case"Ed448":o={name:c};break;default:throw new O("Invalid or unsupported crv option provided")}break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{a=["deriveKey","deriveBits"];const c=e?.crv??"P-256";switch(c){case"P-256":case"P-384":case"P-521":{o={name:"ECDH",namedCurve:c};break}case"X25519":case"X448":o={name:c};break;default:throw new O("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}break}default:throw new O('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return F.subtle.generateKey(o,e?.extractable??!1,a)}async function ze(r,e){return Le(r,e)}const te=[{alg:"HS256",keyDesc:"256 bit (32 byte) secret",key:"secret",verify:"HMAC-SHA256"},{alg:"HS384",keyDesc:"384 bit (48 byte) secret",key:"secret",verify:"HMAC-SHA384"},{alg:"HS512",keyDesc:"512 bit (64 byte) secret",key:"secret",verify:"HMAC-SHA512"},{alg:"ES256",keyDesc:"NIST P-256 elliptic curve key",key:"keyspair",verify:"ECDSA-SHA256"},{alg:"ES256K",keyDesc:"secp256k1 elliptic curve key",key:"keyspair",verify:"ECDSA-SHA256(secp256k1)"},{alg:"ES384",keyDesc:"NIST P-384 elliptic curve key",key:"keyspair",verify:"ECDSA-SHA384"},{alg:"ES512",keyDesc:"NIST P-521 elliptic curve key",key:"keyspair",verify:"ECDSA-SHA512"},{alg:"PS256",keyDesc:"RSA key of at least 2048 bit modulus length",key:"keyspair",verify:"RSA-PSS-SHA256"},{alg:"PS384",keyDesc:"RSA key of at least 2048 bit modulus length",key:"keyspair",verify:"RSA-PSS-SHA384"},{alg:"PS512",keyDesc:"RSA key of at least 2048 bit modulus length",key:"keyspair",verify:"RSA-PSS-SHA512"},{alg:"RS256",keyDesc:"RSA key of at least 2048 bit modulus length",key:"keyspair",verify:"RSA-SHA256"},{alg:"RS384",keyDesc:"RSA key of at least 2048 bit modulus length",key:"keyspair",verify:"RSA-SHA384"},{alg:"RS512",keyDesc:"RSA key of at least 2048 bit modulus length",key:"keyspair",verify:"RSA-SHA512"}],Xe={key:0},Fe={key:1},ct=ne({__name:"jwt-generator",setup(r){const{t:e}=le(),o=m(`{
  "sub": "1234567890",
  "name": "John Doe",
  "iat": 1516239022
}`),a=ie({name:"alg",storageName:"jwt-gen:alg",defaultValue:"HS512"}),c=$(()=>te.find(l=>l.alg===a.value)||{alg:"UNK",keyDesc:"",key:"secret",verify:""}),y=$(()=>c.value.key==="secret"),f=m(""),h=m("");j(f,l=>{h.value="";try{o.value=JSON.stringify(Ke(l),null,2),a.value=Je({jwt:l})||"HS512"}catch(s){h.value=s.toString()}});const v=m(""),E=m("text"),V=[{label:e("tools.jwt-generator.texts.label-raw-text"),value:"text"},{label:e("tools.jwt-generator.texts.label-hex-array"),value:"hex"},{label:"Base64",value:"base64"}],d=m(""),S=m(""),b=m(""),_=m("");j(d,async l=>{try{S.value=JSON.stringify(await I(await Ce(l,a.value,{extractable:!0})),null,2)}catch{}},{immediate:!0}),j(_,async l=>{try{b.value=JSON.stringify(await I(await Te(l,a.value,{extractable:!0})),null,2)}catch{}},{immediate:!0}),j(S,async l=>{try{d.value=await Z(await z({...JSON.parse(l),ext:!0},a.value))}catch{}},{immediate:!0}),j(b,async l=>{try{_.value=await ee(await z({...JSON.parse(l),ext:!0},a.value))}catch{}},{immediate:!0}),ce(async()=>{if(y.value)v.value="your-secret",b.value="",S.value="",_.value="",d.value="";else{const{publicKey:l,privateKey:s}=await ze(a.value,{extractable:!0});b.value=JSON.stringify(await I(s),null,2),S.value=JSON.stringify(await I(l),null,2),_.value=await ee(s),d.value=await Z(l)}});const ae=$(()=>JSON.stringify({alg:a.value,typ:"JWT"},null,2)),P=ue(async()=>{const l=y.value,s=v.value,g=E.value,J=b.value,k=a.value,C=o.value;try{let u;if(l)try{switch(g){case"text":u=new TextEncoder().encode(s);break;case"hex":u=fe.fromString(s);break;case"base64":if(!Q.isValid(s))throw new Error(e("tools.jwt-generator.texts.invalid-base64-string"));u=Q.toUint8Array(s);break}}catch(T){throw new Error(e("tools.jwt-generator.texts.cannot-parse-secret-as-encoding",[s,g,T]))}else u=await z(JSON.parse(J),k);return{token:await new Me(G.parse(C)).setProtectedHeader({alg:k}).sign(u),error:""}}catch(u){return{error:u.toString(),token:""}}}),re=de({source:o,rules:[{message:e("tools.jwt-generator.texts.message-invalid-json-string"),validator:l=>G.parse(l)}]});return(l,s)=>{const g=pe,J=ye,k=ve,C=ge,u=Re,T=oe,se=Ne;return A(),B("div",null,[i(k,{"mb-3":""},{default:p(()=>[q("details",null,[q("summary",null,R(t(e)("tools.jwt-generator.texts.click-to-input-a-existing-jwt-token-to-modify")),1),i(g,{value:t(f),"onUpdate:value":s[0]||(s[0]=n=>w(f)?f.value=n:null),placeholder:t(e)("tools.jwt-generator.texts.placeholder-input-token")},null,8,["value","placeholder"]),t(h)?(A(),N(J,{key:0},{default:p(()=>[M(R(t(h)),1)]),_:1})):U("",!0)])]),_:1}),i(C,{value:t(a),"onUpdate:value":s[1]||(s[1]=n=>w(a)?a.value=n:null),options:t(te).map(n=>({value:n.alg,label:`${n.alg}: ${n.verify}`})),placeholder:t(e)("tools.jwt-generator.texts.placeholder-algorithms"),"mb-2":""},null,8,["value","options","placeholder"]),i(u,{label:t(e)("tools.jwt-generator.texts.label-description"),"label-placement":"left","mb-2":""},{default:p(()=>[M(R(t(e)("tools.jwt-generator.texts.verify-description",[t(c).alg,t(c).keyDesc,t(c).verify])),1)]),_:1},8,["label"]),i(k,{title:t(e)("tools.jwt-generator.texts.title-token-content"),"mb-2":""},{default:p(()=>[i(u,{label:t(e)("tools.jwt-generator.texts.label-header")},{default:p(()=>[i(T,{value:t(ae),language:"json"},null,8,["value"])]),_:1},8,["label"]),i(g,{value:t(o),"onUpdate:value":s[2]||(s[2]=n=>w(o)?o.value=n:null),label:t(e)("tools.jwt-generator.texts.label-payload"),multiline:"",rows:"5",autosize:"",placeholder:t(e)("tools.jwt-generator.texts.placeholder-json-payload"),validation:t(re)},null,8,["value","label","placeholder","validation"])]),_:1},8,["title"]),i(k,{title:t(y)?t(e)("tools.jwt-generator.texts.token-secret"):t(e)("tools.jwt-generator.texts.token-keys"),"mb-2":""},{default:p(()=>[t(y)?(A(),B("div",Xe,[i(C,{value:t(E),"onUpdate:value":s[3]||(s[3]=n=>w(E)?E.value=n:null),"label-placement":"left",label:t(e)("tools.jwt-generator.texts.label-secret-encoding"),options:V,"mb-2":""},null,8,["value","label"]),i(g,{value:t(v),"onUpdate:value":s[4]||(s[4]=n=>w(v)?v.value=n:null)},null,8,["value"])])):(A(),B("div",Fe,[i(u,{label:t(e)("tools.jwt-generator.texts.label-public-key-pem")},{default:p(()=>[i(g,{value:t(d),"onUpdate:value":s[5]||(s[5]=n=>w(d)?d.value=n:null),multiline:"",rows:"5",autosize:""},null,8,["value"])]),_:1},8,["label"]),i(u,{label:t(e)("tools.jwt-generator.texts.label-private-key-pem")},{default:p(()=>[i(g,{value:t(_),"onUpdate:value":s[6]||(s[6]=n=>w(_)?_.value=n:null),multiline:"",rows:"5",autosize:""},null,8,["value"])]),_:1},8,["label"]),i(se),i(u,{label:t(e)("tools.jwt-generator.texts.label-public-key-jwk")},{default:p(()=>[i(g,{value:t(S),"onUpdate:value":s[7]||(s[7]=n=>w(S)?S.value=n:null),multiline:"",rows:"5",autosize:""},null,8,["value"])]),_:1},8,["label"]),i(u,{label:t(e)("tools.jwt-generator.texts.label-private-key-jwk")},{default:p(()=>[i(g,{value:t(b),"onUpdate:value":s[8]||(s[8]=n=>w(b)?b.value=n:null),multiline:"",rows:"5",autosize:""},null,8,["value"])]),_:1},8,["label"])]))]),_:1},8,["title"]),t(P)?(A(),N(k,{key:0,title:t(e)("tools.jwt-generator.texts.title-generated-jwt-token"),"mb-2":""},{default:p(()=>[t(P).token?(A(),N(T,{key:0,value:t(P).token,"word-wrap":""},null,8,["value"])):U("",!0),t(P).error?(A(),N(J,{key:1},{default:p(()=>[M(R(t(P).error),1)]),_:1})):U("",!0)]),_:1},8,["title"])):U("",!0)])}}});export{ct as default};
