import{d as X,a0 as G,ac as D,r as b,o as C,c as j,k as p,w as f,l as n,m as O,a6 as k,G as y,a as w,j as B,ad as J,a7 as M,a8 as I,ai as Q,aW as W,aj as q,af as H}from"./index-0c1fde36.js";import{_ as K}from"./TextareaCopyable-59231e95.js";import{_ as Y}from"./Radio-424d9905.js";import{_ as Z}from"./RadioGroup-1850ca84.js";import{_ as ee}from"./Space-7fc52151.js";import{_ as te}from"./Checkbox-ba7202eb.js";import{N as ne}from"./Alert-a9fb131b.js";import{_ as oe}from"./Divider-5fc425b0.js";import"./base64-ae7cf34b.js";import"./index-a6f01dde.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./get-slot-1efb97e5.js";function le(v,u){const c=[];for(let s=0;s<v.length;s+=u)c.push(v.slice(s,s+u));return c}function ie(v,u){const c=[],s=Math.ceil(v.length/u);for(let _=0;_<v.length;_+=s)c.push(v.slice(_,_+s));return c}function se(v,u,c,s="maxSize"){const _=m=>s==="fixedCount"?le(m,c):s==="chunkCount"?ie(m,c):[];if(u==="lines"){const m=v.split(/\r?\n/);if(s==="maxSize"){const o=[];let e=[],l=0;for(const t of m){const a=t.length+1;l+a>c&&e.length>0&&(o.push(e.join(`
`)),e=[],l=0),e.push(t),l+=a}return e.length>0&&o.push(e.join(`
`)),o}return _(m).map(o=>o.join(`
`))}try{const m=JSON.parse(v);if(Array.isArray(m)){if(s==="maxSize"){const o=[];let e=[],l=0;for(const t of m){const d=JSON.stringify(t).length+2;l+d>c&&e.length>0&&(o.push(JSON.stringify(e)),e=[],l=0),e.push(t),l+=d}return e.length>0&&o.push(JSON.stringify(e)),o}return _(m).map(o=>JSON.stringify(o))}if(typeof m=="object"){const o=Object.entries(m);if(s==="maxSize"){const e=[];let l=[],t=0;for(const[a,d]of o){const N=JSON.stringify({[a]:d}).length+2;t+N>c&&l.length>0&&(e.push(JSON.stringify(Object.fromEntries(l))),l=[],t=0),l.push([a,d]),t+=N}return l.length>0&&e.push(JSON.stringify(Object.fromEntries(l))),e}return _(o).map(e=>JSON.stringify(Object.fromEntries(e)))}}catch{const e=new DOMParser().parseFromString(v,"application/xml").documentElement,l=Array.from(e.children);if(s==="maxSize"){const t=[];let a=[];for(const d of l){const S=document.implementation.createDocument("",e.tagName,null);if(a.forEach(r=>S.documentElement.appendChild(r.cloneNode(!0))),S.documentElement.appendChild(d.cloneNode(!0)),new XMLSerializer().serializeToString(S).length>c&&a.length>0){const r=document.implementation.createDocument("",e.tagName,null);a.forEach(i=>r.documentElement.appendChild(i.cloneNode(!0))),t.push(new XMLSerializer().serializeToString(r)),a=[]}a.push(d)}if(a.length>0){const d=document.implementation.createDocument("",e.tagName,null);a.forEach(S=>d.documentElement.appendChild(S.cloneNode(!0))),t.push(new XMLSerializer().serializeToString(d))}return t}return _(l).map(t=>{const a=document.implementation.createDocument("",e.tagName,null);return t.forEach(d=>a.documentElement.appendChild(d.cloneNode(!0))),new XMLSerializer().serializeToString(a)})}throw new Error("Unsupported format or invalid content")}const ae={style:{flex:"0 0 100%"},"mb-2":""},re={"mx-auto":"","max-w-600px":""},ue={"mb-1":"",flex:"","justify-center":""},ce={"mb-2":"",flex:"","justify-center":""},pe={flex:"","justify-center":""},me={key:0},fe={flex:"","justify-center":""},Ue=X({__name:"file-splitter",setup(v){const{t:u}=G(),c=D({name:"mode",storageName:"file-split:m",defaultValue:"lines"}),s=D({name:"strategy",storageName:"file-split:s",defaultValue:"fixedCount"}),_=D({name:"count",storageName:"file-split:c",defaultValue:100}),m=b(""),o=b(!1),e=b(""),l=b(""),t=b([]);async function a(){e.value="";const r=c.value,i=_.value,g=s.value,h=l.value;if(!h)return[];try{t.value=await new Promise((z,E)=>{try{z(se(h,r,(g==="maxSize"?1024:1)*i,g))}catch(U){E(U)}})}catch(z){e.value=z.toString(),t.value=[]}}function d(r){return new Promise((i,g)=>{const h=new FileReader;h.onload=()=>{i(h.result||"")},h.onerror=g,h.readAsText(r)})}async function S(r){m.value=r.name?.split(".").pop()||"txt",l.value=await d(r)}function N(r){const i=new Blob([t.value[r]],{type:"text/plain"}),g=URL.createObjectURL(i),h=document.createElement("a");h.href=g,h.download=`chunk-${r+1}.${m.value}`,h.click(),URL.revokeObjectURL(g)}function L(){for(let r=0;r<t.value.length;r++)N(r)}return(r,i)=>{const g=Y,h=Z,z=ee,E=Q,U=W,R=te,V=q,A=ne,F=oe,T=K,P=H;return C(),j("div",null,[p(z,{justify:"center","mb-2":""},{default:f(()=>[p(h,{value:n(c),"onUpdate:value":i[0]||(i[0]=x=>O(c)?c.value=x:null)},{default:f(()=>[p(g,{value:"lines"},{default:f(()=>[k(y(n(u)("tools.file-splitter.texts.tag-split-by-lines")),1)]),_:1}),p(g,{value:"nodes"},{default:f(()=>[k(y(n(u)("tools.file-splitter.texts.tag-split-by-nodes")),1)]),_:1})]),_:1},8,["value"])]),_:1}),p(z,{justify:"center",align:"baseline","mb-2":""},{default:f(()=>[p(h,{value:n(s),"onUpdate:value":i[1]||(i[1]=x=>O(s)?s.value=x:null)},{default:f(()=>[p(g,{value:"maxSize"},{default:f(()=>[k(y(n(u)("tools.file-splitter.texts.tag-max-chunk-size-kb")),1)]),_:1}),p(g,{value:"fixedCount"},{default:f(()=>[k(y(n(u)("tools.file-splitter.texts.tag-fixed-count")),1)]),_:1}),p(g,{value:"chunkCount"},{default:f(()=>[k(y(n(u)("tools.file-splitter.texts.tag-chunk-count")),1)]),_:1})]),_:1},8,["value"]),p(E,{value:n(_),"onUpdate:value":i[2]||(i[2]=x=>O(_)?_.value=x:null),min:1,placeholder:n(u)("tools.file-splitter.texts.placeholder-strategy-value"),style:{width:"150px"}},null,8,["value","placeholder"])]),_:1}),w("div",ae,[w("div",re,[p(U,{title:n(u)("tools.file-splitter.texts.title-drag-and-drop-a-txt-json-or-xml-file-here-or-click-to-select-a-file"),accept:".txt,.json,.xml",onFileUpload:S},null,8,["title"])])]),w("div",ue,[p(R,{checked:n(o),"onUpdate:checked":i[3]||(i[3]=x=>O(o)?o.value=x:null)},{default:f(()=>[k(y(n(u)("tools.file-splitter.texts.tag-preview-chunks")),1)]),_:1},8,["checked"])]),w("div",ce,[p(V,{size:"small",onClick:i[4]||(i[4]=x=>a())},{default:f(()=>[k(y(n(u)("tools.file-splitter.texts.tag-process-chunks")),1)]),_:1})]),n(e)?(C(),B(A,{key:0},{default:f(()=>[k(y(n(e)),1)]),_:1})):J("",!0),n(t)&&n(t).length?(C(),B(P,{key:1,title:`Chunks (${n(t).length})`},{default:f(()=>[w("div",pe,[p(V,{size:"small",onClick:i[5]||(i[5]=x=>L())},{default:f(()=>[k(y(n(u)("tools.file-splitter.texts.tag-download-all")),1)]),_:1})]),n(o)?(C(),j("div",me,[(C(!0),j(M,null,I(n(t),(x,$)=>(C(),j(M,{key:$},[p(F,null,{default:f(()=>[k("Chunk "+y($+1),1)]),_:2},1024),p(T,{value:x,language:n(m),style:{"max-height":"10em"},multiline:"","word-wrap":"","mb-1":""},null,8,["value","language"]),w("div",fe,[p(V,{size:"small",onClick:de=>N($)},{default:f(()=>[k(y(n(u)("tools.file-splitter.texts.tag-download")),1)]),_:2},1032,["onClick"])])],64))),128))])):J("",!0)]),_:1},8,["title"])):J("",!0)])}}});export{Ue as default};
