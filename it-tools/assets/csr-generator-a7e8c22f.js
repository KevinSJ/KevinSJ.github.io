import{d as E,a0 as S,am as g,R as T,r as K,o as z,c as R,a as n,k as a,w as i,l as e,m as p,a6 as q,G as N,ad as B,ah as $,s as D}from"./index-0c1fde36.js";import{l as _}from"./index-20485d98.js";import{g as F,a as I}from"./crypto-51584306.js";import{_ as V}from"./TextareaCopyable-59231e95.js";import{a as O}from"./defaults-4d6daddf.js";import{c as G}from"./computedRefreshable-6ca60894.js";import{_ as Q}from"./FormItem-1b9a5952.js";import{_ as H}from"./Divider-5fc425b0.js";import"./index-a6f01dde.js";import"./index-892bd980.js";import"./browser-703720a1.js";import"./index-649b5bab.js";import"./inherits_browser-6f38ab1b.js";import"./index-0397ab6f.js";import"./index-fdbe2ce9.js";import"./string_decoder-8ac4312e.js";import"./hash-f152040d.js";import"./index-4bc05a7f.js";import"./index-e6f9cbd8.js";import"./index-5fa9e804.js";import"./prime.worker.min-a8ac05bb.js";import"./base64-ae7cf34b.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./context-00991937.js";async function J(r={}){const{privateKey:l,publicKey:d}=await F(r),u=_.pki.createCertificationRequest();u.publicKey=d,u.setSubject([{name:"commonName",value:r.commonName},{name:"countryName",value:r.countryName},{name:"stateOrProvinceName",value:r.state},{name:"localityName",value:r.city},{name:"organizationName",value:r.organizationName},{name:"organizationalUnitName",value:r.organizationalUnit},{name:"emailAddress",value:r.contactEmail}].filter(b=>b.value!==null&&b.value?.trim()!==""));const s=[],v=I(r.subjectAlternativeNames);v&&s.push(v),s.length&&u.setAttributes([{name:"extensionRequest",extensions:s}]),u.sign(l);const f=_.pki.certificationRequestToPem(u),y=_.pki.privateKeyToPem(l);return{csrPem:f,publicKeyPem:_.pki.publicKeyToPem(d),privateKeyPem:r?.password?_.pki.encryptRsaPrivateKey(l,r?.password):y}}const L={"mb-2":""},M={flex:"","justify-center":""},W={key:0},ke=E({__name:"csr-generator",setup(r){const{t:l}=S(),d=g({tool:"csr-gen",name:"cn",defaultValue:"test.com"}),u=T({source:d,rules:[{message:l("tools.csr-generator.texts.message-common-name-domain-name-must-not-be-empty"),validator:U=>U?.trim()!==""}]}),s=g({tool:"csr-gen",name:"org",defaultValue:"Test"}),v=g({tool:"csr-gen",name:"ou",defaultValue:""}),f=K(""),y=g({tool:"csr-gen",name:"city",defaultValue:"Paris"}),b=g({tool:"csr-gen",name:"state",defaultValue:"FR"}),h=g({tool:"csr-gen",name:"country",defaultValue:"France"}),x=g({tool:"csr-gen",name:"email",defaultValue:""}),w=K(""),P={csrPem:"",privateKeyPem:"",publicKeyPem:""},[k,A]=G(()=>O(()=>u.isValid?J({password:f.value,commonName:d.value,countryName:h.value,city:y.value,state:b.value,organizationName:s.value,organizationalUnit:v.value,subjectAlternativeNames:w.value,contactEmail:x.value}):P,P),P);return(U,t)=>{const m=$,c=Q,C=D,j=H;return z(),R("div",null,[n("div",L,[a(c,{label:e(l)("tools.csr-generator.texts.label-common-name-domain-name"),"label-placement":"top",feedback:e(u).message,"validation-status":e(u).status},{default:i(()=>[a(m,{value:e(d),"onUpdate:value":t[0]||(t[0]=o=>p(d)?d.value=o:null),placeholder:e(l)("tools.csr-generator.texts.placeholder-common-domain-name")},null,8,["value","placeholder"])]),_:1},8,["label","feedback","validation-status"])]),n("div",null,[a(c,{label:e(l)("tools.csr-generator.texts.label-organization-name"),"label-placement":"left","label-width":"100"},{default:i(()=>[a(m,{value:e(s),"onUpdate:value":t[1]||(t[1]=o=>p(s)?s.value=o:null),placeholder:e(l)("tools.csr-generator.texts.placeholder-organization-name")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(l)("tools.csr-generator.texts.label-organization-unit"),"label-placement":"left","label-width":"100"},{default:i(()=>[a(m,{value:e(v),"onUpdate:value":t[2]||(t[2]=o=>p(v)?v.value=o:null),placeholder:e(l)("tools.csr-generator.texts.placeholder-organization-unit")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(l)("tools.csr-generator.texts.label-state"),"label-placement":"left","label-width":"100"},{default:i(()=>[a(m,{value:e(b),"onUpdate:value":t[3]||(t[3]=o=>p(b)?b.value=o:null),placeholder:e(l)("tools.csr-generator.texts.placeholder-state")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(l)("tools.csr-generator.texts.label-city"),"label-placement":"left","label-width":"100"},{default:i(()=>[a(m,{value:e(y),"onUpdate:value":t[4]||(t[4]=o=>p(y)?y.value=o:null),placeholder:e(l)("tools.csr-generator.texts.placeholder-city")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(l)("tools.csr-generator.texts.label-country"),"label-placement":"left","label-width":"100"},{default:i(()=>[a(m,{value:e(h),"onUpdate:value":t[5]||(t[5]=o=>p(h)?h.value=o:null),placeholder:e(l)("tools.csr-generator.texts.placeholder-country")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(l)("tools.csr-generator.texts.label-contact-email"),"label-placement":"left","label-width":"100"},{default:i(()=>[a(m,{value:e(x),"onUpdate:value":t[6]||(t[6]=o=>p(x)?x.value=o:null),placeholder:e(l)("tools.csr-generator.texts.placeholder-contact-email")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(l)("tools.csr-generator.texts.label-subject-alternative-names"),"label-placement":"top"},{default:i(()=>[a(m,{value:e(w),"onUpdate:value":t[7]||(t[7]=o=>p(w)?w.value=o:null),placeholder:e(l)("tools.csr-generator.texts.placeholder-dns-names-emails-ip-uri"),type:"textarea"},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(l)("tools.csr-generator.texts.label-private-key-passphrase"),"label-placement":"top"},{default:i(()=>[a(m,{value:e(f),"onUpdate:value":t[8]||(t[8]=o=>p(f)?f.value=o:null),type:"password","show-password-on":"mousedown",placeholder:e(l)("tools.csr-generator.texts.placeholder-passphrase")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",M,[a(C,{onClick:e(A)},{default:i(()=>[q(N(e(l)("tools.csr-generator.texts.tag-refresh-csr")),1)]),_:1},8,["onClick"])]),a(j),e(u).isValid?(z(),R("div",W,[n("div",null,[n("h3",null,N(e(l)("tools.csr-generator.texts.tag-certificate-signing-request")),1),a(V,{value:e(k).csrPem,"download-file-name":`${e(s)}.csr`},null,8,["value","download-file-name"])]),n("div",null,[n("h3",null,N(e(l)("tools.csr-generator.texts.tag-public-key")),1),a(V,{value:e(k).publicKeyPem,"word-wrap":"","download-file-name":`${e(s)}.pem`},null,8,["value","download-file-name"])]),n("div",null,[n("h3",null,N(e(l)("tools.csr-generator.texts.tag-private-key")),1),a(V,{value:e(k).privateKeyPem,"download-file-name":`${e(s)}.key`},null,8,["value","download-file-name"])])])):B("",!0)])}}});export{ke as default};
