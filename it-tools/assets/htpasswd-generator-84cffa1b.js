import{b as D,t as B,dt as H,d as N,a0 as F,r as $,i as P,o as k,c as q,k as m,l as c,m as S,j as V,w as I,ad as O,x as T,ae as Z,ak as G}from"./index-0c1fde36.js";import{a as J}from"./index-922f2090.js";import{B as K}from"./index-a6f01dde.js";import{a as Q,r as W}from"./index-892bd980.js";import{_ as X}from"./TextareaCopyable-59231e95.js";import{_ as Y}from"./FormItem-1b9a5952.js";import{_ as tt}from"./Divider-5fc425b0.js";import"./index-19e2bc48.js";import"./browser-703720a1.js";import"./index-649b5bab.js";import"./inherits_browser-6f38ab1b.js";import"./index-0397ab6f.js";import"./index-fdbe2ce9.js";import"./string_decoder-8ac4312e.js";import"./hash-f152040d.js";import"./base64-ae7cf34b.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./context-00991937.js";var et=Q();const y=D(et);function rt(t,e){if(e===void 0&&(e=t,t=0),typeof t!="number"||typeof e!="number")throw new TypeError("Expected all arguments to be numbers");return Math.floor(Math.random()*(e-t+1)+t)}var p;(function(t){t[t.sha256=5]="sha256",t[t.sha512=6]="sha512"})(p||(p={}));const _="./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",st={sha256:[20,10,0,11,1,21,2,22,12,23,13,3,14,4,24,5,25,15,26,16,6,17,7,27,8,28,18,29,19,9,30,31],sha512:[42,21,0,1,43,22,23,2,44,45,24,3,4,46,25,26,5,47,48,27,6,7,49,28,29,8,50,51,30,9,10,52,31,32,11,53,54,33,12,13,55,34,35,14,56,57,36,15,16,58,37,38,17,59,60,39,18,19,61,40,41,20,62,63]},U=5e3,j=t=>new Blob([t]).size;function at(t){var e="";for(let s=0;s<t;s++)e+=_[rt(0,_.length-1)];return e}function ot(t){const e=["",t.id];return(t.specifyRounds||t.rounds!==U)&&e.push(`rounds=${t.rounds}`),e.push(t.saltString),e.join("$")}function nt(t){const r={id:p.sha512,saltString:at(16),rounds:U,specifyRounds:!1};if(t){const a=t.split("$");if(r.id=Number(a[1]),r.id!==p.sha256&&r.id!==p.sha512)throw new Error("Only sha256 and sha512 is supported by this library");if(a.length<2||a.length>4)throw new Error("Invalid salt string");if(a.length>2){const o=a[2].match(/^rounds=(\d*)$/);o?(r.rounds=Number(o[1]),r.specifyRounds=!0,(a[3]||a[3]==="")&&(r.saltString=a[3])):r.saltString=a[2]}}if(r.rounds=r.rounds<1e3?1e3:r.rounds>999999999?r.rounds=999999999:r.rounds,r.saltString=r.saltString.substring(0,16),r.saltString.match("[^./0-9A-Za-z]"))throw new Error("Invalid salt string");return r}function lt(t,e){const s=e.id===p.sha256?32:64,r=y(p[e.id]);r.update(t),r.update(e.saltString);const a=y(p[e.id]);a.update(t),a.update(e.saltString),a.update(t);const o=a.digest(),n=j(t);for(let u=0;u+s<n;u+=s)r.update(o);const i=n%s;return r.update(o.slice(0,i)),n.toString(2).split("").reverse().forEach(u=>{r.update(u==="0"?t:o)}),r.digest()}function ut(t,e){const s=e.id===p.sha256?32:64,r=p[e.id],a=lt(t,e),o=j(t),n=y(r);for(let l=0;l<o;l++)n.update(t);const i=n.digest(),u=new Uint8Array(o);for(let l=0;l+s<o;l+=s)u.set(i,l);const d=o%s;u.set(i.slice(0,d),o-d);const v=y(r),x=16+a[0];for(let l=0;l<x;l++)v.update(e.saltString);const A=v.digest(),f=new Uint8Array(e.saltString.length),w=K.byteLength(e.saltString);for(let l=0;l+s<w;l+=s)f.set(A,l);const h=w%s;f.set(A.slice(0,h),w-h);const L=Array(e.rounds).fill(0).reduce((l,bt,C)=>{const g=y(r);return C%2===0?g.update(l):g.update(u),C%3!==0&&g.update(f),C%7!==0&&g.update(u),C%2!==0?g.update(l):g.update(u),g.digest()},a);return ct(L,st[r])}function ct(t,e){let s="";for(let r=0;r<t.length;r+=3){const a=new Uint8Array(3);a[0]=t[e[r]],a[1]=t[e[r+1]],a[2]=t[e[r+2]],s+=dt(a)}return s.slice(0,t.length===32?-1:-2)}function dt(t){const e=t[0]&parseInt("00111111",2),s=(t[0]&parseInt("11000000",2))>>>6|(t[1]&parseInt("00001111",2))<<2,r=(t[1]&parseInt("11110000",2))>>>4|(t[2]&parseInt("00000011",2))<<4,a=(t[2]&parseInt("11111100",2))>>>2;return _.charAt(e)+_.charAt(s)+_.charAt(r)+_.charAt(a)}function M(t,e){const s=nt(e),r=ut(t,s);return ot(s)+"$"+r}const E=W(),z="./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function b(t,e){let s="";for(;--e>=0;)s+=z[t&63],t=t>>6;return s}function it(t){let e="";if(t)e=t.split("$")[2];else for(;e.length<8;){let s=Math.floor(Math.random()*64);e+=z[s]}return e}function ht(t){let e="";return e+=b(t.charCodeAt(0)<<16|t.charCodeAt(6)<<8|t.charCodeAt(12),4),e+=b(t.charCodeAt(1)<<16|t.charCodeAt(7)<<8|t.charCodeAt(13),4),e+=b(t.charCodeAt(2)<<16|t.charCodeAt(8)<<8|t.charCodeAt(14),4),e+=b(t.charCodeAt(3)<<16|t.charCodeAt(9)<<8|t.charCodeAt(15),4),e+=b(t.charCodeAt(4)<<16|t.charCodeAt(10)<<8|t.charCodeAt(5),4),e+=b(t.charCodeAt(11),2),e}var pt=(t,e)=>{let s="";e&&e.split("$")[1]==="1"?s="$1$":s="$apr1$",e=it(e);let r=t+s+e,a=E.createHash("md5").update(t+e+t,"ascii").digest("binary");for(let o=t.length;o>0;o-=16)r+=a.substr(0,o>16?16:o);for(let o=t.length;o;o>>=1)o%2?r+=String.fromCharCode(0):r+=t.charAt(0);a=E.createHash("md5").update(r,"ascii").digest("binary");for(let o=0;o<1e3;++o){let n="";o%2?n+=t:n+=a.substr(0,16),o%3&&(n+=e),o%7&&(n+=t),o%2?n+=a.substr(0,16):n+=t,a=E.createHash("md5").update(n,"ascii").digest("binary")}return s+e+"$"+ht(a)};const R=D(pt),gt="./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function mt({username:t,password:e,algorithm:s,salt:r=null,saltRounds:a=10}){const o=d=>H([...gt],d).join("");let n;const i=r||o(s==="sha512"?16:8),u=/[^\x00-\x7F]/;switch(s){case"bcrypt":n=J(e,a);break;case"md5":if(u.test(e))throw new Error(B("tools.htpasswd-generator.service.text.md5-does-not-currently-support-non-ascii-characters"));n=R(e,`$1$${i}`);break;case"apr1":if(u.test(e))throw new Error(B("tools.htpasswd-generator.service.text.md5-does-not-currently-support-non-ascii-characters-0"));n=R(e,`$apr1$${i}`);break;case"sha256":n=M(e,`$5$${i}`);break;case"sha512":n=M(e,`$6$${i}`);break;default:throw new Error(B("tools.htpasswd-generator.service.text.unsupported-algorithm"))}return`${t}:${n}`}const Ft=N({__name:"htpasswd-generator",setup(t){const{t:e}=F(),s=$(""),r=$(""),a=$("bcrypt"),o=$(10),n=[{value:"bcrypt",label:e("tools.htpasswd-generator.texts.label-bcrypt")},{value:"md5",label:e("tools.htpasswd-generator.texts.label-md5")},{value:"apr1",label:e("tools.htpasswd-generator.texts.label-apache-md5-apr1")},{value:"sha256",label:e("tools.htpasswd-generator.texts.label-sha256")},{value:"sha512",label:e("tools.htpasswd-generator.texts.label-sha512")}],i=P(()=>s.value===""||r.value===""?"# username and password must not be empty":mt({username:s.value,password:r.value,saltRounds:o.value,algorithm:a.value}));return(u,d)=>{const v=T,x=Z,A=G,f=Y,w=tt;return k(),q("div",null,[m(v,{value:c(s),"onUpdate:value":d[0]||(d[0]=h=>S(s)?s.value=h:null),label:c(e)("tools.htpasswd-generator.texts.label-username"),placeholder:c(e)("tools.htpasswd-generator.texts.placeholder-your-username"),clearable:"","raw-text":"","mb-5":""},null,8,["value","label","placeholder"]),m(v,{value:c(r),"onUpdate:value":d[1]||(d[1]=h=>S(r)?r.value=h:null),label:c(e)("tools.htpasswd-generator.texts.label-password"),placeholder:c(e)("tools.htpasswd-generator.texts.placeholder-your-password"),clearable:"","raw-text":"","mb-2":"",type:"password"},null,8,["value","label","placeholder"]),m(x,{value:c(a),"onUpdate:value":d[2]||(d[2]=h=>S(a)?a.value=h:null),label:c(e)("tools.htpasswd-generator.texts.label-hash-method"),options:n,"mb-2":""},null,8,["value","label"]),c(a)==="bcrypt"?(k(),V(f,{key:0,label:c(e)("tools.htpasswd-generator.texts.label-salt-rounds"),"label-placement":"left","label-width":"120"},{default:I(()=>[m(A,{value:c(o),"onUpdate:value":d[3]||(d[3]=h=>S(o)?o.value=h:null),placeholder:c(e)("tools.htpasswd-generator.texts.placeholder-salt-rounds"),max:100,min:0,"w-full":""},null,8,["value","placeholder"])]),_:1},8,["label"])):O("",!0),m(w),m(f,{label:c(e)("tools.htpasswd-generator.texts.label-htpasswd-content")},{default:I(()=>[m(X,{value:c(i)},null,8,["value"])]),_:1},8,["label"])])}}});export{Ft as default};
