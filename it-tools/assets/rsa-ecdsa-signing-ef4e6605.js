import{d as O,a0 as $,r,o as g,c as j,k as a,w as n,a as f,l as e,m as u,j as _,a6 as y,G as h,ad as b,x as A,ae as D,ag as G,af as H}from"./index-0c1fde36.js";import{s as P}from"./index-522ff296.js";import{a as S}from"./catchedComputed-1286d939.js";import{_ as T}from"./TextareaCopyable-59231e95.js";import{_ as I}from"./FormItem-1b9a5952.js";import{N as R}from"./Alert-a9fb131b.js";import"./index-a6f01dde.js";import"./assert-53be9de1.js";import"./index-fdbe2ce9.js";import"./string_decoder-8ac4312e.js";import"./index-649b5bab.js";import"./inherits_browser-6f38ab1b.js";import"./index-0397ab6f.js";import"./index-b4fd5f8c.js";import"./safer-073402ba.js";import"./index-892bd980.js";import"./browser-703720a1.js";import"./hash-f152040d.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./base64-ae7cf34b.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./context-00991937.js";const q={flex:"","flex-1":"","flex-col":"","gap-2":""},F={flex:"","flex-1":"","flex-col":"","gap-2":""},he=O({__name:"rsa-ecdsa-signing",setup(J){const{t}=$(),B=["sha1","sha256","sha384","sha512","md5"],c=r(""),d=r(""),i=r(""),[k,K]=S(()=>{const l=P.parseKey(i.value,"auto").createVerify();return l.update(c.value),l.verify(d.value)},{defaultValue:"",defaultErrorMessage:"Unable to verify your text"}),m=r(""),p=r(""),v=r(""),x=r("sha1"),[U,z]=S(()=>{const l=P.parsePrivateKey(p.value,"auto",{passphrase:v.value}).createSign(x.value);l.update(m.value);const o=l.sign();return{asn1:o.toString("asn1"),ssh:o.toString("ssh")}},{defaultValue:{asn1:"",ssh:""},defaultErrorMessage:"Unable to sign your text"});return(V,l)=>{const o=A,C=D,w=G,N=I,E=H,M=R;return g(),j("div",null,[a(E,{title:e(t)("tools.rsa-ecdsa-signing.texts.title-sign")},{default:n(()=>[f("div",null,[a(o,{value:e(m),"onUpdate:value":l[0]||(l[0]=s=>u(m)?m.value=s:null),label:e(t)("tools.rsa-ecdsa-signing.texts.label-your-text"),placeholder:e(t)("tools.rsa-ecdsa-signing.texts.placeholder-the-string-to-sign"),rows:"4",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),a(C,{value:e(x),"onUpdate:value":l[1]||(l[1]=s=>u(x)?x.value=s:null),label:e(t)("tools.rsa-ecdsa-signing.texts.label-hash-type"),options:B,placeholder:e(t)("tools.rsa-ecdsa-signing.texts.placeholder-select-the-hashing-algorithm")},null,8,["value","label","placeholder"]),f("div",q,[a(o,{value:e(p),"onUpdate:value":l[2]||(l[2]=s=>u(p)?p.value=s:null),label:e(t)("tools.rsa-ecdsa-signing.texts.label-your-private-key"),placeholder:e(t)("tools.rsa-ecdsa-signing.texts.placeholder-the-private-key-to-use-to-sign-message"),rows:"5",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),a(o,{value:e(v),"onUpdate:value":l[3]||(l[3]=s=>u(v)?v.value=s:null),label:e(t)("tools.rsa-ecdsa-signing.texts.label-your-private-key-password"),clearable:"","raw-text":""},null,8,["value","label"])])]),e(z)&&e(p)!==""?(g(),_(w,{key:0,type:"error","mt-12":"",title:e(t)("tools.rsa-ecdsa-signing.texts.title-error-while-signing")},{default:n(()=>[y(h(e(z)),1)]),_:1},8,["title"])):b("",!0),a(N,{label:e(t)("tools.rsa-ecdsa-signing.texts.label-asn1-signature"),"mt-3":""},{default:n(()=>[a(T,{value:e(U)?.asn1||"",placeholder:e(t)("tools.rsa-ecdsa-signing.texts.placeholder-asn1-signature"),multiline:"",monospace:"",readonly:"",autosize:"","mt-5":""},null,8,["value","placeholder"])]),_:1},8,["label"]),a(N,{label:e(t)("tools.rsa-ecdsa-signing.texts.label-ssh-signature"),"mt-3":""},{default:n(()=>[a(T,{value:e(U)?.ssh||"",placeholder:e(t)("tools.rsa-ecdsa-signing.texts.placeholder-ssg-signature"),multiline:"",monospace:"",readonly:"",autosize:"","mt-5":""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["title"]),a(E,{title:e(t)("tools.rsa-ecdsa-signing.texts.title-verify")},{default:n(()=>[f("div",null,[a(o,{value:e(c),"onUpdate:value":l[4]||(l[4]=s=>u(c)?c.value=s:null),label:e(t)("tools.rsa-ecdsa-signing.texts.label-your-text-to-verify"),placeholder:e(t)("tools.rsa-ecdsa-signing.texts.placeholder-the-string-to-verify"),rows:"4",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),a(o,{value:e(d),"onUpdate:value":l[5]||(l[5]=s=>u(d)?d.value=s:null),label:e(t)("tools.rsa-ecdsa-signing.texts.label-associated-signature"),placeholder:e(t)("tools.rsa-ecdsa-signing.texts.placeholder-text-signature"),rows:"4",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),f("div",F,[a(o,{value:e(i),"onUpdate:value":l[6]||(l[6]=s=>u(i)?i.value=s:null),label:e(t)("tools.rsa-ecdsa-signing.texts.label-public-key"),placeholder:e(t)("tools.rsa-ecdsa-signing.texts.placeholder-public-key"),rows:"5",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"])])]),e(K)&&e(i)!==""?(g(),_(w,{key:0,type:"error","mt-12":"",title:e(t)("tools.rsa-ecdsa-signing.texts.title-error-while-verifying")},{default:n(()=>[y(h(e(K)),1)]),_:1},8,["title"])):b("",!0),e(k)&&e(i)!==""?(g(),_(w,{key:1,type:"error","mt-12":"",title:e(t)("tools.rsa-ecdsa-signing.texts.title-signature-failed")},{default:n(()=>[y(h(e(t)("tools.rsa-ecdsa-signing.texts.tag-signature-is-not-valid-for-the-given-text")),1)]),_:1},8,["title"])):b("",!0),!e(k)&&e(i)!==""?(g(),_(M,{key:2,type:"success","mt-12":"",title:e(t)("tools.rsa-ecdsa-signing.texts.title-signature-verified")},{default:n(()=>[y(h(e(t)("tools.rsa-ecdsa-signing.texts.tag-signature-is-valid-for-the-given-text")),1)]),_:1},8,["title"])):b("",!0)]),_:1},8,["title"])])}}});export{he as default};
