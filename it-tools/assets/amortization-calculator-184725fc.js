import{d as $,a0 as E,r as A,i as b,ac as C,R as I,o as h,c as P,k as g,w as B,l as a,m as R,a as n,G as s,a7 as S,a8 as G,ad as K,x as Q,ae as j,af as q}from"./index-0c1fde36.js";import{_ as H}from"./Table-4b7ecda9.js";class y{static validateLoanAmount(t){return y.validatePositive(t)}static validateLoanMonths(t){return y.validatePositiveInteger(t)}static validateInterestRate(t){return y.validateFractional(t)}*getAmortizationSchedule(t){let e=0,l=0,i=0;for(;e<t.numberOfPayments;){const r=this.getNth(t,++e);l+=r.principalPayment,i+=r.interestPayment,yield{...r,type:"month"},e%12===0&&(yield{...r,paymentIndex:e/12,principalPayment:l,interestPayment:i,type:"year"},l=0,i=0)}}getPayment(t){const e=this.getCacheString(t),l=this.paymentCache.get(e);if(!l){const i=this.calculatePayment(t),r=this.calculateTotalPayments(t,i),u={payment:i,totalPayments:r};return this.paymentCache.set(e,u),u}return l}paymentCache=new Map;calculatePayment({principal:t,periodInterestRate:e,numberOfPayments:l}){if(e===0)return t/l;const i=e*(1+e)**l,r=(1+e)**l-1;return t*(i/r)}calculateTotalPayments({numberOfPayments:t},e){return e*t}getCacheString({principal:t,periodInterestRate:e,numberOfPayments:l}){return`principal:${t};interest-rate:${e};number-of-payments:${l}`}static validatePositiveInteger(t){const e=Number(t);return!Number.isNaN(e)&&Number.isSafeInteger(e)&&e>0}static validateFractional(t){const e=Number(t);return!Number.isNaN(e)&&Number.isFinite(e)&&e<=100&&e>0}static validatePositive(t){const e=Number(t);return!Number.isNaN(e)&&Number.isFinite(e)&&e>0}}class J extends y{getNth(t,e){const{payment:l,totalPayments:i}=this.getPayment(t),{principal:r,periodInterestRate:u,numberOfPayments:v}=t;if(u===0){const m=r/v,V=r-m*e;return{payment:l,totalPayments:i,remainingBalance:Math.max(0,V),interestPayment:0,principalPayment:m,paymentIndex:e}}const _=1+u,f=r*_**(e-1)-l*((_**(e-1)-1)/u),c=f*u,N=l-c,z=f-N;return{payment:l,totalPayments:i,remainingBalance:z,interestPayment:c,principalPayment:N,paymentIndex:e}}}const W={key:0},Z=$({__name:"amortization-calculator",setup(D){const{t,locale:e}=E(),l=A(new J),i=b(()=>new Intl.DisplayNames(e.value,{type:"currency"})),r=A(Intl.supportedValuesOf("currency").map(x=>({value:x,label:i.value.of(x)}))),u=C({name:"selectedCurrency",storageName:"amortization-calculator:selectedCurrency",defaultValue:"USD"}),v=C({name:"amount",storageName:"amortization-calculator:amount",defaultValue:"200000"}),_=I({source:v,rules:[{message:t("tools.amortization-calculator.texts.message-loan-amount-must-be-positive"),validator:y.validateLoanAmount}]}),f=b(()=>Number(v.value)),c=C({name:"months",storageName:"amortization-calculator:months",defaultValue:"360"}),N=I({source:c,rules:[{message:t("tools.amortization-calculator.texts.message-loan-term-must-be-positive-integer"),validator:y.validateLoanMonths}]}),z=b(()=>Number(c.value)),m=C({name:"interestRate",storageName:"amortization-calculator:interestRate",defaultValue:"6"}),V=I({source:m,rules:[{message:t("tools.amortization-calculator.texts.message-interest-rate-must-be-between-1-and-100"),validator:y.validateInterestRate}]}),L=b(()=>Number(m.value)),F=b(()=>V.isValid&&N.isValid&&_.isValid),k=b(()=>l.value.getPayment({principal:f.value,periodInterestRate:L.value/1200,numberOfPayments:z.value})),U=b(()=>(u.value,l.value.getAmortizationSchedule({principal:f.value,periodInterestRate:L.value/1200,numberOfPayments:z.value})));function d(x){return x.toLocaleString(void 0,{style:"currency",currency:u.value,signDisplay:"negative"})}return(x,p)=>{const w=Q,O=j,T=q,M=H;return h(),P(S,null,[g(T,{title:a(t)("tools.amortization-calculator.texts.title-loan-parameters"),"mb-5":""},{default:B(()=>[g(w,{value:a(v),"onUpdate:value":p[0]||(p[0]=o=>R(v)?v.value=o:null),placeholder:"e.g. 200000",label:a(t)("tools.amortization-calculator.texts.label-loan-amount"),"raw-text":"","mb-5":"",validation:a(_)},null,8,["value","label","validation"]),g(w,{value:a(c),"onUpdate:value":p[1]||(p[1]=o=>R(c)?c.value=o:null),placeholder:"e.g. 360",label:a(t)("tools.amortization-calculator.texts.label-loan-term"),"raw-text":"","mb-5":"",validation:a(N)},null,8,["value","label","validation"]),g(w,{value:a(m),"onUpdate:value":p[2]||(p[2]=o=>R(m)?m.value=o:null),placeholder:"e.g. 6.0",label:a(t)("tools.amortization-calculator.texts.label-interest-rate"),"raw-text":"","mb-5":"",validation:a(V)},null,8,["value","label","validation"]),g(O,{value:a(u),"onUpdate:value":p[3]||(p[3]=o=>R(u)?u.value=o:null),options:a(r),label:a(t)("tools.amortization-calculator.texts.label-displayed-currency"),"mb-5":""},null,8,["value","options","label"])]),_:1},8,["title"]),a(F)?(h(),P("div",W,[g(M,{"mb-5":""},{default:B(()=>[n("thead",null,[n("tr",null,[n("th",null,s(a(t)("tools.amortization-calculator.texts.label-monthly-payment")),1),n("th",null,s(a(t)("tools.amortization-calculator.texts.label-total-of-payments")),1)])]),n("tbody",null,[n("tr",null,[n("td",null,s(d(a(k).payment)),1),n("td",null,s(d(a(k).totalPayments)),1)])])]),_:1}),g(M,null,{default:B(()=>[n("thead",null,[n("tr",null,[n("th",null,s(a(t)("tools.amortization-calculator.texts.label-month")),1),n("th",null,s(a(t)("tools.amortization-calculator.texts.label-interest")),1),n("th",null,s(a(t)("tools.amortization-calculator.texts.label-principal")),1),n("th",null,s(a(t)("tools.amortization-calculator.texts.label-ending-balance")),1)])]),n("tbody",null,[(h(!0),P(S,null,G(a(U),o=>(h(),P("tr",{key:o.type+o.paymentIndex},[o.type==="month"?(h(),P(S,{key:0},[n("td",null,s(o.paymentIndex),1),n("td",null,s(d(o.interestPayment)),1),n("td",null,s(d(o.principalPayment)),1),n("td",null,s(d(o.remainingBalance)),1)],64)):(h(),P(S,{key:1},[n("th",null,s(a(t)("tools.amortization-calculator.texts.label-end-of-year",{year:o.paymentIndex})),1),n("th",null,s(d(o.interestPayment)),1),n("th",null,s(d(o.principalPayment)),1),n("th",null,s(d(o.remainingBalance)),1)],64))]))),128))])]),_:1})])):K("",!0)],64)}}});export{Z as default};
