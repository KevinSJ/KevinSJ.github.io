function m(e){return e.includes(":")?6:e.includes(".")?4:0}function g(e){const t=m(e);if(!t)throw new Error(`Invalid IP address: ${e}`);let n=0n,s=0n;const r=Object.create(null);if(t===4)for(const l of e.split(".").map(BigInt).reverse())n+=l*2n**s,s+=8n;else{if(e.includes(".")&&(r.ipv4mapped=!0,e=e.split(":").map(o=>{if(o.includes(".")){const[u,f,i,c]=o.split(".").map(d=>Number(d).toString(16).padStart(2,"0"));return`${u}${f}:${i}${c}`}else return o}).join(":")),e.includes("%")){let o;[,e,o]=/(.+)%(.+)/.exec(e)||[],r.scopeid=o}const l=e.split(":"),a=l.indexOf("");if(a!==-1)for(;l.length<8;)l.splice(a,0,"");for(const o of l.map(u=>BigInt(parseInt(u||"0",16))).reverse())n+=o*2n**s,s+=16n}return r.number=n,r.version=t,r}function $({number:e,version:t,ipv4mapped:n,scopeid:s},{compress:r=!0,hexify:l=!1}={}){let a=t===4?24n:112n;const o=t===4?8n:16n;let u=e;const f=[];for(;a>0n;){const i=2n**a;f.push(u/i),u=e%i,a-=o}if(f.push(u),t===4)return f.join(".");{let i="";if(n&&!l){for(const[c,d]of f.entries())c<6?i+=`${d.toString(16)}:`:i+=`${String(d>>8n)}.${String(d&255n)}${c===6?".":""}`;r&&(i=p(i.split(":")))}else r?i=p(f.map(c=>c.toString(16))):i=f.map(c=>c.toString(16)).join(":");return s?`${i}%${s}`:i}}function I(e,{compress:t=!0,hexify:n=!1}={}){return $(g(e),{compress:t,hexify:n})}function p(e){let t=null,n=null;for(const[s,r]of e.entries())r==="0"?n?n.add(s):n=new Set([s]):n&&((!t||n.size>t.size)&&(t=n),n=null);(!t&&n||n&&t&&n.size>t.size)&&(t=n);for(const s of t||[])e[s]=":";return e.filter(Boolean).join(":").replace(/:{2,}/,"::")}export{m as i,I as n,g as p,$ as s};
