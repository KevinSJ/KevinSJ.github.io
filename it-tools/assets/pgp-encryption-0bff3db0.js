import{d as j,a0 as O,r as s,o as b,c as R,j as z,w as n,a6 as m,G as i,l as e,k as r,ad as C,a as u,m as c,ag as W,x as Y,af as q}from"./index-0c1fde36.js";import{_ as D}from"./TextareaCopyable-59231e95.js";import{R as G,_ as A,l as B,Y as S,g as F,i as H,n as J,p as L}from"./openpgp.min-274e41ac.js";import{c as N}from"./catchedComputed-1286d939.js";import{_ as Q}from"./a-07fc27a5.js";import{_ as X}from"./FormItem-1b9a5952.js";import"./base64-ae7cf34b.js";import"./index-a6f01dde.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./index-892bd980.js";import"./browser-703720a1.js";import"./index-649b5bab.js";import"./inherits_browser-6f38ab1b.js";import"./index-0397ab6f.js";import"./index-fdbe2ce9.js";import"./string_decoder-8ac4312e.js";import"./hash-f152040d.js";import"./context-00991937.js";const Z={flex:"","flex-1":"","flex-col":"","gap-2":""},ee={flex:"","flex-1":"","flex-col":"","gap-2":""},ke=j({__name:"pgp-encryption",setup(te){const{t}=O();G.rejectCurves=new Set;const f=s(""),g=s(""),w=s(""),h=s(""),[I,T]=N(async()=>{const x=g.value,o=w.value,y=h.value,p=f.value,a=await A({armoredKey:x}),d=o!==""?y!==""?await B({privateKey:await S({armoredKey:o}),passphrase:y}):await S({armoredKey:o}):void 0;return await F({message:await H({text:p}),encryptionKeys:a,signingKeys:d})},{defaultValue:"",defaultErrorMessage:"Unable to encrypt your text"}),K=s(""),k=s(""),v=s(""),U=s(""),[P,V]=N(async()=>{const x=k.value,o=v.value,y=U.value,p=K.value,a=x!==""?await A({armoredKey:x}):void 0,d=y!==""?await B({privateKey:await S({armoredKey:o}),passphrase:y}):await S({armoredKey:o}),E=await J({armoredMessage:p}),{data:_,signatures:l}=await L({message:E,verificationKeys:a,decryptionKeys:d});if(l.length>0)try{await l[0].verified}catch($){return{decryptedText:_,signatureError:`Signature could not be verified: ${$.toString()}`}}return{decryptedText:_,signatureError:""}},{defaultValue:{decryptedText:"",signatureError:""},defaultErrorMessage:"Unable to encrypt your text"});function M(){return window.isSecureContext}return(x,o)=>{const y=Q,p=W,a=Y,d=D,E=X,_=q;return b(),R("div",null,[M()?C("",!0):(b(),z(p,{key:0,"mb-2":""},{default:n(()=>[m(i(e(t)("tools.pgp-encryption.texts.tag-your-browser-is-not-in")),1),r(y,{href:"https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts",target:"_blank"},{default:n(()=>[m(i(e(t)("tools.pgp-encryption.texts.tag-secure-context-https")),1)]),_:1}),m(i(e(t)("tools.pgp-encryption.texts.tag-this-tool-may-not-work-correctly-and-require-https-to-work-fully")),1)]),_:1})),r(_,{title:e(t)("tools.pgp-encryption.texts.title-encrypt"),"mb-2":""},{default:n(()=>[u("div",null,[r(a,{value:e(f),"onUpdate:value":o[0]||(o[0]=l=>c(f)?f.value=l:null),label:e(t)("tools.pgp-encryption.texts.label-your-text"),placeholder:e(t)("tools.pgp-encryption.texts.placeholder-the-string-to-encrypt"),rows:"4",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),u("div",Z,[r(a,{value:e(g),"onUpdate:value":o[1]||(o[1]=l=>c(g)?g.value=l:null),label:e(t)("tools.pgp-encryption.texts.label-target-public-key"),placeholder:e(t)("tools.pgp-encryption.texts.placeholder-target-public-key"),rows:"5",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),u("details",null,[u("summary",null,i(e(t)("tools.pgp-encryption.texts.tag-signing-private-key-optional")),1),r(a,{value:e(w),"onUpdate:value":o[2]||(o[2]=l=>c(w)?w.value=l:null),label:e(t)("tools.pgp-encryption.texts.label-your-private-key"),placeholder:e(t)("tools.pgp-encryption.texts.placeholder-the-private-key-to-use-to-sign-message"),rows:"5",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),r(a,{value:e(h),"onUpdate:value":o[3]||(o[3]=l=>c(h)?h.value=l:null),label:e(t)("tools.pgp-encryption.texts.label-your-private-key-password"),clearable:"","raw-text":""},null,8,["value","label"])])])]),e(T)&&e(g)!==""?(b(),z(p,{key:0,type:"error","mt-12":"",title:e(t)("tools.pgp-encryption.texts.title-error-while-encrypting")},{default:n(()=>[m(i(e(T)),1)]),_:1},8,["title"])):C("",!0),r(E,{label:e(t)("tools.pgp-encryption.texts.label-your-text-encrypted"),"mt-3":""},{default:n(()=>[r(d,{value:e(I)||"",rows:"3",placeholder:e(t)("tools.pgp-encryption.texts.placeholder-your-string-encrypted"),multiline:"",monospace:"",readonly:"",autosize:"","mt-5":""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["title"]),r(_,{title:e(t)("tools.pgp-encryption.texts.title-decrypt")},{default:n(()=>[u("div",null,[r(a,{value:e(K),"onUpdate:value":o[4]||(o[4]=l=>c(K)?K.value=l:null),label:e(t)("tools.pgp-encryption.texts.label-your-pgp-message-to-decrypt"),placeholder:e(t)("tools.pgp-encryption.texts.placeholder-the-string-to-decrypt"),rows:"4",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),u("div",ee,[r(a,{value:e(v),"onUpdate:value":o[5]||(o[5]=l=>c(v)?v.value=l:null),label:e(t)("tools.pgp-encryption.texts.label-your-private-key"),placeholder:e(t)("tools.pgp-encryption.texts.placeholder-the-private-key-to-use-to-decrypt-message"),rows:"5",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"]),r(a,{value:e(U),"onUpdate:value":o[6]||(o[6]=l=>c(U)?U.value=l:null),label:e(t)("tools.pgp-encryption.texts.label-your-private-key-password"),clearable:"","raw-text":""},null,8,["value","label"]),u("details",null,[u("summary",null,i(e(t)("tools.pgp-encryption.texts.tag-signing-public-key-optional")),1),r(a,{value:e(k),"onUpdate:value":o[7]||(o[7]=l=>c(k)?k.value=l:null),label:e(t)("tools.pgp-encryption.texts.label-sender-public-key"),placeholder:e(t)("tools.pgp-encryption.texts.placeholder-sender-public-key"),rows:"5",multiline:"","raw-text":"",monospace:"",autosize:"","flex-1":""},null,8,["value","label","placeholder"])])])]),e(V)&&e(v)!==""?(b(),z(p,{key:0,type:"error","mt-3":"",title:e(t)("tools.pgp-encryption.texts.title-error-while-decrypting")},{default:n(()=>[m(i(e(V)),1)]),_:1},8,["title"])):C("",!0),e(P)?.signatureError!==""?(b(),z(p,{key:1,type:"error","mt-3":"",title:e(t)("tools.pgp-encryption.texts.title-signature-verification")},{default:n(()=>[m(i(e(P)?.signatureError),1)]),_:1},8,["title"])):C("",!0),r(E,{label:e(t)("tools.pgp-encryption.texts.label-your-text-decrypted"),"mt-3":""},{default:n(()=>[r(d,{value:e(P)?.decryptedText||"",rows:"3",placeholder:e(t)("tools.pgp-encryption.texts.placeholder-your-string-decrypted"),multiline:"",monospace:"",readonly:"",autosize:"","mt-5":""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["title"])])}}});export{ke as default};
