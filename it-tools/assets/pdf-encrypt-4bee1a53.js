import{_ as Y}from"./InputCopyable.vue_vue_type_script_setup_true_lang-294ac243.js";import{d as Z,a0 as ee,r as c,ac as i,o as P,c as te,a as d,k as o,l as t,G as s,a6 as p,w as a,m as u,j as R,ad as S,aW as le,ae as oe,af as ne,ah as ae,s as se,ag as re}from"./index-0c1fde36.js";import{g as pe}from"./base64-ae7cf34b.js";import{q as ce}from"./qpdf-45a7a22a.js";import{a as ie}from"./downloadBase64-508288e2.js";import{_ as ue}from"./Checkbox-ba7202eb.js";import{_ as de}from"./Space-7fc52151.js";import{_ as fe}from"./FormItem-1b9a5952.js";import{_ as me}from"./Divider-5fc425b0.js";import{_ as _e}from"./Spin-885f2a22.js";import"./index-a6f01dde.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./get-slot-1efb97e5.js";import"./context-00991937.js";const ye={style:{flex:"0 0 100%"}},ve={"mx-auto":"","max-w-600px":""},be={"mt-2":"","text-center":""},ge={"mt-3":"",flex:"","justify-center":""},xe={"mt-3":"",flex:"","justify-center":""},qe=Z({__name:"pdf-encrypt",setup(he){const{t:l}=ee(),_=c("idle"),y=c(null),b=i({name:"a11y",storageName:"pdf-encrypt:accessibility",defaultValue:!1}),g=i({name:"annot",storageName:"pdf-encrypt:annotate",defaultValue:!1}),x=i({name:"assemble",storageName:"pdf-encrypt:assemble",defaultValue:!1}),h=i({name:"extract",storageName:"pdf-encrypt:extract",defaultValue:!1}),w=i({name:"form",storageName:"pdf-encrypt:form",defaultValue:!1}),k=i({name:"othermodify",storageName:"pdf-encrypt:modoth",defaultValue:!1}),$=i({name:"clearmeta",storageName:"pdf-encrypt:clearmeta",defaultValue:!1}),N=i({name:"modify",storageName:"pdf-encrypt:mod",defaultValue:"all"}),U=i({name:"print",storageName:"pdf-encrypt:print",defaultValue:"full"}),A=c(""),C=c(""),O=c(""),V=c([]),F=c(""),D=c("pdf"),{download:I}=ie({source:O,filename:F,extension:D}),j=c("");function T(f){y.value=f,F.value=`encrypted_${y.value.name}`}async function W(){if(!y.value)return;const f=await y.value.arrayBuffer();_.value="processing";try{const e=["--verbose","--encrypt"];e.push(`${A.value}`),e.push(`${C.value}`),e.push("128"),e.push("--use-aes=y"),e.push(`--accessibility=${b.value?"n":"y"}`),e.push(`--annotate=${g.value?"n":"y"}`),e.push(`--assemble=${x.value?"n":"y"}`),e.push(`--extract=${h.value?"n":"y"}`),e.push(`--form=${w.value?"n":"y"}`),e.push(`--modify-other=${k.value?"n":"y"}`),e.push(`--modify=${N.value}`),e.push(`--print=${U.value}`),$.value&&e.push("--cleartext-metadata"),e.push("--"),e.push("in.pdf"),e.push("out.pdf");const v=await z(f,e,0);O.value=`data:application/pdf;base64,${pe.fromUint8Array(v)}`,_.value="done",I()}catch{_.value="error"}}async function z(f,e,v){j.value=e.join(" "),V.value=[];const r=await ce({print(m){V.value.push(m)},printErr(m){V.value.push(m)}});r.FS.writeFile("in.pdf",new Uint8Array(f));const B=r.callMain(e);if(v!==B)throw new Error("Process run failed");return r.FS.readFile("out.pdf")}const G=[{value:"none",label:l("tools.pdf-encrypt.texts.label-disallow-printing")},{value:"low",label:l("tools.pdf-encrypt.texts.label-allow-only-low-resolution-printing")},{value:"full",label:l("tools.pdf-encrypt.texts.label-allow-full-printing")}],Q=[{value:"none",label:l("tools.pdf-encrypt.texts.label-allow-no-modifications")},{value:"assembly",label:l("tools.pdf-encrypt.texts.label-allow-document-assembly-only")},{value:"form",label:l("tools.pdf-encrypt.texts.label-allow-document-assembly-only-filling-in-form-fields-and-signing")},{value:"annotate",label:l("tools.pdf-encrypt.texts.label-allow-document-assembly-only-filling-in-form-fields-and-signing-commenting-and-modifying-forms")},{value:"all",label:l("tools.pdf-encrypt.texts.label-allow-full-document-modification")}];return(f,e)=>{const v=le,r=ue,B=de,m=oe,E=ne,M=ae,q=fe,H=se,J=me,K=re,L=_e,X=Y;return P(),te("div",null,[d("div",ye,[d("div",ve,[o(v,{title:t(l)("tools.pdf-encrypt.texts.title-drag-and-drop-a-pdf-file-here-or-click-to-select-a-file"),accept:".pdf",onFileUpload:T},null,8,["title"]),d("div",be,[d("strong",null,s(t(l)("tools.pdf-encrypt.texts.tag-output-file")),1),p(" "+s(t(F)),1)])])]),o(E,{title:t(l)("tools.pdf-encrypt.texts.title-permissions"),"mb-3":"","mt-3":""},{default:a(()=>[o(B,null,{default:a(()=>[o(r,{checked:t(b),"onUpdate:checked":e[0]||(e[0]=n=>u(b)?b.value=n:null)},{default:a(()=>[p(s(t(l)("tools.pdf-encrypt.texts.tag-restrict-accessibility-usually-ignored")),1)]),_:1},8,["checked"]),o(r,{checked:t(g),"onUpdate:checked":e[1]||(e[1]=n=>u(g)?g.value=n:null)},{default:a(()=>[p(s(t(l)("tools.pdf-encrypt.texts.tag-restrict-commenting-filling-form-fields")),1)]),_:1},8,["checked"]),o(r,{checked:t(x),"onUpdate:checked":e[2]||(e[2]=n=>u(x)?x.value=n:null)},{default:a(()=>[p(s(t(l)("tools.pdf-encrypt.texts.tag-restrict-document-assembly")),1)]),_:1},8,["checked"]),o(r,{checked:t(h),"onUpdate:checked":e[3]||(e[3]=n=>u(h)?h.value=n:null)},{default:a(()=>[p(s(t(l)("tools.pdf-encrypt.texts.tag-restrict-text-graphic-extraction")),1)]),_:1},8,["checked"]),o(r,{checked:t(w),"onUpdate:checked":e[4]||(e[4]=n=>u(w)?w.value=n:null)},{default:a(()=>[p(s(t(l)("tools.pdf-encrypt.texts.tag-restrict-filling-form-fields")),1)]),_:1},8,["checked"]),o(r,{checked:t(k),"onUpdate:checked":e[5]||(e[5]=n=>u(k)?k.value=n:null)},{default:a(()=>[p(s(t(l)("tools.pdf-encrypt.texts.tag-restrict-other-modifications")),1)]),_:1},8,["checked"]),o(r,{checked:t($),"onUpdate:checked":e[6]||(e[6]=n=>u($)?$.value=n:null)},{default:a(()=>[p(s(t(l)("tools.pdf-encrypt.texts.tag-prevent-encryption-of-metadata")),1)]),_:1},8,["checked"])]),_:1}),o(m,{value:t(N),"onUpdate:value":e[7]||(e[7]=n=>u(N)?N.value=n:null),options:Q,label:t(l)("tools.pdf-encrypt.texts.label-control-modify-access-by-level"),"mt-3":""},null,8,["value","label"]),o(m,{value:t(U),"onUpdate:value":e[8]||(e[8]=n=>u(U)?U.value=n:null),options:G,label:t(l)("tools.pdf-encrypt.texts.label-control-printing-access"),"mt-3":""},null,8,["value","label"])]),_:1},8,["title"]),o(q,{label:t(l)("tools.pdf-encrypt.texts.label-owner-password"),"label-placement":"left","mb-1":""},{default:a(()=>[o(M,{value:t(C),type:"password",placeholder:t(l)("tools.pdf-encrypt.texts.placeholder-owner-password-optional")},null,8,["value","placeholder"])]),_:1},8,["label"]),o(q,{label:t(l)("tools.pdf-encrypt.texts.label-user-password"),"label-placement":"left","mb-1":""},{default:a(()=>[o(M,{value:t(A),type:"password",placeholder:t(l)("tools.pdf-encrypt.texts.placeholder-user-password-optional")},null,8,["value","placeholder"])]),_:1},8,["label"]),d("div",ge,[o(H,{disabled:!t(y),onClick:e[9]||(e[9]=n=>W())},{default:a(()=>[p(s(t(l)("tools.pdf-encrypt.texts.tag-encrypt-pdf")),1)]),_:1},8,["disabled"])]),o(J),d("div",xe,[t(_)==="error"?(P(),R(K,{key:0,type:"error"},{default:a(()=>[p(" An error occured processing "+s(t(F)),1)]),_:1})):S("",!0),t(_)==="processing"?(P(),R(L,{key:1,size:"small"})):S("",!0)]),o(E,{title:t(l)("tools.pdf-encrypt.texts.title-logs")},{default:a(()=>[o(X,{label:t(l)("tools.pdf-encrypt.texts.label-qpdf"),value:t(j),"mb-1":""},null,8,["label","value"]),d("pre",null,s(t(V).join(`
`)),1)]),_:1},8,["title"])])}}});export{qe as default};
