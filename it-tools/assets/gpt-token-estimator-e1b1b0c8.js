import{_ as M}from"./InputCopyable.vue_vue_type_script_setup_true_lang-294ac243.js";import{d as R,a0 as D,ac as E,r as g,R as U,aX as x,i as O,o as k,c as w,k as o,l as e,m,a as Q,w as n,j as T,a6 as j,G as V,ad as S,ae as X,x as q,af as z,ag as F}from"./index-0c1fde36.js";import{G as $}from"./gpt-tokens.service-cc57640e.js";import{_ as H}from"./Checkbox-ba7202eb.js";import{_ as K}from"./FormItem-1b9a5952.js";import{_ as L}from"./Divider-5fc425b0.js";import{_ as W}from"./a-07fc27a5.js";import{_ as Y}from"./p-77eb774b.js";import"./index-50a5cdf9.js";import"./context-00991937.js";const Z={flex:"","justify-center":""},ee={key:3},ce=R({__name:"gpt-token-estimator",setup(te){const{t}=D(),A=$.supportModels,v=E({name:"model",storageName:"gpt-counter:model",defaultValue:"gpt-3.5-turbo-1106"}),i=g(""),c=g(""),d=g(!1),r=g(""),p=g(""),C=U({source:r,rules:[{message:t("tools.gpt-token-estimator.texts.message-invalid-messages-array"),validator:s=>s&&x.parse(s.trim())}]}),N=U({source:p,rules:[{message:t("tools.gpt-token-estimator.texts.message-invalid-tools-array"),validator:s=>s&&x.parse(s.trim())}]}),u=O(()=>{try{let s=[],l=[];if(d.value?(s=r.value?x.parse(r.value.trim()):[],l=p.value?x.parse(p.value.trim()):[]):(i.value&&s.push({role:"system",content:i.value}),c.value&&s.push({role:"user",content:c.value})),!s.length)return{error:"",usedTokens:"0",promptUsedTokens:"0",completionUsedTokens:"0"};const _=new $({model:v.value,messages:s,tools:l});return{error:"",usedTokens:_.usedTokens.toString(),promptUsedTokens:_.promptUsedTokens.toString(),completionUsedTokens:_.completionUsedTokens.toString()}}catch(s){return{error:s.toString(),usedTokens:"",promptUsedTokens:"",completionUsedTokens:""}}});return(s,l)=>{const _=X,B=H,f=K,b=q,h=z,P=L,G=F,y=M,I=W,J=Y;return k(),w("div",null,[o(_,{value:e(v),"onUpdate:value":l[0]||(l[0]=a=>m(v)?v.value=a:null),"label-position":"left",label:e(t)("tools.gpt-token-estimator.texts.label-model"),options:e(A),placeholder:e(t)("tools.gpt-token-estimator.texts.placeholder-select-gpt-model"),"mb-2":""},null,8,["value","label","options","placeholder"]),Q("div",Z,[o(f,{label:e(t)("tools.gpt-token-estimator.texts.label-advanded-json-mode"),"label-placement":"left"},{default:n(()=>[o(B,{checked:e(d),"onUpdate:checked":l[1]||(l[1]=a=>m(d)?d.value=a:null),"mr-2":""},null,8,["checked"])]),_:1},8,["label"])]),e(d)?(k(),T(h,{key:0,title:e(t)("tools.gpt-token-estimator.texts.title-prompts")},{default:n(()=>[o(b,{value:e(r),"onUpdate:value":l[2]||(l[2]=a=>m(r)?r.value=a:null),multiline:"","raw-text":"",placeholder:e(t)("tools.gpt-token-estimator.texts.placeholder-your-messages-json-array"),rows:"5",autofocus:"",label:e(t)("tools.gpt-token-estimator.texts.label-your-messages-json-array"),validation:e(C)},null,8,["value","placeholder","label","validation"]),o(b,{value:e(p),"onUpdate:value":l[3]||(l[3]=a=>m(p)?p.value=a:null),multiline:"","raw-text":"",placeholder:e(t)("tools.gpt-token-estimator.texts.placeholder-your-tools-json-array"),rows:"5",autofocus:"",label:e(t)("tools.gpt-token-estimator.texts.label-your-tools-json-array"),validation:e(N)},null,8,["value","placeholder","label","validation"])]),_:1},8,["title"])):(k(),T(h,{key:1,title:e(t)("tools.gpt-token-estimator.texts.title-input-json-s")},{default:n(()=>[o(b,{value:e(i),"onUpdate:value":l[4]||(l[4]=a=>m(i)?i.value=a:null),multiline:"","raw-text":"",placeholder:e(t)("tools.gpt-token-estimator.texts.placeholder-your-system-prompt-content"),rows:"2",autofocus:"",label:e(t)("tools.gpt-token-estimator.texts.label-your-system-prompt-content")},null,8,["value","placeholder","label"]),o(b,{value:e(c),"onUpdate:value":l[5]||(l[5]=a=>m(c)?c.value=a:null),multiline:"","raw-text":"",placeholder:e(t)("tools.gpt-token-estimator.texts.placeholder-your-user-prompt-content"),rows:"6",autofocus:"",label:e(t)("tools.gpt-token-estimator.texts.label-your-user-prompt-content")},null,8,["value","placeholder","label"])]),_:1},8,["title"])),o(P),e(u).error?(k(),T(G,{key:2},{default:n(()=>[j(V(e(u).error),1)]),_:1})):S("",!0),e(u).error?S("",!0):(k(),w("div",ee,[o(f,{label:e(t)("tools.gpt-token-estimator.texts.label-used-tokens"),"label-placement":"left"},{default:n(()=>[o(y,{value:e(u).usedTokens},null,8,["value"])]),_:1},8,["label"]),o(f,{label:e(t)("tools.gpt-token-estimator.texts.label-prompt-tokens"),"label-placement":"left"},{default:n(()=>[o(y,{value:e(u).promptUsedTokens},null,8,["value"])]),_:1},8,["label"]),o(f,{label:e(t)("tools.gpt-token-estimator.texts.label-completion-tokens"),"label-placement":"left"},{default:n(()=>[o(y,{value:e(u).completionUsedTokens},null,8,["value"])]),_:1},8,["label"]),o(J,{"mt-3":""},{default:n(()=>[o(I,{href:"https://platform.openai.com/docs/pricing",target:"_blank"},{default:n(()=>[j(V(e(t)("tools.gpt-token-estimator.texts.tag-see-openapi-pricings")),1)]),_:1})]),_:1})]))])}}});export{ce as default};
