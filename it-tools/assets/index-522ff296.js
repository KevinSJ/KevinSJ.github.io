import{Q as ua,b as ca}from"./index-0c1fde36.js";import{B as Wi}from"./index-a6f01dde.js";import{r as pi}from"./assert-53be9de1.js";import{s as Ji,u as Pr}from"./index-fdbe2ce9.js";import{s as Qe}from"./safer-073402ba.js";import{r as pt}from"./index-892bd980.js";import{c as ha}from"./_commonjs-dynamic-modules-302442b1.js";var qr=pi(),pa=Ji.Stream,da=Pr,la=/^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$/;function zr(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Ot(t,r,p,D,A){throw new qr.AssertionError({message:da.format("%s (%s) is required",t,r),actual:A===void 0?typeof D:A(D),expected:r,operator:p||"===",stackStartFunction:Ot.caller})}function Kr(t){return Object.prototype.toString.call(t).slice(8,-1)}function Ht(){}var sr={bool:{check:function(t){return typeof t=="boolean"}},func:{check:function(t){return typeof t=="function"}},string:{check:function(t){return typeof t=="string"}},object:{check:function(t){return typeof t=="object"&&t!==null}},number:{check:function(t){return typeof t=="number"&&!isNaN(t)}},finite:{check:function(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}},buffer:{check:function(t){return Wi.isBuffer(t)},operator:"Buffer.isBuffer"},array:{check:function(t){return Array.isArray(t)},operator:"Array.isArray"},stream:{check:function(t){return t instanceof pa},operator:"instanceof",actual:Kr},date:{check:function(t){return t instanceof Date},operator:"instanceof",actual:Kr},regexp:{check:function(t){return t instanceof RegExp},operator:"instanceof",actual:Kr},uuid:{check:function(t){return typeof t=="string"&&la.test(t)},operator:"isUUID"}};function ea(t){var r=Object.keys(sr),p;return{}.NODE_NDEBUG?p=Ht:p=function(D,A){D||Ot(A,"true",D)},r.forEach(function(D){if(t){p[D]=Ht;return}var A=sr[D];p[D]=function(b,E){A.check(b)||Ot(E,D,A.operator,b,A.actual)}}),r.forEach(function(D){var A="optional"+zr(D);if(t){p[A]=Ht;return}var b=sr[D];p[A]=function(E,T){E!=null&&(b.check(E)||Ot(T,D,b.operator,E,b.actual))}}),r.forEach(function(D){var A="arrayOf"+zr(D);if(t){p[A]=Ht;return}var b=sr[D],E="["+D+"]";p[A]=function(T,k){Array.isArray(T)||Ot(k,E,b.operator,T,b.actual);var z;for(z=0;z<T.length;z++)b.check(T[z])||Ot(k,E,b.operator,T,b.actual)}}),r.forEach(function(D){var A="optionalArrayOf"+zr(D);if(t){p[A]=Ht;return}var b=sr[D],E="["+D+"]";p[A]=function(T,k){if(T!=null){Array.isArray(T)||Ot(k,E,b.operator,T,b.actual);var z;for(z=0;z<T.length;z++)b.check(T[z])||Ot(k,E,b.operator,T,b.actual)}}}),Object.keys(qr).forEach(function(D){if(D==="AssertionError"){p[D]=qr[D];return}if(t){p[D]=Ht;return}p[D]=qr[D]}),p._setExports=ea,p}var et=ea({}.NODE_NDEBUG),at=Qe.Buffer,ci={dsa:{parts:["p","q","g","y"],sizePart:"p"},rsa:{parts:["e","n"],sizePart:"n"},ecdsa:{parts:["curve","Q"],sizePart:"Q"},ed25519:{parts:["A"],sizePart:"A"}};ci.curve25519=ci.ed25519;var hi={dsa:{parts:["p","q","g","y","x"]},rsa:{parts:["n","e","d","iqmp","p","q"]},ecdsa:{parts:["curve","Q","d"]},ed25519:{parts:["A","k"]}};hi.curve25519=hi.ed25519;var xa={md5:!0,sha1:!0,sha256:!0,sha384:!0,sha512:!0},va={nistp256:{size:256,pkcs8oid:"1.2.840.10045.3.1.7",p:at.from("00ffffffff 00000001 00000000 0000000000000000 ffffffff ffffffff ffffffff".replace(/ /g,""),"hex"),a:at.from("00FFFFFFFF 00000001 00000000 0000000000000000 FFFFFFFF FFFFFFFF FFFFFFFC".replace(/ /g,""),"hex"),b:at.from("5ac635d8 aa3a93e7 b3ebbd55 769886bc651d06b0 cc53b0f6 3bce3c3e 27d2604b".replace(/ /g,""),"hex"),s:at.from("00c49d3608 86e70493 6a6678e1 139d26b7819f7e90".replace(/ /g,""),"hex"),n:at.from("00ffffffff 00000000 ffffffff ffffffffbce6faad a7179e84 f3b9cac2 fc632551".replace(/ /g,""),"hex"),G:at.from("046b17d1f2 e12c4247 f8bce6e5 63a440f277037d81 2deb33a0 f4a13945 d898c2964fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e162bce3357 6b315ece cbb64068 37bf51f5".replace(/ /g,""),"hex")},nistp384:{size:384,pkcs8oid:"1.3.132.0.34",p:at.from("00ffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff fffffffeffffffff 00000000 00000000 ffffffff".replace(/ /g,""),"hex"),a:at.from("00FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFEFFFFFFFF 00000000 00000000 FFFFFFFC".replace(/ /g,""),"hex"),b:at.from("b3312fa7 e23ee7e4 988e056b e3f82d19181d9c6e fe814112 0314088f 5013875ac656398d 8a2ed19d 2a85c8ed d3ec2aef".replace(/ /g,""),"hex"),s:at.from("00a335926a a319a27a 1d00896a 6773a4827acdac73".replace(/ /g,""),"hex"),n:at.from("00ffffffff ffffffff ffffffff ffffffffffffffff ffffffff c7634d81 f4372ddf581a0db2 48b0a77a ecec196a ccc52973".replace(/ /g,""),"hex"),G:at.from("04aa87ca22 be8b0537 8eb1c71e f320ad746e1d3b62 8ba79b98 59f741e0 82542a385502f25d bf55296c 3a545e38 72760ab73617de4a 96262c6f 5d9e98bf 9292dc29f8f41dbd 289a147c e9da3113 b5f0b8c00a60b1ce 1d7e819d 7a431d7c 90ea0e5f".replace(/ /g,""),"hex")},nistp521:{size:521,pkcs8oid:"1.3.132.0.35",p:at.from("01ffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffff".replace(/ /g,""),"hex"),a:at.from("01FFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFC".replace(/ /g,""),"hex"),b:at.from("51953eb961 8e1c9a1f 929a21a0 b68540eea2da725b 99b315f3 b8b48991 8ef109e156193951 ec7e937b 1652c0bd 3bb1bf073573df88 3d2c34f1 ef451fd4 6b503f00".replace(/ /g,""),"hex"),s:at.from("00d09e8800 291cb853 96cc6717 393284aaa0da64ba".replace(/ /g,""),"hex"),n:at.from("01ffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff fffffffa51868783 bf2f966b 7fcc0148 f709a5d03bb5c9b8 899c47ae bb6fb71e 91386409".replace(/ /g,""),"hex"),G:at.from("0400c6 858e06b7 0404e9cd 9e3ecb66 2395b4429c648139 053fb521 f828af60 6b4d3dbaa14b5e77 efe75928 fe1dc127 a2ffa8de3348b3c1 856a429b f97e7e31 c2e5bd660118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd998f54449 579b4468 17afbd17 273e662c97ee7299 5ef42640 c550b901 3fad0761353c7086 a272c240 88be9476 9fd16650".replace(/ /g,""),"hex")}},wt={info:ci,privInfo:hi,hashAlgs:xa,curves:va},Zt=Pr;function di(t,r){Error.captureStackTrace&&Error.captureStackTrace(this,di),this.name="FingerprintFormatError",this.fingerprint=t,this.format=r,this.message="Fingerprint format is not supported, or is invalid: ",t!==void 0&&(this.message+=" fingerprint = "+t),r!==void 0&&(this.message+=" format = "+r)}Zt.inherits(di,Error);function li(t){Error.captureStackTrace&&Error.captureStackTrace(this,li),this.name="InvalidAlgorithmError",this.algorithm=t,this.message='Algorithm "'+t+'" is not supported'}Zt.inherits(li,Error);function xi(t,r,p){Error.captureStackTrace&&Error.captureStackTrace(this,xi),this.name="KeyParseError",this.format=r,this.keyName=t,this.innerErr=p,this.message="Failed to parse "+t+" as a valid "+r+" format key: "+p.message}Zt.inherits(xi,Error);function vi(t,r,p){Error.captureStackTrace&&Error.captureStackTrace(this,vi),this.name="SignatureParseError",this.type=t,this.format=r,this.innerErr=p,this.message="Failed to parse the given data as a "+t+" signature in "+r+" format: "+p.message}Zt.inherits(vi,Error);function bi(t,r,p){Error.captureStackTrace&&Error.captureStackTrace(this,bi),this.name="CertificateParseError",this.format=r,this.certName=t,this.innerErr=p,this.message="Failed to parse "+t+" as a valid "+r+" format certificate: "+p.message}Zt.inherits(bi,Error);function gi(t,r){Error.captureStackTrace&&Error.captureStackTrace(this,gi),this.name="KeyEncryptedError",this.format=r,this.keyName=t,this.message="The "+r+" format key "+t+" is encrypted (password-protected), and no passphrase was provided in `options`"}Zt.inherits(gi,Error);var At={FingerprintFormatError:di,InvalidAlgorithmError:li,KeyParseError:xi,SignatureParseError:vi,KeyEncryptedError:gi,CertificateParseError:bi},ta={exports:{}},mi={newInvalidAsn1Error:function(t){var r=new Error;return r.name="InvalidAsn1Error",r.message=t||"",r}},yi={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128},ba=pi(),ra=Qe.Buffer,or=yi,ga=mi,Gt=ga.newInvalidAsn1Error;function ht(t){if(!t||!ra.isBuffer(t))throw new TypeError("data must be a node Buffer");this._buf=t,this._size=t.length,this._len=0,this._offset=0}Object.defineProperty(ht.prototype,"length",{enumerable:!0,get:function(){return this._len}});Object.defineProperty(ht.prototype,"offset",{enumerable:!0,get:function(){return this._offset}});Object.defineProperty(ht.prototype,"remain",{get:function(){return this._size-this._offset}});Object.defineProperty(ht.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}});ht.prototype.readByte=function(t){if(this._size-this._offset<1)return null;var r=this._buf[this._offset]&255;return t||(this._offset+=1),r};ht.prototype.peek=function(){return this.readByte(!0)};ht.prototype.readLength=function(t){if(t===void 0&&(t=this._offset),t>=this._size)return null;var r=this._buf[t++]&255;if(r===null)return null;if((r&128)===128){if(r&=127,r===0)throw Gt("Indefinite length not supported");if(r>4)throw Gt("encoding too long");if(this._size-t<r)return null;this._len=0;for(var p=0;p<r;p++)this._len=(this._len<<8)+(this._buf[t++]&255)}else this._len=r;return t};ht.prototype.readSequence=function(t){var r=this.peek();if(r===null)return null;if(t!==void 0&&t!==r)throw Gt("Expected 0x"+t.toString(16)+": got 0x"+r.toString(16));var p=this.readLength(this._offset+1);return p===null?null:(this._offset=p,r)};ht.prototype.readInt=function(){return this._readTag(or.Integer)};ht.prototype.readBoolean=function(){return this._readTag(or.Boolean)!==0};ht.prototype.readEnumeration=function(){return this._readTag(or.Enumeration)};ht.prototype.readString=function(t,r){t||(t=or.OctetString);var p=this.peek();if(p===null)return null;if(p!==t)throw Gt("Expected 0x"+t.toString(16)+": got 0x"+p.toString(16));var D=this.readLength(this._offset+1);if(D===null||this.length>this._size-D)return null;if(this._offset=D,this.length===0)return r?ra.alloc(0):"";var A=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,r?A:A.toString("utf8")};ht.prototype.readOID=function(t){t||(t=or.OID);var r=this.readString(t,!0);if(r===null)return null;for(var p=[],D=0,A=0;A<r.length;A++){var b=r[A]&255;D<<=7,D+=b&127,b&128||(p.push(D),D=0)}return D=p.shift(),p.unshift(D%40),p.unshift(D/40>>0),p.join(".")};ht.prototype._readTag=function(t){ba.ok(t!==void 0);var r=this.peek();if(r===null)return null;if(r!==t)throw Gt("Expected 0x"+t.toString(16)+": got 0x"+r.toString(16));var p=this.readLength(this._offset+1);if(p===null)return null;if(this.length>4)throw Gt("Integer too long: "+this.length);if(this.length>this._size-p)return null;this._offset=p;for(var D=this._buf[this._offset],A=0,b=0;b<this.length;b++)A<<=8,A|=this._buf[this._offset++]&255;return(D&128)===128&&b!==4&&(A-=1<<b*8),A>>0};var ma=ht,kt=pi(),Ir=Qe.Buffer,Ut=yi,ya=mi,Fr=ya.newInvalidAsn1Error,wa={size:1024,growthFactor:8};function Sa(t,r){kt.ok(t),kt.equal(typeof t,"object"),kt.ok(r),kt.equal(typeof r,"object");var p=Object.getOwnPropertyNames(t);return p.forEach(function(D){if(!r[D]){var A=Object.getOwnPropertyDescriptor(t,D);Object.defineProperty(r,D,A)}}),r}function ut(t){t=Sa(wa,t||{}),this._buf=Ir.alloc(t.size||1024),this._size=this._buf.length,this._offset=0,this._options=t,this._seq=[]}Object.defineProperty(ut.prototype,"buffer",{get:function(){if(this._seq.length)throw Fr(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}});ut.prototype.writeByte=function(t){if(typeof t!="number")throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=t};ut.prototype.writeInt=function(t,r){if(typeof t!="number")throw new TypeError("argument must be a Number");typeof r!="number"&&(r=Ut.Integer);for(var p=4;(!(t&4286578688)||(t&4286578688)===-8388608)&&p>1;)p--,t<<=8;if(p>4)throw Fr("BER ints cannot be > 0xffffffff");for(this._ensure(2+p),this._buf[this._offset++]=r,this._buf[this._offset++]=p;p-- >0;)this._buf[this._offset++]=(t&4278190080)>>>24,t<<=8};ut.prototype.writeNull=function(){this.writeByte(Ut.Null),this.writeByte(0)};ut.prototype.writeEnumeration=function(t,r){if(typeof t!="number")throw new TypeError("argument must be a Number");return typeof r!="number"&&(r=Ut.Enumeration),this.writeInt(t,r)};ut.prototype.writeBoolean=function(t,r){if(typeof t!="boolean")throw new TypeError("argument must be a Boolean");typeof r!="number"&&(r=Ut.Boolean),this._ensure(3),this._buf[this._offset++]=r,this._buf[this._offset++]=1,this._buf[this._offset++]=t?255:0};ut.prototype.writeString=function(t,r){if(typeof t!="string")throw new TypeError("argument must be a string (was: "+typeof t+")");typeof r!="number"&&(r=Ut.OctetString);var p=Ir.byteLength(t);this.writeByte(r),this.writeLength(p),p&&(this._ensure(p),this._buf.write(t,this._offset),this._offset+=p)};ut.prototype.writeBuffer=function(t,r){if(typeof r!="number")throw new TypeError("tag must be a number");if(!Ir.isBuffer(t))throw new TypeError("argument must be a buffer");this.writeByte(r),this.writeLength(t.length),this._ensure(t.length),t.copy(this._buf,this._offset,0,t.length),this._offset+=t.length};ut.prototype.writeStringArray=function(t){if(!t instanceof Array)throw new TypeError("argument must be an Array[String]");var r=this;t.forEach(function(p){r.writeString(p)})};ut.prototype.writeOID=function(t,r){if(typeof t!="string")throw new TypeError("argument must be a string");if(typeof r!="number"&&(r=Ut.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(t))throw new Error("argument is not a valid OID string");function p(E,T){T<128?E.push(T):T<16384?(E.push(T>>>7|128),E.push(T&127)):T<2097152?(E.push(T>>>14|128),E.push((T>>>7|128)&255),E.push(T&127)):T<268435456?(E.push(T>>>21|128),E.push((T>>>14|128)&255),E.push((T>>>7|128)&255),E.push(T&127)):(E.push((T>>>28|128)&255),E.push((T>>>21|128)&255),E.push((T>>>14|128)&255),E.push((T>>>7|128)&255),E.push(T&127))}var D=t.split("."),A=[];A.push(parseInt(D[0],10)*40+parseInt(D[1],10)),D.slice(2).forEach(function(E){p(A,parseInt(E,10))});var b=this;this._ensure(2+A.length),this.writeByte(r),this.writeLength(A.length),A.forEach(function(E){b.writeByte(E)})};ut.prototype.writeLength=function(t){if(typeof t!="number")throw new TypeError("argument must be a Number");if(this._ensure(4),t<=127)this._buf[this._offset++]=t;else if(t<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=t;else if(t<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=t>>8,this._buf[this._offset++]=t;else if(t<=16777215)this._buf[this._offset++]=131,this._buf[this._offset++]=t>>16,this._buf[this._offset++]=t>>8,this._buf[this._offset++]=t;else throw Fr("Length too long (> 4 bytes)")};ut.prototype.startSequence=function(t){typeof t!="number"&&(t=Ut.Sequence|Ut.Constructor),this.writeByte(t),this._seq.push(this._offset),this._ensure(3),this._offset+=3};ut.prototype.endSequence=function(){var t=this._seq.pop(),r=t+3,p=this._offset-r;if(p<=127)this._shift(r,p,-2),this._buf[t]=p;else if(p<=255)this._shift(r,p,-1),this._buf[t]=129,this._buf[t+1]=p;else if(p<=65535)this._buf[t]=130,this._buf[t+1]=p>>8,this._buf[t+2]=p;else if(p<=16777215)this._shift(r,p,1),this._buf[t]=131,this._buf[t+1]=p>>16,this._buf[t+2]=p>>8,this._buf[t+3]=p;else throw Fr("Sequence too long")};ut.prototype._shift=function(t,r,p){kt.ok(t!==void 0),kt.ok(r!==void 0),kt.ok(p),this._buf.copy(this._buf,t+p,t,t+r),this._offset+=p};ut.prototype._ensure=function(t){if(kt.ok(t),this._size-this._offset<t){var r=this._size*this._options.growthFactor;r-this._offset<t&&(r+=t);var p=Ir.alloc(r);this._buf.copy(p,0,0,this._offset),this._buf=p,this._size=r}};var Ba=ut;(function(t){var r=mi,p=yi,D=ma,A=Ba;t.exports={Reader:D,Writer:A};for(var b in p)p.hasOwnProperty(b)&&(t.exports[b]=p[b]);for(var E in r)r.hasOwnProperty(E)&&(t.exports[E]=r[E])})(ta);var Ea=ta.exports,Rr=Ea,Lt={Ber:Rr,BerReader:Rr.Reader,BerWriter:Rr.Writer},ia={exports:{}};(function(t,r){(function(){var p,D=0xdeadbeefcafe,A=(D&16777215)==15715070;function b(a,s,h){a!=null&&(typeof a=="number"?this.fromNumber(a,s,h):s==null&&typeof a!="string"?this.fromString(a,256):this.fromString(a,s))}function E(){return new b(null)}function T(a,s,h,I,Z,X){for(;--X>=0;){var de=s*this[a++]+h[I]+Z;Z=Math.floor(de/67108864),h[I++]=de&67108863}return Z}function k(a,s,h,I,Z,X){for(var de=s&32767,ge=s>>15;--X>=0;){var $e=this[a]&32767,it=this[a++]>>15,xt=ge*$e+it*de;$e=de*$e+((xt&32767)<<15)+h[I]+(Z&1073741823),Z=($e>>>30)+(xt>>>15)+ge*it+(Z>>>30),h[I++]=$e&1073741823}return Z}function z(a,s,h,I,Z,X){for(var de=s&16383,ge=s>>14;--X>=0;){var $e=this[a]&16383,it=this[a++]>>14,xt=ge*$e+it*de;$e=de*$e+((xt&16383)<<14)+h[I]+Z,Z=($e>>28)+(xt>>14)+ge*it,h[I++]=$e&268435455}return Z}var C=typeof navigator<"u";C&&A&&navigator.appName=="Microsoft Internet Explorer"?(b.prototype.am=k,p=30):C&&A&&navigator.appName!="Netscape"?(b.prototype.am=T,p=26):(b.prototype.am=z,p=28),b.prototype.DB=p,b.prototype.DM=(1<<p)-1,b.prototype.DV=1<<p;var m=52;b.prototype.FV=Math.pow(2,m),b.prototype.F1=m-p,b.prototype.F2=2*p-m;var P="0123456789abcdefghijklmnopqrstuvwxyz",w=new Array,n,l;for(n="0".charCodeAt(0),l=0;l<=9;++l)w[n++]=l;for(n="a".charCodeAt(0),l=10;l<36;++l)w[n++]=l;for(n="A".charCodeAt(0),l=10;l<36;++l)w[n++]=l;function B(a){return P.charAt(a)}function f(a,s){var h=w[a.charCodeAt(s)];return h??-1}function d(a){for(var s=this.t-1;s>=0;--s)a[s]=this[s];a.t=this.t,a.s=this.s}function _(a){this.t=1,this.s=a<0?-1:0,a>0?this[0]=a:a<-1?this[0]=a+this.DV:this.t=0}function N(a){var s=E();return s.fromInt(a),s}function Y(a,s){var h;if(s==16)h=4;else if(s==8)h=3;else if(s==256)h=8;else if(s==2)h=1;else if(s==32)h=5;else if(s==4)h=2;else{this.fromRadix(a,s);return}this.t=0,this.s=0;for(var I=a.length,Z=!1,X=0;--I>=0;){var de=h==8?a[I]&255:f(a,I);if(de<0){a.charAt(I)=="-"&&(Z=!0);continue}Z=!1,X==0?this[this.t++]=de:X+h>this.DB?(this[this.t-1]|=(de&(1<<this.DB-X)-1)<<X,this[this.t++]=de>>this.DB-X):this[this.t-1]|=de<<X,X+=h,X>=this.DB&&(X-=this.DB)}h==8&&a[0]&128&&(this.s=-1,X>0&&(this[this.t-1]|=(1<<this.DB-X)-1<<X)),this.clamp(),Z&&b.ZERO.subTo(this,this)}function H(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t}function ae(a){if(this.s<0)return"-"+this.negate().toString(a);var s;if(a==16)s=4;else if(a==8)s=3;else if(a==2)s=1;else if(a==32)s=5;else if(a==4)s=2;else return this.toRadix(a);var h=(1<<s)-1,I,Z=!1,X="",de=this.t,ge=this.DB-de*this.DB%s;if(de-- >0)for(ge<this.DB&&(I=this[de]>>ge)>0&&(Z=!0,X=B(I));de>=0;)ge<s?(I=(this[de]&(1<<ge)-1)<<s-ge,I|=this[--de]>>(ge+=this.DB-s)):(I=this[de]>>(ge-=s)&h,ge<=0&&(ge+=this.DB,--de)),I>0&&(Z=!0),Z&&(X+=B(I));return Z?X:"0"}function L(){var a=E();return b.ZERO.subTo(this,a),a}function ne(){return this.s<0?this.negate():this}function J(a){var s=this.s-a.s;if(s!=0)return s;var h=this.t;if(s=h-a.t,s!=0)return this.s<0?-s:s;for(;--h>=0;)if((s=this[h]-a[h])!=0)return s;return 0}function te(a){var s=1,h;return(h=a>>>16)!=0&&(a=h,s+=16),(h=a>>8)!=0&&(a=h,s+=8),(h=a>>4)!=0&&(a=h,s+=4),(h=a>>2)!=0&&(a=h,s+=2),(h=a>>1)!=0&&(a=h,s+=1),s}function ce(){return this.t<=0?0:this.DB*(this.t-1)+te(this[this.t-1]^this.s&this.DM)}function Be(a,s){var h;for(h=this.t-1;h>=0;--h)s[h+a]=this[h];for(h=a-1;h>=0;--h)s[h]=0;s.t=this.t+a,s.s=this.s}function U(a,s){for(var h=a;h<this.t;++h)s[h-a]=this[h];s.t=Math.max(this.t-a,0),s.s=this.s}function G(a,s){var h=a%this.DB,I=this.DB-h,Z=(1<<I)-1,X=Math.floor(a/this.DB),de=this.s<<h&this.DM,ge;for(ge=this.t-1;ge>=0;--ge)s[ge+X+1]=this[ge]>>I|de,de=(this[ge]&Z)<<h;for(ge=X-1;ge>=0;--ge)s[ge]=0;s[X]=de,s.t=this.t+X+1,s.s=this.s,s.clamp()}function F(a,s){s.s=this.s;var h=Math.floor(a/this.DB);if(h>=this.t){s.t=0;return}var I=a%this.DB,Z=this.DB-I,X=(1<<I)-1;s[0]=this[h]>>I;for(var de=h+1;de<this.t;++de)s[de-h-1]|=(this[de]&X)<<Z,s[de-h]=this[de]>>I;I>0&&(s[this.t-h-1]|=(this.s&X)<<Z),s.t=this.t-h,s.clamp()}function j(a,s){for(var h=0,I=0,Z=Math.min(a.t,this.t);h<Z;)I+=this[h]-a[h],s[h++]=I&this.DM,I>>=this.DB;if(a.t<this.t){for(I-=a.s;h<this.t;)I+=this[h],s[h++]=I&this.DM,I>>=this.DB;I+=this.s}else{for(I+=this.s;h<a.t;)I-=a[h],s[h++]=I&this.DM,I>>=this.DB;I-=a.s}s.s=I<0?-1:0,I<-1?s[h++]=this.DV+I:I>0&&(s[h++]=I),s.t=h,s.clamp()}function v(a,s){var h=this.abs(),I=a.abs(),Z=h.t;for(s.t=Z+I.t;--Z>=0;)s[Z]=0;for(Z=0;Z<I.t;++Z)s[Z+h.t]=h.am(0,I[Z],s,Z,0,h.t);s.s=0,s.clamp(),this.s!=a.s&&b.ZERO.subTo(s,s)}function c(a){for(var s=this.abs(),h=a.t=2*s.t;--h>=0;)a[h]=0;for(h=0;h<s.t-1;++h){var I=s.am(h,s[h],a,2*h,0,1);(a[h+s.t]+=s.am(h+1,2*s[h],a,2*h+1,I,s.t-h-1))>=s.DV&&(a[h+s.t]-=s.DV,a[h+s.t+1]=1)}a.t>0&&(a[a.t-1]+=s.am(h,s[h],a,2*h,0,1)),a.s=0,a.clamp()}function y(a,s,h){var I=a.abs();if(!(I.t<=0)){var Z=this.abs();if(Z.t<I.t){s?.fromInt(0),h!=null&&this.copyTo(h);return}h==null&&(h=E());var X=E(),de=this.s,ge=a.s,$e=this.DB-te(I[I.t-1]);$e>0?(I.lShiftTo($e,X),Z.lShiftTo($e,h)):(I.copyTo(X),Z.copyTo(h));var it=X.t,xt=X[it-1];if(xt!=0){var lt=xt*(1<<this.F1)+(it>1?X[it-2]>>this.F2:0),_t=this.FV/lt,Er=(1<<this.F1)/lt,bt=1<<this.F2,gt=h.t,_r=gt-it,Ct=s??E();for(X.dlShiftTo(_r,Ct),h.compareTo(Ct)>=0&&(h[h.t++]=1,h.subTo(Ct,h)),b.ONE.dlShiftTo(it,Ct),Ct.subTo(X,X);X.t<it;)X[X.t++]=0;for(;--_r>=0;){var Nr=h[--gt]==xt?this.DM:Math.floor(h[gt]*_t+(h[gt-1]+bt)*Er);if((h[gt]+=X.am(0,Nr,h,_r,0,it))<Nr)for(X.dlShiftTo(_r,Ct),h.subTo(Ct,h);h[gt]<--Nr;)h.subTo(Ct,h)}s!=null&&(h.drShiftTo(it,s),de!=ge&&b.ZERO.subTo(s,s)),h.t=it,h.clamp(),$e>0&&h.rShiftTo($e,h),de<0&&b.ZERO.subTo(h,h)}}}function g(a){var s=E();return this.abs().divRemTo(a,null,s),this.s<0&&s.compareTo(b.ZERO)>0&&a.subTo(s,s),s}function V(a){this.m=a}function ie(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function se(a){return a}function re(a){a.divRemTo(this.m,null,a)}function ue(a,s,h){a.multiplyTo(s,h),this.reduce(h)}function Te(a,s){a.squareTo(s),this.reduce(s)}V.prototype.convert=ie,V.prototype.revert=se,V.prototype.reduce=re,V.prototype.mulTo=ue,V.prototype.sqrTo=Te;function Ne(){if(this.t<1)return 0;var a=this[0];if(!(a&1))return 0;var s=a&3;return s=s*(2-(a&15)*s)&15,s=s*(2-(a&255)*s)&255,s=s*(2-((a&65535)*s&65535))&65535,s=s*(2-a*s%this.DV)%this.DV,s>0?this.DV-s:-s}function ze(a){this.m=a,this.mp=a.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function He(a){var s=E();return a.abs().dlShiftTo(this.m.t,s),s.divRemTo(this.m,null,s),a.s<0&&s.compareTo(b.ZERO)>0&&this.m.subTo(s,s),s}function Je(a){var s=E();return a.copyTo(s),this.reduce(s),s}function Ye(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var s=0;s<this.m.t;++s){var h=a[s]&32767,I=h*this.mpl+((h*this.mph+(a[s]>>15)*this.mpl&this.um)<<15)&a.DM;for(h=s+this.m.t,a[h]+=this.m.am(0,I,a,s,0,this.m.t);a[h]>=a.DV;)a[h]-=a.DV,a[++h]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function dt(a,s){a.squareTo(s),this.reduce(s)}function yt(a,s,h){a.multiplyTo(s,h),this.reduce(h)}ze.prototype.convert=He,ze.prototype.revert=Je,ze.prototype.reduce=Ye,ze.prototype.mulTo=yt,ze.prototype.sqrTo=dt;function Pt(){return(this.t>0?this[0]&1:this.s)==0}function $t(a,s){if(a>4294967295||a<1)return b.ONE;var h=E(),I=E(),Z=s.convert(this),X=te(a)-1;for(Z.copyTo(h);--X>=0;)if(s.sqrTo(h,I),(a&1<<X)>0)s.mulTo(I,Z,h);else{var de=h;h=I,I=de}return s.revert(h)}function tt(a,s){var h;return a<256||s.isEven()?h=new V(s):h=new ze(s),this.exp(a,h)}b.prototype.copyTo=d,b.prototype.fromInt=_,b.prototype.fromString=Y,b.prototype.clamp=H,b.prototype.dlShiftTo=Be,b.prototype.drShiftTo=U,b.prototype.lShiftTo=G,b.prototype.rShiftTo=F,b.prototype.subTo=j,b.prototype.multiplyTo=v,b.prototype.squareTo=c,b.prototype.divRemTo=y,b.prototype.invDigit=Ne,b.prototype.isEven=Pt,b.prototype.exp=$t,b.prototype.toString=ae,b.prototype.negate=L,b.prototype.abs=ne,b.prototype.compareTo=J,b.prototype.bitLength=ce,b.prototype.mod=g,b.prototype.modPowInt=tt,b.ZERO=N(0),b.ONE=N(1);function vr(){var a=E();return this.copyTo(a),a}function St(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Qt(){return this.t==0?this.s:this[0]<<24>>24}function br(){return this.t==0?this.s:this[0]<<16>>16}function Xt(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function gr(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Wt(a){if(a==null&&(a=10),this.signum()==0||a<2||a>36)return"0";var s=this.chunkSize(a),h=Math.pow(a,s),I=N(h),Z=E(),X=E(),de="";for(this.divRemTo(I,Z,X);Z.signum()>0;)de=(h+X.intValue()).toString(a).substr(1)+de,Z.divRemTo(I,Z,X);return X.intValue().toString(a)+de}function Jt(a,s){this.fromInt(0),s==null&&(s=10);for(var h=this.chunkSize(s),I=Math.pow(s,h),Z=!1,X=0,de=0,ge=0;ge<a.length;++ge){var $e=f(a,ge);if($e<0){a.charAt(ge)=="-"&&this.signum()==0&&(Z=!0);continue}de=s*de+$e,++X>=h&&(this.dMultiply(I),this.dAddOffset(de,0),X=0,de=0)}X>0&&(this.dMultiply(Math.pow(s,X)),this.dAddOffset(de,0)),Z&&b.ZERO.subTo(this,this)}function er(a,s,h){if(typeof s=="number")if(a<2)this.fromInt(1);else for(this.fromNumber(a,h),this.testBit(a-1)||this.bitwiseTo(b.ONE.shiftLeft(a-1),Bt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(s);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(b.ONE.shiftLeft(a-1),this);else{var I=new Array,Z=a&7;I.length=(a>>3)+1,s.nextBytes(I),Z>0?I[0]&=(1<<Z)-1:I[0]=0,this.fromString(I,256)}}function mr(){var a=this.t,s=new Array;s[0]=this.s;var h=this.DB-a*this.DB%8,I,Z=0;if(a-- >0)for(h<this.DB&&(I=this[a]>>h)!=(this.s&this.DM)>>h&&(s[Z++]=I|this.s<<this.DB-h);a>=0;)h<8?(I=(this[a]&(1<<h)-1)<<8-h,I|=this[--a]>>(h+=this.DB-8)):(I=this[a]>>(h-=8)&255,h<=0&&(h+=this.DB,--a)),I&128&&(I|=-256),Z==0&&(this.s&128)!=(I&128)&&++Z,(Z>0||I!=this.s)&&(s[Z++]=I);return s}function tr(a){return this.compareTo(a)==0}function yr(a){return this.compareTo(a)<0?this:a}function Cr(a){return this.compareTo(a)>0?this:a}function rr(a,s,h){var I,Z,X=Math.min(a.t,this.t);for(I=0;I<X;++I)h[I]=s(this[I],a[I]);if(a.t<this.t){for(Z=a.s&this.DM,I=X;I<this.t;++I)h[I]=s(this[I],Z);h.t=this.t}else{for(Z=this.s&this.DM,I=X;I<a.t;++I)h[I]=s(Z,a[I]);h.t=a.t}h.s=s(this.s,a.s),h.clamp()}function ir(a,s){return a&s}function jt(a){var s=E();return this.bitwiseTo(a,ir,s),s}function Bt(a,s){return a|s}function It(a){var s=E();return this.bitwiseTo(a,Bt,s),s}function Ft(a,s){return a^s}function Mt(a){var s=E();return this.bitwiseTo(a,Ft,s),s}function Tt(a,s){return a&~s}function Kt(a){var s=E();return this.bitwiseTo(a,Tt,s),s}function ar(){for(var a=E(),s=0;s<this.t;++s)a[s]=this.DM&~this[s];return a.t=this.t,a.s=~this.s,a}function wr(a){var s=E();return a<0?this.rShiftTo(-a,s):this.lShiftTo(a,s),s}function Or(a){var s=E();return a<0?this.lShiftTo(-a,s):this.rShiftTo(a,s),s}function kr(a){if(a==0)return-1;var s=0;return a&65535||(a>>=16,s+=16),a&255||(a>>=8,s+=8),a&15||(a>>=4,s+=4),a&3||(a>>=2,s+=2),a&1||++s,s}function vt(){for(var a=0;a<this.t;++a)if(this[a]!=0)return a*this.DB+kr(this[a]);return this.s<0?this.t*this.DB:-1}function Et(a){for(var s=0;a!=0;)a&=a-1,++s;return s}function Dt(){for(var a=0,s=this.s&this.DM,h=0;h<this.t;++h)a+=Et(this[h]^s);return a}function fr(a){var s=Math.floor(a/this.DB);return s>=this.t?this.s!=0:(this[s]&1<<a%this.DB)!=0}function nr(a,s){var h=b.ONE.shiftLeft(a);return this.bitwiseTo(h,s,h),h}function Sr(a){return this.changeBit(a,Bt)}function Ur(a){return this.changeBit(a,Tt)}function ct(a){return this.changeBit(a,Ft)}function Br(a,s){for(var h=0,I=0,Z=Math.min(a.t,this.t);h<Z;)I+=this[h]+a[h],s[h++]=I&this.DM,I>>=this.DB;if(a.t<this.t){for(I+=a.s;h<this.t;)I+=this[h],s[h++]=I&this.DM,I>>=this.DB;I+=this.s}else{for(I+=this.s;h<a.t;)I+=a[h],s[h++]=I&this.DM,I>>=this.DB;I+=a.s}s.s=I<0?-1:0,I>0?s[h++]=I:I<-1&&(s[h++]=this.DV+I),s.t=h,s.clamp()}function i(a){var s=E();return this.addTo(a,s),s}function u(a){var s=E();return this.subTo(a,s),s}function o(a){var s=E();return this.multiplyTo(a,s),s}function e(){var a=E();return this.squareTo(a),a}function x(a){var s=E();return this.divRemTo(a,s,null),s}function O(a){var s=E();return this.divRemTo(a,null,s),s}function K(a){var s=E(),h=E();return this.divRemTo(a,s,h),new Array(s,h)}function W(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function oe(a,s){if(a!=0){for(;this.t<=s;)this[this.t++]=0;for(this[s]+=a;this[s]>=this.DV;)this[s]-=this.DV,++s>=this.t&&(this[this.t++]=0),++this[s]}}function le(){}function he(a){return a}function Le(a,s,h){a.multiplyTo(s,h)}function be(a,s){a.squareTo(s)}le.prototype.convert=he,le.prototype.revert=he,le.prototype.mulTo=Le,le.prototype.sqrTo=be;function Ae(a){return this.exp(a,new le)}function qe(a,s,h){var I=Math.min(this.t+a.t,s);for(h.s=0,h.t=I;I>0;)h[--I]=0;var Z;for(Z=h.t-this.t;I<Z;++I)h[I+this.t]=this.am(0,a[I],h,I,0,this.t);for(Z=Math.min(a.t,s);I<Z;++I)this.am(0,a[I],h,I,0,s-I);h.clamp()}function De(a,s,h){--s;var I=h.t=this.t+a.t-s;for(h.s=0;--I>=0;)h[I]=0;for(I=Math.max(s-this.t,0);I<a.t;++I)h[this.t+I-s]=this.am(s-I,a[I],h,0,0,this.t+I-s);h.clamp(),h.drShiftTo(1,h)}function _e(a){this.r2=E(),this.q3=E(),b.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function Pe(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var s=E();return a.copyTo(s),this.reduce(s),s}function Fe(a){return a}function Ie(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function me(a,s){a.squareTo(s),this.reduce(s)}function Se(a,s,h){a.multiplyTo(s,h),this.reduce(h)}_e.prototype.convert=Pe,_e.prototype.revert=Fe,_e.prototype.reduce=Ie,_e.prototype.mulTo=Se,_e.prototype.sqrTo=me;function xe(a,s){var h=a.bitLength(),I,Z=N(1),X;if(h<=0)return Z;h<18?I=1:h<48?I=3:h<144?I=4:h<768?I=5:I=6,h<8?X=new V(s):s.isEven()?X=new _e(s):X=new ze(s);var de=new Array,ge=3,$e=I-1,it=(1<<I)-1;if(de[1]=X.convert(this),I>1){var xt=E();for(X.sqrTo(de[1],xt);ge<=it;)de[ge]=E(),X.mulTo(xt,de[ge-2],de[ge]),ge+=2}var lt=a.t-1,_t,Er=!0,bt=E(),gt;for(h=te(a[lt])-1;lt>=0;){for(h>=$e?_t=a[lt]>>h-$e&it:(_t=(a[lt]&(1<<h+1)-1)<<$e-h,lt>0&&(_t|=a[lt-1]>>this.DB+h-$e)),ge=I;!(_t&1);)_t>>=1,--ge;if((h-=ge)<0&&(h+=this.DB,--lt),Er)de[_t].copyTo(Z),Er=!1;else{for(;ge>1;)X.sqrTo(Z,bt),X.sqrTo(bt,Z),ge-=2;ge>0?X.sqrTo(Z,bt):(gt=Z,Z=bt,bt=gt),X.mulTo(bt,de[_t],Z)}for(;lt>=0&&!(a[lt]&1<<h);)X.sqrTo(Z,bt),gt=Z,Z=bt,bt=gt,--h<0&&(h=this.DB-1,--lt)}return X.revert(Z)}function ye(a){var s=this.s<0?this.negate():this.clone(),h=a.s<0?a.negate():a.clone();if(s.compareTo(h)<0){var I=s;s=h,h=I}var Z=s.getLowestSetBit(),X=h.getLowestSetBit();if(X<0)return s;for(Z<X&&(X=Z),X>0&&(s.rShiftTo(X,s),h.rShiftTo(X,h));s.signum()>0;)(Z=s.getLowestSetBit())>0&&s.rShiftTo(Z,s),(Z=h.getLowestSetBit())>0&&h.rShiftTo(Z,h),s.compareTo(h)>=0?(s.subTo(h,s),s.rShiftTo(1,s)):(h.subTo(s,h),h.rShiftTo(1,h));return X>0&&h.lShiftTo(X,h),h}function we(a){if(a<=0)return 0;var s=this.DV%a,h=this.s<0?a-1:0;if(this.t>0)if(s==0)h=this[0]%a;else for(var I=this.t-1;I>=0;--I)h=(s*h+this[I])%a;return h}function pe(a){var s=a.isEven();if(this.isEven()&&s||a.signum()==0)return b.ZERO;for(var h=a.clone(),I=this.clone(),Z=N(1),X=N(0),de=N(0),ge=N(1);h.signum()!=0;){for(;h.isEven();)h.rShiftTo(1,h),s?((!Z.isEven()||!X.isEven())&&(Z.addTo(this,Z),X.subTo(a,X)),Z.rShiftTo(1,Z)):X.isEven()||X.subTo(a,X),X.rShiftTo(1,X);for(;I.isEven();)I.rShiftTo(1,I),s?((!de.isEven()||!ge.isEven())&&(de.addTo(this,de),ge.subTo(a,ge)),de.rShiftTo(1,de)):ge.isEven()||ge.subTo(a,ge),ge.rShiftTo(1,ge);h.compareTo(I)>=0?(h.subTo(I,h),s&&Z.subTo(de,Z),X.subTo(ge,X)):(I.subTo(h,I),s&&de.subTo(Z,de),ge.subTo(X,ge))}if(I.compareTo(b.ONE)!=0)return b.ZERO;if(ge.compareTo(a)>=0)return ge.subtract(a);if(ge.signum()<0)ge.addTo(a,ge);else return ge;return ge.signum()<0?ge.add(a):ge}var R=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],M=(1<<26)/R[R.length-1];function fe(a){var s,h=this.abs();if(h.t==1&&h[0]<=R[R.length-1]){for(s=0;s<R.length;++s)if(h[0]==R[s])return!0;return!1}if(h.isEven())return!1;for(s=1;s<R.length;){for(var I=R[s],Z=s+1;Z<R.length&&I<M;)I*=R[Z++];for(I=h.modInt(I);s<Z;)if(I%R[s++]==0)return!1}return h.millerRabin(a)}function Q(a){var s=this.subtract(b.ONE),h=s.getLowestSetBit();if(h<=0)return!1;var I=s.shiftRight(h);a=a+1>>1,a>R.length&&(a=R.length);for(var Z=E(),X=0;X<a;++X){Z.fromInt(R[Math.floor(Math.random()*R.length)]);var de=Z.modPow(I,this);if(de.compareTo(b.ONE)!=0&&de.compareTo(s)!=0){for(var ge=1;ge++<h&&de.compareTo(s)!=0;)if(de=de.modPowInt(2,this),de.compareTo(b.ONE)==0)return!1;if(de.compareTo(s)!=0)return!1}}return!0}b.prototype.chunkSize=Xt,b.prototype.toRadix=Wt,b.prototype.fromRadix=Jt,b.prototype.fromNumber=er,b.prototype.bitwiseTo=rr,b.prototype.changeBit=nr,b.prototype.addTo=Br,b.prototype.dMultiply=W,b.prototype.dAddOffset=oe,b.prototype.multiplyLowerTo=qe,b.prototype.multiplyUpperTo=De,b.prototype.modInt=we,b.prototype.millerRabin=Q,b.prototype.clone=vr,b.prototype.intValue=St,b.prototype.byteValue=Qt,b.prototype.shortValue=br,b.prototype.signum=gr,b.prototype.toByteArray=mr,b.prototype.equals=tr,b.prototype.min=yr,b.prototype.max=Cr,b.prototype.and=jt,b.prototype.or=It,b.prototype.xor=Mt,b.prototype.andNot=Kt,b.prototype.not=ar,b.prototype.shiftLeft=wr,b.prototype.shiftRight=Or,b.prototype.getLowestSetBit=vt,b.prototype.bitCount=Dt,b.prototype.testBit=fr,b.prototype.setBit=Sr,b.prototype.clearBit=Ur,b.prototype.flipBit=ct,b.prototype.add=i,b.prototype.subtract=u,b.prototype.multiply=o,b.prototype.divide=x,b.prototype.remainder=O,b.prototype.divideAndRemainder=K,b.prototype.modPow=xe,b.prototype.modInverse=pe,b.prototype.pow=Ae,b.prototype.gcd=ye,b.prototype.isProbablePrime=fe,b.prototype.square=e,b.prototype.Barrett=_e;var $,ee,ve;function Ce(a){ee[ve++]^=a&255,ee[ve++]^=a>>8&255,ee[ve++]^=a>>16&255,ee[ve++]^=a>>24&255,ve>=Ze&&(ve-=Ze)}function Oe(){Ce(new Date().getTime())}if(ee==null){ee=new Array,ve=0;var Ee;if(typeof window<"u"&&window.crypto){if(window.crypto.getRandomValues){var S=new Uint8Array(32);for(window.crypto.getRandomValues(S),Ee=0;Ee<32;++Ee)ee[ve++]=S[Ee]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var Ue=window.crypto.random(32);for(Ee=0;Ee<Ue.length;++Ee)ee[ve++]=Ue.charCodeAt(Ee)&255}}for(;ve<Ze;)Ee=Math.floor(65536*Math.random()),ee[ve++]=Ee>>>8,ee[ve++]=Ee&255;ve=0,Oe()}function je(){if($==null){for(Oe(),$=Ve(),$.init(ee),ve=0;ve<ee.length;++ve)ee[ve]=0;ve=0}return $.next()}function Me(a){var s;for(s=0;s<a.length;++s)a[s]=je()}function ke(){}ke.prototype.nextBytes=Me;function Ke(){this.i=0,this.j=0,this.S=new Array}function Re(a){var s,h,I;for(s=0;s<256;++s)this.S[s]=s;for(h=0,s=0;s<256;++s)h=h+this.S[s]+a[s%a.length]&255,I=this.S[s],this.S[s]=this.S[h],this.S[h]=I;this.i=0,this.j=0}function Xe(){var a;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[a+this.S[this.i]&255]}Ke.prototype.init=Re,Ke.prototype.next=Xe;function Ve(){return new Ke}var Ze=256;b.SecureRandom=ke,b.BigInteger=b,t.exports=b}).call(ua)})(ia);var ur=ia.exports,Ge=ur.BigInteger,_a=Ge.prototype.Barrett;function We(t,r){this.x=r,this.q=t}function Aa(t){return t==this?!0:this.q.equals(t.q)&&this.x.equals(t.x)}function qa(){return this.x}function Pa(){return new We(this.q,this.x.negate().mod(this.q))}function Ia(t){return new We(this.q,this.x.add(t.toBigInteger()).mod(this.q))}function Fa(t){return new We(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))}function Ta(t){return new We(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))}function Da(){return new We(this.q,this.x.square().mod(this.q))}function Ca(t){return new We(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))}We.prototype.equals=Aa;We.prototype.toBigInteger=qa;We.prototype.negate=Pa;We.prototype.add=Ia;We.prototype.subtract=Fa;We.prototype.multiply=Ta;We.prototype.square=Da;We.prototype.divide=Ca;function ot(t,r,p,D){this.curve=t,this.x=r,this.y=p,D==null?this.z=Ge.ONE:this.z=D,this.zinv=null}function Oa(){this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q));var t=this.x.toBigInteger().multiply(this.zinv);return this.curve.reduce(t),this.curve.fromBigInteger(t)}function ka(){this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q));var t=this.y.toBigInteger().multiply(this.zinv);return this.curve.reduce(t),this.curve.fromBigInteger(t)}function Ua(t){if(t==this)return!0;if(this.isInfinity())return t.isInfinity();if(t.isInfinity())return this.isInfinity();var r,p;return r=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),r.equals(Ge.ZERO)?(p=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q),p.equals(Ge.ZERO)):!1}function Na(){return this.x==null&&this.y==null?!0:this.z.equals(Ge.ZERO)&&!this.y.toBigInteger().equals(Ge.ZERO)}function za(){return new ot(this.curve,this.x,this.y.negate(),this.z)}function Ka(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var r=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),p=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(Ge.ZERO.equals(p))return Ge.ZERO.equals(r)?this.twice():this.curve.getInfinity();var D=new Ge("3"),A=this.x.toBigInteger(),b=this.y.toBigInteger();t.x.toBigInteger(),t.y.toBigInteger();var E=p.square(),T=E.multiply(p),k=A.multiply(E),z=r.square().multiply(this.z),C=z.subtract(k.shiftLeft(1)).multiply(t.z).subtract(T).multiply(p).mod(this.curve.q),m=k.multiply(D).multiply(r).subtract(b.multiply(T)).subtract(z.multiply(r)).multiply(t.z).add(r.multiply(T)).mod(this.curve.q),P=T.multiply(this.z).multiply(t.z).mod(this.curve.q);return new ot(this.curve,this.curve.fromBigInteger(C),this.curve.fromBigInteger(m),P)}function Ra(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var t=new Ge("3"),r=this.x.toBigInteger(),p=this.y.toBigInteger(),D=p.multiply(this.z),A=D.multiply(p).mod(this.curve.q),b=this.curve.a.toBigInteger(),E=r.square().multiply(t);Ge.ZERO.equals(b)||(E=E.add(this.z.square().multiply(b))),E=E.mod(this.curve.q);var T=E.square().subtract(r.shiftLeft(3).multiply(A)).shiftLeft(1).multiply(D).mod(this.curve.q),k=E.multiply(t).multiply(r).subtract(A.shiftLeft(1)).shiftLeft(2).multiply(A).subtract(E.square().multiply(E)).mod(this.curve.q),z=D.square().multiply(D).shiftLeft(3).mod(this.curve.q);return new ot(this.curve,this.curve.fromBigInteger(T),this.curve.fromBigInteger(k),z)}function La(t){if(this.isInfinity())return this;if(t.signum()==0)return this.curve.getInfinity();var r=t,p=r.multiply(new Ge("3")),D=this.negate(),A=this,b;for(b=p.bitLength()-2;b>0;--b){A=A.twice();var E=p.testBit(b),T=r.testBit(b);E!=T&&(A=A.add(E?this:D))}return A}function ja(t,r,p){var D;t.bitLength()>p.bitLength()?D=t.bitLength()-1:D=p.bitLength()-1;for(var A=this.curve.getInfinity(),b=this.add(r);D>=0;)A=A.twice(),t.testBit(D)?p.testBit(D)?A=A.add(b):A=A.add(this):p.testBit(D)&&(A=A.add(r)),--D;return A}ot.prototype.getX=Oa;ot.prototype.getY=ka;ot.prototype.equals=Ua;ot.prototype.isInfinity=Na;ot.prototype.negate=za;ot.prototype.add=Ka;ot.prototype.twice=Ra;ot.prototype.multiply=La;ot.prototype.multiplyTwo=ja;function mt(t,r,p){this.q=t,this.a=this.fromBigInteger(r),this.b=this.fromBigInteger(p),this.infinity=new ot(this,null,null),this.reducer=new _a(this.q)}function Ma(){return this.q}function Ha(){return this.a}function Ya(){return this.b}function Va(t){return t==this?!0:this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)}function Ga(){return this.infinity}function Za(t){return new We(this.q,t)}function $a(t){this.reducer.reduce(t)}function Qa(t){if(t.isInfinity())return"00";var r=t.getX().toBigInteger().toString(16),p=t.getY().toBigInteger().toString(16),D=this.getQ().toString(16).length;for(D%2!=0&&D++;r.length<D;)r="0"+r;for(;p.length<D;)p="0"+p;return"04"+r+p}mt.prototype.getQ=Ma;mt.prototype.getA=Ha;mt.prototype.getB=Ya;mt.prototype.equals=Va;mt.prototype.getInfinity=Ga;mt.prototype.fromBigInteger=Za;mt.prototype.reduce=$a;mt.prototype.encodePointHex=Qa;mt.prototype.decodePointHex=function(t){var r;switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:r=!1;case 3:r==null&&(r=!0);var E=t.length-2,T=t.substr(2,E),p=this.fromBigInteger(new Ge(T,16)),D=p.multiply(p.square().add(this.getA())).add(this.getB()),A=D.sqrt();if(A==null)throw"Invalid point compression";var b=A.toBigInteger();return b.testBit(0)!=r&&(A=this.fromBigInteger(this.getQ().subtract(b))),new ot(this,p,A);case 4:case 6:case 7:var E=(t.length-2)/2,T=t.substr(2,E),k=t.substr(E+2,E);return new ot(this,this.fromBigInteger(new Ge(T,16)),this.fromBigInteger(new Ge(k,16)));default:return null}};mt.prototype.encodeCompressedPointHex=function(t){if(t.isInfinity())return"00";var r=t.getX().toBigInteger().toString(16),p=this.getQ().toString(16).length;for(p%2!=0&&p++;r.length<p;)r="0"+r;var D;return t.getY().toBigInteger().isEven()?D="02":D="03",D+r};We.prototype.getR=function(){if(this.r!=null)return this.r;this.r=null;var t=this.q.bitLength();if(t>128){var r=this.q.shiftRight(t-64);r.intValue()==-1&&(this.r=Ge.ONE.shiftLeft(t).subtract(this.q))}return this.r};We.prototype.modMult=function(t,r){return this.modReduce(t.multiply(r))};We.prototype.modReduce=function(t){if(this.getR()!=null){for(var r=q.bitLength();t.bitLength()>r+1;){var p=t.shiftRight(r),D=t.subtract(p.shiftLeft(r));this.getR().equals(Ge.ONE)||(p=p.multiply(this.getR())),t=p.add(D)}for(;t.compareTo(q)>=0;)t=t.subtract(q)}else t=t.mod(q);return t};We.prototype.sqrt=function(){if(!this.q.testBit(0))throw"unsupported";if(this.q.testBit(1)){var t=new We(this.q,this.x.modPow(this.q.shiftRight(2).add(Ge.ONE),this.q));return t.square().equals(this)?t:null}var r=this.q.subtract(Ge.ONE),p=r.shiftRight(1);if(!this.x.modPow(p,this.q).equals(Ge.ONE))return null;var D=r.shiftRight(2),A=D.shiftLeft(1).add(Ge.ONE),b=this.x,E=modDouble(modDouble(b)),T,k;do{var z;do z=new Ge(this.q.bitLength(),new SecureRandom);while(z.compareTo(this.q)>=0||!z.multiply(z).subtract(E).modPow(p,this.q).equals(r));var C=this.lucasSequence(z,b,A);if(T=C[0],k=C[1],this.modMult(k,k).equals(E))return k.testBit(0)&&(k=k.add(q)),k=k.shiftRight(1),new We(q,k)}while(T.equals(Ge.ONE)||T.equals(r));return null};We.prototype.lucasSequence=function(t,r,p){for(var D=p.bitLength(),A=p.getLowestSetBit(),b=Ge.ONE,E=Ge.TWO,T=t,k=Ge.ONE,z=Ge.ONE,C=D-1;C>=A+1;--C)k=this.modMult(k,z),p.testBit(C)?(z=this.modMult(k,r),b=this.modMult(b,T),E=this.modReduce(T.multiply(E).subtract(t.multiply(k))),T=this.modReduce(T.multiply(T).subtract(z.shiftLeft(1)))):(z=k,b=this.modReduce(b.multiply(E).subtract(k)),T=this.modReduce(T.multiply(E).subtract(t.multiply(k))),E=this.modReduce(E.multiply(E).subtract(k.shiftLeft(1))));k=this.modMult(k,z),z=this.modMult(k,r),b=this.modReduce(b.multiply(E).subtract(k)),E=this.modReduce(T.multiply(E).subtract(t.multiply(k))),k=this.modMult(k,z);for(var C=1;C<=A;++C)b=this.modMult(b,E),E=this.modReduce(E.multiply(E).subtract(k.shiftLeft(1))),k=this.modMult(k,k);return[b,E]};var Xa={ECCurveFp:mt,ECPointFp:ot,ECFieldElementFp:We},Tr=Xa,aa={exports:{}};(function(t){(function(r){var p=function(i){var u,o=new Float64Array(16);if(i)for(u=0;u<i.length;u++)o[u]=i[u];return o},D=function(){throw new Error("no PRNG")},A=new Uint8Array(16),b=new Uint8Array(32);b[0]=9;var E=p(),T=p([1]),k=p([56129,1]),z=p([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),C=p([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=p([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),P=p([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),w=p([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function n(i,u,o,e){i[u]=o>>24&255,i[u+1]=o>>16&255,i[u+2]=o>>8&255,i[u+3]=o&255,i[u+4]=e>>24&255,i[u+5]=e>>16&255,i[u+6]=e>>8&255,i[u+7]=e&255}function l(i,u,o,e,x){var O,K=0;for(O=0;O<x;O++)K|=i[u+O]^o[e+O];return(1&K-1>>>8)-1}function B(i,u,o,e){return l(i,u,o,e,16)}function f(i,u,o,e){return l(i,u,o,e,32)}function d(i,u,o,e){for(var x=e[0]&255|(e[1]&255)<<8|(e[2]&255)<<16|(e[3]&255)<<24,O=o[0]&255|(o[1]&255)<<8|(o[2]&255)<<16|(o[3]&255)<<24,K=o[4]&255|(o[5]&255)<<8|(o[6]&255)<<16|(o[7]&255)<<24,W=o[8]&255|(o[9]&255)<<8|(o[10]&255)<<16|(o[11]&255)<<24,oe=o[12]&255|(o[13]&255)<<8|(o[14]&255)<<16|(o[15]&255)<<24,le=e[4]&255|(e[5]&255)<<8|(e[6]&255)<<16|(e[7]&255)<<24,he=u[0]&255|(u[1]&255)<<8|(u[2]&255)<<16|(u[3]&255)<<24,Le=u[4]&255|(u[5]&255)<<8|(u[6]&255)<<16|(u[7]&255)<<24,be=u[8]&255|(u[9]&255)<<8|(u[10]&255)<<16|(u[11]&255)<<24,Ae=u[12]&255|(u[13]&255)<<8|(u[14]&255)<<16|(u[15]&255)<<24,qe=e[8]&255|(e[9]&255)<<8|(e[10]&255)<<16|(e[11]&255)<<24,De=o[16]&255|(o[17]&255)<<8|(o[18]&255)<<16|(o[19]&255)<<24,_e=o[20]&255|(o[21]&255)<<8|(o[22]&255)<<16|(o[23]&255)<<24,Pe=o[24]&255|(o[25]&255)<<8|(o[26]&255)<<16|(o[27]&255)<<24,Fe=o[28]&255|(o[29]&255)<<8|(o[30]&255)<<16|(o[31]&255)<<24,Ie=e[12]&255|(e[13]&255)<<8|(e[14]&255)<<16|(e[15]&255)<<24,me=x,Se=O,xe=K,ye=W,we=oe,pe=le,R=he,M=Le,fe=be,Q=Ae,$=qe,ee=De,ve=_e,Ce=Pe,Oe=Fe,Ee=Ie,S,Ue=0;Ue<20;Ue+=2)S=me+ve|0,we^=S<<7|S>>>32-7,S=we+me|0,fe^=S<<9|S>>>32-9,S=fe+we|0,ve^=S<<13|S>>>32-13,S=ve+fe|0,me^=S<<18|S>>>32-18,S=pe+Se|0,Q^=S<<7|S>>>32-7,S=Q+pe|0,Ce^=S<<9|S>>>32-9,S=Ce+Q|0,Se^=S<<13|S>>>32-13,S=Se+Ce|0,pe^=S<<18|S>>>32-18,S=$+R|0,Oe^=S<<7|S>>>32-7,S=Oe+$|0,xe^=S<<9|S>>>32-9,S=xe+Oe|0,R^=S<<13|S>>>32-13,S=R+xe|0,$^=S<<18|S>>>32-18,S=Ee+ee|0,ye^=S<<7|S>>>32-7,S=ye+Ee|0,M^=S<<9|S>>>32-9,S=M+ye|0,ee^=S<<13|S>>>32-13,S=ee+M|0,Ee^=S<<18|S>>>32-18,S=me+ye|0,Se^=S<<7|S>>>32-7,S=Se+me|0,xe^=S<<9|S>>>32-9,S=xe+Se|0,ye^=S<<13|S>>>32-13,S=ye+xe|0,me^=S<<18|S>>>32-18,S=pe+we|0,R^=S<<7|S>>>32-7,S=R+pe|0,M^=S<<9|S>>>32-9,S=M+R|0,we^=S<<13|S>>>32-13,S=we+M|0,pe^=S<<18|S>>>32-18,S=$+Q|0,ee^=S<<7|S>>>32-7,S=ee+$|0,fe^=S<<9|S>>>32-9,S=fe+ee|0,Q^=S<<13|S>>>32-13,S=Q+fe|0,$^=S<<18|S>>>32-18,S=Ee+Oe|0,ve^=S<<7|S>>>32-7,S=ve+Ee|0,Ce^=S<<9|S>>>32-9,S=Ce+ve|0,Oe^=S<<13|S>>>32-13,S=Oe+Ce|0,Ee^=S<<18|S>>>32-18;me=me+x|0,Se=Se+O|0,xe=xe+K|0,ye=ye+W|0,we=we+oe|0,pe=pe+le|0,R=R+he|0,M=M+Le|0,fe=fe+be|0,Q=Q+Ae|0,$=$+qe|0,ee=ee+De|0,ve=ve+_e|0,Ce=Ce+Pe|0,Oe=Oe+Fe|0,Ee=Ee+Ie|0,i[0]=me>>>0&255,i[1]=me>>>8&255,i[2]=me>>>16&255,i[3]=me>>>24&255,i[4]=Se>>>0&255,i[5]=Se>>>8&255,i[6]=Se>>>16&255,i[7]=Se>>>24&255,i[8]=xe>>>0&255,i[9]=xe>>>8&255,i[10]=xe>>>16&255,i[11]=xe>>>24&255,i[12]=ye>>>0&255,i[13]=ye>>>8&255,i[14]=ye>>>16&255,i[15]=ye>>>24&255,i[16]=we>>>0&255,i[17]=we>>>8&255,i[18]=we>>>16&255,i[19]=we>>>24&255,i[20]=pe>>>0&255,i[21]=pe>>>8&255,i[22]=pe>>>16&255,i[23]=pe>>>24&255,i[24]=R>>>0&255,i[25]=R>>>8&255,i[26]=R>>>16&255,i[27]=R>>>24&255,i[28]=M>>>0&255,i[29]=M>>>8&255,i[30]=M>>>16&255,i[31]=M>>>24&255,i[32]=fe>>>0&255,i[33]=fe>>>8&255,i[34]=fe>>>16&255,i[35]=fe>>>24&255,i[36]=Q>>>0&255,i[37]=Q>>>8&255,i[38]=Q>>>16&255,i[39]=Q>>>24&255,i[40]=$>>>0&255,i[41]=$>>>8&255,i[42]=$>>>16&255,i[43]=$>>>24&255,i[44]=ee>>>0&255,i[45]=ee>>>8&255,i[46]=ee>>>16&255,i[47]=ee>>>24&255,i[48]=ve>>>0&255,i[49]=ve>>>8&255,i[50]=ve>>>16&255,i[51]=ve>>>24&255,i[52]=Ce>>>0&255,i[53]=Ce>>>8&255,i[54]=Ce>>>16&255,i[55]=Ce>>>24&255,i[56]=Oe>>>0&255,i[57]=Oe>>>8&255,i[58]=Oe>>>16&255,i[59]=Oe>>>24&255,i[60]=Ee>>>0&255,i[61]=Ee>>>8&255,i[62]=Ee>>>16&255,i[63]=Ee>>>24&255}function _(i,u,o,e){for(var x=e[0]&255|(e[1]&255)<<8|(e[2]&255)<<16|(e[3]&255)<<24,O=o[0]&255|(o[1]&255)<<8|(o[2]&255)<<16|(o[3]&255)<<24,K=o[4]&255|(o[5]&255)<<8|(o[6]&255)<<16|(o[7]&255)<<24,W=o[8]&255|(o[9]&255)<<8|(o[10]&255)<<16|(o[11]&255)<<24,oe=o[12]&255|(o[13]&255)<<8|(o[14]&255)<<16|(o[15]&255)<<24,le=e[4]&255|(e[5]&255)<<8|(e[6]&255)<<16|(e[7]&255)<<24,he=u[0]&255|(u[1]&255)<<8|(u[2]&255)<<16|(u[3]&255)<<24,Le=u[4]&255|(u[5]&255)<<8|(u[6]&255)<<16|(u[7]&255)<<24,be=u[8]&255|(u[9]&255)<<8|(u[10]&255)<<16|(u[11]&255)<<24,Ae=u[12]&255|(u[13]&255)<<8|(u[14]&255)<<16|(u[15]&255)<<24,qe=e[8]&255|(e[9]&255)<<8|(e[10]&255)<<16|(e[11]&255)<<24,De=o[16]&255|(o[17]&255)<<8|(o[18]&255)<<16|(o[19]&255)<<24,_e=o[20]&255|(o[21]&255)<<8|(o[22]&255)<<16|(o[23]&255)<<24,Pe=o[24]&255|(o[25]&255)<<8|(o[26]&255)<<16|(o[27]&255)<<24,Fe=o[28]&255|(o[29]&255)<<8|(o[30]&255)<<16|(o[31]&255)<<24,Ie=e[12]&255|(e[13]&255)<<8|(e[14]&255)<<16|(e[15]&255)<<24,me=x,Se=O,xe=K,ye=W,we=oe,pe=le,R=he,M=Le,fe=be,Q=Ae,$=qe,ee=De,ve=_e,Ce=Pe,Oe=Fe,Ee=Ie,S,Ue=0;Ue<20;Ue+=2)S=me+ve|0,we^=S<<7|S>>>32-7,S=we+me|0,fe^=S<<9|S>>>32-9,S=fe+we|0,ve^=S<<13|S>>>32-13,S=ve+fe|0,me^=S<<18|S>>>32-18,S=pe+Se|0,Q^=S<<7|S>>>32-7,S=Q+pe|0,Ce^=S<<9|S>>>32-9,S=Ce+Q|0,Se^=S<<13|S>>>32-13,S=Se+Ce|0,pe^=S<<18|S>>>32-18,S=$+R|0,Oe^=S<<7|S>>>32-7,S=Oe+$|0,xe^=S<<9|S>>>32-9,S=xe+Oe|0,R^=S<<13|S>>>32-13,S=R+xe|0,$^=S<<18|S>>>32-18,S=Ee+ee|0,ye^=S<<7|S>>>32-7,S=ye+Ee|0,M^=S<<9|S>>>32-9,S=M+ye|0,ee^=S<<13|S>>>32-13,S=ee+M|0,Ee^=S<<18|S>>>32-18,S=me+ye|0,Se^=S<<7|S>>>32-7,S=Se+me|0,xe^=S<<9|S>>>32-9,S=xe+Se|0,ye^=S<<13|S>>>32-13,S=ye+xe|0,me^=S<<18|S>>>32-18,S=pe+we|0,R^=S<<7|S>>>32-7,S=R+pe|0,M^=S<<9|S>>>32-9,S=M+R|0,we^=S<<13|S>>>32-13,S=we+M|0,pe^=S<<18|S>>>32-18,S=$+Q|0,ee^=S<<7|S>>>32-7,S=ee+$|0,fe^=S<<9|S>>>32-9,S=fe+ee|0,Q^=S<<13|S>>>32-13,S=Q+fe|0,$^=S<<18|S>>>32-18,S=Ee+Oe|0,ve^=S<<7|S>>>32-7,S=ve+Ee|0,Ce^=S<<9|S>>>32-9,S=Ce+ve|0,Oe^=S<<13|S>>>32-13,S=Oe+Ce|0,Ee^=S<<18|S>>>32-18;i[0]=me>>>0&255,i[1]=me>>>8&255,i[2]=me>>>16&255,i[3]=me>>>24&255,i[4]=pe>>>0&255,i[5]=pe>>>8&255,i[6]=pe>>>16&255,i[7]=pe>>>24&255,i[8]=$>>>0&255,i[9]=$>>>8&255,i[10]=$>>>16&255,i[11]=$>>>24&255,i[12]=Ee>>>0&255,i[13]=Ee>>>8&255,i[14]=Ee>>>16&255,i[15]=Ee>>>24&255,i[16]=R>>>0&255,i[17]=R>>>8&255,i[18]=R>>>16&255,i[19]=R>>>24&255,i[20]=M>>>0&255,i[21]=M>>>8&255,i[22]=M>>>16&255,i[23]=M>>>24&255,i[24]=fe>>>0&255,i[25]=fe>>>8&255,i[26]=fe>>>16&255,i[27]=fe>>>24&255,i[28]=Q>>>0&255,i[29]=Q>>>8&255,i[30]=Q>>>16&255,i[31]=Q>>>24&255}function N(i,u,o,e){d(i,u,o,e)}function Y(i,u,o,e){_(i,u,o,e)}var H=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function ae(i,u,o,e,x,O,K){var W=new Uint8Array(16),oe=new Uint8Array(64),le,he;for(he=0;he<16;he++)W[he]=0;for(he=0;he<8;he++)W[he]=O[he];for(;x>=64;){for(N(oe,W,K,H),he=0;he<64;he++)i[u+he]=o[e+he]^oe[he];for(le=1,he=8;he<16;he++)le=le+(W[he]&255)|0,W[he]=le&255,le>>>=8;x-=64,u+=64,e+=64}if(x>0)for(N(oe,W,K,H),he=0;he<x;he++)i[u+he]=o[e+he]^oe[he];return 0}function L(i,u,o,e,x){var O=new Uint8Array(16),K=new Uint8Array(64),W,oe;for(oe=0;oe<16;oe++)O[oe]=0;for(oe=0;oe<8;oe++)O[oe]=e[oe];for(;o>=64;){for(N(K,O,x,H),oe=0;oe<64;oe++)i[u+oe]=K[oe];for(W=1,oe=8;oe<16;oe++)W=W+(O[oe]&255)|0,O[oe]=W&255,W>>>=8;o-=64,u+=64}if(o>0)for(N(K,O,x,H),oe=0;oe<o;oe++)i[u+oe]=K[oe];return 0}function ne(i,u,o,e,x){var O=new Uint8Array(32);Y(O,e,x,H);for(var K=new Uint8Array(8),W=0;W<8;W++)K[W]=e[W+16];return L(i,u,o,K,O)}function J(i,u,o,e,x,O,K){var W=new Uint8Array(32);Y(W,O,K,H);for(var oe=new Uint8Array(8),le=0;le<8;le++)oe[le]=O[le+16];return ae(i,u,o,e,x,oe,W)}var te=function(i){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var u,o,e,x,O,K,W,oe;u=i[0]&255|(i[1]&255)<<8,this.r[0]=u&8191,o=i[2]&255|(i[3]&255)<<8,this.r[1]=(u>>>13|o<<3)&8191,e=i[4]&255|(i[5]&255)<<8,this.r[2]=(o>>>10|e<<6)&7939,x=i[6]&255|(i[7]&255)<<8,this.r[3]=(e>>>7|x<<9)&8191,O=i[8]&255|(i[9]&255)<<8,this.r[4]=(x>>>4|O<<12)&255,this.r[5]=O>>>1&8190,K=i[10]&255|(i[11]&255)<<8,this.r[6]=(O>>>14|K<<2)&8191,W=i[12]&255|(i[13]&255)<<8,this.r[7]=(K>>>11|W<<5)&8065,oe=i[14]&255|(i[15]&255)<<8,this.r[8]=(W>>>8|oe<<8)&8191,this.r[9]=oe>>>5&127,this.pad[0]=i[16]&255|(i[17]&255)<<8,this.pad[1]=i[18]&255|(i[19]&255)<<8,this.pad[2]=i[20]&255|(i[21]&255)<<8,this.pad[3]=i[22]&255|(i[23]&255)<<8,this.pad[4]=i[24]&255|(i[25]&255)<<8,this.pad[5]=i[26]&255|(i[27]&255)<<8,this.pad[6]=i[28]&255|(i[29]&255)<<8,this.pad[7]=i[30]&255|(i[31]&255)<<8};te.prototype.blocks=function(i,u,o){for(var e=this.fin?0:2048,x,O,K,W,oe,le,he,Le,be,Ae,qe,De,_e,Pe,Fe,Ie,me,Se,xe,ye=this.h[0],we=this.h[1],pe=this.h[2],R=this.h[3],M=this.h[4],fe=this.h[5],Q=this.h[6],$=this.h[7],ee=this.h[8],ve=this.h[9],Ce=this.r[0],Oe=this.r[1],Ee=this.r[2],S=this.r[3],Ue=this.r[4],je=this.r[5],Me=this.r[6],ke=this.r[7],Ke=this.r[8],Re=this.r[9];o>=16;)x=i[u+0]&255|(i[u+1]&255)<<8,ye+=x&8191,O=i[u+2]&255|(i[u+3]&255)<<8,we+=(x>>>13|O<<3)&8191,K=i[u+4]&255|(i[u+5]&255)<<8,pe+=(O>>>10|K<<6)&8191,W=i[u+6]&255|(i[u+7]&255)<<8,R+=(K>>>7|W<<9)&8191,oe=i[u+8]&255|(i[u+9]&255)<<8,M+=(W>>>4|oe<<12)&8191,fe+=oe>>>1&8191,le=i[u+10]&255|(i[u+11]&255)<<8,Q+=(oe>>>14|le<<2)&8191,he=i[u+12]&255|(i[u+13]&255)<<8,$+=(le>>>11|he<<5)&8191,Le=i[u+14]&255|(i[u+15]&255)<<8,ee+=(he>>>8|Le<<8)&8191,ve+=Le>>>5|e,be=0,Ae=be,Ae+=ye*Ce,Ae+=we*(5*Re),Ae+=pe*(5*Ke),Ae+=R*(5*ke),Ae+=M*(5*Me),be=Ae>>>13,Ae&=8191,Ae+=fe*(5*je),Ae+=Q*(5*Ue),Ae+=$*(5*S),Ae+=ee*(5*Ee),Ae+=ve*(5*Oe),be+=Ae>>>13,Ae&=8191,qe=be,qe+=ye*Oe,qe+=we*Ce,qe+=pe*(5*Re),qe+=R*(5*Ke),qe+=M*(5*ke),be=qe>>>13,qe&=8191,qe+=fe*(5*Me),qe+=Q*(5*je),qe+=$*(5*Ue),qe+=ee*(5*S),qe+=ve*(5*Ee),be+=qe>>>13,qe&=8191,De=be,De+=ye*Ee,De+=we*Oe,De+=pe*Ce,De+=R*(5*Re),De+=M*(5*Ke),be=De>>>13,De&=8191,De+=fe*(5*ke),De+=Q*(5*Me),De+=$*(5*je),De+=ee*(5*Ue),De+=ve*(5*S),be+=De>>>13,De&=8191,_e=be,_e+=ye*S,_e+=we*Ee,_e+=pe*Oe,_e+=R*Ce,_e+=M*(5*Re),be=_e>>>13,_e&=8191,_e+=fe*(5*Ke),_e+=Q*(5*ke),_e+=$*(5*Me),_e+=ee*(5*je),_e+=ve*(5*Ue),be+=_e>>>13,_e&=8191,Pe=be,Pe+=ye*Ue,Pe+=we*S,Pe+=pe*Ee,Pe+=R*Oe,Pe+=M*Ce,be=Pe>>>13,Pe&=8191,Pe+=fe*(5*Re),Pe+=Q*(5*Ke),Pe+=$*(5*ke),Pe+=ee*(5*Me),Pe+=ve*(5*je),be+=Pe>>>13,Pe&=8191,Fe=be,Fe+=ye*je,Fe+=we*Ue,Fe+=pe*S,Fe+=R*Ee,Fe+=M*Oe,be=Fe>>>13,Fe&=8191,Fe+=fe*Ce,Fe+=Q*(5*Re),Fe+=$*(5*Ke),Fe+=ee*(5*ke),Fe+=ve*(5*Me),be+=Fe>>>13,Fe&=8191,Ie=be,Ie+=ye*Me,Ie+=we*je,Ie+=pe*Ue,Ie+=R*S,Ie+=M*Ee,be=Ie>>>13,Ie&=8191,Ie+=fe*Oe,Ie+=Q*Ce,Ie+=$*(5*Re),Ie+=ee*(5*Ke),Ie+=ve*(5*ke),be+=Ie>>>13,Ie&=8191,me=be,me+=ye*ke,me+=we*Me,me+=pe*je,me+=R*Ue,me+=M*S,be=me>>>13,me&=8191,me+=fe*Ee,me+=Q*Oe,me+=$*Ce,me+=ee*(5*Re),me+=ve*(5*Ke),be+=me>>>13,me&=8191,Se=be,Se+=ye*Ke,Se+=we*ke,Se+=pe*Me,Se+=R*je,Se+=M*Ue,be=Se>>>13,Se&=8191,Se+=fe*S,Se+=Q*Ee,Se+=$*Oe,Se+=ee*Ce,Se+=ve*(5*Re),be+=Se>>>13,Se&=8191,xe=be,xe+=ye*Re,xe+=we*Ke,xe+=pe*ke,xe+=R*Me,xe+=M*je,be=xe>>>13,xe&=8191,xe+=fe*Ue,xe+=Q*S,xe+=$*Ee,xe+=ee*Oe,xe+=ve*Ce,be+=xe>>>13,xe&=8191,be=(be<<2)+be|0,be=be+Ae|0,Ae=be&8191,be=be>>>13,qe+=be,ye=Ae,we=qe,pe=De,R=_e,M=Pe,fe=Fe,Q=Ie,$=me,ee=Se,ve=xe,u+=16,o-=16;this.h[0]=ye,this.h[1]=we,this.h[2]=pe,this.h[3]=R,this.h[4]=M,this.h[5]=fe,this.h[6]=Q,this.h[7]=$,this.h[8]=ee,this.h[9]=ve},te.prototype.finish=function(i,u){var o=new Uint16Array(10),e,x,O,K;if(this.leftover){for(K=this.leftover,this.buffer[K++]=1;K<16;K++)this.buffer[K]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(e=this.h[1]>>>13,this.h[1]&=8191,K=2;K<10;K++)this.h[K]+=e,e=this.h[K]>>>13,this.h[K]&=8191;for(this.h[0]+=e*5,e=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=e,e=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=e,o[0]=this.h[0]+5,e=o[0]>>>13,o[0]&=8191,K=1;K<10;K++)o[K]=this.h[K]+e,e=o[K]>>>13,o[K]&=8191;for(o[9]-=8192,x=(e^1)-1,K=0;K<10;K++)o[K]&=x;for(x=~x,K=0;K<10;K++)this.h[K]=this.h[K]&x|o[K];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,O=this.h[0]+this.pad[0],this.h[0]=O&65535,K=1;K<8;K++)O=(this.h[K]+this.pad[K]|0)+(O>>>16)|0,this.h[K]=O&65535;i[u+0]=this.h[0]>>>0&255,i[u+1]=this.h[0]>>>8&255,i[u+2]=this.h[1]>>>0&255,i[u+3]=this.h[1]>>>8&255,i[u+4]=this.h[2]>>>0&255,i[u+5]=this.h[2]>>>8&255,i[u+6]=this.h[3]>>>0&255,i[u+7]=this.h[3]>>>8&255,i[u+8]=this.h[4]>>>0&255,i[u+9]=this.h[4]>>>8&255,i[u+10]=this.h[5]>>>0&255,i[u+11]=this.h[5]>>>8&255,i[u+12]=this.h[6]>>>0&255,i[u+13]=this.h[6]>>>8&255,i[u+14]=this.h[7]>>>0&255,i[u+15]=this.h[7]>>>8&255},te.prototype.update=function(i,u,o){var e,x;if(this.leftover){for(x=16-this.leftover,x>o&&(x=o),e=0;e<x;e++)this.buffer[this.leftover+e]=i[u+e];if(o-=x,u+=x,this.leftover+=x,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(o>=16&&(x=o-o%16,this.blocks(i,u,x),u+=x,o-=x),o){for(e=0;e<o;e++)this.buffer[this.leftover+e]=i[u+e];this.leftover+=o}};function ce(i,u,o,e,x,O){var K=new te(O);return K.update(o,e,x),K.finish(i,u),0}function Be(i,u,o,e,x,O){var K=new Uint8Array(16);return ce(K,0,o,e,x,O),B(i,u,K,0)}function U(i,u,o,e,x){var O;if(o<32)return-1;for(J(i,0,u,0,o,e,x),ce(i,16,i,32,o-32,i),O=0;O<16;O++)i[O]=0;return 0}function G(i,u,o,e,x){var O,K=new Uint8Array(32);if(o<32||(ne(K,0,32,e,x),Be(u,16,u,32,o-32,K)!==0))return-1;for(J(i,0,u,0,o,e,x),O=0;O<32;O++)i[O]=0;return 0}function F(i,u){var o;for(o=0;o<16;o++)i[o]=u[o]|0}function j(i){var u,o,e=1;for(u=0;u<16;u++)o=i[u]+e+65535,e=Math.floor(o/65536),i[u]=o-e*65536;i[0]+=e-1+37*(e-1)}function v(i,u,o){for(var e,x=~(o-1),O=0;O<16;O++)e=x&(i[O]^u[O]),i[O]^=e,u[O]^=e}function c(i,u){var o,e,x,O=p(),K=p();for(o=0;o<16;o++)K[o]=u[o];for(j(K),j(K),j(K),e=0;e<2;e++){for(O[0]=K[0]-65517,o=1;o<15;o++)O[o]=K[o]-65535-(O[o-1]>>16&1),O[o-1]&=65535;O[15]=K[15]-32767-(O[14]>>16&1),x=O[15]>>16&1,O[14]&=65535,v(K,O,1-x)}for(o=0;o<16;o++)i[2*o]=K[o]&255,i[2*o+1]=K[o]>>8}function y(i,u){var o=new Uint8Array(32),e=new Uint8Array(32);return c(o,i),c(e,u),f(o,0,e,0)}function g(i){var u=new Uint8Array(32);return c(u,i),u[0]&1}function V(i,u){var o;for(o=0;o<16;o++)i[o]=u[2*o]+(u[2*o+1]<<8);i[15]&=32767}function ie(i,u,o){for(var e=0;e<16;e++)i[e]=u[e]+o[e]}function se(i,u,o){for(var e=0;e<16;e++)i[e]=u[e]-o[e]}function re(i,u,o){var e,x,O=0,K=0,W=0,oe=0,le=0,he=0,Le=0,be=0,Ae=0,qe=0,De=0,_e=0,Pe=0,Fe=0,Ie=0,me=0,Se=0,xe=0,ye=0,we=0,pe=0,R=0,M=0,fe=0,Q=0,$=0,ee=0,ve=0,Ce=0,Oe=0,Ee=0,S=o[0],Ue=o[1],je=o[2],Me=o[3],ke=o[4],Ke=o[5],Re=o[6],Xe=o[7],Ve=o[8],Ze=o[9],a=o[10],s=o[11],h=o[12],I=o[13],Z=o[14],X=o[15];e=u[0],O+=e*S,K+=e*Ue,W+=e*je,oe+=e*Me,le+=e*ke,he+=e*Ke,Le+=e*Re,be+=e*Xe,Ae+=e*Ve,qe+=e*Ze,De+=e*a,_e+=e*s,Pe+=e*h,Fe+=e*I,Ie+=e*Z,me+=e*X,e=u[1],K+=e*S,W+=e*Ue,oe+=e*je,le+=e*Me,he+=e*ke,Le+=e*Ke,be+=e*Re,Ae+=e*Xe,qe+=e*Ve,De+=e*Ze,_e+=e*a,Pe+=e*s,Fe+=e*h,Ie+=e*I,me+=e*Z,Se+=e*X,e=u[2],W+=e*S,oe+=e*Ue,le+=e*je,he+=e*Me,Le+=e*ke,be+=e*Ke,Ae+=e*Re,qe+=e*Xe,De+=e*Ve,_e+=e*Ze,Pe+=e*a,Fe+=e*s,Ie+=e*h,me+=e*I,Se+=e*Z,xe+=e*X,e=u[3],oe+=e*S,le+=e*Ue,he+=e*je,Le+=e*Me,be+=e*ke,Ae+=e*Ke,qe+=e*Re,De+=e*Xe,_e+=e*Ve,Pe+=e*Ze,Fe+=e*a,Ie+=e*s,me+=e*h,Se+=e*I,xe+=e*Z,ye+=e*X,e=u[4],le+=e*S,he+=e*Ue,Le+=e*je,be+=e*Me,Ae+=e*ke,qe+=e*Ke,De+=e*Re,_e+=e*Xe,Pe+=e*Ve,Fe+=e*Ze,Ie+=e*a,me+=e*s,Se+=e*h,xe+=e*I,ye+=e*Z,we+=e*X,e=u[5],he+=e*S,Le+=e*Ue,be+=e*je,Ae+=e*Me,qe+=e*ke,De+=e*Ke,_e+=e*Re,Pe+=e*Xe,Fe+=e*Ve,Ie+=e*Ze,me+=e*a,Se+=e*s,xe+=e*h,ye+=e*I,we+=e*Z,pe+=e*X,e=u[6],Le+=e*S,be+=e*Ue,Ae+=e*je,qe+=e*Me,De+=e*ke,_e+=e*Ke,Pe+=e*Re,Fe+=e*Xe,Ie+=e*Ve,me+=e*Ze,Se+=e*a,xe+=e*s,ye+=e*h,we+=e*I,pe+=e*Z,R+=e*X,e=u[7],be+=e*S,Ae+=e*Ue,qe+=e*je,De+=e*Me,_e+=e*ke,Pe+=e*Ke,Fe+=e*Re,Ie+=e*Xe,me+=e*Ve,Se+=e*Ze,xe+=e*a,ye+=e*s,we+=e*h,pe+=e*I,R+=e*Z,M+=e*X,e=u[8],Ae+=e*S,qe+=e*Ue,De+=e*je,_e+=e*Me,Pe+=e*ke,Fe+=e*Ke,Ie+=e*Re,me+=e*Xe,Se+=e*Ve,xe+=e*Ze,ye+=e*a,we+=e*s,pe+=e*h,R+=e*I,M+=e*Z,fe+=e*X,e=u[9],qe+=e*S,De+=e*Ue,_e+=e*je,Pe+=e*Me,Fe+=e*ke,Ie+=e*Ke,me+=e*Re,Se+=e*Xe,xe+=e*Ve,ye+=e*Ze,we+=e*a,pe+=e*s,R+=e*h,M+=e*I,fe+=e*Z,Q+=e*X,e=u[10],De+=e*S,_e+=e*Ue,Pe+=e*je,Fe+=e*Me,Ie+=e*ke,me+=e*Ke,Se+=e*Re,xe+=e*Xe,ye+=e*Ve,we+=e*Ze,pe+=e*a,R+=e*s,M+=e*h,fe+=e*I,Q+=e*Z,$+=e*X,e=u[11],_e+=e*S,Pe+=e*Ue,Fe+=e*je,Ie+=e*Me,me+=e*ke,Se+=e*Ke,xe+=e*Re,ye+=e*Xe,we+=e*Ve,pe+=e*Ze,R+=e*a,M+=e*s,fe+=e*h,Q+=e*I,$+=e*Z,ee+=e*X,e=u[12],Pe+=e*S,Fe+=e*Ue,Ie+=e*je,me+=e*Me,Se+=e*ke,xe+=e*Ke,ye+=e*Re,we+=e*Xe,pe+=e*Ve,R+=e*Ze,M+=e*a,fe+=e*s,Q+=e*h,$+=e*I,ee+=e*Z,ve+=e*X,e=u[13],Fe+=e*S,Ie+=e*Ue,me+=e*je,Se+=e*Me,xe+=e*ke,ye+=e*Ke,we+=e*Re,pe+=e*Xe,R+=e*Ve,M+=e*Ze,fe+=e*a,Q+=e*s,$+=e*h,ee+=e*I,ve+=e*Z,Ce+=e*X,e=u[14],Ie+=e*S,me+=e*Ue,Se+=e*je,xe+=e*Me,ye+=e*ke,we+=e*Ke,pe+=e*Re,R+=e*Xe,M+=e*Ve,fe+=e*Ze,Q+=e*a,$+=e*s,ee+=e*h,ve+=e*I,Ce+=e*Z,Oe+=e*X,e=u[15],me+=e*S,Se+=e*Ue,xe+=e*je,ye+=e*Me,we+=e*ke,pe+=e*Ke,R+=e*Re,M+=e*Xe,fe+=e*Ve,Q+=e*Ze,$+=e*a,ee+=e*s,ve+=e*h,Ce+=e*I,Oe+=e*Z,Ee+=e*X,O+=38*Se,K+=38*xe,W+=38*ye,oe+=38*we,le+=38*pe,he+=38*R,Le+=38*M,be+=38*fe,Ae+=38*Q,qe+=38*$,De+=38*ee,_e+=38*ve,Pe+=38*Ce,Fe+=38*Oe,Ie+=38*Ee,x=1,e=O+x+65535,x=Math.floor(e/65536),O=e-x*65536,e=K+x+65535,x=Math.floor(e/65536),K=e-x*65536,e=W+x+65535,x=Math.floor(e/65536),W=e-x*65536,e=oe+x+65535,x=Math.floor(e/65536),oe=e-x*65536,e=le+x+65535,x=Math.floor(e/65536),le=e-x*65536,e=he+x+65535,x=Math.floor(e/65536),he=e-x*65536,e=Le+x+65535,x=Math.floor(e/65536),Le=e-x*65536,e=be+x+65535,x=Math.floor(e/65536),be=e-x*65536,e=Ae+x+65535,x=Math.floor(e/65536),Ae=e-x*65536,e=qe+x+65535,x=Math.floor(e/65536),qe=e-x*65536,e=De+x+65535,x=Math.floor(e/65536),De=e-x*65536,e=_e+x+65535,x=Math.floor(e/65536),_e=e-x*65536,e=Pe+x+65535,x=Math.floor(e/65536),Pe=e-x*65536,e=Fe+x+65535,x=Math.floor(e/65536),Fe=e-x*65536,e=Ie+x+65535,x=Math.floor(e/65536),Ie=e-x*65536,e=me+x+65535,x=Math.floor(e/65536),me=e-x*65536,O+=x-1+37*(x-1),x=1,e=O+x+65535,x=Math.floor(e/65536),O=e-x*65536,e=K+x+65535,x=Math.floor(e/65536),K=e-x*65536,e=W+x+65535,x=Math.floor(e/65536),W=e-x*65536,e=oe+x+65535,x=Math.floor(e/65536),oe=e-x*65536,e=le+x+65535,x=Math.floor(e/65536),le=e-x*65536,e=he+x+65535,x=Math.floor(e/65536),he=e-x*65536,e=Le+x+65535,x=Math.floor(e/65536),Le=e-x*65536,e=be+x+65535,x=Math.floor(e/65536),be=e-x*65536,e=Ae+x+65535,x=Math.floor(e/65536),Ae=e-x*65536,e=qe+x+65535,x=Math.floor(e/65536),qe=e-x*65536,e=De+x+65535,x=Math.floor(e/65536),De=e-x*65536,e=_e+x+65535,x=Math.floor(e/65536),_e=e-x*65536,e=Pe+x+65535,x=Math.floor(e/65536),Pe=e-x*65536,e=Fe+x+65535,x=Math.floor(e/65536),Fe=e-x*65536,e=Ie+x+65535,x=Math.floor(e/65536),Ie=e-x*65536,e=me+x+65535,x=Math.floor(e/65536),me=e-x*65536,O+=x-1+37*(x-1),i[0]=O,i[1]=K,i[2]=W,i[3]=oe,i[4]=le,i[5]=he,i[6]=Le,i[7]=be,i[8]=Ae,i[9]=qe,i[10]=De,i[11]=_e,i[12]=Pe,i[13]=Fe,i[14]=Ie,i[15]=me}function ue(i,u){re(i,u,u)}function Te(i,u){var o=p(),e;for(e=0;e<16;e++)o[e]=u[e];for(e=253;e>=0;e--)ue(o,o),e!==2&&e!==4&&re(o,o,u);for(e=0;e<16;e++)i[e]=o[e]}function Ne(i,u){var o=p(),e;for(e=0;e<16;e++)o[e]=u[e];for(e=250;e>=0;e--)ue(o,o),e!==1&&re(o,o,u);for(e=0;e<16;e++)i[e]=o[e]}function ze(i,u,o){var e=new Uint8Array(32),x=new Float64Array(80),O,K,W=p(),oe=p(),le=p(),he=p(),Le=p(),be=p();for(K=0;K<31;K++)e[K]=u[K];for(e[31]=u[31]&127|64,e[0]&=248,V(x,o),K=0;K<16;K++)oe[K]=x[K],he[K]=W[K]=le[K]=0;for(W[0]=he[0]=1,K=254;K>=0;--K)O=e[K>>>3]>>>(K&7)&1,v(W,oe,O),v(le,he,O),ie(Le,W,le),se(W,W,le),ie(le,oe,he),se(oe,oe,he),ue(he,Le),ue(be,W),re(W,le,W),re(le,oe,Le),ie(Le,W,le),se(W,W,le),ue(oe,W),se(le,he,be),re(W,le,k),ie(W,W,he),re(le,le,W),re(W,he,be),re(he,oe,x),ue(oe,Le),v(W,oe,O),v(le,he,O);for(K=0;K<16;K++)x[K+16]=W[K],x[K+32]=le[K],x[K+48]=oe[K],x[K+64]=he[K];var Ae=x.subarray(32),qe=x.subarray(16);return Te(Ae,Ae),re(qe,qe,Ae),c(i,qe),0}function He(i,u){return ze(i,u,b)}function Je(i,u){return D(u,32),He(i,u)}function Ye(i,u,o){var e=new Uint8Array(32);return ze(e,o,u),Y(i,A,e,H)}var dt=U,yt=G;function Pt(i,u,o,e,x,O){var K=new Uint8Array(32);return Ye(K,x,O),dt(i,u,o,e,K)}function $t(i,u,o,e,x,O){var K=new Uint8Array(32);return Ye(K,x,O),yt(i,u,o,e,K)}var tt=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function vr(i,u,o,e){for(var x=new Int32Array(16),O=new Int32Array(16),K,W,oe,le,he,Le,be,Ae,qe,De,_e,Pe,Fe,Ie,me,Se,xe,ye,we,pe,R,M,fe,Q,$,ee,ve=i[0],Ce=i[1],Oe=i[2],Ee=i[3],S=i[4],Ue=i[5],je=i[6],Me=i[7],ke=u[0],Ke=u[1],Re=u[2],Xe=u[3],Ve=u[4],Ze=u[5],a=u[6],s=u[7],h=0;e>=128;){for(we=0;we<16;we++)pe=8*we+h,x[we]=o[pe+0]<<24|o[pe+1]<<16|o[pe+2]<<8|o[pe+3],O[we]=o[pe+4]<<24|o[pe+5]<<16|o[pe+6]<<8|o[pe+7];for(we=0;we<80;we++)if(K=ve,W=Ce,oe=Oe,le=Ee,he=S,Le=Ue,be=je,Ae=Me,qe=ke,De=Ke,_e=Re,Pe=Xe,Fe=Ve,Ie=Ze,me=a,Se=s,R=Me,M=s,fe=M&65535,Q=M>>>16,$=R&65535,ee=R>>>16,R=(S>>>14|Ve<<32-14)^(S>>>18|Ve<<32-18)^(Ve>>>41-32|S<<32-(41-32)),M=(Ve>>>14|S<<32-14)^(Ve>>>18|S<<32-18)^(S>>>41-32|Ve<<32-(41-32)),fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,R=S&Ue^~S&je,M=Ve&Ze^~Ve&a,fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,R=tt[we*2],M=tt[we*2+1],fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,R=x[we%16],M=O[we%16],fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,Q+=fe>>>16,$+=Q>>>16,ee+=$>>>16,xe=$&65535|ee<<16,ye=fe&65535|Q<<16,R=xe,M=ye,fe=M&65535,Q=M>>>16,$=R&65535,ee=R>>>16,R=(ve>>>28|ke<<32-28)^(ke>>>34-32|ve<<32-(34-32))^(ke>>>39-32|ve<<32-(39-32)),M=(ke>>>28|ve<<32-28)^(ve>>>34-32|ke<<32-(34-32))^(ve>>>39-32|ke<<32-(39-32)),fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,R=ve&Ce^ve&Oe^Ce&Oe,M=ke&Ke^ke&Re^Ke&Re,fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,Q+=fe>>>16,$+=Q>>>16,ee+=$>>>16,Ae=$&65535|ee<<16,Se=fe&65535|Q<<16,R=le,M=Pe,fe=M&65535,Q=M>>>16,$=R&65535,ee=R>>>16,R=xe,M=ye,fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,Q+=fe>>>16,$+=Q>>>16,ee+=$>>>16,le=$&65535|ee<<16,Pe=fe&65535|Q<<16,Ce=K,Oe=W,Ee=oe,S=le,Ue=he,je=Le,Me=be,ve=Ae,Ke=qe,Re=De,Xe=_e,Ve=Pe,Ze=Fe,a=Ie,s=me,ke=Se,we%16===15)for(pe=0;pe<16;pe++)R=x[pe],M=O[pe],fe=M&65535,Q=M>>>16,$=R&65535,ee=R>>>16,R=x[(pe+9)%16],M=O[(pe+9)%16],fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,xe=x[(pe+1)%16],ye=O[(pe+1)%16],R=(xe>>>1|ye<<32-1)^(xe>>>8|ye<<32-8)^xe>>>7,M=(ye>>>1|xe<<32-1)^(ye>>>8|xe<<32-8)^(ye>>>7|xe<<32-7),fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,xe=x[(pe+14)%16],ye=O[(pe+14)%16],R=(xe>>>19|ye<<32-19)^(ye>>>61-32|xe<<32-(61-32))^xe>>>6,M=(ye>>>19|xe<<32-19)^(xe>>>61-32|ye<<32-(61-32))^(ye>>>6|xe<<32-6),fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,Q+=fe>>>16,$+=Q>>>16,ee+=$>>>16,x[pe]=$&65535|ee<<16,O[pe]=fe&65535|Q<<16;R=ve,M=ke,fe=M&65535,Q=M>>>16,$=R&65535,ee=R>>>16,R=i[0],M=u[0],fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,Q+=fe>>>16,$+=Q>>>16,ee+=$>>>16,i[0]=ve=$&65535|ee<<16,u[0]=ke=fe&65535|Q<<16,R=Ce,M=Ke,fe=M&65535,Q=M>>>16,$=R&65535,ee=R>>>16,R=i[1],M=u[1],fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,Q+=fe>>>16,$+=Q>>>16,ee+=$>>>16,i[1]=Ce=$&65535|ee<<16,u[1]=Ke=fe&65535|Q<<16,R=Oe,M=Re,fe=M&65535,Q=M>>>16,$=R&65535,ee=R>>>16,R=i[2],M=u[2],fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,Q+=fe>>>16,$+=Q>>>16,ee+=$>>>16,i[2]=Oe=$&65535|ee<<16,u[2]=Re=fe&65535|Q<<16,R=Ee,M=Xe,fe=M&65535,Q=M>>>16,$=R&65535,ee=R>>>16,R=i[3],M=u[3],fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,Q+=fe>>>16,$+=Q>>>16,ee+=$>>>16,i[3]=Ee=$&65535|ee<<16,u[3]=Xe=fe&65535|Q<<16,R=S,M=Ve,fe=M&65535,Q=M>>>16,$=R&65535,ee=R>>>16,R=i[4],M=u[4],fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,Q+=fe>>>16,$+=Q>>>16,ee+=$>>>16,i[4]=S=$&65535|ee<<16,u[4]=Ve=fe&65535|Q<<16,R=Ue,M=Ze,fe=M&65535,Q=M>>>16,$=R&65535,ee=R>>>16,R=i[5],M=u[5],fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,Q+=fe>>>16,$+=Q>>>16,ee+=$>>>16,i[5]=Ue=$&65535|ee<<16,u[5]=Ze=fe&65535|Q<<16,R=je,M=a,fe=M&65535,Q=M>>>16,$=R&65535,ee=R>>>16,R=i[6],M=u[6],fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,Q+=fe>>>16,$+=Q>>>16,ee+=$>>>16,i[6]=je=$&65535|ee<<16,u[6]=a=fe&65535|Q<<16,R=Me,M=s,fe=M&65535,Q=M>>>16,$=R&65535,ee=R>>>16,R=i[7],M=u[7],fe+=M&65535,Q+=M>>>16,$+=R&65535,ee+=R>>>16,Q+=fe>>>16,$+=Q>>>16,ee+=$>>>16,i[7]=Me=$&65535|ee<<16,u[7]=s=fe&65535|Q<<16,h+=128,e-=128}return e}function St(i,u,o){var e=new Int32Array(8),x=new Int32Array(8),O=new Uint8Array(256),K,W=o;for(e[0]=1779033703,e[1]=3144134277,e[2]=1013904242,e[3]=2773480762,e[4]=1359893119,e[5]=2600822924,e[6]=528734635,e[7]=1541459225,x[0]=4089235720,x[1]=2227873595,x[2]=4271175723,x[3]=1595750129,x[4]=2917565137,x[5]=725511199,x[6]=4215389547,x[7]=327033209,vr(e,x,u,o),o%=128,K=0;K<o;K++)O[K]=u[W-o+K];for(O[o]=128,o=256-128*(o<112?1:0),O[o-9]=0,n(O,o-8,W/536870912|0,W<<3),vr(e,x,O,o),K=0;K<8;K++)n(i,8*K,e[K],x[K]);return 0}function Qt(i,u){var o=p(),e=p(),x=p(),O=p(),K=p(),W=p(),oe=p(),le=p(),he=p();se(o,i[1],i[0]),se(he,u[1],u[0]),re(o,o,he),ie(e,i[0],i[1]),ie(he,u[0],u[1]),re(e,e,he),re(x,i[3],u[3]),re(x,x,C),re(O,i[2],u[2]),ie(O,O,O),se(K,e,o),se(W,O,x),ie(oe,O,x),ie(le,e,o),re(i[0],K,W),re(i[1],le,oe),re(i[2],oe,W),re(i[3],K,le)}function br(i,u,o){var e;for(e=0;e<4;e++)v(i[e],u[e],o)}function Xt(i,u){var o=p(),e=p(),x=p();Te(x,u[2]),re(o,u[0],x),re(e,u[1],x),c(i,e),i[31]^=g(o)<<7}function gr(i,u,o){var e,x;for(F(i[0],E),F(i[1],T),F(i[2],T),F(i[3],E),x=255;x>=0;--x)e=o[x/8|0]>>(x&7)&1,br(i,u,e),Qt(u,i),Qt(i,i),br(i,u,e)}function Wt(i,u){var o=[p(),p(),p(),p()];F(o[0],m),F(o[1],P),F(o[2],T),re(o[3],m,P),gr(i,o,u)}function Jt(i,u,o){var e=new Uint8Array(64),x=[p(),p(),p(),p()],O;for(o||D(u,32),St(e,u,32),e[0]&=248,e[31]&=127,e[31]|=64,Wt(x,e),Xt(i,x),O=0;O<32;O++)u[O+32]=i[O];return 0}var er=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function mr(i,u){var o,e,x,O;for(e=63;e>=32;--e){for(o=0,x=e-32,O=e-12;x<O;++x)u[x]+=o-16*u[e]*er[x-(e-32)],o=u[x]+128>>8,u[x]-=o*256;u[x]+=o,u[e]=0}for(o=0,x=0;x<32;x++)u[x]+=o-(u[31]>>4)*er[x],o=u[x]>>8,u[x]&=255;for(x=0;x<32;x++)u[x]-=o*er[x];for(e=0;e<32;e++)u[e+1]+=u[e]>>8,i[e]=u[e]&255}function tr(i){var u=new Float64Array(64),o;for(o=0;o<64;o++)u[o]=i[o];for(o=0;o<64;o++)i[o]=0;mr(i,u)}function yr(i,u,o,e){var x=new Uint8Array(64),O=new Uint8Array(64),K=new Uint8Array(64),W,oe,le=new Float64Array(64),he=[p(),p(),p(),p()];St(x,e,32),x[0]&=248,x[31]&=127,x[31]|=64;var Le=o+64;for(W=0;W<o;W++)i[64+W]=u[W];for(W=0;W<32;W++)i[32+W]=x[32+W];for(St(K,i.subarray(32),o+32),tr(K),Wt(he,K),Xt(i,he),W=32;W<64;W++)i[W]=e[W];for(St(O,i,o+64),tr(O),W=0;W<64;W++)le[W]=0;for(W=0;W<32;W++)le[W]=K[W];for(W=0;W<32;W++)for(oe=0;oe<32;oe++)le[W+oe]+=O[W]*x[oe];return mr(i.subarray(32),le),Le}function Cr(i,u){var o=p(),e=p(),x=p(),O=p(),K=p(),W=p(),oe=p();return F(i[2],T),V(i[1],u),ue(x,i[1]),re(O,x,z),se(x,x,i[2]),ie(O,i[2],O),ue(K,O),ue(W,K),re(oe,W,K),re(o,oe,x),re(o,o,O),Ne(o,o),re(o,o,x),re(o,o,O),re(o,o,O),re(i[0],o,O),ue(e,i[0]),re(e,e,O),y(e,x)&&re(i[0],i[0],w),ue(e,i[0]),re(e,e,O),y(e,x)?-1:(g(i[0])===u[31]>>7&&se(i[0],E,i[0]),re(i[3],i[0],i[1]),0)}function rr(i,u,o,e){var x,O,K=new Uint8Array(32),W=new Uint8Array(64),oe=[p(),p(),p(),p()],le=[p(),p(),p(),p()];if(O=-1,o<64||Cr(le,e))return-1;for(x=0;x<o;x++)i[x]=u[x];for(x=0;x<32;x++)i[x+32]=e[x];if(St(W,i,o),tr(W),gr(oe,le,W),Wt(le,u.subarray(32)),Qt(oe,le),Xt(K,oe),o-=64,f(u,0,K,0)){for(x=0;x<o;x++)i[x]=0;return-1}for(x=0;x<o;x++)i[x]=u[x+64];return O=o,O}var ir=32,jt=24,Bt=32,It=16,Ft=32,Mt=32,Tt=32,Kt=32,ar=32,wr=jt,Or=Bt,kr=It,vt=64,Et=32,Dt=64,fr=32,nr=64;r.lowlevel={crypto_core_hsalsa20:Y,crypto_stream_xor:J,crypto_stream:ne,crypto_stream_salsa20_xor:ae,crypto_stream_salsa20:L,crypto_onetimeauth:ce,crypto_onetimeauth_verify:Be,crypto_verify_16:B,crypto_verify_32:f,crypto_secretbox:U,crypto_secretbox_open:G,crypto_scalarmult:ze,crypto_scalarmult_base:He,crypto_box_beforenm:Ye,crypto_box_afternm:dt,crypto_box:Pt,crypto_box_open:$t,crypto_box_keypair:Je,crypto_hash:St,crypto_sign:yr,crypto_sign_keypair:Jt,crypto_sign_open:rr,crypto_secretbox_KEYBYTES:ir,crypto_secretbox_NONCEBYTES:jt,crypto_secretbox_ZEROBYTES:Bt,crypto_secretbox_BOXZEROBYTES:It,crypto_scalarmult_BYTES:Ft,crypto_scalarmult_SCALARBYTES:Mt,crypto_box_PUBLICKEYBYTES:Tt,crypto_box_SECRETKEYBYTES:Kt,crypto_box_BEFORENMBYTES:ar,crypto_box_NONCEBYTES:wr,crypto_box_ZEROBYTES:Or,crypto_box_BOXZEROBYTES:kr,crypto_sign_BYTES:vt,crypto_sign_PUBLICKEYBYTES:Et,crypto_sign_SECRETKEYBYTES:Dt,crypto_sign_SEEDBYTES:fr,crypto_hash_BYTES:nr};function Sr(i,u){if(i.length!==ir)throw new Error("bad key size");if(u.length!==jt)throw new Error("bad nonce size")}function Ur(i,u){if(i.length!==Tt)throw new Error("bad public key size");if(u.length!==Kt)throw new Error("bad secret key size")}function ct(){var i,u;for(u=0;u<arguments.length;u++)if((i=Object.prototype.toString.call(arguments[u]))!=="[object Uint8Array]")throw new TypeError("unexpected type "+i+", use Uint8Array")}function Br(i){for(var u=0;u<i.length;u++)i[u]=0}r.util||(r.util={},r.util.decodeUTF8=r.util.encodeUTF8=r.util.encodeBase64=r.util.decodeBase64=function(){throw new Error("nacl.util moved into separate package: https://github.com/dchest/tweetnacl-util-js")}),r.randomBytes=function(i){var u=new Uint8Array(i);return D(u,i),u},r.secretbox=function(i,u,o){ct(i,u,o),Sr(o,u);for(var e=new Uint8Array(Bt+i.length),x=new Uint8Array(e.length),O=0;O<i.length;O++)e[O+Bt]=i[O];return U(x,e,e.length,u,o),x.subarray(It)},r.secretbox.open=function(i,u,o){ct(i,u,o),Sr(o,u);for(var e=new Uint8Array(It+i.length),x=new Uint8Array(e.length),O=0;O<i.length;O++)e[O+It]=i[O];return e.length<32||G(x,e,e.length,u,o)!==0?!1:x.subarray(Bt)},r.secretbox.keyLength=ir,r.secretbox.nonceLength=jt,r.secretbox.overheadLength=It,r.scalarMult=function(i,u){if(ct(i,u),i.length!==Mt)throw new Error("bad n size");if(u.length!==Ft)throw new Error("bad p size");var o=new Uint8Array(Ft);return ze(o,i,u),o},r.scalarMult.base=function(i){if(ct(i),i.length!==Mt)throw new Error("bad n size");var u=new Uint8Array(Ft);return He(u,i),u},r.scalarMult.scalarLength=Mt,r.scalarMult.groupElementLength=Ft,r.box=function(i,u,o,e){var x=r.box.before(o,e);return r.secretbox(i,u,x)},r.box.before=function(i,u){ct(i,u),Ur(i,u);var o=new Uint8Array(ar);return Ye(o,i,u),o},r.box.after=r.secretbox,r.box.open=function(i,u,o,e){var x=r.box.before(o,e);return r.secretbox.open(i,u,x)},r.box.open.after=r.secretbox.open,r.box.keyPair=function(){var i=new Uint8Array(Tt),u=new Uint8Array(Kt);return Je(i,u),{publicKey:i,secretKey:u}},r.box.keyPair.fromSecretKey=function(i){if(ct(i),i.length!==Kt)throw new Error("bad secret key size");var u=new Uint8Array(Tt);return He(u,i),{publicKey:u,secretKey:new Uint8Array(i)}},r.box.publicKeyLength=Tt,r.box.secretKeyLength=Kt,r.box.sharedKeyLength=ar,r.box.nonceLength=wr,r.box.overheadLength=r.secretbox.overheadLength,r.sign=function(i,u){if(ct(i,u),u.length!==Dt)throw new Error("bad secret key size");var o=new Uint8Array(vt+i.length);return yr(o,i,i.length,u),o},r.sign.open=function(i,u){if(arguments.length!==2)throw new Error("nacl.sign.open accepts 2 arguments; did you mean to use nacl.sign.detached.verify?");if(ct(i,u),u.length!==Et)throw new Error("bad public key size");var o=new Uint8Array(i.length),e=rr(o,i,i.length,u);if(e<0)return null;for(var x=new Uint8Array(e),O=0;O<x.length;O++)x[O]=o[O];return x},r.sign.detached=function(i,u){for(var o=r.sign(i,u),e=new Uint8Array(vt),x=0;x<e.length;x++)e[x]=o[x];return e},r.sign.detached.verify=function(i,u,o){if(ct(i,u,o),u.length!==vt)throw new Error("bad signature size");if(o.length!==Et)throw new Error("bad public key size");var e=new Uint8Array(vt+i.length),x=new Uint8Array(vt+i.length),O;for(O=0;O<vt;O++)e[O]=u[O];for(O=0;O<i.length;O++)e[O+vt]=i[O];return rr(x,e,e.length,o)>=0},r.sign.keyPair=function(){var i=new Uint8Array(Et),u=new Uint8Array(Dt);return Jt(i,u),{publicKey:i,secretKey:u}},r.sign.keyPair.fromSecretKey=function(i){if(ct(i),i.length!==Dt)throw new Error("bad secret key size");for(var u=new Uint8Array(Et),o=0;o<u.length;o++)u[o]=i[32+o];return{publicKey:u,secretKey:new Uint8Array(i)}},r.sign.keyPair.fromSeed=function(i){if(ct(i),i.length!==fr)throw new Error("bad seed size");for(var u=new Uint8Array(Et),o=new Uint8Array(Dt),e=0;e<32;e++)o[e]=i[e];return Jt(u,o,!0),{publicKey:u,secretKey:o}},r.sign.publicKeyLength=Et,r.sign.secretKeyLength=Dt,r.sign.seedLength=fr,r.sign.signatureLength=vt,r.hash=function(i){ct(i);var u=new Uint8Array(nr);return St(u,i,i.length),u},r.hash.hashLength=nr,r.verify=function(i,u){return ct(i,u),i.length===0||u.length===0||i.length!==u.length?!1:l(i,0,u,0,i.length)===0},r.setPRNG=function(i){D=i},function(){var i=typeof self<"u"?self.crypto||self.msCrypto:null;if(i&&i.getRandomValues){var u=65536;r.setPRNG(function(o,e){var x,O=new Uint8Array(e);for(x=0;x<e;x+=u)i.getRandomValues(O.subarray(x,x+Math.min(e-x,u)));for(x=0;x<e;x++)o[x]=O[x];Br(O)})}else typeof ha<"u"&&(i=pt(),i&&i.randomBytes&&r.setPRNG(function(o,e){var x,O=i.randomBytes(e);for(x=0;x<e;x++)o[x]=O[x];Br(O)}))}()})(t.exports?t.exports:self.nacl=self.nacl||{})})(aa);var cr=aa.exports,Lr,Ai;function ft(){if(Ai)return Lr;Ai=1,Lr={bufferSplit:d,addRSAMissing:Be,calculateDSAPublic:J,calculateED25519Public:te,calculateX25519Public:ce,mpNormalize:H,mpDenormalize:ae,ecNormalize:_,countZeros:f,assertCompatible:P,isCompatible:m,opensslKeyDeriv:l,opensshCipherInfo:G,publicFromPrivateECDSA:U,zeroPadToLength:L,writeBitString:Y,readBitString:N,pbkdf2:B};var t=et,r=Qe.Buffer,p=nt(),D=st(),A=pt(),b=wt,E=Lt,T=Tr,k=ur.BigInteger,z=cr,C=3;function m(F,j,v){if(F===null||typeof F!="object")return!1;if(v===void 0&&(v=j.prototype._sshpkApiVersion),F instanceof j&&j.prototype._sshpkApiVersion[0]==v[0])return!0;for(var c=Object.getPrototypeOf(F),y=0;c.constructor.name!==j.name;)if(c=Object.getPrototypeOf(c),!c||++y>C)return!1;if(c.constructor.name!==j.name)return!1;var g=c._sshpkApiVersion;return g===void 0&&(g=j._oldVersionDetect(F)),!(g[0]!=v[0]||g[1]<v[1])}function P(F,j,v,c){if(c===void 0&&(c="object"),t.ok(F,c+" must not be null"),t.object(F,c+" must be an object"),v===void 0&&(v=j.prototype._sshpkApiVersion),!(F instanceof j&&j.prototype._sshpkApiVersion[0]==v[0])){for(var y=Object.getPrototypeOf(F),g=0;y.constructor.name!==j.name;)y=Object.getPrototypeOf(y),t.ok(y&&++g<=C,c+" must be a "+j.name+" instance");t.strictEqual(y.constructor.name,j.name,c+" must be a "+j.name+" instance");var V=y._sshpkApiVersion;V===void 0&&(V=j._oldVersionDetect(F)),t.ok(V[0]==v[0]&&V[1]>=v[1],c+" must be compatible with "+j.name+" klass version "+v[0]+"."+v[1])}}var w={"des-ede3-cbc":{key:24,iv:8},"aes-128-cbc":{key:16,iv:16},"aes-256-cbc":{key:32,iv:16}},n=8;function l(F,j,v,c){t.buffer(j,"salt"),t.buffer(v,"passphrase"),t.number(c,"iteration count");var y=w[F];t.object(y,"supported cipher"),j=j.slice(0,n);for(var g,V,ie,se=r.alloc(0);se.length<y.key+y.iv;){ie=[],V&&ie.push(V),ie.push(v),ie.push(j),g=r.concat(ie);for(var re=0;re<c;++re)g=A.createHash("md5").update(g).digest();se=r.concat([se,g]),V=g}return{key:se.slice(0,y.key),iv:se.slice(y.key,y.key+y.iv)}}function B(F,j,v,c,y){var g=r.alloc(j.length+4);j.copy(g);for(var V=0,ie=[],se=1;V<c;){var re=ue(se++);V+=re.length,ie.push(re)}return r.concat(ie).slice(0,c);function ue(Te){g.writeUInt32BE(Te,g.length-4);var Ne=A.createHmac(F,y);Ne.update(g);for(var ze=Ne.digest(),He=ze,Je=1;Je++<v;){Ne=A.createHmac(F,y),Ne.update(He),He=Ne.digest();for(var Ye=0;Ye<ze.length;++Ye)ze[Ye]^=He[Ye]}return ze}}function f(F){for(var j=0,v=8;j<F.length;){var c=1<<v;if((F[j]&c)===c)break;v--,v<0&&(j++,v=8)}return j*8+(8-v)-1}function d(F,j){t.buffer(F),t.string(j);for(var v=[],c=0,y=0,g=0;g<F.length;++g)if(F[g]===j.charCodeAt(y)?++y:F[g]===j.charCodeAt(0)?y=1:y=0,y>=j.length){var V=g+1;v.push(F.slice(c,V-y)),c=V,y=0}return c<=F.length&&v.push(F.slice(c,F.length)),v}function _(F,j){if(t.buffer(F),F[0]===0&&F[1]===4)return j?F:F.slice(1);if(F[0]===4){if(!j)return F}else{for(;F[0]===0;)F=F.slice(1);if(F[0]===2||F[0]===3)throw new Error("Compressed elliptic curve points are not supported");if(F[0]!==4)throw new Error("Not a valid elliptic curve point");if(!j)return F}var v=r.alloc(F.length+1);return v[0]=0,F.copy(v,1),v}function N(F,j){j===void 0&&(j=E.Ber.BitString);var v=F.readString(j,!0);return t.strictEqual(v[0],0,"bit strings with unused bits are not supported (0x"+v[0].toString(16)+")"),v.slice(1)}function Y(F,j,v){v===void 0&&(v=E.Ber.BitString);var c=r.alloc(j.length+1);c[0]=0,j.copy(c,1),F.writeBuffer(c,v)}function H(F){for(t.buffer(F);F.length>1&&F[0]===0&&!(F[1]&128);)F=F.slice(1);if((F[0]&128)===128){var j=r.alloc(F.length+1);j[0]=0,F.copy(j,1),F=j}return F}function ae(F){for(t.buffer(F);F.length>1&&F[0]===0;)F=F.slice(1);return F}function L(F,j){for(t.buffer(F),t.number(j);F.length>j;)t.equal(F[0],0),F=F.slice(1);for(;F.length<j;){var v=r.alloc(F.length+1);v[0]=0,F.copy(v,1),F=v}return F}function ne(F){var j=r.from(F.toByteArray());return j=H(j),j}function J(F,j,v){t.buffer(F),t.buffer(j),t.buffer(v),F=new k(F),j=new k(j),v=new k(v);var c=F.modPow(v,j),y=ne(c);return y}function te(F){t.buffer(F);var j=z.sign.keyPair.fromSeed(new Uint8Array(F));return r.from(j.publicKey)}function ce(F){t.buffer(F);var j=z.box.keyPair.fromSeed(new Uint8Array(F));return r.from(j.publicKey)}function Be(F){t.object(F),P(F,p,[1,1]);var j=new k(F.part.d.data),v;if(!F.part.dmodp){var c=new k(F.part.p.data),y=j.mod(c.subtract(1));v=ne(y),F.part.dmodp={name:"dmodp",data:v},F.parts.push(F.part.dmodp)}if(!F.part.dmodq){var g=new k(F.part.q.data),V=j.mod(g.subtract(1));v=ne(V),F.part.dmodq={name:"dmodq",data:v},F.parts.push(F.part.dmodq)}}function U(F,j){t.string(F,"curveName"),t.buffer(j);var v=b.curves[F],c=new k(v.p),y=new k(v.a),g=new k(v.b),V=new T.ECCurveFp(c,y,g),ie=V.decodePointHex(v.G.toString("hex")),se=new k(H(j)),re=ie.multiply(se);re=r.from(V.encodePointHex(re),"hex");var ue=[];ue.push({name:"curve",data:r.from(F)}),ue.push({name:"Q",data:re});var Te=new D({type:"ecdsa",curve:V,parts:ue});return Te}function G(F){var j={};switch(F){case"3des-cbc":j.keySize=24,j.blockSize=8,j.opensslName="des-ede3-cbc";break;case"blowfish-cbc":j.keySize=16,j.blockSize=8,j.opensslName="bf-cbc";break;case"aes128-cbc":case"aes128-ctr":case"aes128-gcm@openssh.com":j.keySize=16,j.blockSize=16,j.opensslName="aes-128-"+F.slice(7,10);break;case"aes192-cbc":case"aes192-ctr":case"aes192-gcm@openssh.com":j.keySize=24,j.blockSize=16,j.opensslName="aes-192-"+F.slice(7,10);break;case"aes256-cbc":case"aes256-ctr":case"aes256-gcm@openssh.com":j.keySize=32,j.blockSize=16,j.opensslName="aes-256-"+F.slice(7,10);break;default:throw new Error('Unsupported openssl cipher "'+F+'"')}return j}return Lr}var hr=rt,Rt=et,wi=Qe.Buffer;function rt(t){Rt.object(t,"options"),t.buffer!==void 0&&Rt.buffer(t.buffer,"options.buffer"),this._size=t.buffer?t.buffer.length:1024,this._buffer=t.buffer||wi.alloc(this._size),this._offset=0}rt.prototype.toBuffer=function(){return this._buffer.slice(0,this._offset)};rt.prototype.atEnd=function(){return this._offset>=this._buffer.length};rt.prototype.remainder=function(){return this._buffer.slice(this._offset)};rt.prototype.skip=function(t){this._offset+=t};rt.prototype.expand=function(){this._size*=2;var t=wi.alloc(this._size);this._buffer.copy(t,0),this._buffer=t};rt.prototype.readPart=function(){return{data:this.readBuffer()}};rt.prototype.readBuffer=function(){var t=this._buffer.readUInt32BE(this._offset);this._offset+=4,Rt.ok(this._offset+t<=this._buffer.length,"length out of bounds at +0x"+this._offset.toString(16)+" (data truncated?)");var r=this._buffer.slice(this._offset,this._offset+t);return this._offset+=t,r};rt.prototype.readString=function(){return this.readBuffer().toString()};rt.prototype.readCString=function(){for(var t=this._offset;t<this._buffer.length&&this._buffer[t]!==0;)t++;Rt.ok(t<this._buffer.length,"c string does not terminate");var r=this._buffer.slice(this._offset,t).toString();return this._offset=t+1,r};rt.prototype.readInt=function(){var t=this._buffer.readUInt32BE(this._offset);return this._offset+=4,t};rt.prototype.readInt64=function(){Rt.ok(this._offset+8<this._buffer.length,"buffer not long enough to read Int64");var t=this._buffer.slice(this._offset,this._offset+8);return this._offset+=8,t};rt.prototype.readChar=function(){var t=this._buffer[this._offset++];return t};rt.prototype.writeBuffer=function(t){for(;this._offset+4+t.length>this._size;)this.expand();this._buffer.writeUInt32BE(t.length,this._offset),this._offset+=4,t.copy(this._buffer,this._offset),this._offset+=t.length};rt.prototype.writeString=function(t){this.writeBuffer(wi.from(t,"utf8"))};rt.prototype.writeCString=function(t){for(;this._offset+1+t.length>this._size;)this.expand();this._buffer.write(t,this._offset),this._offset+=t.length,this._buffer[this._offset++]=0};rt.prototype.writeInt=function(t){for(;this._offset+4>this._size;)this.expand();this._buffer.writeUInt32BE(t,this._offset),this._offset+=4};rt.prototype.writeInt64=function(t){if(Rt.buffer(t,"value"),t.length>8){for(var r=t.slice(0,t.length-8),p=0;p<r.length;++p)Rt.strictEqual(r[p],0,"must fit in 64 bits of precision");t=t.slice(t.length-8,t.length)}for(;this._offset+8>this._size;)this.expand();t.copy(this._buffer,this._offset),this._offset+=8};rt.prototype.writeChar=function(t){for(;this._offset+1>this._size;)this.expand();this._buffer[this._offset++]=t};rt.prototype.writePart=function(t){this.writeBuffer(t.data)};rt.prototype.write=function(t){for(;this._offset+t.length>this._size;)this.expand();t.copy(this._buffer,this._offset),this._offset+=t.length};var jr,qi;function qt(){if(qi)return jr;qi=1,jr=k;var t=et,r=Qe.Buffer;pt();var p=At,D=ft(),A=Lt,b=hr,E=p.InvalidAlgorithmError,T=p.SignatureParseError;function k(w){t.object(w,"options"),t.arrayOfObject(w.parts,"options.parts"),t.string(w.type,"options.type");for(var n={},l=0;l<w.parts.length;++l){var B=w.parts[l];n[B.name]=B}this.type=w.type,this.hashAlgorithm=w.hashAlgo,this.curve=w.curve,this.parts=w.parts,this.part=n}k.prototype.toBuffer=function(w){w===void 0&&(w="asn1"),t.string(w,"format");var n,l="ssh-"+this.type;switch(this.type){case"rsa":switch(this.hashAlgorithm){case"sha256":l="rsa-sha2-256";break;case"sha512":l="rsa-sha2-512";break;case"sha1":case void 0:break;default:throw new Error("SSH signature format does not support hash algorithm "+this.hashAlgorithm)}return w==="ssh"?(n=new b({}),n.writeString(l),n.writePart(this.part.sig),n.toBuffer()):this.part.sig.data;case"ed25519":return w==="ssh"?(n=new b({}),n.writeString(l),n.writePart(this.part.sig),n.toBuffer()):this.part.sig.data;case"dsa":case"ecdsa":var B,f;if(w==="asn1"){var d=new A.BerWriter;return d.startSequence(),B=D.mpNormalize(this.part.r.data),f=D.mpNormalize(this.part.s.data),d.writeBuffer(B,A.Ber.Integer),d.writeBuffer(f,A.Ber.Integer),d.endSequence(),d.buffer}else if(w==="ssh"&&this.type==="dsa"){if(n=new b({}),n.writeString("ssh-dss"),B=this.part.r.data,B.length>20&&B[0]===0&&(B=B.slice(1)),f=this.part.s.data,f.length>20&&f[0]===0&&(f=f.slice(1)),this.hashAlgorithm&&this.hashAlgorithm!=="sha1"||B.length+f.length!==40)throw new Error("OpenSSH only supports DSA signatures with SHA1 hash");return n.writeBuffer(r.concat([B,f])),n.toBuffer()}else if(w==="ssh"&&this.type==="ecdsa"){var _=new b({});B=this.part.r.data,_.writeBuffer(B),_.writePart(this.part.s),n=new b({});var N;B[0]===0&&(B=B.slice(1));var Y=B.length*8;return Y===256?N="nistp256":Y===384?N="nistp384":Y===528&&(N="nistp521"),n.writeString("ecdsa-sha2-"+N),n.writeBuffer(_.toBuffer()),n.toBuffer()}throw new Error("Invalid signature format");default:throw new Error("Invalid signature data")}},k.prototype.toString=function(w){return t.optionalString(w,"format"),this.toBuffer(w).toString("base64")},k.parse=function(w,n,l){typeof w=="string"&&(w=r.from(w,"base64")),t.buffer(w,"data"),t.string(l,"format"),t.string(n,"type");var B={};B.type=n.toLowerCase(),B.parts=[];try{switch(t.ok(w.length>0,"signature must not be empty"),B.type){case"rsa":return z(w,n,l,B);case"ed25519":return z(w,n,l,B);case"dsa":case"ecdsa":return l==="asn1"?C(w,n,l,B):B.type==="dsa"?m(w,n,l,B):P(w,n,l,B);default:throw new E(n)}}catch(f){throw f instanceof E?f:new T(n,l,f)}};function z(w,n,l,B){if(l==="ssh"){try{var f=new b({buffer:w}),d=f.readString()}catch{}if(f!==void 0){var _="SSH signature does not match expected type (expected "+n+", got "+d+")";switch(d){case"ssh-rsa":t.strictEqual(n,"rsa",_),B.hashAlgo="sha1";break;case"rsa-sha2-256":t.strictEqual(n,"rsa",_),B.hashAlgo="sha256";break;case"rsa-sha2-512":t.strictEqual(n,"rsa",_),B.hashAlgo="sha512";break;case"ssh-ed25519":t.strictEqual(n,"ed25519",_),B.hashAlgo="sha512";break;default:throw new Error("Unknown SSH signature type: "+d)}var N=f.readPart();return t.ok(f.atEnd(),"extra trailing bytes"),N.name="sig",B.parts.push(N),new k(B)}}return B.parts.push({name:"sig",data:w}),new k(B)}function C(w,n,l,B){var f=new A.BerReader(w);f.readSequence();var d=f.readString(A.Ber.Integer,!0),_=f.readString(A.Ber.Integer,!0);return B.parts.push({name:"r",data:D.mpNormalize(d)}),B.parts.push({name:"s",data:D.mpNormalize(_)}),new k(B)}function m(w,n,l,B){if(w.length!=40){var f=new b({buffer:w}),d=f.readBuffer();d.toString("ascii")==="ssh-dss"&&(d=f.readBuffer()),t.ok(f.atEnd(),"extra trailing bytes"),t.strictEqual(d.length,40,"invalid inner length"),w=d}return B.parts.push({name:"r",data:w.slice(0,20)}),B.parts.push({name:"s",data:w.slice(20,40)}),new k(B)}function P(w,n,l,B){var f=new b({buffer:w}),d,_,N=f.readBuffer(),Y=N.toString("ascii");if(Y.slice(0,6)==="ecdsa-"){var H=Y.split("-");switch(t.strictEqual(H[0],"ecdsa"),t.strictEqual(H[1],"sha2"),B.curve=H[2],B.curve){case"nistp256":B.hashAlgo="sha256";break;case"nistp384":B.hashAlgo="sha384";break;case"nistp521":B.hashAlgo="sha512";break;default:throw new Error("Unsupported ECDSA curve: "+B.curve)}N=f.readBuffer(),t.ok(f.atEnd(),"extra trailing bytes on outer"),f=new b({buffer:N}),d=f.readPart()}else d={data:N};return _=f.readPart(),t.ok(f.atEnd(),"extra trailing bytes"),d.name="r",_.name="s",B.parts.push(d),B.parts.push(_),new k(B)}return k.isSignature=function(w,n){return D.isCompatible(w,k,n)},k.prototype._sshpkApiVersion=[2,1],k._oldVersionDetect=function(w){return t.func(w.toBuffer),w.hasOwnProperty("hashAlgorithm")?[2,0]:[1,0]},jr}ur.BigInteger;Tr.ECCurveFp;pt();ur.BigInteger;Tr.ECPointFp;Qe.Buffer;var Mr,Pi;function Si(){if(Pi)return Mr;Pi=1,Mr={DiffieHellman:m,generateECDSA:B,generateED25519:l};var t=et,r=pt(),p=Qe.Buffer,D=wt,A=ft(),b=cr,E=st(),T=nt(),k=r.createECDH!==void 0,z=Tr,C=ur.BigInteger;function m(f){if(A.assertCompatible(f,E,[1,4],"key"),this._isPriv=T.isPrivateKey(f,[1,3]),this._algo=f.type,this._curve=f.curve,this._key=f,f.type==="dsa"){if(!k)throw new Error("Due to bugs in the node 0.10 crypto API, node 0.12.x or later is required to use DH");this._dh=r.createDiffieHellman(f.part.p.data,void 0,f.part.g.data,void 0),this._p=f.part.p,this._g=f.part.g,this._isPriv&&this._dh.setPrivateKey(f.part.x.data),this._dh.setPublicKey(f.part.y.data)}else if(f.type==="ecdsa"){if(!k){this._ecParams=new P(this._curve),this._isPriv&&(this._priv=new n(this._ecParams,f.part.d.data));return}var d={nistp256:"prime256v1",nistp384:"secp384r1",nistp521:"secp521r1"}[f.curve];if(this._dh=r.createECDH(d),typeof this._dh!="object"||typeof this._dh.setPrivateKey!="function"){k=!1,m.call(this,f);return}this._isPriv&&this._dh.setPrivateKey(f.part.d.data),this._dh.setPublicKey(f.part.Q.data)}else if(f.type==="curve25519")this._isPriv&&(A.assertCompatible(f,T,[1,5],"key"),this._priv=f.part.k.data);else throw new Error("DH not supported for "+f.type+" keys")}m.prototype.getPublicKey=function(){return this._isPriv?this._key.toPublic():this._key},m.prototype.getPrivateKey=function(){if(this._isPriv)return this._key},m.prototype.getKey=m.prototype.getPrivateKey,m.prototype._keyCheck=function(f,d){if(t.object(f,"key"),d||A.assertCompatible(f,T,[1,3],"key"),A.assertCompatible(f,E,[1,4],"key"),f.type!==this._algo)throw new Error("A "+f.type+" key cannot be used in "+this._algo+" Diffie-Hellman");if(f.curve!==this._curve)throw new Error("A key from the "+f.curve+" curve cannot be used with a "+this._curve+" Diffie-Hellman");f.type==="dsa"&&(t.deepEqual(f.part.p,this._p,"DSA key prime does not match"),t.deepEqual(f.part.g,this._g,"DSA key generator does not match"))},m.prototype.setKey=function(f){if(this._keyCheck(f),f.type==="dsa")this._dh.setPrivateKey(f.part.x.data),this._dh.setPublicKey(f.part.y.data);else if(f.type==="ecdsa")k?(this._dh.setPrivateKey(f.part.d.data),this._dh.setPublicKey(f.part.Q.data)):this._priv=new n(this._ecParams,f.part.d.data);else if(f.type==="curve25519"){var d=f.part.k;f.part.k||(d=f.part.r),this._priv=d.data,this._priv[0]===0&&(this._priv=this._priv.slice(1)),this._priv=this._priv.slice(0,32)}this._key=f,this._isPriv=!0},m.prototype.setPrivateKey=m.prototype.setKey,m.prototype.computeSecret=function(f){if(this._keyCheck(f,!0),!this._isPriv)throw new Error("DH exchange has not been initialized with a private key yet");var d;if(this._algo==="dsa")return this._dh.computeSecret(f.part.y.data);if(this._algo==="ecdsa")return k?this._dh.computeSecret(f.part.Q.data):(d=new w(this._ecParams,f.part.Q.data),this._priv.deriveSharedSecret(d));if(this._algo==="curve25519"){for(d=f.part.A.data;d[0]===0&&d.length>32;)d=d.slice(1);var _=this._priv;t.strictEqual(d.length,32),t.strictEqual(_.length,32);var N=b.box.before(new Uint8Array(d),new Uint8Array(_));return p.from(N)}throw new Error("Invalid algorithm: "+this._algo)},m.prototype.generateKey=function(){var f=[],d,_;if(this._algo==="dsa")return this._dh.generateKeys(),f.push({name:"p",data:this._p.data}),f.push({name:"q",data:this._key.part.q.data}),f.push({name:"g",data:this._g.data}),f.push({name:"y",data:this._dh.getPublicKey()}),f.push({name:"x",data:this._dh.getPrivateKey()}),this._key=new T({type:"dsa",parts:f}),this._isPriv=!0,this._key;if(this._algo==="ecdsa"){if(k)return this._dh.generateKeys(),f.push({name:"curve",data:p.from(this._curve)}),f.push({name:"Q",data:this._dh.getPublicKey()}),f.push({name:"d",data:this._dh.getPrivateKey()}),this._key=new T({type:"ecdsa",curve:this._curve,parts:f}),this._isPriv=!0,this._key;var N=this._ecParams.getN(),Y=new C(r.randomBytes(N.bitLength())),H=N.subtract(C.ONE);return d=Y.mod(H).add(C.ONE),_=this._ecParams.getG().multiply(d),d=p.from(d.toByteArray()),_=p.from(this._ecParams.getCurve().encodePointHex(_),"hex"),this._priv=new n(this._ecParams,d),f.push({name:"curve",data:p.from(this._curve)}),f.push({name:"Q",data:_}),f.push({name:"d",data:d}),this._key=new T({type:"ecdsa",curve:this._curve,parts:f}),this._isPriv=!0,this._key}else if(this._algo==="curve25519"){var ae=b.box.keyPair();return d=p.from(ae.secretKey),_=p.from(ae.publicKey),d=p.concat([d,_]),t.strictEqual(d.length,64),t.strictEqual(_.length,32),f.push({name:"A",data:_}),f.push({name:"k",data:d}),this._key=new T({type:"curve25519",parts:f}),this._isPriv=!0,this._key}throw new Error("Invalid algorithm: "+this._algo)},m.prototype.generateKeys=m.prototype.generateKey;function P(f){var d=D.curves[f];t.object(d);var _=new C(d.p),N=new C(d.a),Y=new C(d.b),H=new C(d.n),ae=C.ONE,L=new z.ECCurveFp(_,N,Y),ne=L.decodePointHex(d.G.toString("hex"));this.curve=L,this.g=ne,this.n=H,this.h=ae}P.prototype.getCurve=function(){return this.curve},P.prototype.getG=function(){return this.g},P.prototype.getN=function(){return this.n},P.prototype.getH=function(){return this.h};function w(f,d){this._params=f,d[0]===0&&(d=d.slice(1)),this._pub=f.getCurve().decodePointHex(d.toString("hex"))}function n(f,d){this._params=f,this._priv=new C(A.mpNormalize(d))}n.prototype.deriveSharedSecret=function(f){t.ok(f instanceof w);var d=f._pub.multiply(this._priv);return p.from(d.getX().toBigInteger().toByteArray())};function l(){var f=b.sign.keyPair(),d=p.from(f.secretKey),_=p.from(f.publicKey);t.strictEqual(d.length,64),t.strictEqual(_.length,32);var N=[];N.push({name:"A",data:_}),N.push({name:"k",data:d.slice(0,32)});var Y=new T({type:"ed25519",parts:N});return Y}function B(f){var d=[],_;if(k){var N={nistp256:"prime256v1",nistp384:"secp384r1",nistp521:"secp521r1"}[f],Y=r.createECDH(N);return Y.generateKeys(),d.push({name:"curve",data:p.from(f)}),d.push({name:"Q",data:Y.getPublicKey()}),d.push({name:"d",data:Y.getPrivateKey()}),_=new T({type:"ecdsa",curve:f,parts:d}),_}else{var H=new P(f),ae=H.getN(),L=Math.ceil((ae.bitLength()+64)/8),ne=new C(r.randomBytes(L)),J=ae.subtract(C.ONE),te=ne.mod(J).add(C.ONE),ce=H.getG().multiply(te);return te=p.from(te.toByteArray()),ce=p.from(H.getCurve().encodePointHex(ce),"hex"),d.push({name:"curve",data:p.from(f)}),d.push({name:"Q",data:ce}),d.push({name:"d",data:te}),_=new T({type:"ecdsa",curve:f,parts:d}),_}}return Mr}var Hr,Ii;function fa(){if(Ii)return Hr;Ii=1,Hr={Verifier:E,Signer:T};var t=cr,r=Ji,p=Pr,D=et,A=Qe.Buffer,b=qt();function E(k,z){if(z.toLowerCase()!=="sha512")throw new Error("ED25519 only supports the use of SHA-512 hashes");this.key=k,this.chunks=[],r.Writable.call(this,{})}p.inherits(E,r.Writable),E.prototype._write=function(k,z,C){this.chunks.push(k),C()},E.prototype.update=function(k){typeof k=="string"&&(k=A.from(k,"binary")),this.chunks.push(k)},E.prototype.verify=function(k,z){var C;if(b.isSignature(k,[2,0])){if(k.type!=="ed25519")return!1;C=k.toBuffer("raw")}else if(typeof k=="string")C=A.from(k,"base64");else if(b.isSignature(k,[1,0]))throw new Error("signature was created by too old a version of sshpk and cannot be verified");return D.buffer(C),t.sign.detached.verify(new Uint8Array(A.concat(this.chunks)),new Uint8Array(C),new Uint8Array(this.key.part.A.data))};function T(k,z){if(z.toLowerCase()!=="sha512")throw new Error("ED25519 only supports the use of SHA-512 hashes");this.key=k,this.chunks=[],r.Writable.call(this,{})}return p.inherits(T,r.Writable),T.prototype._write=function(k,z,C){this.chunks.push(k),C()},T.prototype.update=function(k){typeof k=="string"&&(k=A.from(k,"binary")),this.chunks.push(k)},T.prototype.sign=function(){var k=t.sign.detached(new Uint8Array(A.concat(this.chunks)),new Uint8Array(A.concat([this.key.part.k.data,this.key.part.A.data]))),z=A.from(k),C=b.parse(z,"ed25519","raw");return C.hashAlgorithm="sha512",C},Hr}var Yr,Fi;function pr(){if(Fi)return Yr;Fi=1,Yr={read:k,readPkcs8:m,write:z,writePkcs8:L,pkcs8ToBuffer:ae,readECDSACurve:B,writeECDSACurve:Be};var t=et,r=Lt,p=Qe.Buffer,D=wt,A=ft(),b=st(),E=nt(),T=zt();function k(v,c){return T.read(v,c,"pkcs8")}function z(v,c){return T.write(v,c,"pkcs8")}function C(v,c){return t.strictEqual(v.peek(),r.Ber.Integer,c+" is not an Integer"),A.mpNormalize(v.readString(r.Ber.Integer,!0))}function m(v,c,y){y.peek()===r.Ber.Integer&&(t.strictEqual(c,"private","unexpected Integer at start of public key"),y.readString(r.Ber.Integer,!0)),y.readSequence();var g=y.offset+y.length,V=y.readOID();switch(V){case"1.2.840.113549.1.1.1":return y._offset=g,c==="public"?P(y):w(y);case"1.2.840.10040.4.1":return c==="public"?n(y):l(y);case"1.2.840.10045.2.1":return c==="public"?d(y):f(y);case"1.3.101.112":return c==="public"?_(y):Y(y);case"1.3.101.110":return c==="public"?N(y):H(y);default:throw new Error("Unknown key type OID "+V)}}function P(v){v.readSequence(r.Ber.BitString),v.readByte(),v.readSequence();var c=C(v,"modulus"),y=C(v,"exponent"),g={type:"rsa",source:v.originalInput,parts:[{name:"e",data:y},{name:"n",data:c}]};return new b(g)}function w(v){v.readSequence(r.Ber.OctetString),v.readSequence();var c=C(v,"version");t.equal(c[0],0,"unknown RSA private key version");var y=C(v,"modulus"),g=C(v,"public exponent"),V=C(v,"private exponent"),ie=C(v,"prime1"),se=C(v,"prime2"),re=C(v,"exponent1"),ue=C(v,"exponent2"),Te=C(v,"iqmp"),Ne={type:"rsa",parts:[{name:"n",data:y},{name:"e",data:g},{name:"d",data:V},{name:"iqmp",data:Te},{name:"p",data:ie},{name:"q",data:se},{name:"dmodp",data:re},{name:"dmodq",data:ue}]};return new E(Ne)}function n(v){v.readSequence();var c=C(v,"p"),y=C(v,"q"),g=C(v,"g");v.readSequence(r.Ber.BitString),v.readByte();var V=C(v,"y"),ie={type:"dsa",parts:[{name:"p",data:c},{name:"q",data:y},{name:"g",data:g},{name:"y",data:V}]};return new b(ie)}function l(v){v.readSequence();var c=C(v,"p"),y=C(v,"q"),g=C(v,"g");v.readSequence(r.Ber.OctetString);var V=C(v,"x"),ie=A.calculateDSAPublic(g,c,V),se={type:"dsa",parts:[{name:"p",data:c},{name:"q",data:y},{name:"g",data:g},{name:"y",data:ie},{name:"x",data:V}]};return new E(se)}function B(v){var c,y,g,V,ie;if(v.peek()===r.Ber.OID){var se=v.readOID();for(y=Object.keys(D.curves),g=0;g<y.length;++g)if(V=y[g],ie=D.curves[V],ie.pkcs8oid===se){c=V;break}}else{v.readSequence();var re=v.readString(r.Ber.Integer,!0);t.strictEqual(re[0],1,"ECDSA key not version 1");var ue={};v.readSequence();var Te=v.readOID();t.strictEqual(Te,"1.2.840.10045.1.1","ECDSA key is not from a prime-field");var Ne=ue.p=A.mpNormalize(v.readString(r.Ber.Integer,!0));ue.size=Ne.length*8-A.countZeros(Ne),v.readSequence(),ue.a=A.mpNormalize(v.readString(r.Ber.OctetString,!0)),ue.b=A.mpNormalize(v.readString(r.Ber.OctetString,!0)),v.peek()===r.Ber.BitString&&(ue.s=v.readString(r.Ber.BitString,!0)),ue.G=v.readString(r.Ber.OctetString,!0),t.strictEqual(ue.G[0],4,"uncompressed G is required"),ue.n=A.mpNormalize(v.readString(r.Ber.Integer,!0)),ue.h=A.mpNormalize(v.readString(r.Ber.Integer,!0)),t.strictEqual(ue.h[0],1,"a cofactor=1 curve is required"),y=Object.keys(D.curves);var ze=Object.keys(ue);for(g=0;g<y.length;++g){V=y[g],ie=D.curves[V];for(var He=!0,Je=0;Je<ze.length;++Je){var Ye=ze[Je];if(ie[Ye]!==void 0){if(typeof ie[Ye]=="object"&&ie[Ye].equals!==void 0){if(!ie[Ye].equals(ue[Ye])){He=!1;break}}else if(p.isBuffer(ie[Ye])){if(ie[Ye].toString("binary")!==ue[Ye].toString("binary")){He=!1;break}}else if(ie[Ye]!==ue[Ye]){He=!1;break}}}if(He){c=V;break}}}return c}function f(v){var c=B(v);t.string(c,"a known elliptic curve"),v.readSequence(r.Ber.OctetString),v.readSequence();var y=C(v,"version");t.equal(y[0],1,"unknown version of ECDSA key");var g=v.readString(r.Ber.OctetString,!0),V;if(v.peek()==160&&(v.readSequence(160),v._offset+=v.length),v.peek()==161&&(v.readSequence(161),V=v.readString(r.Ber.BitString,!0),V=A.ecNormalize(V)),V===void 0){var ie=A.publicFromPrivateECDSA(c,g);V=ie.part.Q.data}var se={type:"ecdsa",parts:[{name:"curve",data:p.from(c)},{name:"Q",data:V},{name:"d",data:g}]};return new E(se)}function d(v){var c=B(v);t.string(c,"a known elliptic curve");var y=v.readString(r.Ber.BitString,!0);y=A.ecNormalize(y);var g={type:"ecdsa",parts:[{name:"curve",data:p.from(c)},{name:"Q",data:y}]};return new b(g)}function _(v){v.peek()===0&&v.readByte();var c=A.readBitString(v),y={type:"ed25519",parts:[{name:"A",data:A.zeroPadToLength(c,32)}]};return new b(y)}function N(v){var c=A.readBitString(v),y={type:"curve25519",parts:[{name:"A",data:A.zeroPadToLength(c,32)}]};return new b(y)}function Y(v){v.peek()===0&&v.readByte(),v.readSequence(r.Ber.OctetString);var c=v.readString(r.Ber.OctetString,!0);c=A.zeroPadToLength(c,32);for(var y,g;(g=v.peek())!==null;)g===(r.Ber.Context|1)?y=A.readBitString(v,g):(v.readSequence(g),v._offset+=v.length);y===void 0&&(y=A.calculateED25519Public(c));var V={type:"ed25519",parts:[{name:"A",data:A.zeroPadToLength(y,32)},{name:"k",data:A.zeroPadToLength(c,32)}]};return new E(V)}function H(v){v.peek()===0&&v.readByte(),v.readSequence(r.Ber.OctetString);var c=v.readString(r.Ber.OctetString,!0);c=A.zeroPadToLength(c,32);var y=A.calculateX25519Public(c),g={type:"curve25519",parts:[{name:"A",data:A.zeroPadToLength(y,32)},{name:"k",data:A.zeroPadToLength(c,32)}]};return new E(g)}function ae(v){var c=new r.BerWriter;return L(c,v),c.buffer}function L(v,c){if(v.startSequence(),E.isPrivateKey(c)){var y=0;c.type==="ed25519"&&(y=1);var g=p.from([y]);v.writeBuffer(g,r.Ber.Integer)}switch(v.startSequence(),c.type){case"rsa":v.writeOID("1.2.840.113549.1.1.1"),E.isPrivateKey(c)?ne(c,v):J(c,v);break;case"dsa":v.writeOID("1.2.840.10040.4.1"),E.isPrivateKey(c)?te(c,v):ce(c,v);break;case"ecdsa":v.writeOID("1.2.840.10045.2.1"),E.isPrivateKey(c)?G(c,v):U(c,v);break;case"ed25519":v.writeOID("1.3.101.112"),E.isPrivateKey(c)?j(c,v):F(c,v);break;default:throw new Error("Unsupported key type: "+c.type)}v.endSequence()}function ne(v,c){c.writeNull(),c.endSequence(),c.startSequence(r.Ber.OctetString),c.startSequence();var y=p.from([0]);c.writeBuffer(y,r.Ber.Integer),c.writeBuffer(v.part.n.data,r.Ber.Integer),c.writeBuffer(v.part.e.data,r.Ber.Integer),c.writeBuffer(v.part.d.data,r.Ber.Integer),c.writeBuffer(v.part.p.data,r.Ber.Integer),c.writeBuffer(v.part.q.data,r.Ber.Integer),(!v.part.dmodp||!v.part.dmodq)&&A.addRSAMissing(v),c.writeBuffer(v.part.dmodp.data,r.Ber.Integer),c.writeBuffer(v.part.dmodq.data,r.Ber.Integer),c.writeBuffer(v.part.iqmp.data,r.Ber.Integer),c.endSequence(),c.endSequence()}function J(v,c){c.writeNull(),c.endSequence(),c.startSequence(r.Ber.BitString),c.writeByte(0),c.startSequence(),c.writeBuffer(v.part.n.data,r.Ber.Integer),c.writeBuffer(v.part.e.data,r.Ber.Integer),c.endSequence(),c.endSequence()}function te(v,c){c.startSequence(),c.writeBuffer(v.part.p.data,r.Ber.Integer),c.writeBuffer(v.part.q.data,r.Ber.Integer),c.writeBuffer(v.part.g.data,r.Ber.Integer),c.endSequence(),c.endSequence(),c.startSequence(r.Ber.OctetString),c.writeBuffer(v.part.x.data,r.Ber.Integer),c.endSequence()}function ce(v,c){c.startSequence(),c.writeBuffer(v.part.p.data,r.Ber.Integer),c.writeBuffer(v.part.q.data,r.Ber.Integer),c.writeBuffer(v.part.g.data,r.Ber.Integer),c.endSequence(),c.endSequence(),c.startSequence(r.Ber.BitString),c.writeByte(0),c.writeBuffer(v.part.y.data,r.Ber.Integer),c.endSequence()}function Be(v,c){var y=D.curves[v.curve];if(y.pkcs8oid)c.writeOID(y.pkcs8oid);else{c.startSequence();var g=p.from([1]);c.writeBuffer(g,r.Ber.Integer),c.startSequence(),c.writeOID("1.2.840.10045.1.1"),c.writeBuffer(y.p,r.Ber.Integer),c.endSequence(),c.startSequence();var V=y.p;V[0]===0&&(V=V.slice(1)),c.writeBuffer(V,r.Ber.OctetString),c.writeBuffer(y.b,r.Ber.OctetString),c.writeBuffer(y.s,r.Ber.BitString),c.endSequence(),c.writeBuffer(y.G,r.Ber.OctetString),c.writeBuffer(y.n,r.Ber.Integer);var ie=y.h;ie||(ie=p.from([1])),c.writeBuffer(ie,r.Ber.Integer),c.endSequence()}}function U(v,c){Be(v,c),c.endSequence();var y=A.ecNormalize(v.part.Q.data,!0);c.writeBuffer(y,r.Ber.BitString)}function G(v,c){Be(v,c),c.endSequence(),c.startSequence(r.Ber.OctetString),c.startSequence();var y=p.from([1]);c.writeBuffer(y,r.Ber.Integer),c.writeBuffer(v.part.d.data,r.Ber.OctetString),c.startSequence(161);var g=A.ecNormalize(v.part.Q.data,!0);c.writeBuffer(g,r.Ber.BitString),c.endSequence(),c.endSequence(),c.endSequence()}function F(v,c){c.endSequence(),A.writeBitString(c,v.part.A.data)}function j(v,c){c.endSequence(),c.startSequence(r.Ber.OctetString);for(var y=A.mpNormalize(v.part.k.data);y.length>32&&y[0]===0;)y=y.slice(1);c.writeBuffer(y,r.Ber.OctetString),c.endSequence(),A.writeBitString(c,v.part.A.data,r.Ber.Context|1)}return Yr}var Vr,Ti;function Bi(){if(Ti)return Vr;Ti=1,Vr={read:C,readPkcs1:w,write:m,writePkcs1:Y};var t=et,r=Lt,p=Qe.Buffer,D=wt,A=ft(),b=st(),E=nt(),T=zt(),k=pr(),z=k.readECDSACurve;function C(U,G){return T.read(U,G,"pkcs1")}function m(U,G){return T.write(U,G,"pkcs1")}function P(U,G){return t.strictEqual(U.peek(),r.Ber.Integer,G+" is not an Integer"),A.mpNormalize(U.readString(r.Ber.Integer,!0))}function w(U,G,F){switch(U){case"RSA":if(G==="public")return n(F);if(G==="private")return l(F);throw new Error("Unknown key type: "+G);case"DSA":if(G==="public")return d(F);if(G==="private")return B(F);throw new Error("Unknown key type: "+G);case"EC":case"ECDSA":if(G==="private")return N(F);if(G==="public")return _(F);throw new Error("Unknown key type: "+G);case"EDDSA":case"EdDSA":if(G==="private")return f(F);throw new Error(G+" keys not supported with EdDSA");default:throw new Error("Unknown key algo: "+U)}}function n(U){var G=P(U,"modulus"),F=P(U,"exponent"),j={type:"rsa",parts:[{name:"e",data:F},{name:"n",data:G}]};return new b(j)}function l(U){var G=P(U,"version");t.strictEqual(G[0],0);var F=P(U,"modulus"),j=P(U,"public exponent"),v=P(U,"private exponent"),c=P(U,"prime1"),y=P(U,"prime2"),g=P(U,"exponent1"),V=P(U,"exponent2"),ie=P(U,"iqmp"),se={type:"rsa",parts:[{name:"n",data:F},{name:"e",data:j},{name:"d",data:v},{name:"iqmp",data:ie},{name:"p",data:c},{name:"q",data:y},{name:"dmodp",data:g},{name:"dmodq",data:V}]};return new E(se)}function B(U){var G=P(U,"version");t.strictEqual(G.readUInt8(0),0);var F=P(U,"p"),j=P(U,"q"),v=P(U,"g"),c=P(U,"y"),y=P(U,"x"),g={type:"dsa",parts:[{name:"p",data:F},{name:"q",data:j},{name:"g",data:v},{name:"y",data:c},{name:"x",data:y}]};return new E(g)}function f(U){var G=P(U,"version");t.strictEqual(G.readUInt8(0),1);var F=U.readString(r.Ber.OctetString,!0);U.readSequence(160);var j=U.readOID();t.strictEqual(j,"1.3.101.112","the ed25519 curve identifier"),U.readSequence(161);var v=A.readBitString(U),c={type:"ed25519",parts:[{name:"A",data:A.zeroPadToLength(v,32)},{name:"k",data:F}]};return new E(c)}function d(U){var G=P(U,"y"),F=P(U,"p"),j=P(U,"q"),v=P(U,"g"),c={type:"dsa",parts:[{name:"y",data:G},{name:"p",data:F},{name:"q",data:j},{name:"g",data:v}]};return new b(c)}function _(U){U.readSequence();var G=U.readOID();t.strictEqual(G,"1.2.840.10045.2.1","must be ecPublicKey");for(var F=U.readOID(),j,v=Object.keys(D.curves),c=0;c<v.length;++c){var y=v[c],g=D.curves[y];if(g.pkcs8oid===F){j=y;break}}t.string(j,"a known ECDSA named curve");var V=U.readString(r.Ber.BitString,!0);V=A.ecNormalize(V);var ie={type:"ecdsa",parts:[{name:"curve",data:p.from(j)},{name:"Q",data:V}]};return new b(ie)}function N(U){var G=P(U,"version");t.strictEqual(G.readUInt8(0),1);var F=U.readString(r.Ber.OctetString,!0);U.readSequence(160);var j=z(U);t.string(j,"a known elliptic curve"),U.readSequence(161);var v=U.readString(r.Ber.BitString,!0);v=A.ecNormalize(v);var c={type:"ecdsa",parts:[{name:"curve",data:p.from(j)},{name:"Q",data:v},{name:"d",data:F}]};return new E(c)}function Y(U,G){switch(U.startSequence(),G.type){case"rsa":E.isPrivateKey(G)?ae(U,G):H(U,G);break;case"dsa":E.isPrivateKey(G)?L(U,G):ne(U,G);break;case"ecdsa":E.isPrivateKey(G)?te(U,G):J(U,G);break;case"ed25519":E.isPrivateKey(G)?ce(U,G):Be();break;default:throw new Error("Unknown key algo: "+G.type)}U.endSequence()}function H(U,G){U.writeBuffer(G.part.n.data,r.Ber.Integer),U.writeBuffer(G.part.e.data,r.Ber.Integer)}function ae(U,G){var F=p.from([0]);U.writeBuffer(F,r.Ber.Integer),U.writeBuffer(G.part.n.data,r.Ber.Integer),U.writeBuffer(G.part.e.data,r.Ber.Integer),U.writeBuffer(G.part.d.data,r.Ber.Integer),U.writeBuffer(G.part.p.data,r.Ber.Integer),U.writeBuffer(G.part.q.data,r.Ber.Integer),(!G.part.dmodp||!G.part.dmodq)&&A.addRSAMissing(G),U.writeBuffer(G.part.dmodp.data,r.Ber.Integer),U.writeBuffer(G.part.dmodq.data,r.Ber.Integer),U.writeBuffer(G.part.iqmp.data,r.Ber.Integer)}function L(U,G){var F=p.from([0]);U.writeBuffer(F,r.Ber.Integer),U.writeBuffer(G.part.p.data,r.Ber.Integer),U.writeBuffer(G.part.q.data,r.Ber.Integer),U.writeBuffer(G.part.g.data,r.Ber.Integer),U.writeBuffer(G.part.y.data,r.Ber.Integer),U.writeBuffer(G.part.x.data,r.Ber.Integer)}function ne(U,G){U.writeBuffer(G.part.y.data,r.Ber.Integer),U.writeBuffer(G.part.p.data,r.Ber.Integer),U.writeBuffer(G.part.q.data,r.Ber.Integer),U.writeBuffer(G.part.g.data,r.Ber.Integer)}function J(U,G){U.startSequence(),U.writeOID("1.2.840.10045.2.1");var F=G.part.curve.data.toString(),j=D.curves[F].pkcs8oid;t.string(j,"a known ECDSA named curve"),U.writeOID(j),U.endSequence();var v=A.ecNormalize(G.part.Q.data,!0);U.writeBuffer(v,r.Ber.BitString)}function te(U,G){var F=p.from([1]);U.writeBuffer(F,r.Ber.Integer),U.writeBuffer(G.part.d.data,r.Ber.OctetString),U.startSequence(160);var j=G.part.curve.data.toString(),v=D.curves[j].pkcs8oid;t.string(v,"a known ECDSA named curve"),U.writeOID(v),U.endSequence(),U.startSequence(161);var c=A.ecNormalize(G.part.Q.data,!0);U.writeBuffer(c,r.Ber.BitString),U.endSequence()}function ce(U,G){var F=p.from([1]);U.writeBuffer(F,r.Ber.Integer),U.writeBuffer(G.part.k.data,r.Ber.OctetString),U.startSequence(160),U.writeOID("1.3.101.112"),U.endSequence(),U.startSequence(161),A.writeBitString(U,G.part.A.data),U.endSequence()}function Be(U,G){throw new Error("Public keys are not supported for EdDSA PKCS#1")}return Vr}var Gr,Di;function Nt(){if(Di)return Gr;Di=1,Gr={read:z.bind(void 0,!1,void 0),readType:z.bind(void 0,!1),write:C,readPartial:z.bind(void 0,!0),readInternal:z,keyTypeToAlg:k,algToKeyType:T};var t=et,r=Qe.Buffer,p=wt,D=ft(),A=st(),b=nt(),E=hr;function T(m){if(t.string(m),m==="ssh-dss")return"dsa";if(m==="ssh-rsa")return"rsa";if(m==="ssh-ed25519")return"ed25519";if(m==="ssh-curve25519")return"curve25519";if(m.match(/^ecdsa-sha2-/))return"ecdsa";throw new Error("Unknown algorithm "+m)}function k(m){if(t.object(m),m.type==="dsa")return"ssh-dss";if(m.type==="rsa")return"ssh-rsa";if(m.type==="ed25519")return"ssh-ed25519";if(m.type==="curve25519")return"ssh-curve25519";if(m.type==="ecdsa")return"ecdsa-sha2-"+m.part.curve.data.toString();throw new Error("Unknown key type "+m.type)}function z(m,P,w,n){typeof w=="string"&&(w=r.from(w)),t.buffer(w,"buf");var l={},B=l.parts=[],f=new E({buffer:w}),d=f.readString();t.ok(!f.atEnd(),"key must have at least one part"),l.type=T(d);var _=p.info[l.type].parts.length;for(P&&P==="private"&&(_=p.privInfo[l.type].parts.length);!f.atEnd()&&B.length<_;)B.push(f.readPart());for(;!m&&!f.atEnd();)B.push(f.readPart());t.ok(B.length>=1,"key must have at least one part"),t.ok(m||f.atEnd(),"leftover bytes at end of key");var N=A,Y=p.info[l.type];if((P==="private"||Y.parts.length!==B.length)&&(Y=p.privInfo[l.type],N=b),t.strictEqual(Y.parts.length,B.length),l.type==="ecdsa"){var H=/^ecdsa-sha2-(.+)$/.exec(d);t.ok(H!==null),t.strictEqual(H[1],B[0].data.toString())}for(var ae=!0,L=0;L<Y.parts.length;++L){var ne=B[L];if(ne.name=Y.parts[L],l.type==="ed25519"&&ne.name==="k"&&(ne.data=ne.data.slice(0,32)),ne.name!=="curve"&&Y.normalize!==!1){var J;l.type==="ed25519"?J=D.zeroPadToLength(ne.data,32):J=D.mpNormalize(ne.data),J.toString("binary")!==ne.data.toString("binary")&&(ne.data=J,ae=!1)}}return ae&&(l._rfc4253Cache=f.toBuffer()),m&&typeof m=="object"&&(m.remainder=f.remainder(),m.consumed=f._offset),new N(l)}function C(m,P){t.object(m);var w=k(m),n,l=p.info[m.type];b.isPrivateKey(m)&&(l=p.privInfo[m.type]);var B=l.parts,f=new E({});for(f.writeString(w),n=0;n<B.length;++n){var d=m.part[B[n]].data;l.normalize!==!1&&(m.type==="ed25519"?d=D.zeroPadToLength(d,32):d=D.mpNormalize(d)),m.type==="ed25519"&&B[n]==="k"&&(d=r.concat([d,m.part.A.data])),f.writeBuffer(d)}return f.toBuffer()}return Gr}var Zr,Ci;function Oi(){if(Ci)return Zr;Ci=1;var t=cr.lowlevel.crypto_hash,r=0,p=function(){this.S=[new Uint32Array([3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]),new Uint32Array([1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]),new Uint32Array([3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]),new Uint32Array([976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462])],this.P=new Uint32Array([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731])};function D(z,C,m){return(z[0][C[m+3]]+z[1][C[m+2]]^z[2][C[m+1]])+z[3][C[m]]}p.prototype.encipher=function(z,C){C===void 0&&(C=new Uint8Array(z.buffer),z.byteOffset!==0&&(C=C.subarray(z.byteOffset))),z[0]^=this.P[0];for(var m=1;m<16;m+=2)z[1]^=D(this.S,C,0)^this.P[m],z[0]^=D(this.S,C,4)^this.P[m+1];var P=z[0];z[0]=z[1]^this.P[17],z[1]=P},p.prototype.decipher=function(z){var C=new Uint8Array(z.buffer);z.byteOffset!==0&&(C=C.subarray(z.byteOffset)),z[0]^=this.P[17];for(var m=16;m>0;m-=2)z[1]^=D(this.S,C,0)^this.P[m],z[0]^=D(this.S,C,4)^this.P[m-1];var P=z[0];z[0]=z[1]^this.P[0],z[1]=P};function A(z,C){var m,P=0;for(m=0;m<4;m++,r++)r>=C&&(r=0),P=P<<8|z[r];return P}p.prototype.expand0state=function(z,C){var m=new Uint32Array(2),P,w,n=new Uint8Array(m.buffer);for(P=0,r=0;P<18;P++)this.P[P]^=A(z,C);for(r=0,P=0;P<18;P+=2)this.encipher(m,n),this.P[P]=m[0],this.P[P+1]=m[1];for(P=0;P<4;P++)for(w=0;w<256;w+=2)this.encipher(m,n),this.S[P][w]=m[0],this.S[P][w+1]=m[1]},p.prototype.expandstate=function(z,C,m,P){var w=new Uint32Array(2),n,l;for(n=0,r=0;n<18;n++)this.P[n]^=A(m,P);for(n=0,r=0;n<18;n+=2)w[0]^=A(z,C),w[1]^=A(z,C),this.encipher(w),this.P[n]=w[0],this.P[n+1]=w[1];for(n=0;n<4;n++)for(l=0;l<256;l+=2)w[0]^=A(z,C),w[1]^=A(z,C),this.encipher(w),this.S[n][l]=w[0],this.S[n][l+1]=w[1];r=0},p.prototype.enc=function(z,C){for(var m=0;m<C;m++)this.encipher(z.subarray(m*2))},p.prototype.dec=function(z,C){for(var m=0;m<C;m++)this.decipher(z.subarray(m*2))};var b=8,E=32;function T(z,C,m){var P=new p,w=new Uint32Array(b),n,l=new Uint8Array([79,120,121,99,104,114,111,109,97,116,105,99,66,108,111,119,102,105,115,104,83,119,97,116,68,121,110,97,109,105,116,101]);for(P.expandstate(C,64,z,64),n=0;n<64;n++)P.expand0state(C,64),P.expand0state(z,64);for(n=0;n<b;n++)w[n]=A(l,l.byteLength);for(n=0;n<64;n++)P.enc(w,w.byteLength/8);for(n=0;n<b;n++)m[4*n+3]=w[n]>>>24,m[4*n+2]=w[n]>>>16,m[4*n+1]=w[n]>>>8,m[4*n+0]=w[n]}function k(z,C,m,P,w,n,l){var B=new Uint8Array(64),f=new Uint8Array(64),d=new Uint8Array(E),_=new Uint8Array(E),N=new Uint8Array(P+4),Y,H,ae,L,ne,J,te=n;if(l<1||C===0||P===0||n===0||n>d.byteLength*d.byteLength||P>1<<20)return-1;for(L=Math.floor((n+d.byteLength-1)/d.byteLength),ae=Math.floor((n+L-1)/L),Y=0;Y<P;Y++)N[Y]=m[Y];for(t(B,z,C),J=1;n>0;J++){for(N[P+0]=J>>>24,N[P+1]=J>>>16,N[P+2]=J>>>8,N[P+3]=J,t(f,N,P+4),T(B,f,_),Y=d.byteLength;Y--;)d[Y]=_[Y];for(Y=1;Y<l;Y++)for(t(f,_,_.byteLength),T(B,f,_),H=0;H<d.byteLength;H++)d[H]^=_[H];for(ae=Math.min(ae,n),Y=0;Y<ae&&(ne=Y*L+(J-1),!(ne>=te));Y++)w[ne]=d[Y];n-=Y}return 0}return Zr={BLOCKS:b,HASHSIZE:E,hash:T,pbkdf:k},Zr}var $r,ki;function Dr(){if(ki)return $r;ki=1,$r={read:C,readSSHPrivate:P,write:w};var t=et,r=Qe.Buffer,p=ft(),D=pt();st();var A=nt(),b=zt(),E=Nt(),T=hr,k=At,z;function C(n,l){return b.read(n,l)}var m="openssh-key-v1";function P(n,l,B){l=new T({buffer:l});var f=l.readCString();t.strictEqual(f,m,"bad magic string");var d=l.readString(),_=l.readString(),N=l.readBuffer(),Y=l.readInt();if(Y!==1)throw new Error("OpenSSH-format key file contains multiple keys: this is unsupported.");var H=l.readBuffer();if(n==="public")return t.ok(l.atEnd(),"excess bytes left after key"),E.read(H);var ae=l.readBuffer();t.ok(l.atEnd(),"excess bytes left after key");var L=new T({buffer:N});switch(_){case"none":if(d!=="none")throw new Error('OpenSSH-format key uses KDF "none" but specifies a cipher other than "none"');break;case"bcrypt":var ne=L.readBuffer(),J=L.readInt(),te=p.opensshCipherInfo(d);if(z===void 0&&(z=Oi()),typeof B.passphrase=="string"&&(B.passphrase=r.from(B.passphrase,"utf-8")),!r.isBuffer(B.passphrase))throw new k.KeyEncryptedError(B.filename,"OpenSSH");var ce=new Uint8Array(B.passphrase),Be=new Uint8Array(ne),U=new Uint8Array(te.keySize+te.blockSize),G=z.pbkdf(ce,ce.length,Be,Be.length,U,U.length,J);if(G!==0)throw new Error("bcrypt_pbkdf function returned failure, parameters invalid");U=r.from(U);var F=U.slice(0,te.keySize),j=U.slice(te.keySize,te.keySize+te.blockSize),v=D.createDecipheriv(te.opensslName,F,j);v.setAutoPadding(!1);var c,y=[];for(v.once("error",function(ue){throw ue.toString().indexOf("bad decrypt")!==-1?new Error("Incorrect passphrase supplied, could not decrypt key"):ue}),v.write(ae),v.end();(c=v.read())!==null;)y.push(c);ae=r.concat(y);break;default:throw new Error('OpenSSH-format key uses unknown KDF "'+_+'"')}l=new T({buffer:ae});var g=l.readInt(),V=l.readInt();if(g!==V)throw new Error("Incorrect passphrase supplied, could not decrypt key");var ie={},se=E.readInternal(ie,"private",l.remainder());l.skip(ie.consumed);var re=l.readString();return se.comment=re,se}function w(n,l){var B;A.isPrivateKey(n)?B=n.toPublic():B=n;var f="none",d="none",_=r.alloc(0),N={blockSize:8},Y;l!==void 0&&(Y=l.passphrase,typeof Y=="string"&&(Y=r.from(Y,"utf-8")),Y!==void 0&&(t.buffer(Y,"options.passphrase"),t.optionalString(l.cipher,"options.cipher"),f=l.cipher,f===void 0&&(f="aes128-ctr"),N=p.opensshCipherInfo(f),d="bcrypt"));var H;if(A.isPrivateKey(n)){H=new T({});var ae=D.randomBytes(4).readUInt32BE(0);H.writeInt(ae),H.writeInt(ae),H.write(n.toBuffer("rfc4253")),H.writeString(n.comment||"");for(var L=1;H._offset%N.blockSize!==0;)H.writeChar(L++);H=H.toBuffer()}switch(d){case"none":break;case"bcrypt":var ne=D.randomBytes(16),J=16,te=new T({});te.writeBuffer(ne),te.writeInt(J),_=te.toBuffer(),z===void 0&&(z=Oi());var ce=new Uint8Array(Y),Be=new Uint8Array(ne),U=new Uint8Array(N.keySize+N.blockSize),G=z.pbkdf(ce,ce.length,Be,Be.length,U,U.length,J);if(G!==0)throw new Error("bcrypt_pbkdf function returned failure, parameters invalid");U=r.from(U);var F=U.slice(0,N.keySize),j=U.slice(N.keySize,N.keySize+N.blockSize),v=D.createCipheriv(N.opensslName,F,j);v.setAutoPadding(!1);var c,y=[];for(v.once("error",function(Ne){throw Ne}),v.write(H),v.end();(c=v.read())!==null;)y.push(c);H=r.concat(y);break;default:throw new Error("Unsupported kdf "+d)}var g=new T({});g.writeCString(m),g.writeString(f),g.writeString(d),g.writeBuffer(_),g.writeInt(1),g.writeBuffer(B.toBuffer("rfc4253")),H&&g.writeBuffer(H),g=g.toBuffer();var V;A.isPrivateKey(n)?V="OPENSSH PRIVATE KEY":V="OPENSSH PUBLIC KEY";var ie=g.toString("base64"),se=ie.length+ie.length/70+18+16+V.length*2+10;g=r.alloc(se);var re=0;re+=g.write("-----BEGIN "+V+`-----
`,re);for(var ue=0;ue<ie.length;){var Te=ue+70;Te>ie.length&&(Te=ie.length),re+=g.write(ie.slice(ue,Te),re),g[re++]=10,ue=Te}return re+=g.write("-----END "+V+`-----
`,re),g.slice(0,re)}return $r}var Qr,Ui;function zt(){if(Ui)return Qr;Ui=1,Qr={read:B,write:f};var t=et,r=Lt,p=pt(),D=Qe.Buffer,A=ft(),b=st(),E=nt(),T=Bi(),k=pr(),z=Dr(),C=Nt(),m=At,P="1.2.840.113549.1.5.13",w="1.2.840.113549.1.5.12",n={"1.2.840.113549.3.7":"3des-cbc","2.16.840.1.101.3.4.1.2":"aes128-cbc","2.16.840.1.101.3.4.1.42":"aes256-cbc"};Object.keys(n).forEach(function(d){});var l={"1.2.840.113549.2.7":"sha1","1.2.840.113549.2.9":"sha256","1.2.840.113549.2.11":"sha512"};Object.keys(l).forEach(function(d){});function B(d,_,N){var Y=d;typeof d!="string"&&(t.buffer(d,"buf"),d=d.toString("ascii"));for(var H=d.trim().split(/[\r\n]+/g),ae,L=-1;!ae&&L<H.length;)ae=H[++L].match(/[-]+[ ]*BEGIN ([A-Z0-9][A-Za-z0-9]+ )?(PUBLIC|PRIVATE) KEY[ ]*[-]+/);t.ok(ae,"invalid PEM header");for(var ne,J=H.length;!ne&&J>0;)ne=H[--J].match(/[-]+[ ]*END ([A-Z0-9][A-Za-z0-9]+ )?(PUBLIC|PRIVATE) KEY[ ]*[-]+/);t.ok(ne,"invalid PEM footer"),t.equal(ae[2],ne[2]);var te=ae[2].toLowerCase(),ce;ae[1]&&(t.equal(ae[1],ne[1],"PEM header and footer mismatch"),ce=ae[1].trim()),H=H.slice(L,J+1);for(var Be={};H=H.slice(1),ae=H[0].match(/^([A-Za-z0-9-]+): (.+)$/),!!ae;)Be[ae[1].toLowerCase()]=ae[2];H=H.slice(0,-1).join(""),d=D.from(H,"base64");var U,G,F;if(Be["proc-type"]){var j=Be["proc-type"].split(",");if(j[0]==="4"&&j[1]==="ENCRYPTED")if(typeof _.passphrase=="string"&&(_.passphrase=D.from(_.passphrase,"utf-8")),D.isBuffer(_.passphrase))j=Be["dek-info"].split(","),t.ok(j.length===2),U=j[0].toLowerCase(),F=D.from(j[1],"hex"),G=A.opensslKeyDeriv(U,F,_.passphrase,1).key;else throw new m.KeyEncryptedError(_.filename,"PEM")}if(ce&&ce.toLowerCase()==="encrypted"){var v=new r.BerReader(d),c;v.readSequence(),v.readSequence(),c=v.offset+v.length;var y=v.readOID();if(y!==P)throw new Error("Unsupported PEM/PKCS8 encryption scheme: "+y);v.readSequence(),v.readSequence();var g=v.offset+v.length,V=v.readOID();if(V!==w)throw new Error("Unsupported PBES2 KDF: "+V);v.readSequence();var ie=v.readString(r.Ber.OctetString,!0),se=v.readInt(),re="sha1";if(v.offset<g){v.readSequence();var ue=v.readOID();if(re=l[ue],re===void 0)throw new Error("Unsupported PBKDF2 hash: "+ue)}v._offset=g,v.readSequence();var Te=v.readOID();if(U=n[Te],U===void 0)throw new Error("Unsupported PBES2 cipher: "+Te);if(F=v.readString(r.Ber.OctetString,!0),v._offset=c,d=v.readString(r.Ber.OctetString,!0),typeof _.passphrase=="string"&&(_.passphrase=D.from(_.passphrase,"utf-8")),!D.isBuffer(_.passphrase))throw new m.KeyEncryptedError(_.filename,"PEM");var Ne=A.opensshCipherInfo(U);U=Ne.opensslName,G=A.pbkdf2(re,ie,se,Ne.keySize,_.passphrase),ce=void 0}if(U&&G&&F){var ze=p.createDecipheriv(U,G,F),He,Je=[];for(ze.once("error",function(dt){throw dt.toString().indexOf("bad decrypt")!==-1?new Error("Incorrect passphrase supplied, could not decrypt key"):dt}),ze.write(d),ze.end();(He=ze.read())!==null;)Je.push(He);d=D.concat(Je)}if(ce&&ce.toLowerCase()==="openssh")return z.readSSHPrivate(te,d,_);if(ce&&ce.toLowerCase()==="ssh2")return C.readType(te,d,_);var Ye=new r.BerReader(d);return Ye.originalInput=Y,Ye.readSequence(),ce?(N&&t.strictEqual(N,"pkcs1"),T.readPkcs1(ce,te,Ye)):(N&&t.strictEqual(N,"pkcs8"),k.readPkcs8(ce,te,Ye))}function f(d,_,N){t.object(d);var Y={ecdsa:"EC",rsa:"RSA",dsa:"DSA",ed25519:"EdDSA"}[d.type],H,ae=new r.BerWriter;if(E.isPrivateKey(d))N&&N==="pkcs8"?(H="PRIVATE KEY",k.writePkcs8(ae,d)):(N&&t.strictEqual(N,"pkcs1"),H=Y+" PRIVATE KEY",T.writePkcs1(ae,d));else if(b.isKey(d))N&&N==="pkcs1"?(H=Y+" PUBLIC KEY",T.writePkcs1(ae,d)):(N&&t.strictEqual(N,"pkcs8"),H="PUBLIC KEY",k.writePkcs8(ae,d));else throw new Error("key is not a Key or PrivateKey");var L=ae.buffer.toString("base64"),ne=L.length+L.length/64+18+16+H.length*2+10,J=D.alloc(ne),te=0;te+=J.write("-----BEGIN "+H+`-----
`,te);for(var ce=0;ce<L.length;){var Be=ce+64;Be>L.length&&(Be=L.length),te+=J.write(L.slice(ce,Be),te),J[te++]=10,ce=Be}return te+=J.write("-----END "+H+`-----
`,te),J.slice(0,te)}return Qr}var Xr,Ni;function na(){if(Ni)return Xr;Ni=1,Xr={read:E,write:T};var t=et,r=Qe.Buffer,p=Nt();ft();var D=st();nt(),Dr();var A=/^([a-z0-9-]+)[ \t]+([a-zA-Z0-9+\/]+[=]*)([ \t]+([^ \t][^\n]*[\n]*)?)?$/,b=/^([a-z0-9-]+)[ \t\n]+([a-zA-Z0-9+\/][a-zA-Z0-9+\/ \t\n=]*)([^a-zA-Z0-9+\/ \t\n=].*)?$/;function E(k,z){typeof k!="string"&&(t.buffer(k,"buf"),k=k.toString("ascii"));var C=k.trim().replace(/[\\\r]/g,""),m=C.match(A);m||(m=C.match(b)),t.ok(m,"key must match regex");var P=p.algToKeyType(m[1]),w=r.from(m[2],"base64"),n,l={};if(m[4])try{n=p.read(w)}catch{m=C.match(b),t.ok(m,"key must match regex"),w=r.from(m[2],"base64"),n=p.readInternal(l,"public",w)}else n=p.readInternal(l,"public",w);if(t.strictEqual(P,n.type),m[4]&&m[4].length>0)n.comment=m[4];else if(l.consumed){var B=m[2]+(m[3]?m[3]:""),f=Math.ceil(l.consumed/3)*4;B=B.slice(0,f-2).replace(/[^a-zA-Z0-9+\/=]/g,"")+B.slice(f-2);var d=l.consumed%3;for(d>0&&B.slice(f-1,f)!=="="&&f--;B.slice(f,f+1)==="=";)f++;var _=B.slice(f);_=_.replace(/[\r\n]/g," ").replace(/^\s+/,""),_.match(/^[a-zA-Z0-9]/)&&(n.comment=_)}return n}function T(k,z){if(t.object(k),!D.isKey(k))throw new Error("Must be a public key");var C=[],m=p.keyTypeToAlg(k);C.push(m);var P=p.write(k);return C.push(P.toString("base64")),k.comment&&C.push(k.comment),r.from(C.join(" "))}return Xr}var Wr,zi;function Ei(){if(zi)return Wr;zi=1,Wr={read:T,write:B};var t=et,r=Qe.Buffer,p=st(),D=nt(),A=ft();Si();var b={"rsa-sha1":5,"rsa-sha256":8,"rsa-sha512":10,"ecdsa-p256-sha256":13,"ecdsa-p384-sha384":14},E={};Object.keys(b).forEach(function(f){E[b[f]]=f.toUpperCase()});function T(f,d){typeof f!="string"&&(t.buffer(f,"buf"),f=f.toString("ascii"));var _=f.split(`
`);if(_[0].match(/^Private-key-format\: v1/)){var N=_[1].split(" "),Y=parseInt(N[1],10),H=N[2];if(!E[Y])throw new Error("Unsupported algorithm: "+H);return m(Y,_.slice(2))}for(var ae=0;_[ae].match(/^\;/);)ae++;if((_[ae].match(/\. IN KEY /)||_[ae].match(/\. IN DNSKEY /))&&_[ae+1].length===0)return k(_[ae]);throw new Error("Cannot parse dnssec key")}function k(f){var d=f.split(" "),_=parseInt(d[5],10);if(!E[_])throw new Error("Unsupported algorithm: "+_);var N=d.slice(6,d.length).join(),Y=r.from(N,"base64");if(E[_].match(/^RSA-/)){var H=Y.readUInt8(0);if(H!=3&&H!=1)throw new Error("Cannot parse dnssec key: unsupported exponent length");var ae=Y.slice(1,H+1);ae=A.mpNormalize(ae);var L=Y.slice(1+H);L=A.mpNormalize(L);var ne={type:"rsa",parts:[]};return ne.parts.push({name:"e",data:ae}),ne.parts.push({name:"n",data:L}),new p(ne)}if(E[_]==="ECDSA-P384-SHA384"||E[_]==="ECDSA-P256-SHA256"){var J="nistp384",te=384;E[_].match(/^ECDSA-P256-SHA256/)&&(J="nistp256",te=256);var ce={type:"ecdsa",curve:J,size:te,parts:[{name:"curve",data:r.from(J)},{name:"Q",data:A.ecNormalize(Y)}]};return new p(ce)}throw new Error("Unsupported algorithm: "+E[_])}function z(f){return r.from(f.split(" ")[1],"base64")}function C(f){var d={};f.forEach(function(N){N.split(" ")[0]==="Modulus:"?d.n=z(N):N.split(" ")[0]==="PublicExponent:"?d.e=z(N):N.split(" ")[0]==="PrivateExponent:"?d.d=z(N):N.split(" ")[0]==="Prime1:"?d.p=z(N):N.split(" ")[0]==="Prime2:"?d.q=z(N):N.split(" ")[0]==="Exponent1:"?d.dmodp=z(N):N.split(" ")[0]==="Exponent2:"?d.dmodq=z(N):N.split(" ")[0]==="Coefficient:"&&(d.iqmp=z(N))});var _={type:"rsa",parts:[{name:"e",data:A.mpNormalize(d.e)},{name:"n",data:A.mpNormalize(d.n)},{name:"d",data:A.mpNormalize(d.d)},{name:"p",data:A.mpNormalize(d.p)},{name:"q",data:A.mpNormalize(d.q)},{name:"dmodp",data:A.mpNormalize(d.dmodp)},{name:"dmodq",data:A.mpNormalize(d.dmodq)},{name:"iqmp",data:A.mpNormalize(d.iqmp)}]};return new D(_)}function m(f,d){if(E[f].match(/^RSA-/))return C(d);if(E[f]==="ECDSA-P384-SHA384"||E[f]==="ECDSA-P256-SHA256"){var _=r.from(d[0].split(" ")[1],"base64"),N="nistp384",Y=384;E[f]==="ECDSA-P256-SHA256"&&(N="nistp256",Y=256);var H=A.publicFromPrivateECDSA(N,_),ae=H.part.Q.data,L={type:"ecdsa",curve:N,size:Y,parts:[{name:"curve",data:r.from(N)},{name:"d",data:_},{name:"Q",data:ae}]};return new D(L)}throw new Error("Unsupported algorithm: "+E[f])}function P(f){var d=f.getFullYear()+"",_=f.getMonth()+1,N=d+_+f.getUTCDate();return N+=""+f.getUTCHours()+f.getUTCMinutes(),N+=f.getUTCSeconds(),N}function w(f){if(!f||!f.hashAlgo||f.hashAlgo==="sha1")return"5 (RSASHA1)";if(f.hashAlgo==="sha256")return"8 (RSASHA256)";if(f.hashAlgo==="sha512")return"10 (RSASHA512)";throw new Error("Unknown or unsupported hash: "+f.hashAlgo)}function n(f,d){(!f.part.dmodp||!f.part.dmodq)&&A.addRSAMissing(f);var _="";_+=`Private-key-format: v1.3
`,_+="Algorithm: "+w(d)+`
`;var N=A.mpDenormalize(f.part.n.data);_+="Modulus: "+N.toString("base64")+`
`;var Y=A.mpDenormalize(f.part.e.data);_+="PublicExponent: "+Y.toString("base64")+`
`;var H=A.mpDenormalize(f.part.d.data);_+="PrivateExponent: "+H.toString("base64")+`
`;var ae=A.mpDenormalize(f.part.p.data);_+="Prime1: "+ae.toString("base64")+`
`;var L=A.mpDenormalize(f.part.q.data);_+="Prime2: "+L.toString("base64")+`
`;var ne=A.mpDenormalize(f.part.dmodp.data);_+="Exponent1: "+ne.toString("base64")+`
`;var J=A.mpDenormalize(f.part.dmodq.data);_+="Exponent2: "+J.toString("base64")+`
`;var te=A.mpDenormalize(f.part.iqmp.data);_+="Coefficient: "+te.toString("base64")+`
`;var ce=new Date;return _+="Created: "+P(ce)+`
`,_+="Publish: "+P(ce)+`
`,_+="Activate: "+P(ce)+`
`,r.from(_,"ascii")}function l(f,d){var _="";if(_+=`Private-key-format: v1.3
`,f.curve==="nistp256")_+=`Algorithm: 13 (ECDSAP256SHA256)
`;else if(f.curve==="nistp384")_+=`Algorithm: 14 (ECDSAP384SHA384)
`;else throw new Error("Unsupported curve");var N=f.part.d.data.toString("base64");_+="PrivateKey: "+N+`
`;var Y=new Date;return _+="Created: "+P(Y)+`
`,_+="Publish: "+P(Y)+`
`,_+="Activate: "+P(Y)+`
`,r.from(_,"ascii")}function B(f,d){if(D.isPrivateKey(f)){if(f.type==="rsa")return n(f,d);if(f.type==="ecdsa")return l(f);throw new Error("Unsupported algorithm: "+f.type)}else throw p.isKey(f)?new Error('Format "dnssec" only supports writing private keys'):new Error("key is not a Key or PrivateKey")}return Wr}var Jr,Ki;function _i(){if(Ki)return Jr;Ki=1,Jr={read:k,write:m};var t=et,r=Qe.Buffer,p=Nt(),D=st(),A=hr,b=pt(),E=nt(),T=At;function k(w,n){for(var l=w.toString("ascii").split(/[\r\n]+/),B=!1,f,d=0,_;d<l.length;)if(f=C(l[d++]),f&&(_={"putty-user-key-file-2":2,"putty-user-key-file-3":3}[f[0].toLowerCase()],_)){B=!0;break}if(!B)throw new Error("No PuTTY format first line found");var N=f[1];f=C(l[d++]),t.equal(f[0].toLowerCase(),"encryption");var Y=f[1];f=C(l[d++]),t.equal(f[0].toLowerCase(),"comment");var H=f[1];f=C(l[d++]),t.equal(f[0].toLowerCase(),"public-lines");var ae=parseInt(f[1],10);if(!isFinite(ae)||ae<0||ae>l.length)throw new Error("Invalid public-lines count");var L=r.from(l.slice(d,d+ae).join(""),"base64"),ne=p.algToKeyType(N),J=p.read(L);if(J.type!==ne)throw new Error("Outer key algorithm mismatch");if(d+=ae,l[d]){f=C(l[d++]),t.equal(f[0].toLowerCase(),"private-lines");var te=parseInt(f[1],10);if(!isFinite(te)||te<0||te>l.length)throw new Error("Invalid private-lines count");var ce=r.from(l.slice(d,d+te).join(""),"base64");if(Y!=="none"&&_===3)throw new Error("Encrypted keys arenot supported for PuTTY format version 3");if(Y==="aes256-cbc"){if(!n.passphrase)throw new T.KeyEncryptedError(n.filename,"PEM");var Be=r.alloc(16,0),U=b.createDecipheriv("aes-256-cbc",z(n.passphrase),Be);U.setAutoPadding(!1),ce=r.concat([U.update(ce),U.final()])}if(J=new E(J),J.type!==ne)throw new Error("Outer key algorithm mismatch");var G=new A({buffer:ce}),F;if(N==="ssh-dss")F=[{name:"x",data:G.readBuffer()}];else if(N==="ssh-rsa")F=[{name:"d",data:G.readBuffer()},{name:"p",data:G.readBuffer()},{name:"q",data:G.readBuffer()},{name:"iqmp",data:G.readBuffer()}];else if(N.match(/^ecdsa-sha2-nistp/))F=[{name:"d",data:G.readBuffer()}];else if(N==="ssh-ed25519")F=[{name:"k",data:G.readBuffer()}];else throw new Error("Unsupported PPK key type: "+N);J=new E({type:J.type,parts:J.parts.concat(F)})}return J.comment=H,J}function z(w){var n=b.createHash("sha1").update(r.concat([r.from([0,0,0,0]),r.from(w)])).digest(),l=b.createHash("sha1").update(r.concat([r.from([0,0,0,1]),r.from(w)])).digest();return r.concat([n,l]).slice(0,32)}function C(w){var n=w.indexOf(":");if(n===-1)return null;var l=w.slice(0,n);for(++n;w[n]===" ";)++n;var B=w.slice(n);return[l,B]}function m(w,n){if(t.object(w),!D.isKey(w))throw new Error("Must be a public key");var l=p.keyTypeToAlg(w),B=p.write(w),f=w.comment||"",d=B.toString("base64"),_=P(d);return _.unshift("Public-Lines: "+_.length),_.unshift("Comment: "+f),_.unshift("Encryption: none"),_.unshift("PuTTY-User-Key-File-2: "+l),r.from(_.join(`
`)+`
`)}function P(w,n){for(var l=[],B=0;B<w.length;)l.push(w.slice(B,B+64)),B+=64;return l}return Jr}var ei,Ri;function sa(){if(Ri)return ei;Ri=1,ei={read:k,write:w};var t=et,r=Qe.Buffer;ft(),st(),nt();var p=zt(),D=na(),A=Nt(),b=Ei(),E=_i(),T="Private-key-format: v1";function k(n,l){if(typeof n=="string"){if(n.trim().match(/^[-]+[ ]*BEGIN/))return p.read(n,l);if(n.match(/^\s*ssh-[a-z]/)||n.match(/^\s*ecdsa-/))return D.read(n,l);if(n.match(/^putty-user-key-file-2:/i))return E.read(n,l);if(P(n))return b.read(n,l);n=r.from(n,"binary")}else{if(t.buffer(n),m(n))return p.read(n,l);if(C(n))return D.read(n,l);if(z(n))return E.read(n,l);if(P(n))return b.read(n,l)}if(n.readUInt32BE(0)<n.length)return A.read(n,l);throw new Error("Failed to auto-detect format of key")}function z(n){for(var l=0;l<n.length&&(n[l]===32||n[l]===10||n[l]===9);)++l;return l+22<=n.length&&n.slice(l,l+22).toString("ascii").toLowerCase()==="putty-user-key-file-2:"}function C(n){for(var l=0;l<n.length&&(n[l]===32||n[l]===10||n[l]===9);)++l;return l+4<=n.length&&n.slice(l,l+4).toString("ascii")==="ssh-"||l+6<=n.length&&n.slice(l,l+6).toString("ascii")==="ecdsa-"}function m(n){for(var l=0;l<n.length&&(n[l]===32||n[l]===10);)++l;if(n[l]!==45)return!1;for(;l<n.length&&n[l]===45;)++l;for(;l<n.length&&n[l]===32;)++l;return!(l+5>n.length||n.slice(l,l+5).toString("ascii")!=="BEGIN")}function P(n){if(n.length<=T.length)return!1;var l=n.slice(0,T.length);if(l.toString("ascii")===T)return!0;typeof n!="string"&&(n=n.toString("ascii"));for(var B=n.split(`
`),f=0;B[f].match(/^\;/);)f++;return!!(B[f].toString("ascii").match(/\. IN KEY /)||B[f].toString("ascii").match(/\. IN DNSKEY /))}function w(n,l){throw new Error('"auto" format cannot be used for writing')}return ei}var ti,Li;function nt(){if(Li)return ti;Li=1,ti=B;var t=et,r=Qe.Buffer,p=wt,D=pt();xr();var A=qt(),b=At,E=Pr,T=ft(),k=Si(),z=k.generateECDSA,C=k.generateED25519,m=fa(),P=cr,w=st();b.InvalidAlgorithmError;var n=b.KeyParseError;b.KeyEncryptedError;var l={};l.auto=sa(),l.pem=zt(),l.pkcs1=Bi(),l.pkcs8=pr(),l.rfc4253=Nt(),l["ssh-private"]=Dr(),l.openssh=l["ssh-private"],l.ssh=l["ssh-private"],l.dnssec=Ei(),l.putty=_i();function B(f){t.object(f,"options"),w.call(this,f),this._pubCache=void 0}return E.inherits(B,w),B.formats=l,B.prototype.toBuffer=function(f,d){return f===void 0&&(f="pkcs1"),t.string(f,"format"),t.object(l[f],"formats[format]"),t.optionalObject(d,"options"),l[f].write(this,d)},B.prototype.hash=function(f,d){return this.toPublic().hash(f,d)},B.prototype.fingerprint=function(f,d){return this.toPublic().fingerprint(f,d)},B.prototype.toPublic=function(){if(this._pubCache)return this._pubCache;for(var f=p.info[this.type],d=[],_=0;_<f.parts.length;++_){var N=f.parts[_];d.push(this.part[N])}return this._pubCache=new w({type:this.type,source:this,parts:d}),this.comment&&(this._pubCache.comment=this.comment),this._pubCache},B.prototype.derive=function(f){t.string(f,"type");var d,_,N;if(this.type==="ed25519"&&f==="curve25519")return d=this.part.k.data,d[0]===0&&(d=d.slice(1)),N=P.box.keyPair.fromSecretKey(new Uint8Array(d)),_=r.from(N.publicKey),new B({type:"curve25519",parts:[{name:"A",data:T.mpNormalize(_)},{name:"k",data:T.mpNormalize(d)}]});if(this.type==="curve25519"&&f==="ed25519")return d=this.part.k.data,d[0]===0&&(d=d.slice(1)),N=P.sign.keyPair.fromSeed(new Uint8Array(d)),_=r.from(N.publicKey),new B({type:"ed25519",parts:[{name:"A",data:T.mpNormalize(_)},{name:"k",data:T.mpNormalize(d)}]});throw new Error("Key derivation not supported from "+this.type+" to "+f)},B.prototype.createVerify=function(f){return this.toPublic().createVerify(f)},B.prototype.createSign=function(f){if(f===void 0&&(f=this.defaultHashAlgorithm()),t.string(f,"hash algorithm"),this.type==="ed25519"&&m!==void 0)return new m.Signer(this,f);if(this.type==="curve25519")throw new Error("Curve25519 keys are not suitable for signing or verification");var d,_,N;try{_=f.toUpperCase(),d=D.createSign(_)}catch(ne){N=ne}(d===void 0||N instanceof Error&&N.message.match(/Unknown message digest/))&&(_="RSA-",_+=f.toUpperCase(),d=D.createSign(_)),t.ok(d,"failed to create verifier");var Y=d.sign.bind(d),H=this.toBuffer("pkcs1"),ae=this.type,L=this.curve;return d.sign=function(){var ne=Y(H);return typeof ne=="string"&&(ne=r.from(ne,"binary")),ne=A.parse(ne,ae,"asn1"),ne.hashAlgorithm=f,ne.curve=L,ne},d},B.parse=function(f,d,_){typeof f!="string"&&t.buffer(f,"data"),d===void 0&&(d="auto"),t.string(d,"format"),typeof _=="string"&&(_={filename:_}),t.optionalObject(_,"options"),_===void 0&&(_={}),t.optionalString(_.filename,"options.filename"),_.filename===void 0&&(_.filename="(unnamed)"),t.object(l[d],"formats[format]");try{var N=l[d].read(f,_);return t.ok(N instanceof B,"key is not a private key"),N.comment||(N.comment=_.filename),N}catch(Y){throw Y.name==="KeyEncryptedError"?Y:new n(_.filename,d,Y)}},B.isPrivateKey=function(f,d){return T.isCompatible(f,B,d)},B.generate=function(f,d){switch(d===void 0&&(d={}),t.object(d,"options"),f){case"ecdsa":return d.curve===void 0&&(d.curve="nistp256"),t.string(d.curve,"options.curve"),z(d.curve);case"ed25519":return C();default:throw new Error('Key generation not supported with key type "'+f+'"')}},B.prototype._sshpkApiVersion=[1,6],B._oldVersionDetect=function(f){return t.func(f.toPublic),t.func(f.createSign),f.derive?[1,3]:f.defaultHashAlgorithm?[1,2]:f.formats.auto?[1,1]:[1,0]},ti}var ri,ji;function dr(){if(ji)return ri;ji=1,ri=T;var t=et;pt(),xr(),qt();var r=ft(),p=Lt,D=Qe.Buffer,A=/^([*]|[a-z0-9][a-z0-9\-]{0,62})(?:\.([*]|[a-z0-9][a-z0-9\-]{0,62}))*$/i,b={};b.cn="2.5.4.3",b.o="2.5.4.10",b.ou="2.5.4.11",b.l="2.5.4.7",b.s="2.5.4.8",b.c="2.5.4.6",b.sn="2.5.4.4",b.postalCode="2.5.4.17",b.serialNumber="2.5.4.5",b.street="2.5.4.9",b.x500UniqueIdentifier="2.5.4.45",b.role="2.5.4.72",b.telephoneNumber="2.5.4.20",b.description="2.5.4.13",b.dc="0.9.2342.19200300.100.1.25",b.uid="0.9.2342.19200300.100.1.1",b.mail="0.9.2342.19200300.100.1.3",b.title="2.5.4.12",b.gn="2.5.4.42",b.initials="2.5.4.43",b.pseudonym="2.5.4.65",b.emailAddress="1.2.840.113549.1.9.1";var E={};Object.keys(b).forEach(function(m){E[b[m]]=m});function T(m){var P=this;if(t.object(m,"options"),t.arrayOfObject(m.components,"options.components"),this.components=m.components,this.componentLookup={},this.components.forEach(function(w){w.name&&!w.oid&&(w.oid=b[w.name]),w.oid&&!w.name&&(w.name=E[w.oid]),P.componentLookup[w.name]===void 0&&(P.componentLookup[w.name]=[]),P.componentLookup[w.name].push(w)}),this.componentLookup.cn&&this.componentLookup.cn.length>0&&(this.cn=this.componentLookup.cn[0].value),t.optionalString(m.type,"options.type"),m.type===void 0)this.components.length===1&&this.componentLookup.cn&&this.componentLookup.cn.length===1&&this.componentLookup.cn[0].value.match(A)?(this.type="host",this.hostname=this.componentLookup.cn[0].value):this.componentLookup.dc&&this.components.length===this.componentLookup.dc.length?(this.type="host",this.hostname=this.componentLookup.dc.map(function(w){return w.value}).join(".")):this.componentLookup.uid&&this.components.length===this.componentLookup.uid.length?(this.type="user",this.uid=this.componentLookup.uid[0].value):this.componentLookup.cn&&this.componentLookup.cn.length===1&&this.componentLookup.cn[0].value.match(A)?(this.type="host",this.hostname=this.componentLookup.cn[0].value):this.componentLookup.uid&&this.componentLookup.uid.length===1?(this.type="user",this.uid=this.componentLookup.uid[0].value):this.componentLookup.mail&&this.componentLookup.mail.length===1?(this.type="email",this.email=this.componentLookup.mail[0].value):this.componentLookup.cn&&this.componentLookup.cn.length===1?(this.type="user",this.uid=this.componentLookup.cn[0].value):this.type="unknown";else if(this.type=m.type,this.type==="host")this.hostname=m.hostname;else if(this.type==="user")this.uid=m.uid;else if(this.type==="email")this.email=m.email;else throw new Error("Unknown type "+this.type)}T.prototype.toString=function(){return this.components.map(function(m){var P=m.name.toUpperCase();P=P.replace(/=/g,"\\=");var w=m.value;return w=w.replace(/,/g,"\\,"),P+"="+w}).join(", ")},T.prototype.get=function(m,P){t.string(m,"name");var w=this.componentLookup[m];if(!(w===void 0||w.length===0)){if(!P&&w.length>1)throw new Error("Multiple values for attribute "+m);return P?w.map(function(n){return n.value}):w[0].value}},T.prototype.toArray=function(m){return this.components.map(function(P){return{name:P.name,value:P.value}})};var k=/[^a-zA-Z0-9 '(),+.\/:=?-]/,z=/[^\x00-\x7f]/;T.prototype.toAsn1=function(m,P){m.startSequence(P),this.components.forEach(function(w){if(m.startSequence(p.Ber.Constructor|p.Ber.Set),m.startSequence(),m.writeOID(w.oid),w.asn1type===p.Ber.Utf8String||w.value.match(z)){var n=D.from(w.value,"utf8");m.writeBuffer(n,p.Ber.Utf8String)}else if(w.asn1type===p.Ber.IA5String||w.value.match(k))m.writeString(w.value,p.Ber.IA5String);else{var l=p.Ber.PrintableString;w.asn1type!==void 0&&(l=w.asn1type),m.writeString(w.value,l)}m.endSequence(),m.endSequence()}),m.endSequence()};function C(m,P){if(m==="**"||P==="**")return!0;var w=m.split("."),n=P.split(".");if(w.length!==n.length)return!1;for(var l=0;l<w.length;++l)if(!(w[l]==="*"||n[l]==="*")&&w[l]!==n[l])return!1;return!0}return T.prototype.equals=function(m){if(!T.isIdentity(m,[1,0])||m.components.length!==this.components.length)return!1;for(var P=0;P<this.components.length;++P)if(this.components[P].oid!==m.components[P].oid||!C(this.components[P].value,m.components[P].value))return!1;return!0},T.forHost=function(m){return t.string(m,"hostname"),new T({type:"host",hostname:m,components:[{name:"cn",value:m}]})},T.forUser=function(m){return t.string(m,"uid"),new T({type:"user",uid:m,components:[{name:"uid",value:m}]})},T.forEmail=function(m){return t.string(m,"email"),new T({type:"email",email:m,components:[{name:"mail",value:m}]})},T.parseDN=function(m){t.string(m,"dn");for(var P=[""],w=0,n=m;n.length>0;){var l;if((l=/^,/.exec(n))!==null)P[++w]="",n=n.slice(l[0].length);else if((l=/^\\,/.exec(n))!==null)P[w]+=",",n=n.slice(l[0].length);else if((l=/^\\./.exec(n))!==null)P[w]+=l[0],n=n.slice(l[0].length);else if((l=/^[^\\,]+/.exec(n))!==null)P[w]+=l[0],n=n.slice(l[0].length);else throw new Error("Failed to parse DN")}var B=P.map(function(f){f=f.trim();for(var d=f.indexOf("=");d>0&&f.charAt(d-1)==="\\";)d=f.indexOf("=",d+1);if(d===-1)throw new Error("Failed to parse DN");var _=f.slice(0,d).toLowerCase().replace(/\\=/g,"="),N=f.slice(d+1);return{name:_,value:N}});return new T({components:B})},T.fromArray=function(m){return t.arrayOfObject(m,"components"),m.forEach(function(P){if(t.object(P,"component"),t.string(P.name,"component.name"),!D.isBuffer(P.value)&&typeof P.value!="string")throw new Error("Invalid component value")}),new T({components:m})},T.parseAsn1=function(m,P){var w=[];m.readSequence(P);for(var n=m.offset+m.length;m.offset<n;){m.readSequence(p.Ber.Constructor|p.Ber.Set);var l=m.offset+m.length;m.readSequence();var B=m.readOID(),f=m.peek(),d;switch(f){case p.Ber.PrintableString:case p.Ber.IA5String:case p.Ber.OctetString:case p.Ber.T61String:d=m.readString(f);break;case p.Ber.Utf8String:d=m.readString(f,!0),d=d.toString("utf8");break;case p.Ber.CharacterString:case p.Ber.BMPString:d=m.readString(f,!0),d=d.toString("utf16le");break;default:throw new Error("Unknown asn1 type "+f)}w.push({oid:B,asn1type:f,value:d}),m._offset=l}return m._offset=n,new T({components:w})},T.isIdentity=function(m,P){return r.isCompatible(m,T,P)},T.prototype._sshpkApiVersion=[1,0],T._oldVersionDetect=function(m){return[1,0]},ri}var ii,Mi;function Wa(){if(Mi)return ii;Mi=1,ii={read:n,verify:m,sign:d,signAsync:_,write:N,fromBuffer:l,toBuffer:Y};var t=et,r=hr,p=pt(),D=Qe.Buffer,A=wt,b=st();nt();var E=dr(),T=Nt(),k=qt(),z=ft(),C=lr();function m(L,ne){return!1}var P={user:1,host:2};Object.keys(P).forEach(function(L){P[P[L]]=L});var w=/^ecdsa-sha2-([^@-]+)-cert-v01@openssh.com$/;function n(L,ne){D.isBuffer(L)&&(L=L.toString("ascii"));var J=L.trim().split(/[ \t\n]+/g);if(J.length<2||J.length>3)throw new Error("Not a valid SSH certificate line");var te=J[0],ce=J[1];return ce=D.from(ce,"base64"),l(ce,te)}function l(L,ne,J){var te=new r({buffer:L}),ce=te.readString();if(ne!==void 0&&ce!==ne)throw new Error("SSH certificate algorithm mismatch");ne===void 0&&(ne=ce);var Be={};Be.signatures={},Be.signatures.openssh={},Be.signatures.openssh.nonce=te.readBuffer();var U={},G=U.parts=[];U.type=H(ne);for(var F=A.info[U.type].parts.length;G.length<F;)G.push(te.readPart());t.ok(G.length>=1,"key must have at least one part");var j=A.info[U.type];if(U.type==="ecdsa"){var v=w.exec(ne);t.ok(v!==null),t.strictEqual(v[1],G[0].data.toString())}for(var c=0;c<j.parts.length;++c)if(G[c].name=j.parts[c],G[c].name!=="curve"&&j.normalize!==!1){var y=G[c];y.data=z.mpNormalize(y.data)}Be.subjectKey=new b(U),Be.serial=te.readInt64();var g=P[te.readInt()];t.string(g,"valid cert type"),Be.signatures.openssh.keyId=te.readString();for(var V=[],ie=te.readBuffer(),se=new r({buffer:ie});!se.atEnd();)V.push(se.readString());V.length===0&&(V=["*"]),Be.subjects=V.map(function(He){if(g==="user")return E.forUser(He);if(g==="host")return E.forHost(He);throw new Error("Unknown identity type "+g)}),Be.validFrom=B(te.readInt64()),Be.validUntil=B(te.readInt64());for(var re=[],ue=new r({buffer:te.readBuffer()}),Te;!ue.atEnd();)Te={critical:!0},Te.name=ue.readString(),Te.data=ue.readBuffer(),re.push(Te);for(ue=new r({buffer:te.readBuffer()});!ue.atEnd();)Te={critical:!1},Te.name=ue.readString(),Te.data=ue.readBuffer(),re.push(Te);Be.signatures.openssh.exts=re,te.readBuffer();var Ne=te.readBuffer();Be.issuerKey=T.read(Ne),Be.issuer=E.forHost("**");var ze=te.readBuffer();return Be.signatures.openssh.signature=k.parse(ze,Be.issuerKey.type,"ssh"),J!==void 0&&(J.remainder=te.remainder(),J.consumed=te._offset),new C(Be)}function B(L){var ne=L.readUInt32BE(0)*4294967296;ne+=L.readUInt32BE(4);var J=new Date;return J.setTime(ne*1e3),J.sourceInt64=L,J}function f(L){if(L.sourceInt64!==void 0)return L.sourceInt64;var ne=Math.round(L.getTime()/1e3),J=Math.floor(ne/4294967296),te=Math.floor(ne%4294967296),ce=D.alloc(8);return ce.writeUInt32BE(J,0),ce.writeUInt32BE(te,4),ce}function d(L,ne){L.signatures.openssh===void 0&&(L.signatures.openssh={});try{var J=Y(L,!0)}catch{return delete L.signatures.openssh,!1}var te=L.signatures.openssh,ce=void 0;(ne.type==="rsa"||ne.type==="dsa")&&(ce="sha1");var Be=ne.createSign(ce);return Be.write(J),te.signature=Be.sign(),!0}function _(L,ne,J){L.signatures.openssh===void 0&&(L.signatures.openssh={});try{var te=Y(L,!0)}catch(Be){delete L.signatures.openssh,J(Be);return}var ce=L.signatures.openssh;ne(te,function(Be,U){if(Be){J(Be);return}try{U.toBuffer("ssh")}catch(G){J(G);return}ce.signature=U,J()})}function N(L,ne){ne===void 0&&(ne={});var J=Y(L),te=ae(L.subjectKey)+" "+J.toString("base64");return ne.comment&&(te=te+" "+ne.comment),te}function Y(L,ne){t.object(L.signatures.openssh,"signature for openssh format");var J=L.signatures.openssh;J.nonce===void 0&&(J.nonce=p.randomBytes(16));var te=new r({});te.writeString(ae(L.subjectKey)),te.writeBuffer(J.nonce);var ce=L.subjectKey,Be=A.info[ce.type];Be.parts.forEach(function(v){te.writePart(ce.part[v])}),te.writeInt64(L.serial);var U=L.subjects[0].type;t.notStrictEqual(U,"unknown"),L.subjects.forEach(function(v){t.strictEqual(v.type,U)}),U=P[U],te.writeInt(U),J.keyId===void 0&&(J.keyId=L.subjects[0].type+"_"+(L.subjects[0].uid||L.subjects[0].hostname)),te.writeString(J.keyId);var G=new r({});L.subjects.forEach(function(v){U===P.host?G.writeString(v.hostname):U===P.user&&G.writeString(v.uid)}),te.writeBuffer(G.toBuffer()),te.writeInt64(f(L.validFrom)),te.writeInt64(f(L.validUntil));var F=J.exts;F===void 0&&(F=[]);var j=new r({});return F.forEach(function(v){v.critical===!0&&(j.writeString(v.name),j.writeBuffer(v.data))}),te.writeBuffer(j.toBuffer()),j=new r({}),F.forEach(function(v){v.critical!==!0&&(j.writeString(v.name),j.writeBuffer(v.data))}),te.writeBuffer(j.toBuffer()),te.writeBuffer(D.alloc(0)),G=T.write(L.issuerKey),te.writeBuffer(G),ne||te.writeBuffer(J.signature.toBuffer("ssh")),te.toBuffer()}function H(L){if(L==="ssh-rsa-cert-v01@openssh.com")return"rsa";if(L==="ssh-dss-cert-v01@openssh.com")return"dsa";if(L.match(w))return"ecdsa";if(L==="ssh-ed25519-cert-v01@openssh.com")return"ed25519";throw new Error("Unsupported cert type "+L)}function ae(L){if(L.type==="rsa")return"ssh-rsa-cert-v01@openssh.com";if(L.type==="dsa")return"ssh-dss-cert-v01@openssh.com";if(L.type==="ecdsa")return"ecdsa-sha2-"+L.curve+"-cert-v01@openssh.com";if(L.type==="ed25519")return"ssh-ed25519-cert-v01@openssh.com";throw new Error("Unsupported key type "+L.type)}return ii}var ai,Hi;function oa(){if(Hi)return ai;Hi=1,ai={read:n,verify:z,sign:Be,signAsync:U,write:G};var t=et,r=Lt,p=Qe.Buffer,D=ft();st(),nt(),zt();var A=dr(),b=qt(),E=lr(),T=pr();function k(c,y){return t.strictEqual(c.peek(),r.Ber.Integer,y+" is not an Integer"),D.mpNormalize(c.readString(r.Ber.Integer,!0))}function z(c,y){var g=c.signatures.x509;t.object(g,"x509 signature");var V=g.algo.split("-");if(V[0]!==y.type)return!1;var ie=g.cache;if(ie===void 0){var se=new r.BerWriter;F(c,se),ie=se.buffer}var re=y.createVerify(V[1]);return re.write(ie),re.verify(g.signature)}function C(c){return r.Ber.Context|r.Ber.Constructor|c}function m(c){return r.Ber.Context|c}var P={"rsa-md5":"1.2.840.113549.1.1.4","rsa-sha1":"1.2.840.113549.1.1.5","rsa-sha256":"1.2.840.113549.1.1.11","rsa-sha384":"1.2.840.113549.1.1.12","rsa-sha512":"1.2.840.113549.1.1.13","dsa-sha1":"1.2.840.10040.4.3","dsa-sha256":"2.16.840.1.101.3.4.3.2","ecdsa-sha1":"1.2.840.10045.4.1","ecdsa-sha256":"1.2.840.10045.4.3.2","ecdsa-sha384":"1.2.840.10045.4.3.3","ecdsa-sha512":"1.2.840.10045.4.3.4","ed25519-sha512":"1.3.101.112"};Object.keys(P).forEach(function(c){P[P[c]]=c}),P["1.3.14.3.2.3"]="rsa-md5",P["1.3.14.3.2.29"]="rsa-sha1";var w={issuerKeyId:"2.5.29.35",altName:"2.5.29.17",basicConstraints:"2.5.29.19",keyUsage:"2.5.29.15",extKeyUsage:"2.5.29.37"};function n(c,y){typeof c=="string"&&(c=p.from(c,"binary")),t.buffer(c,"buf");var g=new r.BerReader(c);if(g.readSequence(),Math.abs(g.length-g.remain)>1)throw new Error("DER sequence does not contain whole byte stream");var V=g.offset;g.readSequence();var ie=g.offset+g.length,se=ie;if(g.peek()===C(0)){g.readSequence(C(0));var re=g.readInt();t.ok(re<=3,"only x.509 versions up to v3 supported")}var ue={};ue.signatures={};var Te=ue.signatures.x509={};Te.extras={},ue.serial=k(g,"serial"),g.readSequence();var Ne=g.offset+g.length,ze=g.readOID(),He=P[ze];if(He===void 0)throw new Error("unknown signature algorithm "+ze);if(g._offset=Ne,ue.issuer=A.parseAsn1(g),g.readSequence(),ue.validFrom=l(g),ue.validUntil=l(g),ue.subjects=[A.parseAsn1(g)],g.readSequence(),Ne=g.offset+g.length,ue.subjectKey=T.readPkcs8(void 0,"public",g),g._offset=Ne,g.peek()===C(1)&&(g.readSequence(C(1)),Te.extras.issuerUniqueID=c.slice(g.offset,g.offset+g.length),g._offset+=g.length),g.peek()===C(2)&&(g.readSequence(C(2)),Te.extras.subjectUniqueID=c.slice(g.offset,g.offset+g.length),g._offset+=g.length),g.peek()===C(3)){g.readSequence(C(3));var Je=g.offset+g.length;for(g.readSequence();g.offset<Je;)Y(ue,c,g);t.strictEqual(g.offset,Je)}t.strictEqual(g.offset,ie),g.readSequence(),Ne=g.offset+g.length;var Ye=g.readOID(),dt=P[Ye];if(dt===void 0)throw new Error("unknown signature algorithm "+Ye);g._offset=Ne;var yt=g.readString(r.Ber.BitString,!0);yt[0]===0&&(yt=yt.slice(1));var Pt=dt.split("-");return Te.signature=b.parse(yt,Pt[0],"asn1"),Te.signature.hashAlgorithm=Pt[1],Te.algo=dt,Te.cache=c.slice(V,se),new E(ue)}function l(c){if(c.peek()===r.Ber.UTCTime)return ae(c.readString(r.Ber.UTCTime));if(c.peek()===r.Ber.GeneralizedTime)return ne(c.readString(r.Ber.GeneralizedTime));throw new Error("Unsupported date format")}function B(c,y){y.getUTCFullYear()>=2050||y.getUTCFullYear()<1950?c.writeString(ce(y),r.Ber.GeneralizedTime):c.writeString(te(y),r.Ber.UTCTime)}var f={OtherName:C(0),RFC822Name:m(1),DNSName:m(2),X400Address:C(3),DirectoryName:C(4),EDIPartyName:C(5),URI:m(6),IPAddress:m(7),OID:m(8)},d={serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",joyentDocker:"1.3.6.1.4.1.38678.1.4.1",joyentCmon:"1.3.6.1.4.1.38678.1.4.2"},_={};Object.keys(d).forEach(function(c){_[d[c]]=c});var N=["signature","identity","keyEncryption","encryption","keyAgreement","ca","crl"];function Y(c,y,g){g.readSequence();var V=g.offset+g.length,ie=g.readOID(),se,re=c.signatures.x509;re.extras.exts||(re.extras.exts=[]);var ue;switch(g.peek()===r.Ber.Boolean&&(ue=g.readBoolean()),ie){case w.basicConstraints:g.readSequence(r.Ber.OctetString),g.readSequence();var Te=g.offset+g.length,Ne=!1;g.peek()===r.Ber.Boolean&&(Ne=g.readBoolean()),c.purposes===void 0&&(c.purposes=[]),Ne===!0&&c.purposes.push("ca");var ze={oid:ie,critical:ue};g.offset<Te&&g.peek()===r.Ber.Integer&&(ze.pathLen=g.readInt()),re.extras.exts.push(ze);break;case w.extKeyUsage:g.readSequence(r.Ber.OctetString),g.readSequence(),c.purposes===void 0&&(c.purposes=[]);for(var He=g.offset+g.length;g.offset<He;){var Je=g.readOID();c.purposes.push(_[Je]||Je)}c.purposes.indexOf("serverAuth")!==-1&&c.purposes.indexOf("clientAuth")===-1?c.subjects.forEach(function(tt){tt.type!=="host"&&(tt.type="host",tt.hostname=tt.uid||tt.email||tt.components[0].value)}):c.purposes.indexOf("clientAuth")!==-1&&c.purposes.indexOf("serverAuth")===-1&&c.subjects.forEach(function(tt){tt.type!=="user"&&(tt.type="user",tt.uid=tt.hostname||tt.email||tt.components[0].value)}),re.extras.exts.push({oid:ie,critical:ue});break;case w.keyUsage:g.readSequence(r.Ber.OctetString);var Ye=g.readString(r.Ber.BitString,!0),dt=j(Ye,N);dt.forEach(function(tt){c.purposes===void 0&&(c.purposes=[]),c.purposes.indexOf(tt)===-1&&c.purposes.push(tt)}),re.extras.exts.push({oid:ie,critical:ue,bits:Ye});break;case w.altName:g.readSequence(r.Ber.OctetString),g.readSequence();for(var yt=g.offset+g.length;g.offset<yt;)switch(g.peek()){case f.OtherName:case f.EDIPartyName:g.readSequence(),g._offset+=g.length;break;case f.OID:g.readOID(f.OID);break;case f.RFC822Name:var Pt=g.readString(f.RFC822Name);se=A.forEmail(Pt),c.subjects[0].equals(se)||c.subjects.push(se);break;case f.DirectoryName:g.readSequence(f.DirectoryName),se=A.parseAsn1(g),c.subjects[0].equals(se)||c.subjects.push(se);break;case f.DNSName:var $t=g.readString(f.DNSName);se=A.forHost($t),c.subjects[0].equals(se)||c.subjects.push(se);break;default:g.readString(g.peek());break}re.extras.exts.push({oid:ie,critical:ue});break;default:re.extras.exts.push({oid:ie,critical:ue,data:g.readString(r.Ber.OctetString,!0)});break}g._offset=V}var H=/^([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})?Z$/;function ae(c){var y=c.match(H);t.ok(y,"timestamps must be in UTC");var g=new Date,V=g.getUTCFullYear(),ie=Math.floor(V/100)*100,se=parseInt(y[1],10);return V%100<50&&se>=60?se+=ie-1:se+=ie,g.setUTCFullYear(se,parseInt(y[2],10)-1,parseInt(y[3],10)),g.setUTCHours(parseInt(y[4],10),parseInt(y[5],10)),y[6]&&y[6].length>0&&g.setUTCSeconds(parseInt(y[6],10)),g}var L=/^([0-9]{4})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})?Z$/;function ne(c){var y=c.match(L);t.ok(y);var g=new Date;return g.setUTCFullYear(parseInt(y[1],10),parseInt(y[2],10)-1,parseInt(y[3],10)),g.setUTCHours(parseInt(y[4],10),parseInt(y[5],10)),y[6]&&y[6].length>0&&g.setUTCSeconds(parseInt(y[6],10)),g}function J(c,y){y===void 0&&(y=2);for(var g=""+c;g.length<y;)g="0"+g;return g}function te(c){var y="";return y+=J(c.getUTCFullYear()%100),y+=J(c.getUTCMonth()+1),y+=J(c.getUTCDate()),y+=J(c.getUTCHours()),y+=J(c.getUTCMinutes()),y+=J(c.getUTCSeconds()),y+="Z",y}function ce(c){var y="";return y+=J(c.getUTCFullYear(),4),y+=J(c.getUTCMonth()+1),y+=J(c.getUTCDate()),y+=J(c.getUTCHours()),y+=J(c.getUTCMinutes()),y+=J(c.getUTCSeconds()),y+="Z",y}function Be(c,y){c.signatures.x509===void 0&&(c.signatures.x509={});var g=c.signatures.x509;if(g.algo=y.type+"-"+y.defaultHashAlgorithm(),P[g.algo]===void 0)return!1;var V=new r.BerWriter;F(c,V);var ie=V.buffer;g.cache=ie;var se=y.createSign();return se.write(ie),c.signatures.x509.signature=se.sign(),!0}function U(c,y,g){c.signatures.x509===void 0&&(c.signatures.x509={});var V=c.signatures.x509,ie=new r.BerWriter;F(c,ie);var se=ie.buffer;V.cache=se,y(se,function(re,ue){if(re){g(re);return}if(V.algo=ue.type+"-"+ue.hashAlgorithm,P[V.algo]===void 0){g(new Error('Invalid signing algorithm "'+V.algo+'"'));return}V.signature=ue,g()})}function G(c,y){var g=c.signatures.x509;t.object(g,"x509 signature");var V=new r.BerWriter;V.startSequence(),g.cache?(V._ensure(g.cache.length),g.cache.copy(V._buf,V._offset),V._offset+=g.cache.length):F(c,V),V.startSequence(),V.writeOID(P[g.algo]),g.algo.match(/^rsa-/)&&V.writeNull(),V.endSequence();var ie=g.signature.toBuffer("asn1"),se=p.alloc(ie.length+1);return se[0]=0,ie.copy(se,1),V.writeBuffer(se,r.Ber.BitString),V.endSequence(),V.buffer}function F(c,y){var g=c.signatures.x509;t.object(g,"x509 signature"),y.startSequence(),y.startSequence(C(0)),y.writeInt(2),y.endSequence(),y.writeBuffer(D.mpNormalize(c.serial),r.Ber.Integer),y.startSequence(),y.writeOID(P[g.algo]),g.algo.match(/^rsa-/)&&y.writeNull(),y.endSequence(),c.issuer.toAsn1(y),y.startSequence(),B(y,c.validFrom),B(y,c.validUntil),y.endSequence();var V=c.subjects[0],ie=c.subjects.slice(1);if(V.toAsn1(y),T.writePkcs8(y,c.subjectKey),g.extras&&g.extras.issuerUniqueID&&y.writeBuffer(g.extras.issuerUniqueID,C(1)),g.extras&&g.extras.subjectUniqueID&&y.writeBuffer(g.extras.subjectUniqueID,C(2)),ie.length>0||V.type==="host"||c.purposes!==void 0&&c.purposes.length>0||g.extras&&g.extras.exts){y.startSequence(C(3)),y.startSequence();var se=[];c.purposes!==void 0&&c.purposes.length>0&&(se.push({oid:w.basicConstraints,critical:!0}),se.push({oid:w.keyUsage,critical:!0}),se.push({oid:w.extKeyUsage,critical:!0})),se.push({oid:w.altName}),g.extras&&g.extras.exts&&(se=g.extras.exts);for(var re=0;re<se.length;++re){if(y.startSequence(),y.writeOID(se[re].oid),se[re].critical!==void 0&&y.writeBoolean(se[re].critical),se[re].oid===w.altName){y.startSequence(r.Ber.OctetString),y.startSequence(),V.type==="host"&&y.writeString(V.hostname,m(2));for(var ue=0;ue<ie.length;++ue)ie[ue].type==="host"?y.writeString(ie[ue].hostname,f.DNSName):ie[ue].type==="email"?y.writeString(ie[ue].email,f.RFC822Name):(y.startSequence(f.DirectoryName),ie[ue].toAsn1(y),y.endSequence());y.endSequence(),y.endSequence()}else if(se[re].oid===w.basicConstraints){y.startSequence(r.Ber.OctetString),y.startSequence();var Te=c.purposes.indexOf("ca")!==-1,Ne=se[re].pathLen;y.writeBoolean(Te),Ne!==void 0&&y.writeInt(Ne),y.endSequence(),y.endSequence()}else if(se[re].oid===w.extKeyUsage)y.startSequence(r.Ber.OctetString),y.startSequence(),c.purposes.forEach(function(He){if(He!=="ca"&&N.indexOf(He)===-1){var Je=He;d[He]!==void 0&&(Je=d[He]),y.writeOID(Je)}}),y.endSequence(),y.endSequence();else if(se[re].oid===w.keyUsage){if(y.startSequence(r.Ber.OctetString),se[re].bits!==void 0)y.writeBuffer(se[re].bits,r.Ber.BitString);else{var ze=v(c.purposes,N);y.writeBuffer(ze,r.Ber.BitString)}y.endSequence()}else y.writeBuffer(se[re].data,r.Ber.OctetString);y.endSequence()}y.endSequence(),y.endSequence()}y.endSequence()}function j(c,y){for(var g=8*(c.length-1)-c[0],V={},ie=0;ie<g;++ie){var se=1+Math.floor(ie/8),re=7-ie%8,ue=1<<re,Te=(c[se]&ue)!==0,Ne=y[ie];Te&&typeof Ne=="string"&&(V[Ne]=!0)}return Object.keys(V)}function v(c,y){var g=y.length,V=Math.ceil(g/8),ie=V*8-g,se=p.alloc(1+V);se[0]=ie;for(var re=0;re<g;++re){var ue=1+Math.floor(re/8),Te=7-re%8,Ne=1<<Te,ze=y[re];if(ze!==void 0){var He=c.indexOf(ze)!==-1;He&&(se[ue]|=Ne)}}return se}return ai}var fi,Yi;function Ja(){if(Yi)return fi;Yi=1;var t=oa();fi={read:D,verify:t.verify,sign:t.sign,write:A};var r=et,p=Qe.Buffer;ft(),st(),nt(),zt(),dr(),qt(),lr();function D(b,E){typeof b!="string"&&(r.buffer(b,"buf"),b=b.toString("ascii"));for(var T=b.trim().split(/[\r\n]+/g),k,z=-1;!k&&z<T.length;)k=T[++z].match(/[-]+[ ]*BEGIN CERTIFICATE[ ]*[-]+/);r.ok(k,"invalid PEM header");for(var C,m=T.length;!C&&m>0;)C=T[--m].match(/[-]+[ ]*END CERTIFICATE[ ]*[-]+/);r.ok(C,"invalid PEM footer"),T=T.slice(z,m+1);for(var P={};T=T.slice(1),k=T[0].match(/^([A-Za-z0-9-]+): (.+)$/),!!k;)P[k[1].toLowerCase()]=k[2];return T=T.slice(0,-1).join(""),b=p.from(T,"base64"),t.read(b,E)}function A(b,E){var T=t.write(b,E),k="CERTIFICATE",z=T.toString("base64"),C=z.length+z.length/64+18+16+k.length*2+10,m=p.alloc(C),P=0;P+=m.write("-----BEGIN "+k+`-----
`,P);for(var w=0;w<z.length;){var n=w+64;n>z.length&&(n=z.length),P+=m.write(z.slice(w,n),P),m[P++]=10,w=n}return P+=m.write("-----END "+k+`-----
`,P),m.slice(0,P)}return fi}var ni,Vi;function lr(){if(Vi)return ni;Vi=1,ni=w;var t=et,r=Qe.Buffer,p=wt,D=pt(),A=xr();qt();var b=At,E=ft(),T=st(),k=nt(),z=dr(),C={};C.openssh=Wa(),C.x509=oa(),C.pem=Ja();var m=b.CertificateParseError,P=b.InvalidAlgorithmError;function w(n){t.object(n,"options"),t.arrayOfObject(n.subjects,"options.subjects"),E.assertCompatible(n.subjects[0],z,[1,0],"options.subjects"),E.assertCompatible(n.subjectKey,T,[1,0],"options.subjectKey"),E.assertCompatible(n.issuer,z,[1,0],"options.issuer"),n.issuerKey!==void 0&&E.assertCompatible(n.issuerKey,T,[1,0],"options.issuerKey"),t.object(n.signatures,"options.signatures"),t.buffer(n.serial,"options.serial"),t.date(n.validFrom,"options.validFrom"),t.date(n.validUntil,"optons.validUntil"),t.optionalArrayOfString(n.purposes,"options.purposes"),this._hashCache={},this.subjects=n.subjects,this.issuer=n.issuer,this.subjectKey=n.subjectKey,this.issuerKey=n.issuerKey,this.signatures=n.signatures,this.serial=n.serial,this.validFrom=n.validFrom,this.validUntil=n.validUntil,this.purposes=n.purposes}return w.formats=C,w.prototype.toBuffer=function(n,l){return n===void 0&&(n="x509"),t.string(n,"format"),t.object(C[n],"formats[format]"),t.optionalObject(l,"options"),C[n].write(this,l)},w.prototype.toString=function(n,l){return n===void 0&&(n="pem"),this.toBuffer(n,l).toString()},w.prototype.fingerprint=function(n){n===void 0&&(n="sha256"),t.string(n,"algorithm");var l={type:"certificate",hash:this.hash(n),algorithm:n};return new A(l)},w.prototype.hash=function(n){if(t.string(n,"algorithm"),n=n.toLowerCase(),p.hashAlgs[n]===void 0)throw new P(n);if(this._hashCache[n])return this._hashCache[n];var l=D.createHash(n).update(this.toBuffer("x509")).digest();return this._hashCache[n]=l,l},w.prototype.isExpired=function(n){return n===void 0&&(n=new Date),!(n.getTime()>=this.validFrom.getTime()&&n.getTime()<this.validUntil.getTime())},w.prototype.isSignedBy=function(n){return E.assertCompatible(n,w,[1,0],"issuer"),!this.issuer.equals(n.subjects[0])||this.issuer.purposes&&this.issuer.purposes.length>0&&this.issuer.purposes.indexOf("ca")===-1?!1:this.isSignedByKey(n.subjectKey)},w.prototype.getExtension=function(n){t.string(n,"keyOrOid");var l=this.getExtensions().filter(function(B){return B.format==="x509"?B.oid===n:B.format==="openssh"?B.name===n:!1})[0];return l},w.prototype.getExtensions=function(){var n=[],l=this.signatures.x509;l&&l.extras&&l.extras.exts&&l.extras.exts.forEach(function(f){f.format="x509",n.push(f)});var B=this.signatures.openssh;return B&&B.exts&&B.exts.forEach(function(f){f.format="openssh",n.push(f)}),n},w.prototype.isSignedByKey=function(n){if(E.assertCompatible(n,T,[1,2],"issuerKey"),this.issuerKey!==void 0)return this.issuerKey.fingerprint("sha512").matches(n);var l=Object.keys(this.signatures)[0],B=C[l].verify(this,n);return B&&(this.issuerKey=n),B},w.prototype.signWith=function(n){E.assertCompatible(n,k,[1,2],"key");for(var l=Object.keys(C),B=!1,f=0;f<l.length;++f)if(l[f]!=="pem"){var d=C[l[f]].sign(this,n);d===!0&&(B=!0)}if(!B)throw new Error("Failed to sign the certificate for any available certificate formats")},w.createSelfSigned=function(n,l,B){var f;Array.isArray(n)?f=n:f=[n],t.arrayOfObject(f),f.forEach(function(J){E.assertCompatible(J,z,[1,0],"subject")}),E.assertCompatible(l,k,[1,2],"private key"),t.optionalObject(B,"options"),B===void 0&&(B={}),t.optionalObject(B.validFrom,"options.validFrom"),t.optionalObject(B.validUntil,"options.validUntil");var d=B.validFrom,_=B.validUntil;if(d===void 0&&(d=new Date),_===void 0){t.optionalNumber(B.lifetime,"options.lifetime");var N=B.lifetime;N===void 0&&(N=10*365*24*3600),_=new Date,_.setTime(_.getTime()+N*1e3)}t.optionalBuffer(B.serial,"options.serial");var Y=B.serial;Y===void 0&&(Y=r.from("0000000000000001","hex"));var H=B.purposes;if(H===void 0&&(H=[]),H.indexOf("signature")===-1&&H.push("signature"),H.indexOf("ca")===-1&&H.push("ca"),H.indexOf("crl")===-1&&H.push("crl"),H.length<=3){var ae=f.filter(function(J){return J.type==="host"}),L=f.filter(function(J){return J.type==="user"});ae.length>0&&H.indexOf("serverAuth")===-1&&H.push("serverAuth"),L.length>0&&H.indexOf("clientAuth")===-1&&H.push("clientAuth"),(L.length>0||ae.length>0)&&(H.indexOf("keyAgreement")===-1&&H.push("keyAgreement"),l.type==="rsa"&&H.indexOf("encryption")===-1&&H.push("encryption"))}var ne=new w({subjects:f,issuer:f[0],subjectKey:l.toPublic(),issuerKey:l.toPublic(),signatures:{},serial:Y,validFrom:d,validUntil:_,purposes:H});return ne.signWith(l),ne},w.create=function(n,l,B,f,d){var _;Array.isArray(n)?_=n:_=[n],t.arrayOfObject(_),_.forEach(function(ce){E.assertCompatible(ce,z,[1,0],"subject")}),E.assertCompatible(l,T,[1,0],"key"),k.isPrivateKey(l)&&(l=l.toPublic()),E.assertCompatible(B,z,[1,0],"issuer"),E.assertCompatible(f,k,[1,2],"issuer key"),t.optionalObject(d,"options"),d===void 0&&(d={}),t.optionalObject(d.validFrom,"options.validFrom"),t.optionalObject(d.validUntil,"options.validUntil");var N=d.validFrom,Y=d.validUntil;if(N===void 0&&(N=new Date),Y===void 0){t.optionalNumber(d.lifetime,"options.lifetime");var H=d.lifetime;H===void 0&&(H=10*365*24*3600),Y=new Date,Y.setTime(Y.getTime()+H*1e3)}t.optionalBuffer(d.serial,"options.serial");var ae=d.serial;ae===void 0&&(ae=r.from("0000000000000001","hex"));var L=d.purposes;L===void 0&&(L=[]),L.indexOf("signature")===-1&&L.push("signature"),d.ca===!0&&(L.indexOf("ca")===-1&&L.push("ca"),L.indexOf("crl")===-1&&L.push("crl"));var ne=_.filter(function(ce){return ce.type==="host"}),J=_.filter(function(ce){return ce.type==="user"});ne.length>0&&L.indexOf("serverAuth")===-1&&L.push("serverAuth"),J.length>0&&L.indexOf("clientAuth")===-1&&L.push("clientAuth"),(J.length>0||ne.length>0)&&(L.indexOf("keyAgreement")===-1&&L.push("keyAgreement"),l.type==="rsa"&&L.indexOf("encryption")===-1&&L.push("encryption"));var te=new w({subjects:_,issuer:B,subjectKey:l,issuerKey:f.toPublic(),signatures:{},serial:ae,validFrom:N,validUntil:Y,purposes:L});return te.signWith(f),te},w.parse=function(n,l,B){typeof n!="string"&&t.buffer(n,"data"),l===void 0&&(l="auto"),t.string(l,"format"),typeof B=="string"&&(B={filename:B}),t.optionalObject(B,"options"),B===void 0&&(B={}),t.optionalString(B.filename,"options.filename"),B.filename===void 0&&(B.filename="(unnamed)"),t.object(C[l],"formats[format]");try{var f=C[l].read(n,B);return f}catch(d){throw new m(B.filename,l,d)}},w.isCertificate=function(n,l){return E.isCompatible(n,w,l)},w.prototype._sshpkApiVersion=[1,1],w._oldVersionDetect=function(n){return[1,0]},ni}var si,Gi;function xr(){if(Gi)return si;Gi=1,si=m;var t=et,r=Qe.Buffer,p=wt,D=pt(),A=At,b=st(),E=nt(),T=lr(),k=ft(),z=A.FingerprintFormatError,C=A.InvalidAlgorithmError;function m(f){if(t.object(f,"options"),t.string(f.type,"options.type"),t.buffer(f.hash,"options.hash"),t.string(f.algorithm,"options.algorithm"),this.algorithm=f.algorithm.toLowerCase(),p.hashAlgs[this.algorithm]!==!0)throw new C(this.algorithm);this.hash=f.hash,this.type=f.type,this.hashType=f.hashType}m.prototype.toString=function(f){switch(f===void 0&&(this.algorithm==="md5"||this.hashType==="spki"?f="hex":f="base64"),t.string(f),f){case"hex":return this.hashType==="spki"?this.hash.toString("hex"):n(this.hash.toString("hex"));case"base64":return this.hashType==="spki"?this.hash.toString("base64"):B(this.algorithm,this.hash.toString("base64"));default:throw new z(void 0,f)}},m.prototype.matches=function(f){t.object(f,"key or certificate"),this.type==="key"&&this.hashType!=="ssh"?(k.assertCompatible(f,b,[1,7],"key with spki"),E.isPrivateKey(f)&&k.assertCompatible(f,E,[1,6],"privatekey with spki support")):this.type==="key"?k.assertCompatible(f,b,[1,0],"key"):k.assertCompatible(f,T,[1,0],"certificate");var d=f.hash(this.algorithm,this.hashType),_=D.createHash(this.algorithm).update(d).digest("base64");return this.hash2===void 0&&(this.hash2=D.createHash(this.algorithm).update(this.hash).digest("base64")),this.hash2===_};var P=/^[A-Za-z0-9+\/=]+$/,w=/^[a-fA-F0-9]+$/;m.parse=function(f,d){t.string(f,"fingerprint");var _,N,Y;Array.isArray(d)&&(Y=d,d={}),t.optionalObject(d,"options"),d===void 0&&(d={}),d.enAlgs!==void 0&&(Y=d.enAlgs),d.algorithms!==void 0&&(Y=d.algorithms),t.optionalArrayOfString(Y,"algorithms");var H="ssh";d.hashType!==void 0&&(H=d.hashType),t.string(H,"options.hashType");var ae=f.split(":");if(ae.length==2){if(_=ae[0].toLowerCase(),!P.test(ae[1]))throw new z(f);try{N=r.from(ae[1],"base64")}catch{throw new z(f)}}else if(ae.length>2){if(_="md5",ae[0].toLowerCase()==="md5"&&(ae=ae.slice(1)),ae=ae.map(function(L){for(;L.length<2;)L="0"+L;if(L.length>2)throw new z(f);return L}),ae=ae.join(""),!w.test(ae)||ae.length%2!==0)throw new z(f);try{N=r.from(ae,"hex")}catch{throw new z(f)}}else{if(w.test(f))N=r.from(f,"hex");else if(P.test(f))N=r.from(f,"base64");else throw new z(f);switch(N.length){case 32:_="sha256";break;case 16:_="md5";break;case 20:_="sha1";break;case 64:_="sha512";break;default:throw new z(f)}d.hashType===void 0&&(H="spki")}if(_===void 0)throw new z(f);if(p.hashAlgs[_]===void 0)throw new C(_);if(Y!==void 0&&(Y=Y.map(function(L){return L.toLowerCase()}),Y.indexOf(_)===-1))throw new C(_);return new m({algorithm:_,hash:N,type:d.type||"key",hashType:H})};function n(f){return f.replace(/(.{2})(?=.)/g,"$1:")}function l(f){return f.replace(/=*$/,"")}function B(f,d){return f.toUpperCase()+":"+l(d)}return m.isFingerprint=function(f,d){return k.isCompatible(f,m,d)},m.prototype._sshpkApiVersion=[1,2],m._oldVersionDetect=function(f){return t.func(f.toString),t.func(f.matches),[1,0]},si}var oi,Zi;function st(){if(Zi)return oi;Zi=1,oi=w;var t=et,r=wt,p=pt(),D=xr(),A=qt(),b=Si().DiffieHellman,E=At,T=ft(),k=nt(),z;try{z=fa()}catch{}var C=E.InvalidAlgorithmError,m=E.KeyParseError,P={};P.auto=sa(),P.pem=zt(),P.pkcs1=Bi(),P.pkcs8=pr(),P.rfc4253=Nt(),P.ssh=na(),P["ssh-private"]=Dr(),P.openssh=P["ssh-private"],P.dnssec=Ei(),P.putty=_i(),P.ppk=P.putty;function w(n){t.object(n,"options"),t.arrayOfObject(n.parts,"options.parts"),t.string(n.type,"options.type"),t.optionalString(n.comment,"options.comment");var l=r.info[n.type];if(typeof l!="object")throw new C(n.type);for(var B={},f=0;f<n.parts.length;++f){var d=n.parts[f];B[d.name]=d}this.type=n.type,this.parts=n.parts,this.part=B,this.comment=void 0,this.source=n.source,this._rfc4253Cache=n._rfc4253Cache,this._hashCache={};var _;if(this.curve=void 0,this.type==="ecdsa"){var N=this.part.curve.data.toString();this.curve=N,_=r.curves[N].size}else if(this.type==="ed25519"||this.type==="curve25519")_=256,this.curve="curve25519";else{var Y=this.part[l.sizePart];_=Y.data.length,_=_*8-T.countZeros(Y.data)}this.size=_}return w.formats=P,w.prototype.toBuffer=function(n,l){return n===void 0&&(n="ssh"),t.string(n,"format"),t.object(P[n],"formats[format]"),t.optionalObject(l,"options"),n==="rfc4253"?(this._rfc4253Cache===void 0&&(this._rfc4253Cache=P.rfc4253.write(this)),this._rfc4253Cache):P[n].write(this,l)},w.prototype.toString=function(n,l){return this.toBuffer(n,l).toString()},w.prototype.hash=function(n,l){if(t.string(n,"algorithm"),t.optionalString(l,"type"),l===void 0&&(l="ssh"),n=n.toLowerCase(),r.hashAlgs[n]===void 0)throw new C(n);var B=n+"||"+l;if(this._hashCache[B])return this._hashCache[B];var f;if(l==="ssh")f=this.toBuffer("rfc4253");else if(l==="spki")f=P.pkcs8.pkcs8ToBuffer(this);else throw new Error("Hash type "+l+" not supported");var d=p.createHash(n).update(f).digest();return this._hashCache[B]=d,d},w.prototype.fingerprint=function(n,l){n===void 0&&(n="sha256"),l===void 0&&(l="ssh"),t.string(n,"algorithm"),t.string(l,"type");var B={type:"key",hash:this.hash(n,l),algorithm:n,hashType:l};return new D(B)},w.prototype.defaultHashAlgorithm=function(){var n="sha1";return this.type==="rsa"&&(n="sha256"),this.type==="dsa"&&this.size>1024&&(n="sha256"),this.type==="ed25519"&&(n="sha512"),this.type==="ecdsa"&&(this.size<=256?n="sha256":this.size<=384?n="sha384":n="sha512"),n},w.prototype.createVerify=function(n){if(n===void 0&&(n=this.defaultHashAlgorithm()),t.string(n,"hash algorithm"),this.type==="ed25519"&&z!==void 0)return new z.Verifier(this,n);if(this.type==="curve25519")throw new Error("Curve25519 keys are not suitable for signing or verification");var l,B,f;try{B=n.toUpperCase(),l=p.createVerify(B)}catch(H){f=H}(l===void 0||f instanceof Error&&f.message.match(/Unknown message digest/))&&(B="RSA-",B+=n.toUpperCase(),l=p.createVerify(B)),t.ok(l,"failed to create verifier");var d=l.verify.bind(l),_=this.toBuffer("pkcs8"),N=this.curve,Y=this;return l.verify=function(H,ae){if(A.isSignature(H,[2,0]))return H.type!==Y.type||H.hashAlgorithm&&H.hashAlgorithm!==n||H.curve&&Y.type==="ecdsa"&&H.curve!==N?!1:d(_,H.toBuffer("asn1"));if(typeof H=="string"||Wi.isBuffer(H))return d(_,H,ae);throw A.isSignature(H,[1,0])?new Error("signature was created by too old a version of sshpk and cannot be verified"):new TypeError("signature must be a string, Buffer, or Signature object")},l},w.prototype.createDiffieHellman=function(){if(this.type==="rsa")throw new Error("RSA keys do not support Diffie-Hellman");return new b(this)},w.prototype.createDH=w.prototype.createDiffieHellman,w.parse=function(n,l,B){typeof n!="string"&&t.buffer(n,"data"),l===void 0&&(l="auto"),t.string(l,"format"),typeof B=="string"&&(B={filename:B}),t.optionalObject(B,"options"),B===void 0&&(B={}),t.optionalString(B.filename,"options.filename"),B.filename===void 0&&(B.filename="(unnamed)"),t.object(P[l],"formats[format]");try{var f=P[l].read(n,B);return f instanceof k&&(f=f.toPublic()),f.comment||(f.comment=B.filename),f}catch(d){throw d.name==="KeyEncryptedError"?d:new m(B.filename,l,d)}},w.isKey=function(n,l){return T.isCompatible(n,w,l)},w.prototype._sshpkApiVersion=[1,7],w._oldVersionDetect=function(n){return t.func(n.toBuffer),t.func(n.fingerprint),n.createDH?[1,4]:n.defaultHashAlgorithm?[1,3]:n.formats.auto?[1,2]:n.formats.pkcs1?[1,1]:[1,0]},oi}var $i=st(),Qi=xr(),Xi=qt(),ui=nt(),Ar=lr(),Yt=dr(),Vt=At,ef={Key:$i,parseKey:$i.parse,Fingerprint:Qi,parseFingerprint:Qi.parse,Signature:Xi,parseSignature:Xi.parse,PrivateKey:ui,parsePrivateKey:ui.parse,generatePrivateKey:ui.generate,Certificate:Ar,parseCertificate:Ar.parse,createSelfSignedCertificate:Ar.createSelfSigned,createCertificate:Ar.create,Identity:Yt,identityFromDN:Yt.parseDN,identityForHost:Yt.forHost,identityForUser:Yt.forUser,identityForEmail:Yt.forEmail,identityFromArray:Yt.fromArray,FingerprintFormatError:Vt.FingerprintFormatError,InvalidAlgorithmError:Vt.InvalidAlgorithmError,KeyParseError:Vt.KeyParseError,SignatureParseError:Vt.SignatureParseError,KeyEncryptedError:Vt.KeyEncryptedError,CertificateParseError:Vt.CertificateParseError};const uf=ca(ef);export{Lt as a,ef as l,uf as s};
