import{_ as fe}from"./InputCopyable.vue_vue_type_script_setup_true_lang-294ac243.js";import{Q as ae,d as le,a0 as ce,r as C,E as ue,i as V,D as pe,R as he,o as b,c as D,k as w,w as M,l as u,m as N,j as E,ad as O,a7 as ge,a8 as xe,aW as me,x as de,bq as ye}from"./index-0c1fde36.js";import{G as I}from"./index-cfd4d427.js";import{w as F}from"./defaults-4d6daddf.js";import{_ as we}from"./Radio-424d9905.js";import{_ as _e}from"./Space-7fc52151.js";import{_ as be}from"./RadioGroup-1850ca84.js";import{_ as Ae}from"./Divider-5fc425b0.js";import"./get-slot-1efb97e5.js";/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wärting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const K="0123456789abcdef",X=[],U=[];for(let e=0;e<256;e++)X[e]=K[e>>4&15]+K[e&15],e<16&&(e<10?U[48+e]=e:U[97-10+e]=e);const x=e=>{const n=e.length;let t="",i=0;for(;i<n;)t+=X[e[i++]];return t},S=e=>{const n=e.length>>1,t=n<<1,i=new Uint8Array(n);let r=0,o=0;for(;o<t;)i[r++]=U[e.charCodeAt(o++)]<<4|U[e.charCodeAt(o++)];return i},Le=(e,n=0)=>{const t=e.length||0;if(!n){let a=t;for(;a--;)n+=e[a].length}const i=new Uint8Array(n);let r=n,o=t;for(;o--;)r-=e[o].length,i.set(e[o],r);return i};var _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Be=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var k=0;k<_.length;k++)Be[_.charCodeAt(k)]=k;var ke=function(e){var n=new Uint8Array(e),t,i=n.length,r="";for(t=0;t<i;t+=3)r+=_[n[t]>>2],r+=_[(n[t]&3)<<4|n[t+1]>>4],r+=_[(n[t+1]&15)<<2|n[t+2]>>6],r+=_[n[t+2]&63];return i%3===2?r=r.substring(0,r.length-1)+"=":i%3===1&&(r=r.substring(0,r.length-2)+"=="),r};const Ue=new TextDecoder,g=(e,n)=>n?new TextDecoder(n).decode(e):Ue.decode(e),ve=new TextEncoder,h=e=>ve.encode(e),Ce=e=>ke(e),P=typeof window<"u"?window:self,G=P.crypto||P.msCrypto||{},q=G.subtle||G.webkitSubtle,Ee={hex:x,base64:Ce},Se=async(e,n,t="sha-1")=>{if(!q)throw new Error("no web crypto support");typeof e=="string"&&(e=h(e));const i=new Uint8Array(await q.digest(t,e));return n?Ee[n](i):i};function A(e){const n=e<0?1:0;return e=Math.abs(Number(e||1)),Math.floor(Math.log10(e))+1+n}function Z(e){return ArrayBuffer.isView(e)?"arraybufferview":Array.isArray(e)?"array":e instanceof Number?"number":e instanceof Boolean?"boolean":e instanceof Set?"set":e instanceof Map?"map":e instanceof String?"string":e instanceof ArrayBuffer?"arraybuffer":typeof e}function l(e,n,t){const i=[];let r=null;return l._encode(i,e),r=Le(i),l.bytes=r.length,ArrayBuffer.isView(n)?(n.set(r,t),n):r}l.bytes=-1;l._floatConversionDetected=!1;l._encode=function(e,n){if(n!=null)switch(Z(n)){case"object":l.dict(e,n);break;case"map":l.dictMap(e,n);break;case"array":l.list(e,n);break;case"set":l.listSet(e,n);break;case"string":l.string(e,n);break;case"number":l.number(e,n);break;case"boolean":l.number(e,n);break;case"arraybufferview":l.buffer(e,new Uint8Array(n.buffer,n.byteOffset,n.byteLength));break;case"arraybuffer":l.buffer(e,new Uint8Array(n));break}};const v=new Uint8Array([101]),z=new Uint8Array([100]),j=new Uint8Array([108]);l.buffer=function(e,n){e.push(h(n.length+":"),n)};l.string=function(e,n){e.push(h(h(n).byteLength+":"+n))};l.number=function(e,n){if(Number.isInteger(n))return e.push(h("i"+BigInt(n)+"e"));const t=2147483648,i=n/t<<0,r=n%t<<0,o=i*t+r;e.push(h("i"+o+"e")),o!==n&&!l._floatConversionDetected&&(l._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+n+'":','Bencoding only defines support for integers, value was converted to "'+o+'"'),console.trace())};l.dict=function(e,n){e.push(z);let t=0,i;const r=Object.keys(n).sort(),o=r.length;for(;t<o;t++)i=r[t],n[i]!=null&&(l.string(e,i),l._encode(e,n[i]));e.push(v)};l.dictMap=function(e,n){e.push(z);const t=Array.from(n.keys()).sort();for(const i of t)n.get(i)!=null&&(ArrayBuffer.isView(i)?l._encode(e,i):l.string(e,String(i)),l._encode(e,n.get(i)));e.push(v)};l.list=function(e,n){let t=0;const i=n.length;for(e.push(j);t<i;t++)n[t]!=null&&l._encode(e,n[t]);e.push(v)};l.listSet=function(e,n){e.push(j);for(const t of n)t!=null&&l._encode(e,t);e.push(v)};const $e=105,Re=58,Te=100,He=108,R=101;function ee(e,n,t){let i=0,r=1;for(let o=n;o<t;o++){const a=e[o];if(a<58&&a>=48){i=i*10+(a-48);continue}if(!(o===n&&a===43)){if(o===n&&a===45){r=-1;continue}if(a===46)break;throw new Error("not a number: buffer["+o+"] = "+a)}}return i*r}function s(e,n,t,i){return e==null||e.length===0?null:(typeof n!="number"&&i==null&&(i=n,n=void 0),typeof t!="number"&&i==null&&(i=t,t=void 0),s.position=0,s.encoding=i||null,s.data=ArrayBuffer.isView(e)?new Uint8Array(e.slice(n,t)):h(e),s.bytes=s.data.length,s.next())}s.bytes=0;s.position=0;s.data=null;s.encoding=null;s.next=function(){switch(s.data[s.position]){case Te:return s.dictionary();case He:return s.list();case $e:return s.integer();default:return s.buffer()}};s.find=function(e){let n=s.position;const t=s.data.length,i=s.data;for(;n<t;){if(i[n]===e)return n;n++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(e)+'" [0x'+e.toString(16)+"]")};s.dictionary=function(){s.position++;const e={};for(;s.data[s.position]!==R;){const n=s.buffer();let t=g(n);t.includes("�")&&(t=x(n)),e[t]=s.next()}return s.position++,e};s.list=function(){s.position++;const e=[];for(;s.data[s.position]!==R;)e.push(s.next());return s.position++,e};s.integer=function(){const e=s.find(R),n=ee(s.data,s.position+1,e);return s.position+=e+1-s.position,n};s.buffer=function(){let e=s.find(Re);const n=ee(s.data,s.position,e),t=++e+n;return s.position=t,s.encoding?g(s.data.slice(e,t)):s.data.slice(e,t)};function Ve(e){let n=2;for(const t of e)n+=L(t);return n}function De(e){let n=2;for(const[t,i]of e){const r=h(t).byteLength;n+=A(r)+1+r,n+=L(i)}return n}function Me(e){let n=2;const t=Object.keys(e);for(let i=0;i<t.length;i++){const r=h(t[i]).byteLength;n+=A(r)+1+r,n+=L(e[t[i]])}return n}function Ne(e){const n=h(e).byteLength;return A(n)+1+n}function Oe(e){const n=e.byteLength-e.byteOffset;return A(n)+1+n}function L(e){if(e==null)return 0;const t=Z(e);switch(t){case"arraybufferview":return Oe(e);case"string":return Ne(e);case"array":case"set":return Ve(e);case"number":return 1+A(Math.floor(e))+1;case"bigint":return 1+e.toString().length+1;case"object":return Me(e);case"map":return De(e);default:throw new TypeError(`Unsupported value of type "${t}"`)}}const Ie=L,W={encode:l,decode:s,byteLength:L,encodingLength:Ie},Y=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255],Fe=function(e){if(!ArrayBuffer.isView(e)&&typeof e!="string")throw new TypeError("base32.decode only takes Buffer or string as parameter");let n=0,t=0,i,r=0;ArrayBuffer.isView(e)||(e=h(e));const o=new Uint8Array(Math.ceil(e.length*5/8));for(let a=0;a<e.length&&e[a]!==61;a++){const f=e[a]-48;if(f<Y.length)t=Y[f],n<=3?(n=(n+5)%8,n===0?(i|=t,o[r]=i,r++,i=0):i|=255&t<<8-n):(n=(n+5)%8,i|=255&t>>>n,o[r]=i,r++,i=255&t<<8-n);else throw new Error("Invalid input - it is not base32 encoded string")}return o.subarray(0,r)};function Ke(e){return e.reduce((n,t,i,r)=>((i===0||t!==r[i-1]+1)&&n.push([]),n[n.length-1].push(t),n),[]).map(n=>n.length>1?`${n[0]}-${n[n.length-1]}`:`${n[0]}`)}function Pe(e){const n=(t,i=t)=>Array.from({length:i-t+1},(r,o)=>o+t);return e.reduce((t,i,r,o)=>{const a=i.split("-").map(f=>parseInt(f));return t.concat(n(...a))},[])}/*! magnet-uri. MIT License. WebTorrent LLC <https://webtorrent.io/opensource> */function $(e){const n={},t=e.split("magnet:?")[1];(t&&t.length>=0?t.split("&"):[]).forEach(o=>{const a=o.split("=");if(a.length!==2)return;const f=a[0];let c=a[1];f==="dn"&&(c=decodeURIComponent(c).replace(/\+/g," ")),(f==="tr"||f==="xs"||f==="as"||f==="ws")&&(c=decodeURIComponent(c)),f==="kt"&&(c=decodeURIComponent(c).split("+")),f==="ix"&&(c=Number(c)),f==="so"&&(c=Pe(decodeURIComponent(c).split(","))),n[f]?(Array.isArray(n[f])||(n[f]=[n[f]]),n[f].push(c)):n[f]=c});let r;return n.xt&&(Array.isArray(n.xt)?n.xt:[n.xt]).forEach(a=>{(r=a.match(/^urn:btih:(.{40})/))?n.infoHash=r[1].toLowerCase():(r=a.match(/^urn:btih:(.{32})/))?n.infoHash=x(Fe(r[1])):(r=a.match(/^urn:btmh:1220(.{64})/))&&(n.infoHashV2=r[1].toLowerCase())}),n.xs&&(Array.isArray(n.xs)?n.xs:[n.xs]).forEach(a=>{(r=a.match(/^urn:btpk:(.{64})/))&&(n.publicKey=r[1].toLowerCase())}),n.infoHash&&(n.infoHashBuffer=S(n.infoHash)),n.infoHashV2&&(n.infoHashV2Buffer=S(n.infoHashV2)),n.publicKey&&(n.publicKeyBuffer=S(n.publicKey)),n.dn&&(n.name=n.dn),n.kt&&(n.keywords=n.kt),n.announce=[],(typeof n.tr=="string"||Array.isArray(n.tr))&&(n.announce=n.announce.concat(n.tr)),n.urlList=[],(typeof n.as=="string"||Array.isArray(n.as))&&(n.urlList=n.urlList.concat(n.as)),(typeof n.ws=="string"||Array.isArray(n.ws))&&(n.urlList=n.urlList.concat(n.ws)),n.peerAddresses=[],(typeof n["x.pe"]=="string"||Array.isArray(n["x.pe"]))&&(n.peerAddresses=n.peerAddresses.concat(n["x.pe"])),n.announce=Array.from(new Set(n.announce)),n.urlList=Array.from(new Set(n.urlList)),n.peerAddresses=Array.from(new Set(n.peerAddresses)),n}function Ge(e){e=Object.assign({},e);let n=new Set;e.xt&&typeof e.xt=="string"&&n.add(e.xt),e.xt&&Array.isArray(e.xt)&&(n=new Set(e.xt)),e.infoHashBuffer&&n.add(`urn:btih:${x(e.infoHashBuffer)}`),e.infoHash&&n.add(`urn:btih:${e.infoHash}`),e.infoHashV2Buffer&&n.add(e.xt=`urn:btmh:1220${x(e.infoHashV2Buffer)}`),e.infoHashV2&&n.add(`urn:btmh:1220${e.infoHashV2}`);const t=Array.from(n);t.length===1&&(e.xt=t[0]),t.length>1&&(e.xt=t),e.publicKeyBuffer&&(e.xs=`urn:btpk:${x(e.publicKeyBuffer)}`),e.publicKey&&(e.xs=`urn:btpk:${e.publicKey}`),e.name&&(e.dn=e.name),e.keywords&&(e.kt=e.keywords),e.announce&&(e.tr=e.announce),e.urlList&&(e.ws=e.urlList,delete e.as),e.peerAddresses&&(e["x.pe"]=e.peerAddresses);let i="magnet:?";return Object.keys(e).filter(r=>r.length===2||r==="x.pe").forEach((r,o)=>{const a=Array.isArray(e[r])?e[r]:[e[r]];a.forEach((f,c)=>{(o>0||c>0)&&(r!=="kt"&&r!=="so"||c===0)&&(i+="&"),r==="dn"&&(f=encodeURIComponent(f).replace(/%20/g,"+")),(r==="tr"||r==="as"||r==="ws")&&(f=encodeURIComponent(f)),r==="xs"&&!f.startsWith("urn:btpk:")&&(f=encodeURIComponent(f)),r==="kt"&&(f=encodeURIComponent(f)),r!=="so"&&(r==="kt"&&c>0?i+=`+${f}`:i+=`${r}=${f}`)}),r==="so"&&(i+=`${r}=${Ke(a)}`)}),i}/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let J;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:ae);/*! parse-torrent. MIT License. WebTorrent LLC <https://webtorrent.io/opensource> */async function Q(e){if(typeof e=="string"&&/^(stream-)?magnet:/.test(e)){const n=$(e);if(!n.infoHash)throw new Error("Invalid torrent identifier");return n}else{if(typeof e=="string"&&(/^[a-f0-9]{40}$/i.test(e)||/^[a-z2-7]{32}$/i.test(e)))return $(`magnet:?xt=urn:btih:${e}`);if(ArrayBuffer.isView(e)&&e.length===20)return $(`magnet:?xt=urn:btih:${x(e)}`);if(ArrayBuffer.isView(e))return await qe(e);if(e&&e.infoHash)return e.infoHash=e.infoHash.toLowerCase(),e.announce||(e.announce=[]),typeof e.announce=="string"&&(e.announce=[e.announce]),e.urlList||(e.urlList=[]),e;throw new Error("Invalid torrent identifier")}}async function qe(e){ArrayBuffer.isView(e)&&(e=W.decode(e)),d(e.info,"info"),d(e.info["name.utf-8"]||e.info.name,"info.name"),d(e.info["piece length"],"info['piece length']"),d(e.info.pieces,"info.pieces"),e.info.files?e.info.files.forEach(o=>{d(typeof o.length=="number","info.files[0].length"),d(o["path.utf-8"]||o.path,"info.files[0].path")}):d(typeof e.info.length=="number","info.length");const n={info:e.info,infoBuffer:W.encode(e.info),name:g(e.info["name.utf-8"]||e.info.name),announce:[]};n.infoHashBuffer=await Se(n.infoBuffer),n.infoHash=x(n.infoHashBuffer),e.info.private!==void 0&&(n.private=!!e.info.private),e["creation date"]&&(n.created=new Date(e["creation date"]*1e3)),e["created by"]&&(n.createdBy=g(e["created by"])),ArrayBuffer.isView(e.comment)&&(n.comment=g(e.comment)),Array.isArray(e["announce-list"])&&e["announce-list"].length>0?e["announce-list"].forEach(o=>{o.forEach(a=>{n.announce.push(g(a))})}):e.announce&&n.announce.push(g(e.announce)),ArrayBuffer.isView(e["url-list"])&&(e["url-list"]=e["url-list"].length>0?[e["url-list"]]:[]),n.urlList=(e["url-list"]||[]).map(o=>g(o)),n.announce=Array.from(new Set(n.announce)),n.urlList=Array.from(new Set(n.urlList));let t=0;const i=e.info.files||[e.info];n.files=i.map((o,a)=>{const f=[].concat(n.name,o["path.utf-8"]||o.path||[]).map(c=>ArrayBuffer.isView(c)?g(c):c);return t+=o.length,{path:I.join.apply(null,[I.sep].concat(f)).slice(1),name:f[f.length-1],length:o.length,offset:t-o.length}}),n.length=t;const r=n.files[n.files.length-1];return n.pieceLength=e.info["piece length"],n.lastPieceLength=(r.offset+r.length)%n.pieceLength||n.pieceLength,n.pieces=We(e.info.pieces),n}function We(e){const n=[];for(let t=0;t<e.length;t+=20)n.push(x(e.slice(t,t+20)));return n}function d(e,n){if(!e)throw new Error(`Torrent is missing required field: ${n}`)}const Ye=Ge,Je=le({__name:"torrent-to-magnet",setup(e){const{t:n}=ce(),t=C("file"),i=C(""),r=C(),o=ue(async()=>{const p=r.value,m=i.value;try{return t.value==="file"&&p?await Q(new Uint8Array(await p.arrayBuffer())):await Q(m)}catch(B){return{error:B.toString()}}}),a=V(()=>F(()=>Object.entries(o.value).map(([p,m])=>({label:p?.toString()||"",value:JSON.stringify(m)})),[])),f=V(()=>F(()=>Ye(o.value),[]));async function c(p){p&&(r.value=p)}pe(i,p=>{p!==""&&(r.value=null)});const{attrs:T}=he({source:a,rules:[{message:n("tools.torrent-to-magnet.texts.message-invalid-torrent-content"),validator:p=>p?.length>0}]});return(p,m)=>{const B=we,ne=_e,te=be,ie=me,re=de,oe=Ae,H=fe;return b(),D("div",null,[w(te,{value:u(t),"onUpdate:value":m[0]||(m[0]=y=>N(t)?t.value=y:null),name:"radiogroup","mb-2":"",flex:"","justify-center":""},{default:M(()=>[w(ne,null,{default:M(()=>[w(B,{value:"file",label:u(n)("tools.torrent-to-magnet.texts.label-file")},null,8,["label"]),w(B,{value:"content",label:u(n)("tools.torrent-to-magnet.texts.label-content")},null,8,["label"])]),_:1})]),_:1},8,["value"]),u(t)==="file"?(b(),E(ie,{key:0,title:u(n)("tools.torrent-to-magnet.texts.title-drag-and-drop-torrent-file-here-or-click-to-select-a-file"),onFileUpload:c},null,8,["title"])):O("",!0),u(t)==="content"?(b(),E(re,{key:1,value:u(i),"onUpdate:value":m[1]||(m[1]=y=>N(i)?i.value=y:null),label:u(n)("tools.torrent-to-magnet.texts.label-torrent-magnet-content"),placeholder:u(n)("tools.torrent-to-magnet.texts.placeholder-paste-your-torrent-magnet-content-here"),multiline:"","mb-2":""},null,8,["value","label","placeholder"])):O("",!0),w(oe),w(H,{label:u(n)("tools.torrent-to-magnet.texts.label-magnet-uri"),"label-position":"left","label-width":"100px","label-align":"right","mb-2":"",value:u(T).validationStatus==="error"?"":u(f),placeholder:u(n)("tools.torrent-to-magnet.texts.placeholder-please-use-a-correct-torrent")},null,8,["label","value","placeholder"]),(b(!0),D(ge,null,xe(u(a),({label:y,value:se})=>(b(),E(H,{key:y,label:y,"label-position":"left","label-width":"100px","label-align":"right","mb-2":"",value:u(T).validationStatus==="error"?"":se,placeholder:u(n)("tools.torrent-to-magnet.texts.placeholder-please-use-a-correct-torrent")},null,8,["label","value","placeholder"]))),128))])}}});const on=ye(Je,[["__scopeId","data-v-8329eb8d"]]);export{on as default};
