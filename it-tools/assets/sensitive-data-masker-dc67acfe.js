import{_ as E}from"./FormatTransformer-bc7b3ed5.js";import{Q as y,d as N,a0 as z,al as S,o as D,c as K,k,l as d,m as C,x as W}from"./index-0c1fde36.js";import{i as Z}from"./index-e6f9cbd8.js";import{w as U}from"./defaults-4d6daddf.js";import{_ as F}from"./Select-9917c364.js";import"./TextareaCopyable-59231e95.js";import"./base64-ae7cf34b.js";import"./index-a6f01dde.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./Tag-e75b8dae.js";import"./FocusDetector-089b8822.js";import"./VirtualList-8140ffff.js";import"./Empty-ca426d71.js";import"./index-cbfaa337.js";var P={},p={},l={};Object.defineProperty(l,"__esModule",{value:!0});l.isNullish=l.isString=l.isObject=l.deepClone=l.hasCircularReference=void 0;function J(e){const t=new WeakSet;function r(n){if(typeof n!="object"||n===null)return!1;if(t.has(n))return!0;t.add(n);for(const s in n)if(Object.prototype.hasOwnProperty.call(n,s)&&r(n[s]))return!0;return!1}return r(e)}l.hasCircularReference=J;function x(e,t=new WeakMap){if(e===null||typeof e!="object")return e;if(t.has(e))return t.get(e);if(e instanceof Date)return new Date(e.getTime());if(Array.isArray(e)){const r=[];return t.set(e,r),r.push(...e.map(n=>x(n,t))),r}if(e instanceof Object){const r=Object.getPrototypeOf(e),n=Object.create(r);return t.set(e,n),[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)].forEach(a=>{const i=Object.getOwnPropertyDescriptor(e,a);i&&typeof i.value=="object"&&i.value!==null&&(i.value=x(i.value,t)),Object.defineProperty(n,a,i)}),n}}l.deepClone=x;function B(e){return e&&typeof e=="object"&&!Array.isArray(e)}l.isObject=B;function T(e){return typeof e=="string"}l.isString=T;function G(e){return e==null}l.isNullish=G;Object.defineProperty(p,"__esModule",{value:!0});p.maskArguments=p.maskData=p.maskString=void 0;const m=l,L=new Set(["password","pwd","pass","token","secret","key","passphrase","privateKey","mail","shared","credential","auth","signature","certificate","crypt","apikey","security","phone","mobile"]),w={uuid:/\b[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[89ab][0-9a-f]{3}-[0-9a-f]{12}\b/gi,creditCard:/\b(?:\d[ -]*?){13,16}\b/g,ssn:/\b[0-9]{3}-[0-9]{2}-[0-9]{4}\b/g,url:/\b(?:https?|ftp):\/\/[a-z0-9-+&@#/%?=~_|!:,.;]*[a-z0-9-+&@#/%=~_|]\b/gi,ipv4:/\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b/g,email:/(?<=^|[\s'"-#+.><])[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,passwordSubstring:/\b(?!password\b)\w*password\w*\b/gi,password:/\b(?!\w*\/)(?=\S*\d)(?=\S*[A-Za-z])[\w!@#$%^&*()_+=\-,.]{6,32}\b/gm,passwordInUri:/(?<=:\/\/[^:]+:)[^@]+?(?=@)/,passwordMention:/(?<=.*(password|passwd|pwd)(?:\s*:\s*|\s+))\S+/gi},v=/##([^#]*)##/g;function O(e,t){const r=v,n=t?.maskLength||e.length-4,s=t?.maskingChar||"*";if(r.test(e))return e;if(t?.fixedMaskLength)return s.repeat(16);if(e.length<=4||n>=e.length)return s.repeat(e.length);const a=(e.length-n)/2;return e.substring(0,a)+s.repeat(n)+e.substring(e.length-a)}function Q(e){const t=e.toLowerCase();for(const r of L)if(t.includes(r))return!0;return!1}function V(e,t,r={},n){const s=Object.assign(Object.assign({},t),r),a=v,i=(c,u)=>{let o="",b=0;c.replace(a,(h,ce,A)=>{const I=c.substring(b,A);return o+=I.replace(u,R=>O(R,n)),o+=h,b=A+h.length,h});const f=c.substring(b);return o+=f.replace(u,h=>O(h,n)),u.lastIndex=0,o};return Object.values(s).reduce((c,u)=>i(c,u),e)}function M(e){const t=/##(.*?)##/g;let r=!1;const n=e.replace(t,(s,a)=>(r=!0,a));return{isUnmasked:r,content:n}}function _(e,t,r={},n){if(!e||e.length===0)return e;let s;if(t&&!Array.isArray(t)?n=t:s=t,!e||e.length===0)return e;if(e.startsWith("{")&&e.endsWith("}")){let u;try{u=JSON.parse(e);const o=g(u);return JSON.stringify(o)}catch{}}const{isUnmasked:a,content:i}=M(e);if(a)return i;if(s||(s=Object.keys(w)),r||(r={}),n?.excludeMatchers){const u=new Set(n.excludeMatchers);s=s.filter(o=>!u.has(o))}const c=s.reduce((u,o)=>(o in w&&(u[o]=w[o]),u),{});return V(e,c,r,n)}p.maskString=_;function Y(e,t){const r=t.immutable?new Map:e;return e.forEach((n,s)=>{typeof s=="string"?r.set(s,j(s,n,t)):r.set(s,g(n,t))}),r}function H(e,t){const r=t.immutable?new Set:e,n=[],s=[];return e.forEach(a=>{let i;typeof a=="string"?i=_(a,void 0,t.customPatterns,t):(0,m.isObject)(a)||Array.isArray(a)||a instanceof Map?i=g(a,t):i=a,t.immutable?r.add(i):(n.push(i),s.push(a))}),t.immutable||(s.forEach(a=>e.delete(a)),n.forEach(a=>e.add(a))),r}function X(e,t){const r=new Error(_(e.message,void 0,t.customPatterns,t));return r.stack=_(e.stack,void 0,t.customPatterns,t),r}function $(e,t){if((0,m.hasCircularReference)(e))return e;const r=t.immutable?(0,m.deepClone)(e):e,n=(s,a,i)=>{s[a]=j(a,i,t)};return Object.entries(r).reduce((s,[a,i])=>(n(s,a,i),s),t.immutable?{}:r)}function q(e,t){return e.map(r=>g(r,t))}function j(e,t,r){if((0,m.isString)(t)){const{isUnmasked:n,content:s}=M(t);if(n)return s}return r.keyCheck(e)&&(0,m.isString)(t)?O(t,r):g(t,r)}function g(e,t={}){const{keyCheck:r=Q,immutable:n=!0}=t;return(0,m.isString)(e)?_(e,void 0,t.customPatterns,t):(t.keyCheck=r,t.immutable=n,e instanceof Map?Y(e,t):e instanceof Set?H(e,t):e instanceof Error?X(e,t):(0,m.isObject)(e)?$(e,t):Array.isArray(e)?q(e,t):e)}p.maskData=g;function ee(e,t){return(0,m.isNullish)(e)||e.length===0?e:e.map(r=>typeof r!="object"&&typeof r!="string"?r:g(r,t))}p.maskArguments=ee;(function(e){var t=y&&y.__createBinding||(Object.create?function(n,s,a,i){i===void 0&&(i=a);var c=Object.getOwnPropertyDescriptor(s,a);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,i,c)}:function(n,s,a,i){i===void 0&&(i=a),n[i]=s[a]}),r=y&&y.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(e,"__esModule",{value:!0}),r(p,e)})(P);const te=/\b([a-zA-Z0-9_=]{5,})\.([a-zA-Z0-9_=]{5,})\.([a-zA-Z0-9_\-\+\/=]{5,})\b/g,re=/(?:(\+\d{1,4})[-.\s]?)(?:[(](\d{1,3})[)][-.\s]?)?(\d{1,4})[-.\s]?(\d{1,4})[-.\s]?(\d{1,9})\b/g,ne=/\b([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})\b/g,se=/\b(https?:\/\/)?(www\.)?[a-zA-Z0-9@:%._+~#=-]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&\/=]*)\b/g;function ae({value:e,customRegex:t="",excludedMatchers:r=[]}){r=r||[];const n=/(?:)/g;return P.maskString(e,null,{customRegex:new RegExp((t||"").split(`
`).map(s=>`(${s})`).join("|"),"gi"),macRegex:r.includes("mac")?n:ne,ipv6Regex:r.includes("ipv6")?n:Z.v6({includeBoundaries:!1}),urlWithOrWithoutPrefixRegex:r.includes("urlWithOrWithoutPrefix")?n:se,jwtRegex:r.includes("jwt")?n:te,phoneRegex:r.includes("phone")?n:re},{excludeMatchers:[...r,"passwordMention","password","passwordSubstring"]})}const ie=`{
  email: 'john.doe@example.com',
  creditCard: '1234 5678 9000 9876',
  id: '3f8a43fd-6489-4ec7-bd55-7a1ba172d77b',
  name: 'John',
  surname: 'Doe',
  phone: '+358 40 1234567',
  url: 'truc.google.com',
  ip4: '83.24.45.56',
  ip6: '2001:db8:0:85a3:0:0:ac1f:8001',
  mac: '3D:F2:C9:A6:B3:4F',
  token: 'eyJhbGciOiJIUzI1NiJ9.ew0KICAic3ViIjogIjEyMzQ1Njc4OTAiLA0KICAibmFtZSI6ICJBbGV4IEtvemxvdiIsDQogICJpYXQiOiAxNTE2MjM5MDIyDQp9.PNKysYFTCenU5bekHCmwIxCUXoYG41H_xc3uN3ZF_b8',
}`,Ce=N({__name:"sensitive-data-masker",setup(e){const{t}=z(),r=S("sensitive-data:regex",""),n=S("sensitive-data:exclude",[]),s=["uuid","creditCard","ssn","url","ipv4","email","passwordInUri","mac","ipv6","urlWithOrWithoutPrefix","jwt","phone"];function a(i){return U(()=>ae({value:i,customRegex:r.value,excludedMatchers:n.value}),"")}return(i,c)=>{const u=W,o=F,b=E;return D(),K("div",null,[k(u,{value:d(r),"onUpdate:value":c[0]||(c[0]=f=>C(r)?r.value=f:null),label:d(t)("tools.sensitive-data-masker.texts.label-your-custom-cleaning-regex-es-case-insensitive"),placeholder:d(t)("tools.sensitive-data-masker.texts.placeholder-your-custom-cleaning-regex-es"),"raw-text":"",multiline:"",rows:"4","mb-2":""},null,8,["value","label","placeholder"]),k(o,{value:d(n),"onUpdate:value":c[1]||(c[1]=f=>C(n)?n.value=f:null),placeholder:d(t)("tools.sensitive-data-masker.texts.placeholder-no-fallback"),multiple:"","fallback-option":!1,options:s.map(f=>({label:f,value:f})),"mb-2":""},null,8,["value","placeholder","options"]),k(b,{"input-label":d(t)("tools.sensitive-data-masker.texts.input-label-your-log-textual-data"),"input-default":ie,"input-placeholder":d(t)("tools.sensitive-data-masker.texts.input-placeholder-paste-your-log-textual-data-here"),"output-label":d(t)("tools.sensitive-data-masker.texts.output-label-cleaned-version"),transformer:a},null,8,["input-label","input-placeholder","output-label"])])}}});export{Ce as default};
