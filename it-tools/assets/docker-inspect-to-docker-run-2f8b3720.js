import{d as b,a0 as F,r as L,i as A,o as h,c as y,k as _,w,a as C,l as f,m as T,a7 as D,a8 as V,ad as $,a_ as j,G as q}from"./index-0c1fde36.js";import{_ as G}from"./c-monaco-editor.vue_vue_type_script_setup_true_lang-735b1924.js";import{r as E}from"./empty-d0adf2b0.js";import{_ as J}from"./TextareaCopyable-59231e95.js";import{N as U}from"./Alert-a9fb131b.js";import{_ as W}from"./Divider-5fc425b0.js";import"./editor.main-9e6d3164.js";import"./index-a6f01dde.js";import"./empty-c5f13335.js";import"./base64-ae7cf34b.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";var x={exports:{}},M;x.exports=function(n,e){let r=!1;const s=[],u=[],i=E.spawn("docker",["inspect"].concat(n));i.stderr.on("data",a=>{u.push(a)}),i.stdout.on("data",a=>{s.push(a)}),i.on("error",a=>{r||(r=!0,e(a))}),i.on("close",(a,o)=>{if(!r){if(a!==0){const d=new Error("docker inspect failed with code "+a+" from signal "+o);return d.code=a,d.signal=o,u.length&&(d.stderr=u.join("")),s.length&&(d.stdout=s.join("")),r=!0,e(d)}try{e(null,O(s.join("")))}catch(d){e(d)}}})};x.exports.readFile=function(n,e){E.readFile(n,{encoding:"utf8"},(r,s)=>{if(r)return e(r);try{e(null,O(s))}catch(u){e(u)}})};const O=M=x.exports.parse=function(n){return[].concat(K(JSON.parse(n)))},K=x.exports.translate=function(n){return Array.isArray(n)?n.map(e=>I(e)):I(n)};function I(t){const n={};return n.image=N(t.Image),n.id=N(t.Id),n.name=t.Name,n.name&&n.name.indexOf("/")===0&&(n.name=n.name.substring(1)),n.command=z(t,n.name),n}function N(t){return t&&t.length&&t.length>12?t.substring(0,12):t}function z(t,n){let e=c("docker run","--name",n);const r=t.HostConfig||{},s=r.NetworkMode,u=r.UTSMode,i={networkMode:s,utsMode:u};e=p(e,r.Privileged,"--privileged"),r.Runtime&&(e=c(e,"--runtime",r.Runtime)),e=l(e,"-v",r.Binds),e=l(e,"--volumes-from",r.VolumesFrom),r.PortBindings&&m("-p",i)&&(e=P(e,"-p",r.PortBindings,o=>o.HostIp?o.HostIp+":"+o.HostPort:o.HostPort)),e=l(e,"--link",r.Links,o=>(o=o.split(":"),o[0]&&~o[0].lastIndexOf("/")&&(o[0]=o[0].substring(o[0].lastIndexOf("/")+1)),o[1]&&~o[1].lastIndexOf("/")&&(o[1]=o[1].substring(o[1].lastIndexOf("/")+1)),o[0]+":"+o[1])),r.PublishAllPorts&&m("-P",i)&&(e=e+" -P"),s&&s!=="default"&&(e=c(e,"--net",s)),u&&m("--uts",i)&&(e=c(e,"--uts",u)),r.RestartPolicy&&r.RestartPolicy.Name&&(e=c(e,"--restart",r.RestartPolicy,o=>o.Name==="on-failure"?o.Name+":"+o.MaximumRetryCount:o.Name)),m("--add-host",i)&&(e=l(e,"--add-host",r.ExtraHosts)),e=l(e,"--group-add",r.GroupAdd),r.PidMode&&(e=c(e,"--pid",r.PidMode)),e=l(e,"--security-opt",r.SecurityOpt,v);const a=t.Config||{};return a.Hostname&&m("-h",i)&&(e=c(e,"-h",a.Hostname)),a.Domainname&&m("--domainname",i)&&(e=c(e,"--domainname",a.Domainname)),a.ExposedPorts&&m("--expose",i)&&(e=P(e,"--expose",a.ExposedPorts)),a.Labels&&(e=P(e,"-l",a.Labels)),e=l(e,"-e",a.Env,v),e=Q(e,a),a.Entrypoint&&(e=k(e,"--entrypoint",a.Entrypoint," ")),e=e+" "+(a.Image||t.Image),a.Cmd&&(e=k(e,null,a.Cmd," ")),e}function m(t,n){switch(t){case"-h":return!(n.networkMode||"").startsWith("container:")&&n.utsMode!=="host";case"--add-host":case"--dns":case"--dns-search":case"--dns-option":case"--mac-address":case"-p":case"-P":case"--expose":return!(n.networkMode||"").startsWith("container:");case"--domainname":return n.utsMode!=="host";default:return!0}}function v(t){return"'"+t.replace(/'/g,"'\\''")+"'"}function Q(t,n){const e=n.AttachStdin===!0,r=n.AttachStdout===!0,s=n.AttachStderr===!0;return t=p(t,!e&&!r&&!s,"-d"),t=p(t,e,"-a","stdin"),t=p(t,r,"-a","stdout"),t=p(t,s,"-a","stderr"),t=p(t,n.Tty===!0,"-t"),t=p(t,n.OpenStdin===!0,"-i"),t}function p(t,n,e,r){return n?r?c(t,e,r):t+" "+e:t}function k(t,n,e,r){return Array.isArray(e)?n?c(t,n,e.join(r),s=>'"'+s+'"'):c(t,n,e.map(v).join(r)):t}function P(t,n,e,r){let s=t;return Object.keys(e).forEach(u=>{s=c(s,n,{key:u,val:e[u]},i=>{if(!i.val)return i.key;let a="";if(Array.isArray(i.val))i.val.forEach(o=>{a=typeof r=="function"?r(o):o});else if(typeof i.val=="string")return i.key+"="+v(i.val);return(a?a+":":"")+i.key})}),s}function l(t,n,e,r){if(!Array.isArray(e))return t;let s=t;return e.forEach(u=>{s=c(s,n,u,r)}),s}function c(t,n,e,r){return e?t+" "+(n?n+" ":"")+(typeof r=="function"?r(e):e):t}const X={relative:"","w-full":""},Y={key:0},fe=b({__name:"docker-inspect-to-docker-run",setup(t){const{t:n}=F(),e=L(""),r=A(()=>{const a=e.value.trim();if(!a)return{commands:"",errors:[]};try{return{commands:M(a).map(o=>o.command).join(`
`),errors:[]}}catch(o){return{commands:"#see error messages",errors:o.toString().split(`
`)}}}),s=A(()=>r.value.errors),u=A(()=>r.value.commands),i={automaticLayout:!0,formatOnType:!0,formatOnPaste:!0};return(a,o)=>{const d=G,R=j,S=U,H=W;return h(),y("div",null,[_(R,{label:f(n)("tools.docker-inspect-to-docker-run.texts.label-paste-your-docker-inspect-json-output")},{default:w(()=>[C("div",X,[_(d,{value:f(e),"onUpdate:value":o[0]||(o[0]=g=>T(e)?e.value=g:null),theme:"vs-dark",language:"json",height:"250px",options:i},null,8,["value"])])]),_:1},8,["label"]),f(s).length>0?(h(),y("div",Y,[_(S,{title:f(n)("tools.docker-inspect-to-docker-run.texts.title-the-following-errors-occured"),type:"error","mt-5":""},{default:w(()=>[C("ul",null,[(h(!0),y(D,null,V(f(s),(g,B)=>(h(),y("li",{key:B},q(g),1))),128))])]),_:1},8,["title"])])):$("",!0),_(H),_(J,{value:f(u),language:"bash","copy-placement":"outside"},null,8,["value"])])}}});export{fe as default};
