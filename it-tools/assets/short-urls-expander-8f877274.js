import{d as H,a0 as O,r as b,al as q,o as x,c as k,k as l,w as a,a as o,G as n,l as t,m as $,a6 as m,j as U,a7 as F,a8 as I,ad as N,x as P,aj as T,af as X,bc as z}from"./index-0c1fde36.js";import{_ as G}from"./InputCopyable.vue_vue_type_script_setup_true_lang-294ac243.js";import{_ as M}from"./p-77eb774b.js";import{_ as J}from"./Card-7ba5ce79.js";import{_ as j}from"./Space-7fc52151.js";import{_ as K}from"./Table-4b7ecda9.js";import{N as Q}from"./Alert-a9fb131b.js";import{_ as W}from"./a-07fc27a5.js";import"./get-slot-1efb97e5.js";const Y={href:"https://github.com/sharevb/cors-anywhere?tab=readme-ov-file#run-with-docker",target:"_blank"},Z={width:"30%"},ee={width:"45%"},de=H({__name:"short-urls-expander",setup(te){const{t:e}=O(),f=b(""),_=b([]),g=b(""),v=b(!1),y=q("short-urls-expander:cors-anywhere-url","//cors.outils-libre.org");function R(u){return new Promise(s=>{try{const c=`${y.value.replace(/\/+$/g,"")}/${u}`,r=new XMLHttpRequest;r.open("HEAD",c,!0),r.onreadystatechange=function(){if(r.readyState===r.DONE){const d=r.getResponseHeader("X-Final-Url")||r.responseURL;s(d&&d!==c?{short:u,expanded:d,status:e("tools.short-urls-expander.texts.expanded"),ok:!0}:{short:u,expanded:null,status:e("tools.short-urls-expander.texts.no-redirect"),ok:!0})}},r.onerror=function(){s({short:u,expanded:null,status:e("tools.short-urls-expander.texts.failed"),ok:!1})},r.send()}catch{s({short:u,expanded:null,status:e("tools.short-urls-expander.texts.failed"),ok:!1})}})}async function C(){_.value=[],g.value="",v.value=!0;const u=f.value.split(`
`).map(s=>s.trim()).filter(s=>s.length>0);try{const s=u.map(async c=>await R(c));_.value=await Promise.all(s)}catch{g.value=e("tools.short-urls-expander.texts.failed-to-expand-some-urls")}finally{v.value=!1}}function L(){if(!_.value.length)return;const u=[e("tools.short-urls-expander.texts.short-url"),e("tools.short-urls-expander.texts.expanded-url"),e("tools.short-urls-expander.texts.tag-status")],s=_.value.map(i=>[i.short,i.expanded??"",i.status]),c=[u,...s].map(i=>i.map(w=>`"${String(w).replace(/"/g,'""')}"`).join(",")).join(`
`),r=new Blob([c],{type:"text/csv;charset=utf-8;"}),d=URL.createObjectURL(r),h=document.createElement("a");h.href=d,h.download="expanded_urls.csv",h.click(),URL.revokeObjectURL(d)}return(u,s)=>{const c=P,r=M,d=J,h=T,i=j,w=G,S=W,B=K,A=X,E=Q,V=j;return x(),k("div",null,[l(V,{vertical:""},{default:a(()=>[o("details",null,[o("summary",null,n(t(e)("tools.short-urls-expander.texts.cors-anywhere-configuration")),1),l(d,null,{default:a(()=>[l(c,{value:t(y),"onUpdate:value":s[0]||(s[0]=p=>$(y)?y.value=p:null),label:t(e)("tools.short-urls-expander.texts.cors-anywhere-instance-url"),"label-position":"left",placeholder:t(e)("tools.short-urls-expander.texts.put-your-cors-anywhere-instance-url"),"mb-1":""},null,8,["value","label","placeholder"]),l(r,null,{default:a(()=>[m(n(t(e)("tools.short-urls-expander.texts.this-tools-requires-a-cors-anywhere-instance-to-bypass-cors-policy-you-can-use-a"))+" ",1),o("a",Y,n(t(e)("tools.short-urls-expander.texts.self-hosted-cors-anywhere")),1)]),_:1})]),_:1})]),l(c,{value:t(f),"onUpdate:value":s[1]||(s[1]=p=>$(f)?f.value=p:null),label:t(e)("tools.short-urls-expander.texts.label-short-urls-to-expand"),multiline:"",rows:"5",placeholder:t(e)("tools.short-urls-expander.texts.placeholder-enter-short-urls-one-per-line"),clearable:"","mb-1":""},null,8,["value","label","placeholder"]),l(i,{justify:"center","mb-2":""},{default:a(()=>[l(h,{type:"primary",loading:t(v),onClick:C},{default:a(()=>[m(n(t(e)("tools.short-urls-expander.texts.tag-expand-all")),1)]),_:1},8,["loading"])]),_:1}),t(_).length?(x(),U(A,{key:0,title:t(e)("tools.short-urls-expander.texts.title-result")},{default:a(()=>[l(i,{justify:"center","mb-2":""},{default:a(()=>[l(h,{type:"primary",onClick:L},{default:a(()=>[m(n(t(e)("tools.short-urls-expander.texts.tag-download-resuls-as-csv")),1)]),_:1})]),_:1}),l(B,null,{default:a(()=>[o("thead",null,[o("tr",null,[o("th",Z,n(t(e)("tools.short-urls-expander.texts.tag-short-url")),1),o("th",ee,n(t(e)("tools.short-urls-expander.texts.tag-expanded-url")),1),o("th",null,n(t(e)("tools.short-urls-expander.texts.tag-link")),1),o("th",null,n(t(e)("tools.short-urls-expander.texts.tag-status")),1)])]),o("tbody",null,[(x(!0),k(F,null,I(t(_),(p,D)=>(x(),k("tr",{key:D},[o("td",null,n(p.short),1),o("td",null,[l(w,{value:p.expanded},null,8,["value"])]),o("td",null,[p.expanded?(x(),U(S,{key:0,href:p.expanded,target:"_blank"},{default:a(()=>[m(n(t(e)("tools.short-urls-expander.texts.tag-open-url")),1)]),_:2},1032,["href"])):N("",!0)]),o("td",{style:z({color:p.ok?"green":"red"})},n(p.status),5)]))),128))])]),_:1})]),_:1},8,["title"])):N("",!0),t(g)?(x(),U(E,{key:1,type:"error"},{default:a(()=>[m(n(t(g)),1)]),_:1})):N("",!0)]),_:1})])}}});export{de as default};
