import{o as C,c as k,a as i,_ as q,d as j,a0 as E,f as $,F as z,G as m,l as e,k as o,w as d,cE as T,a6 as S,s as G,v as J,d4 as W,i as H,cf as X,cd as Y,ac as ee,r as te,m as P,a7 as R,a8 as oe,x as ae,j as ne,bq as re}from"./index-0c1fde36.js";import{u as le}from"./useQRCode-259fb663.js";import{c as w}from"./index-e845e9df.js";import{c as se}from"./token-generator.service-e17d3545.js";import{_ as y}from"./InputCopyable.vue_vue_type_script_setup_true_lang-294ac243.js";import{a as B}from"./computedRefreshable-6ca60894.js";import{_ as ie}from"./Image-22bdebd3.js";import{N as pe}from"./Progress-cb02197e.js";import"./browser-9d43139f.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./index-892bd980.js";import"./browser-703720a1.js";import"./index-649b5bab.js";import"./index-a6f01dde.js";import"./inherits_browser-6f38ab1b.js";import"./index-0397ab6f.js";import"./index-fdbe2ce9.js";import"./string_decoder-8ac4312e.js";import"./hash-f152040d.js";import"./_arrayReduce-865b0d3f.js";import"./download-953ccaa2.js";const de={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ce=i("path",{fill:"currentColor",d:"M17.65 6.35A7.96 7.96 0 0 0 12 4a8 8 0 0 0-8 8a8 8 0 0 0 8 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18a6 6 0 0 1-6-6a6 6 0 0 1 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"},null,-1),ue=[ce];function me(n,t){return C(),k("svg",de,ue)}const _e={name:"mdi-refresh",render:me};function fe(n){return(n.match(/.{1,2}/g)??[]).map(t=>Number.parseInt(t,16))}function he(n,t){return w.HmacSHA1(w.enc.Hex.parse(n),w.enc.Hex.parse(D(t))).toString(w.enc.Hex)}function D(n){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";return(n.toUpperCase().replace(/=+$/,"").split("").map(l=>t.indexOf(l).toString(2).padStart(5,"0")).join("").match(/.{1,8}/g)??[]).map(l=>Number.parseInt(l,2).toString(16).padStart(2,"0")).join("")}function F({key:n,counter:t=0}){const a=he(t.toString(16).padStart(16,"0"),n),r=fe(a),l=r[19]&15,f=(r[l]&127)<<24|(r[l+1]&255)<<16|(r[l+2]&255)<<8|r[l+3]&255;return String(f%1e6).padStart(6,"0")}function U({now:n,timeStep:t}){return Math.floor(n/1e3/t)}function N({key:n,now:t=Date.now(),timeStep:a=30}){const r=U({now:t,timeStep:a});return F({key:n,counter:r})}function ve({secret:n,app:t="IT-Tools",account:a="demo-user",algorithm:r="SHA1",digits:l=6,period:f=30}){const v=q({issuer:t,secret:n,algorithm:r,digits:l,period:f}).map((c,p)=>`${encodeURIComponent(p)}=${encodeURIComponent(c)}`).join("&");return`otpauth://totp/${encodeURIComponent(t)}:${encodeURIComponent(a)}?${v}`}function M(){return se({length:16,alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"})}const xe={"mb-5px":"","w-full":"",flex:"","items-center":""},ge={"flex-1":"","text-left":""},be={"flex-1":"","text-center":""},ye={"flex-1":"","text-right":""},Ce={flex:"","items-center":""},we=j({__name:"token-display",props:{tokens:{}},setup(n){const t=n,{t:a}=E(),{copy:r,isJustCopied:l}=$({createToast:!1}),{copy:f,isJustCopied:s}=$({createToast:!1}),{copy:v,isJustCopied:c}=$({createToast:!1}),{tokens:p}=z(t);return(V,u)=>{const x=G,g=J;return C(),k("div",null,[i("div",xe,[i("div",ge,m(e(a)("tools.otp-code-generator-and-validator.texts.tag-previous")),1),i("div",be,m(e(a)("tools.otp-code-generator-and-validator.texts.tag-current-otp")),1),i("div",ye,m(e(a)("tools.otp-code-generator-and-validator.texts.tag-next")),1)]),i("div",Ce,[o(g,{tooltip:e(l)?"Copied !":"Copy previous OTP",position:"bottom","flex-1":""},{default:d(()=>[o(x,{"data-test-id":"previous-otp","w-full":"","important:h-12":"","important:rounded-r-none":"","important:font-mono":"",onClick:u[0]||(u[0]=T(_=>e(r)(e(p).previous),["prevent"]))},{default:d(()=>[S(m(e(p).previous),1)]),_:1})]),_:1},8,["tooltip"]),o(g,{tooltip:e(s)?"Copied !":"Copy current OTP",position:"bottom","flex-1":"","flex-basis-5xl":""},{default:d(()=>[o(x,{"data-test-id":"current-otp","w-full":"","important:border-x":"1px solid gray op-40","important:h-12":"","important:rounded-0":"","important:text-22px":"",onClick:u[1]||(u[1]=T(_=>e(f)(e(p).current),["prevent"]))},{default:d(()=>[S(m(e(p).current),1)]),_:1})]),_:1},8,["tooltip"]),o(g,{tooltip:e(c)?"Copied !":"Copy next OTP",position:"bottom","flex-1":""},{default:d(()=>[o(x,{"data-test-id":"next-otp","w-full":"","important:h-12":"","important:rounded-l-none":"",onClick:u[2]||(u[2]=T(_=>e(v)(e(p).next),["prevent"]))},{default:d(()=>[S(m(e(p).next),1)]),_:1})]),_:1},8,["tooltip"])])])}}}),Se={style:{"max-width":"350px"}},ke={"mt-4":"",flex:"","flex-col":"","items-center":"","justify-center":"","gap-3":""},$e={style:{"max-width":"350px"}},Te={style:{"max-width":"350px"}},He={style:{"text-align":"center"}},Ne=j({__name:"otp-code-generator-and-validator",setup(n){const{t}=E(),a=W(),r=H(()=>a.value/1e3%30),l=X(),f=Y(),s=ee({name:"secret",storageName:"otp-gen:secret",defaultValue:M()});function v(){s.value=M()}const c=te(0),[p]=B(()=>Object.fromEntries(Array.from({length:10},(_,h)=>[+c.value+h,F({key:s.value,counter:+c.value+h})])),{throttle:500}),[V]=B(()=>({previous:N({key:s.value,now:a.value-3e4}),current:N({key:s.value,now:a.value}),next:N({key:s.value,now:a.value+3e4})}),{throttle:500}),u=H(()=>ve({secret:s.value})),{qrcode:x}=le({text:u,color:{background:H(()=>f.isDarkTheme?"#ffffff":"#00000000"),foreground:"#000000"},options:{width:210}}),g=[{message:t("tools.otp-code-generator-and-validator.texts.message-secret-should-be-a-base32-string"),validator:_=>_.toUpperCase().match(/^[A-Z234567]+$/)},{message:t("tools.otp-code-generator-and-validator.texts.message-please-set-a-secret"),validator:_=>_!==""}];return(_,h)=>{const L=_e,A=G,Q=J,I=ae,K=ie,Z=pe;return C(),k(R,null,[i("div",Se,[o(I,{value:e(s),"onUpdate:value":h[0]||(h[0]=b=>P(s)?s.value=b:null),label:e(t)("tools.otp-code-generator-and-validator.texts.label-secret"),placeholder:e(t)("tools.otp-code-generator-and-validator.texts.placeholder-paste-your-totp-secret"),"mb-5":"","validation-rules":g},{suffix:d(()=>[o(Q,{tooltip:"Generate a new random secret"},{default:d(()=>[o(A,{circle:"",variant:"text",size:"small",onClick:v},{default:d(()=>[o(L)]),_:1})]),_:1})]),_:1},8,["value","label","placeholder"]),o(y,{label:e(t)("tools.otp-code-generator-and-validator.texts.label-secret-in-hexadecimal"),value:e(D)(e(s)),readonly:"",placeholder:e(t)("tools.otp-code-generator-and-validator.texts.placeholder-secret-in-hex-will-be-displayed-here"),"mb-5":""},null,8,["label","value","placeholder"]),i("div",ke,[o(K,{src:e(x)},null,8,["src"]),o(A,{href:e(u),target:"_blank"},{default:d(()=>[S(m(e(t)("tools.otp-code-generator-and-validator.texts.tag-open-key-uri-in-new-tab")),1)]),_:1},8,["href"])])]),i("div",$e,[i("div",null,[o(I,{value:e(c),"onUpdate:value":h[1]||(h[1]=b=>P(c)?c.value=b:null),label:e(t)("tools.otp-code-generator-and-validator.texts.label-start-value-for-hotp-counter"),placeholder:e(t)("tools.otp-code-generator-and-validator.texts.placeholder-start-counter-for-hotp-at"),type:"number","mb-5":"","mt-5":""},null,8,["value","label","placeholder"]),(C(!0),k(R,null,oe(e(p),(b,O)=>(C(),ne(y,{key:O,value:b,readonly:"",label:`HOTP ${O}:`,"label-position":"left","label-width":"90px","label-align":"right",placeholder:e(t)("tools.otp-code-generator-and-validator.texts.placeholder-hotp-will-be-displayed-here"),"mb-1":""},null,8,["value","label","placeholder"]))),128))])]),i("div",Te,[o(y,{label:e(t)("tools.otp-code-generator-and-validator.texts.label-epoch"),value:Math.floor(e(a)/1e3).toString(),readonly:"",placeholder:e(t)("tools.otp-code-generator-and-validator.texts.placeholder-epoch-in-sec-will-be-displayed-here")},null,8,["label","value","placeholder"]),i("p",null,m(e(t)("tools.otp-code-generator-and-validator.texts.tag-iteration")),1),o(y,{value:String(e(U)({now:e(a),timeStep:30})),readonly:"",label:e(t)("tools.otp-code-generator-and-validator.texts.label-count"),"label-position":"left","label-width":"90px","label-align":"right",placeholder:e(t)("tools.otp-code-generator-and-validator.texts.placeholder-iteration-count-will-be-displayed-here")},null,8,["value","label","placeholder"]),o(y,{value:e(U)({now:e(a),timeStep:30}).toString(16).padStart(16,"0"),readonly:"",placeholder:e(t)("tools.otp-code-generator-and-validator.texts.placeholder-iteration-count-in-hex-will-be-displayed-here"),"label-position":"left","label-width":"90px","label-align":"right",label:e(t)("tools.otp-code-generator-and-validator.texts.label-padded-hex")},null,8,["value","placeholder","label"]),i("div",null,[o(we,{tokens:e(V),"mt-5":""},null,8,["tokens"]),o(Z,{percentage:100*e(r)/30,color:e(l).primaryColor,"show-indicator":!1},null,8,["percentage","color"]),i("div",He," Next in "+m(String(Math.floor(30-e(r))).padStart(2,"0"))+"s ",1)])])],64)}}});const We=re(Ne,[["__scopeId","data-v-3861a2e7"]]);export{We as default};
