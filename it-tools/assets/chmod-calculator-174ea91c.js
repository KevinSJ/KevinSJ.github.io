import{t as q,_ as h,d as J,bY as K,l as o,a0 as M,cf as Q,r as I,R as z,D as E,i as R,o as O,c as U,a,k as i,w as k,a6 as F,m as A,G as w,a7 as B,a8 as D,a$ as X,x as Z,af as ee,bo as te,bp as oe,bq as se}from"./index-0c1fde36.js";import{_ as G}from"./InputCopyable.vue_vue_type_script_setup_true_lang-294ac243.js";import{_ as le}from"./Space-7fc52151.js";import{_ as ce}from"./Divider-5fc425b0.js";import{_ as ae}from"./Checkbox-ba7202eb.js";import{_ as ne}from"./Table-4b7ecda9.js";import"./get-slot-1efb97e5.js";function L({permissions:e}){const s={read:4,write:2,execute:1},_={setuid:4,setgid:2,stickybit:1},r=t=>h.reduce(t,(n,u,l)=>n+(u?h.get(s,l,0):0),0);return[(t=>{const n=h.reduce(t,(u,l,b)=>u+(l?h.get(_,b,0):0),0);return n>0?n.toString():""})(e.flags||{setuid:!1,setgid:!1,stickybit:!1}),r(e.owner),r(e.group),r(e.public)].join("")}function re({permissions:e}){const s={read:"r",write:"w",execute:"x"},_="execute",r=(f,t)=>h.reduce(f,(n,u,l)=>n+((l===_?t:void 0)||(u?h.get(s,l,""):"-")),"");return[r(e.owner,e.flags?.setuid?"s":null),r(e.group,e.flags?.setgid?"s":null),r(e.public,e.flags?.stickybit?"t":null)].join("")}function j(e){const s={read:4,write:2,execute:1},_={setuid:4,setgid:2,stickybit:1};if(!e||!e.match(/^[0-7]{3,4}$/))throw new Error(q("tools.chmod-calculator.service.text.invalid-octal-permissions-must-be-3-or-4-octal-digits-octalpermissions",[e]));const r=e.length===3?`0${e}`:e,f=(x,g)=>(Number(r[x])&g)===g;function t(x,g){return h.reduce(x,(c,p,d)=>({...c,[d]:f(g,p)}),{})}const n=0,u=1,l=2,b=3;return{owner:t(s,u),group:t(s,l),public:t(s,b),flags:t(_,n)}}function T(e){const s=/^[-dlbcsp]?([r-])([w-])([xs-])([r-])([w-])([xs-])([r-])([w-])([xt-])$/;if(!e||!e.match(s))throw new Error(q("tools.chmod-calculator.service.text.invalid-string-permissions-must-be-in-form-rwxrwxrwx-symbolicpermissions",[e]));const[_,r,f,t,n,u,l,b,x,g]=s.exec(e)||[],c=(S,v,P)=>S===v?P:0,p=c(r,"r",4)+c(f,"w",2)+c(t,"x",1)+c(t,"s",1),d=c(n,"r",4)+c(u,"w",2)+c(l,"x",1)+c(l,"s",1),V=c(b,"r",4)+c(x,"w",2)+c(g,"x",1)+c(g,"t",1),y=c(t,"s",4)+c(l,"s",2)+c(g,"t",1),$=`${y>0?y:""}${p}${d}${V}`;return j($)}function ie({permissions:e}){const s={read:"r",write:"w",execute:"x"},_=t=>h.reduce(t,(n,u,l)=>n+(u?h.get(s,l,""):""),""),r=`umask u=${_(e.owner)},g=${_(e.group)},o=${_(e.public)}`,f=(511-Number.parseInt(L({permissions:{owner:e.owner,group:e.group,public:e.public,flags:{setuid:!1,setgid:!1,stickybit:!1}}}),8)).toString(8).padStart(3,"0");return{symbolic:r,octal:f}}const W=e=>(te("data-v-b62cfb45"),e=e(),oe(),e),ue={"mb-2":"",flex:"","justify-center":""},de=W(()=>a("code",null,"chmod",-1)),pe=W(()=>a("th",{class:"text-center",scope:"col"},null,-1)),me={class:"text-center",scope:"col"},_e={class:"text-center",scope:"col"},fe={class:"text-center",scope:"col"},ge={class:"line-header"},he={class:"line-header"},be={class:"text-center"},xe={class:"text-center"},we={class:"text-center"},ve={class:"octal-result","mb-1":""},ye={class:"octal-result","mb-1":""},ke=J({__name:"chmod-calculator",setup(e){K(p=>({"194def72":o(_).primaryColor}));const{t:s}=M(),_=Q(),r=[{scope:"read",title:"Read (4)"},{scope:"write",title:"Write (2)"},{scope:"execute",title:"Execute (1)"}],f=["owner","group","public"],t=I({owner:{read:!1,write:!1,execute:!1},group:{read:!1,write:!1,execute:!1},public:{read:!1,write:!1,execute:!1},flags:{setuid:!1,setgid:!1,stickybit:!1}}),n=I("000"),u=z({source:n,rules:[{message:s("tools.chmod-calculator.texts.message-invalid-octal-permission-string"),validator:p=>{try{return j(p.trim()),!0}catch{return!1}}}]});E(n,p=>{u.isValid&&(t.value=j(p.trim()))});const l=I("---------"),b=z({source:l,rules:[{message:s("tools.chmod-calculator.texts.message-invalid-symbolic-permission-string"),validator:p=>{try{return T(p.trim()),!0}catch{return!1}}}]});E(l,p=>{b.isValid&&(t.value=T(p.trim()))});const x=R(()=>L({permissions:t.value})),g=R(()=>re({permissions:t.value})),c=R(()=>ie({permissions:t.value}));return(p,d)=>{const V=X,y=Z,$=le,S=ce,v=ae,P=ne,N=ee;return O(),U("div",null,[a("div",ue,[i(V,{target:"_blank",to:"/chmod-memo"},{default:k(()=>[F(" See "),de,F(" command cheatsheet. ")]),_:1})]),i($,{justify:"center"},{default:k(()=>[i(y,{value:o(n),"onUpdate:value":d[0]||(d[0]=m=>A(n)?n.value=m:null),placeholder:o(s)("tools.chmod-calculator.texts.placeholder-put-your-octal-permissions-here"),label:o(s)("tools.chmod-calculator.texts.label-copy-your-octal-permissions"),validation:o(u),"mb-2":""},null,8,["value","placeholder","label","validation"]),i(y,{value:o(l),"onUpdate:value":d[1]||(d[1]=m=>A(l)?l.value=m:null),placeholder:o(s)("tools.chmod-calculator.texts.placeholder-put-your-symbolic-permissions-here"),label:o(s)("tools.chmod-calculator.texts.label-copy-your-symbolic-permissions"),validation:o(b),"mb-2":""},null,8,["value","placeholder","label","validation"])]),_:1}),i(S),i(P,{bordered:!1,"bottom-bordered":!1,"single-column":"",class:"permission-table"},{default:k(()=>[a("thead",null,[a("tr",null,[pe,a("th",me,w(o(s)("tools.chmod-calculator.texts.tag-owner-u")),1),a("th",_e,w(o(s)("tools.chmod-calculator.texts.tag-group-g")),1),a("th",fe,w(o(s)("tools.chmod-calculator.texts.tag-public-o")),1)])]),a("tbody",null,[(O(),U(B,null,D(r,({scope:m,title:Y})=>a("tr",{key:m},[a("td",ge,w(Y),1),(O(),U(B,null,D(f,C=>a("td",{key:C,class:"text-center"},[i(v,{checked:o(t)[C][m],"onUpdate:checked":H=>o(t)[C][m]=H,size:"large"},null,8,["checked","onUpdate:checked"])])),64))])),64)),a("tr",null,[a("td",he,w(o(s)("tools.chmod-calculator.texts.tag-flags")),1),a("td",be,[i(v,{checked:o(t).flags.setuid,"onUpdate:checked":d[2]||(d[2]=m=>o(t).flags.setuid=m),size:"large"},null,8,["checked"])]),a("td",xe,[i(v,{checked:o(t).flags.setgid,"onUpdate:checked":d[3]||(d[3]=m=>o(t).flags.setgid=m),size:"large"},null,8,["checked"])]),a("td",we,[i(v,{checked:o(t).flags.stickybit,"onUpdate:checked":d[4]||(d[4]=m=>o(t).flags.stickybit=m),size:"large"},null,8,["checked"])])])])]),_:1}),a("div",ve,w(o(x)),1),a("div",ye,w(o(g)),1),i(N,{title:o(s)("tools.chmod-calculator.texts.title-chmod-command"),"mb-1":""},{default:k(()=>[i(G,{"label-position":"left",value:`chmod ${o(x)} path`,readonly:""},null,8,["value"])]),_:1},8,["title"]),i(N,{title:o(s)("tools.chmod-calculator.texts.title-umask")},{default:k(()=>[i(G,{label:o(s)("tools.chmod-calculator.texts.label-octal"),"label-position":"left","label-width":"100px",value:o(c).octal,readonly:""},null,8,["label","value"]),i(G,{label:o(s)("tools.chmod-calculator.texts.label-symbolic"),"label-position":"left","label-width":"100px",value:o(c).symbolic,readonly:""},null,8,["label","value"])]),_:1},8,["title"])])}}});const Oe=se(ke,[["__scopeId","data-v-b62cfb45"]]);export{Oe as default};
