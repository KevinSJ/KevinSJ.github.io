import{g as p,b as U,r as I,cB as q,D as B,m as g,d as G,a0 as K,al as Y,i as N,ac as Q,o as _,c as y,a as S,k as r,w as v,l as e,j as W,ad as P,a7 as D,a8 as C,ak as H,x as X,a_ as Z,G as M,bq as ee}from"./index-0c1fde36.js";import{_ as te}from"./c-monaco-editor.vue_vue_type_script_setup_true_lang-735b1924.js";import{c as z,r as ae}from"./composeverter-a96e10c8.js";import{Y as A}from"./index-84e3bf78.js";import"./index-24bd6b84.js";import{A as oe}from"./ajv-fabfb004.js";import{_ as le}from"./TextareaCopyable-59231e95.js";import{_ as se}from"./Switch-a0f825a4.js";import{_ as ne}from"./FormItem-1b9a5952.js";import{_ as re}from"./Select-9917c364.js";import{N as ie}from"./Alert-a9fb131b.js";import{_ as me}from"./Divider-5fc425b0.js";import"./editor.main-9e6d3164.js";import"./index-a6f01dde.js";import"./index-2709bfd9.js";import"./public-api-a830925a.js";import"./ajv-53acda87.js";import"./base64-ae7cf34b.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./context-00991937.js";import"./Tag-e75b8dae.js";import"./FocusDetector-089b8822.js";import"./VirtualList-8140ffff.js";import"./Empty-ca426d71.js";import"./index-cbfaa337.js";function ue({rawYaml:x,sortKeys:t=!1,indentSize:h=2}){const i=p(x);z.yamlCheck(i);const m=A.parse(i,{intAsBigInt:!0});return A.stringify(m,{sortMapEntries:p(t),indent:p(h)})}var ce=ae();const pe=U(ce);function _e({yaml:x,schemaUrl:t,schemaData:h}){const i=I([]),m=I(null),l=I([]);return q(async()=>{const u=await(await fetch("https://www.schemastore.org/api/json/catalog.json")).json();i.value=u.schemas}),B([t,h].filter(g),async()=>{if(p(t)==="custom"){try{m.value=JSON.parse(p(h))}catch(s){l.value=[`Schema parsing error:${s.toString()}`]}return}if(p(t))try{const u=await(await fetch(p(t))).json();m.value=u}catch(s){l.value=[`Schema fetching error:${s.toString()}`]}},{immediate:!0}),B([x,m].filter(g),()=>{const s=p(m),u=p(x);if(!s){l.value=[];return}if(!u){l.value=[];return}const j=z.yamlParse(u),E=new oe({allErrors:!0,strict:!1});pe(E);const k=E.compile(s);if(k(j)||k.errors===null)l.value=[];else{const O=A.parseDocument(u,{prettyErrors:!0});l.value=k.errors.map(o=>{let{instancePath:c}=o;o.keyword==="additionalProperties"&&(c+=`/${o.params.additionalProperty}`);const n=c.split("/").slice(1);let $=O.getIn(n,!0);$===null&&($=O.getIn(n.slice(0,-1),!0));const d=$,L=d?.range?d.range[0]+1:0,b=(u.substring(0,L).match(/\n/g)||[]).length+1;let f;return o.keyword==="additionalProperties"?f=`Line ${b}(${c}): '${o.params.additionalProperty}' is unknown for '${c}'`:o.keyword==="format"?f=`Line ${b}(${c}): must have a valid syntax for '${o.params.format}'`:o.keyword==="oneOf"?f=`Line ${b}(${c}): must be either a Short Syntax (string(s)) or a Long Syntax (object(s))`:f=`Line ${b}(${c}): ${o.message} (${o.keyword}: ${JSON.stringify(o.params)})`,f})}},{immediate:!0}),{schemas:i,errors:l}}const de={style:{flex:"0 0 100%"}},fe={style:{margin:"0 auto","max-width":"600px"},flex:"","justify-center":"","gap-3":""},ye={relative:"","w-full":""},ve={key:1,"mb-2":"","mt-2":""},ge={key:2,"mb-2":"","mt-2":""},he=G({__name:"yaml-viewer",setup(x){const{t}=K(),h=I(),i=Y("yaml-prettify:raw-yaml",""),m=Y("yaml-prettify:schema-data",""),l=Y("yaml-prettify:indent-size",2),s=Y("yaml-prettify:sort-keys",!1),u=N(()=>{try{return{yaml:ue({rawYaml:i,indentSize:l,sortKeys:s}),errors:[]}}catch(c){return{yaml:t("tools.yaml-viewer.text.see-error-messages"),errors:c.toString().split(`
`)}}}),j=N(()=>u.value.errors),E=N(()=>u.value.yaml),k={automaticLayout:!0,formatOnType:!0,formatOnPaste:!0},w=Q({name:"schema",storageName:"yaml-prettify:schema",defaultValue:""}),{schemas:O,errors:o}=_e({yaml:i,schemaUrl:w,schemaData:m});return(c,n)=>{const $=se,d=ne,L=H,b=re,f=X,J=te,R=Z,V=ie,T=me;return _(),y("div",null,[S("div",de,[S("div",fe,[r(d,{label:e(t)("tools.yaml-viewer.texts.label-sort-keys"),"label-placement":"left","label-width":"100"},{default:v(()=>[r($,{value:e(s),"onUpdate:value":n[0]||(n[0]=a=>g(s)?s.value=a:null)},null,8,["value"])]),_:1},8,["label"]),r(d,{label:e(t)("tools.yaml-viewer.texts.label-indent-size"),"label-placement":"left","label-width":"100","show-feedback":!1},{default:v(()=>[r(L,{value:e(l),"onUpdate:value":n[1]||(n[1]=a=>g(l)?l.value=a:null),min:"1",max:"10",style:{width:"100px"}},null,8,["value"])]),_:1},8,["label"])])]),r(d,{label:e(t)("tools.yaml-viewer.texts.label-json-schema"),"label-placement":"left","label-width":"130px","label-align":"right"},{default:v(()=>[r(b,{value:e(w),"onUpdate:value":n[2]||(n[2]=a=>g(w)?w.value=a:null),options:[{label:e(t)("tools.yaml-viewer.texts.label-no-validation"),value:""},{label:e(t)("tools.yaml-viewer.texts.label-custom"),value:"custom"},...e(O).map(a=>({label:`${a.name} / ${a.description}`,value:a.url}))],filterable:"","mb-4":""},null,8,["value","options"])]),_:1},8,["label"]),e(w)==="custom"?(_(),W(f,{key:0,ref_key:"jsonSchemaInputElement",ref:h,value:e(m),"onUpdate:value":n[3]||(n[3]=a=>g(m)?m.value=a:null),placeholder:e(t)("tools.yaml-viewer.texts.placeholder-paste-your-json-schema-here"),rows:"20",multiline:"",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",monospace:""},null,8,["value","placeholder"])):P("",!0),r(R,{label:e(t)("tools.yaml-viewer.texts.label-your-raw-yaml")},{default:v(()=>[S("div",ye,[r(J,{value:e(i),"onUpdate:value":n[4]||(n[4]=a=>g(i)?i.value=a:null),theme:"vs-dark",language:"yaml",height:"250px",options:k},null,8,["value"])])]),_:1},8,["label"]),e(j).length>0?(_(),y("div",ve,[r(V,{title:e(t)("tools.yaml-viewer.texts.title-the-following-errors-occured"),type:"error","mt-5":""},{default:v(()=>[S("ul",null,[(_(!0),y(D,null,C(e(j),(a,F)=>(_(),y("li",{key:F},M(a),1))),128))])]),_:1},8,["title"])])):P("",!0),e(o).length>0?(_(),y("div",ge,[r(V,{title:e(t)("tools.yaml-viewer.texts.title-schema-validation-errors"),type:"error"},{default:v(()=>[(_(!0),y(D,null,C(e(o),a=>(_(),y("ul",{key:a},[S("li",null,M(a),1)]))),128))]),_:1},8,["title"])])):P("",!0),r(T),r(d,{label:e(t)("tools.yaml-viewer.texts.label-prettified-version-of-your-yaml")},{default:v(()=>[r(le,{value:e(E),language:"yaml","download-file-name":"output.yml"},null,8,["value"])]),_:1},8,["label"])])}}});const Qe=ee(he,[["__scopeId","data-v-ed90929e"]]);export{Qe as default};
