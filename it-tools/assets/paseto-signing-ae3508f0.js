import{d as q,a0 as Q,r as w,E as M,R as O,aX as F,o as U,c as W,k as l,w as s,l as e,m as b,a as Z,a6 as N,G as h,j as V,ad as T,x as ee,aj as te,af as ae,ag as le}from"./index-0c1fde36.js";import{_ as oe}from"./TextareaCopyable-59231e95.js";import{p as z,a as ne,b as R,c as X,d as L,P as Y,s as se,T as G,e as D,f as J,M as $,g as j,h as H,v as ie,i as re,j as ue,k as pe,u as de,r as ce,l as ge}from"./key-f86f55cb.js";import{_ as ve}from"./Switch-a0f825a4.js";import{_ as _e}from"./FormItem-1b9a5952.js";import{_ as fe}from"./Space-7fc52151.js";import"./base64-ae7cf34b.js";import"./index-a6f01dde.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./context-00991937.js";import"./get-slot-1efb97e5.js";function me(y,t,{footer:i=new Uint8Array(0),assertion:r=new Uint8Array(0),addExp:p=!0,addIat:d=!0,maxDepth:c=$,maxKeys:g=j,validatePayload:n=!0}={footer:new Uint8Array(0),assertion:new Uint8Array(0),addExp:!0,addIat:!0,maxDepth:$,maxKeys:j,validatePayload:!0}){y=z("secret",y);const x=ne(R(t,{addExp:!!p,addIat:!!d,maxDepth:c,maxKeys:g,validate:!!n})),v=X(i,{maxDepth:c,maxKeys:g,validate:!!n});r=L(r);const P=Y(H.v4.public,x,v,r),S=se(y,P);let k="";return i.length===0?k=`${G.v4.public}${D(J(x,S))}`:k=`${G.v4.public}${D(J(x,S))}.${D(v)}`,k}function be(y,t,{assertion:i=new Uint8Array(0),maxDepth:r=$,maxKeys:p=j,validatePayload:d=!0}={assertion:new Uint8Array(0),maxDepth:$,maxKeys:j,validatePayload:!0}){ie("public",t),y=z("public",y);const{message:c,signature:g,footer:n}=re(t);n.length>0&&X(n,{maxDepth:r,maxKeys:p,validate:!!d}),i=L(i);const x=Y(H.v4.public,c,n,i);if(!ue(y,x,g))throw new pe("Invalid token signature");const P=de(c);return{payload:R(P,{addExp:!1,addIat:!1,maxDepth:r,maxKeys:p,validate:!!d}),footer:ce(n)}}const ye={flex:"","justify-center":""},he=q({__name:"paseto-signing",setup(y){const{t}=Q(),i=w(`{
  "sub": "1234567890",
  "name": "John Doe",
  "iat": "${new Date().toISOString()}"
}`),r=w("{}"),p=w(""),d=w(""),c=w(!0),g=w(!0),n=w(!0);function x(){const u=ge("public");p.value=u.secretKey,d.value=u.publicKey}x();const v=M(async()=>{const u=p.value,a=i.value,_=c.value,E=g.value,f=r.value,I=n.value;try{return{token:await me(u,a,{addExp:_,addIat:E,footer:f,validatePayload:I}),error:""}}catch(m){return{error:m.toString(),token:""}}}),P=O({source:i,rules:[{message:t("tools.paseto-signing.texts.message-invalid-json-string"),validator:u=>F.parse(u)}]}),S=O({source:r,rules:[{message:t("tools.paseto-signing.texts.message-invalid-json-string"),validator:u=>F.parse(u)}]}),k=w(""),A=M(async()=>{const u=d.value,a=k.value,_=n.value;try{const{payload:E,footer:f}=await be(u,a,{validatePayload:_});return{payload:E,footer:f,error:""}}catch(E){return{error:E.toString(),payload:"",footer:""}}});return(u,a)=>{const _=ee,E=te,f=ae,I=ve,m=_e,C=fe,K=oe,B=le;return U(),W("div",null,[l(f,{title:e(t)("tools.paseto-signing.texts.title-key-pairs"),"mb-2":""},{default:s(()=>[l(_,{value:e(p),"onUpdate:value":a[0]||(a[0]=o=>b(p)?p.value=o:null),label:e(t)("tools.paseto-signing.texts.label-secret-key"),"label-position":"left",placeholder:e(t)("tools.paseto-signing.texts.placeholder-paserk-secret-key-k4-secret-xxxx"),"mb-1":""},null,8,["value","label","placeholder"]),l(_,{value:e(d),"onUpdate:value":a[1]||(a[1]=o=>b(d)?d.value=o:null),label:e(t)("tools.paseto-signing.texts.label-public-key"),"label-position":"left",placeholder:e(t)("tools.paseto-signing.texts.placeholder-paserk-public-key-k4-public-xxxx"),"mb-1":""},null,8,["value","label","placeholder"]),Z("div",ye,[l(E,{onClick:a[2]||(a[2]=o=>x())},{default:s(()=>[N(h(e(t)("tools.paseto-signing.texts.tag-refresh-key")),1)]),_:1})])]),_:1},8,["title"]),l(f,{title:e(t)("tools.paseto-signing.texts.title-signing"),"mb-2":""},{default:s(()=>[l(_,{value:e(i),"onUpdate:value":a[3]||(a[3]=o=>b(i)?i.value=o:null),label:e(t)("tools.paseto-signing.texts.label-payload"),multiline:"",rows:"5",autosize:"",placeholder:e(t)("tools.paseto-signing.texts.placeholder-json-payload"),validation:e(P)},null,8,["value","label","placeholder","validation"]),l(C,{justify:"center"},{default:s(()=>[l(m,{label:e(t)("tools.paseto-signing.texts.label-validate-payload"),"label-placement":"left"},{default:s(()=>[l(I,{value:e(n),"onUpdate:value":a[4]||(a[4]=o=>b(n)?n.value=o:null)},null,8,["value"])]),_:1},8,["label"]),l(m,{label:e(t)("tools.paseto-signing.texts.label-add-exp"),"label-placement":"left"},{default:s(()=>[l(I,{value:e(c),"onUpdate:value":a[5]||(a[5]=o=>b(c)?c.value=o:null)},null,8,["value"])]),_:1},8,["label"]),l(m,{label:e(t)("tools.paseto-signing.texts.label-add-iat"),"label-placement":"left"},{default:s(()=>[l(I,{value:e(g),"onUpdate:value":a[6]||(a[6]=o=>b(g)?g.value=o:null)},null,8,["value"])]),_:1},8,["label"])]),_:1}),l(_,{value:e(r),"onUpdate:value":a[7]||(a[7]=o=>b(r)?r.value=o:null),label:e(t)("tools.paseto-signing.texts.label-footer"),multiline:"",rows:"2",autosize:"",placeholder:e(t)("tools.paseto-signing.texts.placeholder-json-footer"),validation:e(S)},null,8,["value","label","placeholder","validation"]),e(v)?(U(),V(f,{key:0,title:e(t)("tools.paseto-signing.texts.title-signed-paserk-token"),"mb-2":""},{default:s(()=>[e(v).token?(U(),V(K,{key:0,value:e(v).token,"word-wrap":""},null,8,["value"])):T("",!0),e(v).error?(U(),V(B,{key:1},{default:s(()=>[N(h(e(v).error),1)]),_:1})):T("",!0)]),_:1},8,["title"])):T("",!0)]),_:1},8,["title"]),l(f,{title:e(t)("tools.paseto-signing.texts.title-verifying"),"mb-2":""},{default:s(()=>[l(_,{value:e(k),"onUpdate:value":a[8]||(a[8]=o=>b(k)?k.value=o:null),label:e(t)("tools.paseto-signing.texts.label-token"),multiline:"",rows:"5",autosize:"",placeholder:e(t)("tools.paseto-signing.texts.placeholder-paserk-token")},null,8,["value","label","placeholder"]),l(C,{justify:"center"},{default:s(()=>[l(m,{label:e(t)("tools.paseto-signing.texts.label-validate-payload"),"label-placement":"left"},{default:s(()=>[l(I,{value:e(n),"onUpdate:value":a[9]||(a[9]=o=>b(n)?n.value=o:null)},null,8,["value"])]),_:1},8,["label"])]),_:1}),e(A)?(U(),V(f,{key:0,title:e(t)("tools.paseto-signing.texts.title-verification-result"),"mb-2":""},{default:s(()=>[e(A).payload?(U(),V(m,{key:0,label:e(t)("tools.paseto-signing.texts.label-payload")},{default:s(()=>[l(K,{value:JSON.stringify(e(A).payload,null,2),"word-wrap":""},null,8,["value"])]),_:1},8,["label"])):T("",!0),e(A).footer?(U(),V(m,{key:1,label:e(t)("tools.paseto-signing.texts.label-footer")},{default:s(()=>[l(K,{value:JSON.stringify(e(A).footer,null,2),"word-wrap":""},null,8,["value"])]),_:1},8,["label"])):T("",!0),e(A).error?(U(),V(B,{key:2},{default:s(()=>[N(h(e(A).error),1)]),_:1})):T("",!0)]),_:1},8,["title"])):T("",!0)]),_:1},8,["title"])])}}});export{he as default};
