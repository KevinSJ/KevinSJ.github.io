import{d as A,a0 as G,r as m,ac as k,o as p,j as i,w as c,k as s,l as e,m as f,ad as v,a as O,a6 as h,G as N,aW as P,x as Q,aj as R,ag as W,af as z}from"./index-0c1fde36.js";import{_ as E}from"./TextareaCopyable-59231e95.js";import{r as H,u as J}from"./xlsx-5c2e05c6.js";import{o as K}from"./objectarray.export-a35a6164.js";import{_ as L}from"./Select-9917c364.js";import{_ as j}from"./FormItem-1b9a5952.js";import{_ as M}from"./Checkbox-ba7202eb.js";import{_ as X}from"./Card-7ba5ce79.js";import"./base64-ae7cf34b.js";import"./index-a6f01dde.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./index-84e3bf78.js";import"./public-api-a830925a.js";import"./index-32bbd1ee.js";import"./sax-dae1c632.js";import"./index-fdbe2ce9.js";import"./string_decoder-8ac4312e.js";import"./index-649b5bab.js";import"./inherits_browser-6f38ab1b.js";import"./index-0397ab6f.js";import"./index-ceeeeaf1.js";import"./merge-53ce9f8a.js";import"./isPlainObject-1c699aec.js";import"./Tag-e75b8dae.js";import"./FocusDetector-089b8822.js";import"./VirtualList-8140ffff.js";import"./Empty-ca426d71.js";import"./index-cbfaa337.js";import"./context-00991937.js";const Y={"mt-3":"",flex:"","justify-center":""},qe=A({__name:"excel-to-data",setup(Z){const{t}=G(),o=m(null),b=m(""),n=k({name:"fmt",storageName:"excel-to-data:fmt",defaultValue:"json"}),_=k({name:"table",storageName:"excel-to-data:tbl",defaultValue:"TableName"}),d=m(!1),r=m(""),x=m(""),w=[{label:t("tools.excel-to-data.texts.label-json"),value:"json"},{label:t("tools.excel-to-data.texts.label-yaml"),value:"yaml"},{label:t("tools.excel-to-data.texts.label-sql-insert"),value:"sql"},{label:t("tools.excel-to-data.texts.label-csv-comma"),value:"csv"},{label:t("tools.excel-to-data.texts.label-csv-semicolon"),value:"csv_semicolon"},{label:t("tools.excel-to-data.texts.label-csv-tab"),value:"tsv"},{label:t("tools.excel-to-data.texts.label-markdown"),value:"markdown"},{label:t("tools.excel-to-data.texts.label-xml"),value:"xml"}];async function S(u){x.value="",o.value=null,r.value="";try{o.value=H(await u.arrayBuffer(),{type:"binary"}),r.value=o.value.SheetNames[0]}catch(l){x.value=l.toString()}}function U(){if(!o.value)return;const u=J.sheet_to_json(o.value.Sheets[r.value]);!u.length||!n.value||(b.value=K(u,n.value,{tableName:_.value,nestify:d.value}))}return(u,l)=>{const V=P,g=L,y=j,$=M,B=j,C=Q,F=R,q=W,D=E,T=z,I=X;return p(),i(I,{title:e(t)("tools.excel-to-data.texts.title-xlsx-converter")},{default:c(()=>[s(V,{title:e(t)("tools.excel-to-data.texts.title-drag-and-drop-a-xlsx-here-or-click-to-select-a-file"),accept:".xlsx","mb-3":"",onFileUpload:S},null,8,["title"]),e(o)?(p(),i(y,{key:0,label:e(t)("tools.excel-to-data.texts.label-select-sheet-to-use"),"label-placement":"left"},{default:c(()=>[s(g,{value:e(r),"onUpdate:value":l[0]||(l[0]=a=>f(r)?r.value=a:null),options:e(o).SheetNames?.map(a=>({label:a,value:a})),placeholder:e(t)("tools.excel-to-data.texts.placeholder-select-sheet")},null,8,["value","options","placeholder"])]),_:1},8,["label"])):v("",!0),s(y,{label:e(t)("tools.excel-to-data.texts.label-select-output-format"),"label-placement":"left"},{default:c(()=>[s(g,{value:e(n),"onUpdate:value":l[1]||(l[1]=a=>f(n)?n.value=a:null),options:w,placeholder:e(t)("tools.excel-to-data.texts.placeholder-select-format")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(B,{label:e(t)("tools.excel-to-data.texts.label-nestify-a-b-c-to-nested-objects"),"label-placement":"left"},{default:c(()=>[s($,{checked:e(d),"onUpdate:checked":l[2]||(l[2]=a=>f(d)?d.value=a:null)},null,8,["checked"])]),_:1},8,["label"]),e(n)==="sql"?(p(),i(C,{key:1,value:e(_),"onUpdate:value":l[3]||(l[3]=a=>f(_)?_.value=a:null),label:e(t)("tools.excel-to-data.texts.label-table-name"),"label-placement":"left"},null,8,["value","label"])):v("",!0),O("div",Y,[s(F,{disabled:!e(o),onClick:U},{default:c(()=>[h(N(e(t)("tools.excel-to-data.texts.tag-convert")),1)]),_:1},8,["disabled"])]),e(x)?(p(),i(q,{key:2},{default:c(()=>[h(N(e(x)),1)]),_:1})):v("",!0),e(b)?(p(),i(T,{key:3,title:e(t)("tools.excel-to-data.texts.title-converted-data")},{default:c(()=>[s(D,{value:e(b),language:e(n),"download-file-name":`output.${e(n)}`},null,8,["value","language","download-file-name"])]),_:1},8,["title"])):v("",!0)]),_:1},8,["title"])}}});export{qe as default};
