import{b as _}from"./index-4bc05a7f.js";import{Q as l}from"./index-0c1fde36.js";import{c as te}from"./index-a5958021.js";import{l as G}from"./index-d58a7f66.js";import{i as z}from"./index-e6f9cbd8.js";var b={},w={},B={};Object.defineProperty(B,"__esModule",{value:!0});B.isInSubnet=re;B.isCorrect=se;B.numberToPaddedHex=Y;B.stringToPaddedHex=ne;B.testBit=ie;function re(t){return this.subnetMask<t.subnetMask?!1:this.mask(t.subnetMask)===t.mask()}function se(t){return function(){return this.addressMinusSuffix!==this.correctForm()?!1:this.subnetMask===t&&!this.parsedSubnet?!0:this.parsedSubnet===String(this.subnetMask)}}function Y(t){return t.toString(16).padStart(2,"0")}function ne(t){return Y(parseInt(t,10))}function ie(t,e){const{length:r}=t;if(e>r)return!1;const s=r-e;return t.substring(s,s+1)==="1"}var I={};Object.defineProperty(I,"__esModule",{value:!0});I.RE_SUBNET_STRING=I.RE_ADDRESS=I.GROUPS=I.BITS=void 0;I.BITS=32;I.GROUPS=4;I.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;I.RE_SUBNET_STRING=/\/\d{1,2}$/;var T={};Object.defineProperty(T,"__esModule",{value:!0});T.AddressError=void 0;class oe extends Error{constructor(e,r){super(e),this.name="AddressError",this.parseMessage=r}}T.AddressError=oe;var ae=l&&l.__createBinding||(Object.create?function(t,e,r,s){s===void 0&&(s=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,s,n)}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}),ue=l&&l.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),W=l&&l.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ae(e,t,r);return ue(e,t),e};Object.defineProperty(w,"__esModule",{value:!0});w.Address4=void 0;const M=W(B),S=W(I),y=T;class g{constructor(e){this.groups=S.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=M.isCorrect(S.BITS),this.isInSubnet=M.isInSubnet,this.address=e;const r=S.RE_SUBNET_STRING.exec(e);if(r){if(this.parsedSubnet=r[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,this.subnetMask<0||this.subnetMask>S.BITS)throw new y.AddressError("Invalid subnet mask.");e=e.replace(S.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}static isValid(e){try{return new g(e),!0}catch{return!1}}parse(e){const r=e.split(".");if(!e.match(S.RE_ADDRESS))throw new y.AddressError("Invalid IPv4 address.");return r}correctForm(){return this.parsedAddress.map(e=>parseInt(e,10)).join(".")}static fromHex(e){const r=e.replace(/:/g,"").padStart(8,"0"),s=[];let n;for(n=0;n<8;n+=2){const i=r.slice(n,n+2);s.push(parseInt(i,16))}return new g(s.join("."))}static fromInteger(e){return g.fromHex(e.toString(16))}static fromArpa(e){const s=e.replace(/(\.in-addr\.arpa)?\.$/,"").split(".").reverse().join(".");return new g(s)}toHex(){return this.parsedAddress.map(e=>M.stringToPaddedHex(e)).join(":")}toArray(){return this.parsedAddress.map(e=>parseInt(e,10))}toGroup6(){const e=[];let r;for(r=0;r<S.GROUPS;r+=2)e.push(`${M.stringToPaddedHex(this.parsedAddress[r])}${M.stringToPaddedHex(this.parsedAddress[r+1])}`);return e.join(":")}bigInt(){return BigInt(`0x${this.parsedAddress.map(e=>M.stringToPaddedHex(e)).join("")}`)}_startAddress(){return BigInt(`0b${this.mask()+"0".repeat(S.BITS-this.subnetMask)}`)}startAddress(){return g.fromBigInt(this._startAddress())}startAddressExclusive(){const e=BigInt("1");return g.fromBigInt(this._startAddress()+e)}_endAddress(){return BigInt(`0b${this.mask()+"1".repeat(S.BITS-this.subnetMask)}`)}endAddress(){return g.fromBigInt(this._endAddress())}endAddressExclusive(){const e=BigInt("1");return g.fromBigInt(this._endAddress()-e)}static fromBigInt(e){return g.fromHex(e.toString(16))}static fromByteArray(e){if(e.length!==4)throw new y.AddressError("IPv4 addresses require exactly 4 bytes");for(let r=0;r<e.length;r++)if(!Number.isInteger(e[r])||e[r]<0||e[r]>255)throw new y.AddressError("All bytes must be integers between 0 and 255");return this.fromUnsignedByteArray(e)}static fromUnsignedByteArray(e){if(e.length!==4)throw new y.AddressError("IPv4 addresses require exactly 4 bytes");const r=e.join(".");return new g(r)}mask(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)}getBitsBase2(e,r){return this.binaryZeroPad().slice(e,r)}reverseForm(e){e||(e={});const r=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?r:`${r}.in-addr.arpa.`}isMulticast(){return this.isInSubnet(new g("224.0.0.0/4"))}binaryZeroPad(){return this.bigInt().toString(2).padStart(S.BITS,"0")}groupForV6(){const e=this.parsedAddress;return this.address.replace(S.RE_ADDRESS,`<span class="hover-group group-v4 group-6">${e.slice(0,2).join(".")}</span>.<span class="hover-group group-v4 group-7">${e.slice(2,4).join(".")}</span>`)}}w.Address4=g;var N={},d={};Object.defineProperty(d,"__esModule",{value:!0});d.RE_URL_WITH_PORT=d.RE_URL=d.RE_ZONE_STRING=d.RE_SUBNET_STRING=d.RE_BAD_ADDRESS=d.RE_BAD_CHARACTERS=d.TYPES=d.SCOPES=d.GROUPS=d.BITS=void 0;d.BITS=128;d.GROUPS=8;d.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"};d.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};d.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;d.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;d.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;d.RE_ZONE_STRING=/%.*$/;d.RE_URL=/^\[{0,1}([0-9a-f:]+)\]{0,1}/;d.RE_URL_WITH_PORT=/\[([0-9a-f:]+)\]:([0-9]{1,5})/;var $={};Object.defineProperty($,"__esModule",{value:!0});$.spanAllZeroes=q;$.spanAll=ce;$.spanLeadingZeroes=le;$.simpleGroup=de;function q(t){return t.replace(/(0+)/g,'<span class="zero">$1</span>')}function ce(t,e=0){return t.split("").map((s,n)=>`<span class="digit value-${s} position-${n+e}">${q(s)}</span>`).join("")}function V(t){return t.replace(/^(0+)/,'<span class="zero">$1</span>')}function le(t){return t.split(":").map(r=>V(r)).join(":")}function de(t,e=0){return t.split(":").map((s,n)=>/group-v4/.test(s)?s:`<span class="hover-group group-${n+e}">${V(s)}</span>`)}var E={},fe=l&&l.__createBinding||(Object.create?function(t,e,r,s){s===void 0&&(s=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,s,n)}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}),pe=l&&l.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),he=l&&l.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&fe(e,t,r);return pe(e,t),e};Object.defineProperty(E,"__esModule",{value:!0});E.ADDRESS_BOUNDARY=void 0;E.groupPossibilities=j;E.padGroup=O;E.simpleRegularExpression=be;E.possibleElisions=Se;const ge=he(d);function j(t){return`(${t.join("|")})`}function O(t){return t.length<4?`0{0,${4-t.length}}${t}`:t}E.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function be(t){const e=[];t.forEach((s,n)=>{parseInt(s,16)===0&&e.push(n)});const r=e.map(s=>t.map((n,i)=>{if(i===s){const a=i===0||i===ge.GROUPS-1?":":"";return j([O(n),a])}return O(n)}).join(":"));return r.push(t.map(O).join(":")),j(r)}function Se(t,e,r){const s=e?"":":",n=r?"":":",i=[];!e&&!r&&i.push("::"),e&&r&&i.push(""),(r&&!e||!r&&e)&&i.push(":"),i.push(`${s}(:0{1,4}){1,${t-1}}`),i.push(`(0{1,4}:){1,${t-1}}${n}`),i.push(`(0{1,4}:){${t-1}}0{1,4}`);for(let a=1;a<t-1;a++)for(let o=1;o<t-a;o++)i.push(`(0{1,4}:){${o}}:(0{1,4}:){${t-o-a-1}}0{1,4}`);return j(i)}var Ie=l&&l.__createBinding||(Object.create?function(t,e,r,s){s===void 0&&(s=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,s,n)}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}),Ae=l&&l.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),U=l&&l.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ie(e,t,r);return Ae(e,t),e};Object.defineProperty(N,"__esModule",{value:!0});N.Address6=void 0;const k=U(B),C=U(I),c=U(d),F=U($),P=w,R=E,v=T,x=B;function D(t){if(!t)throw new Error("Assertion failed.")}function ve(t){const e=/(\d+)(\d{3})/;for(;e.test(t);)t=t.replace(e,"$1,$2");return t}function Be(t){return t=t.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),t=t.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),t}function me(t,e){const r=[],s=[];let n;for(n=0;n<t.length;n++)n<e[0]?r.push(t[n]):n>e[1]&&s.push(t[n]);return r.concat(["compact"]).concat(s)}function L(t){return parseInt(t,16).toString(16).padStart(4,"0")}function Z(t){return t&255}class h{constructor(e,r){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=k.isInSubnet,this.isCorrect=k.isCorrect(c.BITS),r===void 0?this.groups=c.GROUPS:this.groups=r,this.address=e;const s=c.RE_SUBNET_STRING.exec(e);if(s){if(this.parsedSubnet=s[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>c.BITS)throw new v.AddressError("Invalid subnet mask.");e=e.replace(c.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new v.AddressError("Invalid subnet mask.");const n=c.RE_ZONE_STRING.exec(e);n&&(this.zone=n[0],e=e.replace(c.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}static isValid(e){try{return new h(e),!0}catch{return!1}}static fromBigInt(e){const r=e.toString(16).padStart(32,"0"),s=[];let n;for(n=0;n<c.GROUPS;n++)s.push(r.slice(n*4,(n+1)*4));return new h(s.join(":"))}static fromURL(e){let r,s=null,n;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if(n=c.RE_URL_WITH_PORT.exec(e),n===null)return{error:"failed to parse address with port",address:null,port:null};r=n[1],s=n[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),n=c.RE_URL.exec(e),n===null)return{error:"failed to parse address from URL",address:null,port:null};r=n[1]}else r=e;return s?(s=parseInt(s,10),(s<0||s>65536)&&(s=null)):s=null,{address:new h(r),port:s}}static fromAddress4(e){const r=new P.Address4(e),s=c.BITS-(C.BITS-r.subnetMask);return new h(`::ffff:${r.correctForm()}/${s}`)}static fromArpa(e){let r=e.replace(/(\.ip6\.arpa)?\.$/,"");const s=7;if(r.length!==63)throw new v.AddressError("Invalid 'ip6.arpa' form.");const n=r.split(".").reverse();for(let i=s;i>0;i--){const a=i*4;n.splice(a,0,":")}return r=n.join(""),new h(r)}microsoftTranscription(){return`${this.correctForm().replace(/:/g,"-")}.ipv6-literal.net`}mask(e=this.subnetMask){return this.getBitsBase2(0,e)}possibleSubnets(e=128){const r=c.BITS-this.subnetMask,s=Math.abs(e-c.BITS),n=r-s;return n<0?"0":ve((BigInt("2")**BigInt(n)).toString(10))}_startAddress(){return BigInt(`0b${this.mask()+"0".repeat(c.BITS-this.subnetMask)}`)}startAddress(){return h.fromBigInt(this._startAddress())}startAddressExclusive(){const e=BigInt("1");return h.fromBigInt(this._startAddress()+e)}_endAddress(){return BigInt(`0b${this.mask()+"1".repeat(c.BITS-this.subnetMask)}`)}endAddress(){return h.fromBigInt(this._endAddress())}endAddressExclusive(){const e=BigInt("1");return h.fromBigInt(this._endAddress()-e)}getScope(){let e=c.SCOPES[parseInt(this.getBits(12,16).toString(10),10)];return this.getType()==="Global unicast"&&e!=="Link local"&&(e="Global"),e||"Unknown"}getType(){for(const e of Object.keys(c.TYPES))if(this.isInSubnet(new h(e)))return c.TYPES[e];return"Global unicast"}getBits(e,r){return BigInt(`0b${this.getBitsBase2(e,r)}`)}getBitsBase2(e,r){return this.binaryZeroPad().slice(e,r)}getBitsBase16(e,r){const s=r-e;if(s%4!==0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,r).toString(16).padStart(s/4,"0")}getBitsPastSubnet(){return this.getBitsBase2(this.subnetMask,c.BITS)}reverseForm(e){e||(e={});const r=Math.floor(this.subnetMask/4),s=this.canonicalForm().replace(/:/g,"").split("").slice(0,r).reverse().join(".");return r>0?e.omitSuffix?s:`${s}.ip6.arpa.`:e.omitSuffix?"":"ip6.arpa."}correctForm(){let e,r=[],s=0;const n=[];for(e=0;e<this.parsedAddress.length;e++){const o=parseInt(this.parsedAddress[e],16);o===0&&s++,o!==0&&s>0&&(s>1&&n.push([e-s,e-1]),s=0)}s>1&&n.push([this.parsedAddress.length-s,this.parsedAddress.length-1]);const i=n.map(o=>o[1]-o[0]+1);if(n.length>0){const o=i.indexOf(Math.max(...i));r=me(this.parsedAddress,n[o])}else r=this.parsedAddress;for(e=0;e<r.length;e++)r[e]!=="compact"&&(r[e]=parseInt(r[e],16).toString(16));let a=r.join(":");return a=a.replace(/^compact$/,"::"),a=a.replace(/(^compact)|(compact$)/,":"),a=a.replace(/compact/,""),a}binaryZeroPad(){return this.bigInt().toString(2).padStart(c.BITS,"0")}parse4in6(e){const r=e.split(":"),n=r.slice(-1)[0].match(C.RE_ADDRESS);if(n){this.parsedAddress4=n[0],this.address4=new P.Address4(this.parsedAddress4);for(let i=0;i<this.address4.groups;i++)if(/^0[0-9]+/.test(this.address4.parsedAddress[i]))throw new v.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(C.RE_ADDRESS,this.address4.parsedAddress.map(Be).join(".")));this.v4=!0,r[r.length-1]=this.address4.toGroup6(),e=r.join(":")}return e}parse(e){e=this.parse4in6(e);const r=e.match(c.RE_BAD_CHARACTERS);if(r)throw new v.AddressError(`Bad character${r.length>1?"s":""} detected in address: ${r.join("")}`,e.replace(c.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));const s=e.match(c.RE_BAD_ADDRESS);if(s)throw new v.AddressError(`Address failed regex: ${s.join("")}`,e.replace(c.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));let n=[];const i=e.split("::");if(i.length===2){let a=i[0].split(":"),o=i[1].split(":");a.length===1&&a[0]===""&&(a=[]),o.length===1&&o[0]===""&&(o=[]);const u=this.groups-(a.length+o.length);if(!u)throw new v.AddressError("Error parsing groups");this.elidedGroups=u,this.elisionBegin=a.length,this.elisionEnd=a.length+this.elidedGroups,n=n.concat(a);for(let f=0;f<u;f++)n.push("0");n=n.concat(o)}else if(i.length===1)n=e.split(":"),this.elidedGroups=0;else throw new v.AddressError("Too many :: groups found");if(n=n.map(a=>parseInt(a,16).toString(16)),n.length!==this.groups)throw new v.AddressError("Incorrect number of groups found");return n}canonicalForm(){return this.parsedAddress.map(L).join(":")}decimal(){return this.parsedAddress.map(e=>parseInt(e,16).toString(10).padStart(5,"0")).join(":")}bigInt(){return BigInt(`0x${this.parsedAddress.map(L).join("")}`)}to4(){const e=this.binaryZeroPad().split("");return P.Address4.fromHex(BigInt(`0b${e.slice(96,128).join("")}`).toString(16))}to4in6(){const e=this.to4(),s=new h(this.parsedAddress.slice(0,6).join(":"),6).correctForm();let n="";return/:$/.test(s)||(n=":"),s+n+e.address}inspectTeredo(){const e=this.getBitsBase16(0,32),s=(this.getBits(80,96)^BigInt("0xffff")).toString(),n=P.Address4.fromHex(this.getBitsBase16(32,64)),i=this.getBits(96,128),a=P.Address4.fromHex((i^BigInt("0xffffffff")).toString(16)),o=this.getBitsBase2(64,80),u=(0,x.testBit)(o,15),f=(0,x.testBit)(o,14),p=(0,x.testBit)(o,8),A=(0,x.testBit)(o,9),m=BigInt(`0b${o.slice(2,6)+o.slice(8,16)}`).toString(10);return{prefix:`${e.slice(0,4)}:${e.slice(4,8)}`,server4:n.address,client4:a.address,flags:o,coneNat:u,microsoft:{reserved:f,universalLocal:A,groupIndividual:p,nonce:m},udpPort:s}}inspect6to4(){const e=this.getBitsBase16(0,16),r=P.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:e.slice(0,4),gateway:r.address}}to6to4(){if(!this.is4())return null;const e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new h(e)}toByteArray(){const e=this.bigInt().toString(16),s=`${"0".repeat(e.length%2)}${e}`,n=[];for(let i=0,a=s.length;i<a;i+=2)n.push(parseInt(s.substring(i,i+2),16));return n}toUnsignedByteArray(){return this.toByteArray().map(Z)}static fromByteArray(e){return this.fromUnsignedByteArray(e.map(Z))}static fromUnsignedByteArray(e){const r=BigInt("256");let s=BigInt("0"),n=BigInt("1");for(let i=e.length-1;i>=0;i--)s+=n*BigInt(e[i].toString(10)),n*=r;return h.fromBigInt(s)}isCanonical(){return this.addressMinusSuffix===this.canonicalForm()}isLinkLocal(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"}isMulticast(){return this.getType()==="Multicast"}is4(){return this.v4}isTeredo(){return this.isInSubnet(new h("2001::/32"))}is6to4(){return this.isInSubnet(new h("2002::/16"))}isLoopback(){return this.getType()==="Loopback"}href(e){return e===void 0?e="":e=`:${e}`,`http://[${this.correctForm()}]${e}/`}link(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);let r=this.correctForm;e.v4&&(r=this.to4in6);const s=r.call(this);return e.className?`<a href="${e.prefix}${s}" class="${e.className}">${s}</a>`:`<a href="${e.prefix}${s}">${s}</a>`}group(){if(this.elidedGroups===0)return F.simpleGroup(this.address).join(":");D(typeof this.elidedGroups=="number"),D(typeof this.elisionBegin=="number");const e=[],[r,s]=this.address.split("::");r.length?e.push(...F.simpleGroup(r)):e.push("");const n=["hover-group"];for(let i=this.elisionBegin;i<this.elisionBegin+this.elidedGroups;i++)n.push(`group-${i}`);return e.push(`<span class="${n.join(" ")}"></span>`),s.length?e.push(...F.simpleGroup(s,this.elisionEnd)):e.push(""),this.is4()&&(D(this.address4 instanceof P.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")}regularExpressionString(e=!1){let r=[];const s=new h(this.correctForm());if(s.elidedGroups===0)r.push((0,R.simpleRegularExpression)(s.parsedAddress));else if(s.elidedGroups===c.GROUPS)r.push((0,R.possibleElisions)(c.GROUPS));else{const n=s.address.split("::");n[0].length&&r.push((0,R.simpleRegularExpression)(n[0].split(":"))),D(typeof s.elidedGroups=="number"),r.push((0,R.possibleElisions)(s.elidedGroups,n[0].length!==0,n[1].length!==0)),n[1].length&&r.push((0,R.simpleRegularExpression)(n[1].split(":"))),r=[r.join(":")]}return e||(r=["(?=^|",R.ADDRESS_BOUNDARY,"|[^\\w\\:])(",...r,")(?=[^\\w\\:]|",R.ADDRESS_BOUNDARY,"|$)"]),r.join("")}regularExpression(e=!1){return new RegExp(this.regularExpressionString(e),"i")}}N.Address6=h;(function(t){var e=l&&l.__createBinding||(Object.create?function(u,f,p,A){A===void 0&&(A=p);var m=Object.getOwnPropertyDescriptor(f,p);(!m||("get"in m?!f.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return f[p]}}),Object.defineProperty(u,A,m)}:function(u,f,p,A){A===void 0&&(A=p),u[A]=f[p]}),r=l&&l.__setModuleDefault||(Object.create?function(u,f){Object.defineProperty(u,"default",{enumerable:!0,value:f})}:function(u,f){u.default=f}),s=l&&l.__importStar||function(u){if(u&&u.__esModule)return u;var f={};if(u!=null)for(var p in u)p!=="default"&&Object.prototype.hasOwnProperty.call(u,p)&&e(f,u,p);return r(f,u),f};Object.defineProperty(t,"__esModule",{value:!0}),t.v6=t.AddressError=t.Address6=t.Address4=void 0;var n=w;Object.defineProperty(t,"Address4",{enumerable:!0,get:function(){return n.Address4}});var i=N;Object.defineProperty(t,"Address6",{enumerable:!0,get:function(){return i.Address6}});var a=T;Object.defineProperty(t,"AddressError",{enumerable:!0,get:function(){return a.AddressError}});const o=s($);t.v6={helpers:o}})(b);const X={exact:!1},Q=`${z.v4().source}\\/(3[0-2]|[12]?[0-9])`,J=`${z.v6().source}\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])`,_e=new RegExp(`^${Q}$`),Ee=new RegExp(`^${J}$`),Pe=({exact:t}=X)=>t?_e:new RegExp(Q,"g"),Re=({exact:t}=X)=>t?Ee:new RegExp(J,"g"),K=Pe({exact:!0}),ee=Re({exact:!0}),H=t=>K.test(t)?4:ee.test(t)?6:0;H.v4=t=>K.test(t);H.v6=t=>ee.test(t);const $e=[["0.0.0.0",[8,"This host on this network"]],["10.0.0.0",[8,"Private Use"]],["100.64.0.0",[10,"Shared Address Space"]],["127.0.0.0",[8,"Loopback"]],["169.254.0.0",[16,"Link Local"]],["172.16.0.0",[12,"Private Use"]],["192.0.0.0",[24,"IETF Protocol Assignments"]],["192.0.0.0",[29,"IPv4 Service Continuity Prefix"]],["192.0.0.8",[32,"IPv4 dummy address"]],["192.0.0.9",[32,"Port Control Protocol Anycast"]],["192.0.0.10",[32,"Traversal Using Relays around NAT Anycast"]],["192.0.0.170",[32,"NAT64/DNS64 Discovery"]],["192.0.0.171",[32,"NAT64/DNS64 Discovery"]],["192.0.2.0",[24,"Documentation (TEST-NET-1)"]],["192.31.196.0",[24,"AS112-v4"]],["192.52.193.0",[24,"AMT"]],["192.88.99.0",[24,"Deprecated (6to4 Relay Anycast)"]],["192.168.0.0",[16,"Private Use"]],["192.175.48.0",[24,"Direct Delegation AS112 Service"]],["198.18.0.0",[15,"Benchmarking"]],["198.51.100.0",[24,"Documentation (TEST-NET-2)"]],["203.0.113.0",[24,"Documentation (TEST-NET-3)"]],["224.0.0.0",[24,"Multicast"]],["240.0.0.0",[4,"Reserved"]],["255.255.255.255",[32,"Limited Broadcast"]]],Me=[["::1",[128,"Loopback Address"]],["::",[128,"Unspecified Address"]],["::ffff::",[96,"IPv4-mapped Address"]],["64:ff9b::",[96,"IPv4-IPv6 Translat."]],["64:ff9b:1::",[48,"IPv4-IPv6 Translat."]],["100::",[64,"Discard-Only Address Block"]],["2001::",[23,"IETF Protocol Assignments"]],["2001::",[32,"TEREDO"]],["2001:1::1",[128,"Port Control Protocol Anycast"]],["2001:1::2",[128,"Traversal Using Relays around NAT Anycast"]],["2001:2::",[48,"Benchmarking"]],["2001:3::",[32,"AMT"]],["2001:4:112::",[48,"AS112-v6"]],["2001:5::",[32,"EID Space for LISP (Managed by RIPE NCC)"]],["2001:10::",[28,"Deprecated (previously ORCHID)"]],["2001:20::",[28,"ORCHIDv2"]],["2001:db8::",[32,"Documentation"]],["2002::",[16,"6to4"]],["2620:4f:8000::",[48,"Direct Delegation AS112 Service"]],["fc00::",[7,"Unique-Local"]],["fe80::",[10,"Link-Local Unicast"]],["ff00::",[8,"Multicast address"]]],Te=BigInt(2)**BigInt(32)-BigInt(1),ye=new Map($e.map(t=>[t[0],t[1]])),we=new Map(Me.map(t=>[t[0],t[1]]));function Ce(t){if(H(t))return t;const e=G.getMatch(t);return e instanceof G.IPSubnetwork?e.toString():e instanceof G.IPMask?e.convertToSubnet()?.toString()||"":(e.convertToMasks()||[])[0]?.convertToSubnet()?.toString()||""}function xe(t){const[e,r]=t.split("/");if(_(e)){const s=Number(r||"32"),n=p=>Te>>BigInt(32)-BigInt(p)<<BigInt(32)-BigInt(p),i=BigInt(new b.Address4(e).bigInt()),a=[];let o;s<8&&(o=0),o=i&n(s);const u=BigInt(2)**BigInt(32-s),f=De(t)||1;for(let p=0;p<f;p+=1)a.push({netAddress:b.Address4.fromBigInt(o).correctForm(),firstIP:b.Address4.fromBigInt(o+1n).correctForm(),lastIP:b.Address4.fromBigInt(o+u-2n).correctForm(),broadcastIP:b.Address4.fromBigInt(o+u-1n).correctForm(),prefix:s,hostsCount:Number(u-2n)}),o+=u;return a}return[]}function Fe(t){return xe(t).map(({netAddress:e,prefix:r})=>`${e}/${r}`)}function De(t){const[e,r]=t.split("/");if(_(e)){const n=Number(r||"32");return n%8===0?0:n<8?2**n:n<16?2**(n-8):n<24?2**(n-16):2**(n-24)}const s=Number(r||"128");return s<=64?BigInt(2)**BigInt(64n-BigInt(s)):-1}function He(t){const e=[];for(const[r,s]of(_(t)?ye:we).entries())te([`${r}/${Number(s[0])}`],t)&&e.unshift(s[1]);return e.length===0?"Public":e[0]?.toString()}function ke(t){if(_(t)){const e=BigInt(new b.Address4(t).bigInt());return`${[e&BigInt(255),e>>BigInt(8)&BigInt(255),e>>BigInt(16)&BigInt(255),e>>BigInt(24)&BigInt(255)].join(".")}.in-addr.arpa.`}return new b.Address6(t).reverseForm()}function Le(t){return t?(t.endsWith(".")||(t=`${t}.`),t.includes(".in-addr.arpa")?b.Address4.fromArpa(t).correctForm():b.Address6.fromArpa(t).correctForm()):null}function Ze(t){if(!_(t))return"";const e=new b.Address4(t).toHex().replace(/:/g,"");return`::ffff:${e.substring(0,4)}:${e.substring(4)}`}function ze(t){return _(t)?`::ffff:${t}`:""}function Ye(t){if(!_(t))return"";const e=new b.Address4(t).toHex();return`2002:${e.substring(0,4)}:${e.substring(4)}::/48`}function We(t){return _(t)?new b.Address6(t).microsoftTranscription():""}export{Ye as a,ke as b,xe as c,We as d,b as e,Le as f,He as g,De as h,H as i,Fe as j,Ze as k,Ce as p,ze as t};
