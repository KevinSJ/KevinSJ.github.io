import{t,_ as w,d as f,a0 as k,r as b,i as v,o as h,c as g,k as y,l as i,m as U,w as _,a as c,G as d,a7 as I,a8 as L,a6 as C,x as F,af as N}from"./index-0c1fde36.js";function $(s){const[a,n]=s.toString().split("e"),e=Number.parseFloat(a),o=e%1===0?e.toLocaleString():e.toFixed(2);return n?`${o}e${n}`:o}function D({seconds:s}){if(s<=.001)return t("tools.password-strength-analyser.service.text.instantly");if(s<=1)return t("tools.password-strength-analyser.service.text.less-than-a-second");const a=[{unit:t("tools.password-strength-analyser.service.text.millenium"),secondsInUnit:31536e6,format:$,plural:t("tools.password-strength-analyser.service.text.millennia")},{unit:t("tools.password-strength-analyser.service.text.century"),secondsInUnit:31536e5,plural:t("tools.password-strength-analyser.service.text.centuries")},{unit:t("tools.password-strength-analyser.service.text.decade"),secondsInUnit:31536e4,plural:t("tools.password-strength-analyser.service.text.decades")},{unit:t("tools.password-strength-analyser.service.text.year"),secondsInUnit:31536e3,plural:t("tools.password-strength-analyser.service.text.years")},{unit:t("tools.password-strength-analyser.service.text.month"),secondsInUnit:2592e3,plural:t("tools.password-strength-analyser.service.text.months")},{unit:t("tools.password-strength-analyser.service.text.week"),secondsInUnit:604800,plural:t("tools.password-strength-analyser.service.text.weeks")},{unit:t("tools.password-strength-analyser.service.text.day"),secondsInUnit:86400,plural:t("tools.password-strength-analyser.service.text.days")},{unit:t("tools.password-strength-analyser.service.text.hour"),secondsInUnit:3600,plural:t("tools.password-strength-analyser.service.text.hours")},{unit:t("tools.password-strength-analyser.service.text.minute"),secondsInUnit:60,plural:t("tools.password-strength-analyser.service.text.minutes")},{unit:t("tools.password-strength-analyser.service.text.second"),secondsInUnit:1,plural:t("tools.password-strength-analyser.service.text.seconds")}];return w.chain(a).map(({unit:n,secondsInUnit:e,plural:o,format:r=w.identity})=>{const l=Math.floor(s/e);return s%=e,l<=0?void 0:`${r(l)} ${l>1?o:n}`}).compact().take(2).join(", ").value()}function M({password:s,guessesPerSecond:a=1e9}){const n=B({password:s}),e=s.length,o=s===""?0:Math.log2(n)*e,r=2**o/a,l=D({seconds:r}),u=Math.min(o/128,1);return{entropy:o,charsetLength:n,passwordLength:e,crackDurationFormatted:l,secondsToCrack:r,score:u}}function B({password:s}){const a=/[a-z]/.test(s),n=/[A-Z]/.test(s),e=/\d/.test(s),o=/\W|_/.test(s);let r=0;return a&&(r+=26),n&&(r+=26),e&&(r+=10),o&&(r+=32),r}const E={flex:"","flex-col":"","gap-3":""},S={"op-60":""},T={"text-2xl":"","data-test-id":"crack-duration"},V={"flex-1":"","text-right":"","op-60":""},z={"flex-1":"","text-left":""},A={"op-70":""},Q={"font-bold":""},q=f({__name:"password-strength-analyser",setup(s){const{t:a}=k(),n=b(""),e=v(()=>M({password:n.value})),o=v(()=>[{label:a("tools.password-strength-analyser.texts.label-password-length"),value:e.value.passwordLength},{label:a("tools.password-strength-analyser.texts.label-entropy"),value:Math.round(e.value.entropy*100)/100},{label:a("tools.password-strength-analyser.texts.label-character-set-size"),value:e.value.charsetLength},{label:a("tools.password-strength-analyser.texts.label-score"),value:`${Math.round(e.value.score*100)} / 100`}]);return(r,l)=>{const u=F,x=N;return h(),g("div",E,[y(u,{value:i(n),"onUpdate:value":l[0]||(l[0]=p=>U(n)?n.value=p:null),type:"password",placeholder:i(a)("tools.password-strength-analyser.texts.placeholder-enter-a-password"),clearable:"",autofocus:"","raw-text":"","test-id":"password-input"},null,8,["value","placeholder"]),y(x,{"text-center":""},{default:_(()=>[c("div",S,d(i(a)("tools.password-strength-analyser.texts.tag-duration-to-crack-this-password-with-brute-force")),1),c("div",T,d(i(e).crackDurationFormatted),1)]),_:1}),y(x,null,{default:_(()=>[(h(!0),g(I,null,L(i(o),({label:p,value:m})=>(h(),g("div",{key:p,flex:"","gap-3":""},[c("div",V,d(p),1),c("div",z,d(m),1)]))),128))]),_:1}),c("div",A,[c("span",Q,d(i(a)("tools.password-strength-analyser.texts.tag-note")),1),C(d(i(a)("tools.password-strength-analyser.texts.tag-the-computed-strength-is-based-on-the-time-it-would-take-to-crack-the-password-using-a-brute-force-approach-it-does-not-take-into-account-the-possibility-of-a-dictionary-attack")),1)])])}}});export{q as default};
