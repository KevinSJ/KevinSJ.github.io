import{c as E,i as h}from"./style-ynO7IsM1.js";import"./version-BXrBJCm5.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-C6L5gDe0.js";import{a as g,b as w,P as L,h as x,f as k,u as D,r as b,t as P,w as y,v as F,d as S}from"./main-CdZmBCMR.js";import"./mobileMenu-BoMunYmR.js";const o={file:null,pdfDoc:null};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",v):v();function v(){E({icons:h});const n=document.getElementById("file-input"),e=document.getElementById("drop-zone"),t=document.getElementById("back-to-tools"),d=document.getElementById("process-btn");n&&(n.addEventListener("change",T),n.addEventListener("click",()=>{n.value=""})),e&&(e.addEventListener("dragover",a=>{a.preventDefault(),e.classList.add("border-indigo-500")}),e.addEventListener("dragleave",()=>{e.classList.remove("border-indigo-500")}),e.addEventListener("drop",a=>{a.preventDefault(),e.classList.remove("border-indigo-500"),a.dataTransfer?.files.length&&I(a.dataTransfer.files)})),t&&t.addEventListener("click",()=>{window.location.href="/itools/"}),d&&d.addEventListener("click",z),A()}function T(n){const e=n.target;e.files?.length&&I(e.files)}async function I(n){const e=n[0];if(!e||e.type!=="application/pdf"){g("Invalid File","Please upload a valid PDF file.");return}w("Loading PDF...");try{const t=await e.arrayBuffer();o.pdfDoc=await L.load(t),o.file=e,C(),document.getElementById("options-panel")?.classList.remove("hidden")}catch(t){console.error(t),g("Error","Failed to load PDF file.")}finally{x()}}function C(){const n=document.getElementById("file-display-area");if(!n||!o.file||!o.pdfDoc)return;n.innerHTML="";const e=document.createElement("div");e.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg";const t=document.createElement("div");t.className="flex flex-col flex-1 min-w-0";const d=document.createElement("div");d.className="truncate font-medium text-gray-200 text-sm mb-1",d.textContent=o.file.name;const a=document.createElement("div");a.className="text-xs text-gray-400",a.textContent=`${k(o.file.size)} â€¢ ${o.pdfDoc.getPageCount()} pages`,t.append(d,a);const i=document.createElement("button");i.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",i.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',i.onclick=B,e.append(t,i),n.appendChild(e),E({icons:h})}function B(){o.file=null,o.pdfDoc=null;const n=document.getElementById("file-display-area");n&&(n.innerHTML=""),document.getElementById("options-panel")?.classList.add("hidden");const e=document.getElementById("file-input");e&&(e.value="")}function A(){const n=document.querySelectorAll('input[name="watermark-type"]'),e=document.getElementById("text-watermark-options"),t=document.getElementById("image-watermark-options");n.forEach(m=>{m.addEventListener("change",f=>{f.target.value==="text"?(e?.classList.remove("hidden"),t?.classList.add("hidden")):(e?.classList.add("hidden"),t?.classList.remove("hidden"))})});const d=document.getElementById("opacity-text"),a=document.getElementById("opacity-value-text"),i=document.getElementById("angle-text"),u=document.getElementById("angle-value-text");d?.addEventListener("input",()=>{a&&(a.textContent=d.value)}),i?.addEventListener("input",()=>{u&&(u.textContent=i.value)});const l=document.getElementById("opacity-image"),r=document.getElementById("opacity-value-image"),s=document.getElementById("angle-image"),c=document.getElementById("angle-value-image");l?.addEventListener("input",()=>{r&&(r.textContent=l.value)}),s?.addEventListener("input",()=>{c&&(c.textContent=s.value)})}async function z(){if(!o.pdfDoc){g("Error","Please upload a PDF file first.");return}const n=document.querySelector('input[name="watermark-type"]:checked')?.value||"text";w("Adding watermark...");try{const e=o.pdfDoc.getPages();let t=null;if(n==="text")t=await o.pdfDoc.embedFont(D.Helvetica);else{const a=document.getElementById("image-watermark-input").files?.[0];if(!a)throw new Error("Please select an image file for the watermark.");const i=await b(a);if(a.type==="image/png")t=await o.pdfDoc.embedPng(i);else if(a.type==="image/jpeg")t=await o.pdfDoc.embedJpg(i);else throw new Error("Unsupported Image. Please use a PNG or JPG for the watermark.")}for(const a of e){const{width:i,height:u}=a.getSize();if(n==="text"){const l=document.getElementById("watermark-text").value;if(!l.trim())throw new Error("Please enter text for the watermark.");const r=parseInt(document.getElementById("font-size").value)||72,s=parseInt(document.getElementById("angle-text").value)||0,c=parseFloat(document.getElementById("opacity-text").value)||.3,m=document.getElementById("text-color").value,f=P(m),p=t.widthOfTextAtSize(l,r);a.drawText(l,{x:(i-p)/2,y:u/2,font:t,size:r,color:F(f.r,f.g,f.b),opacity:c,rotate:y(s)})}else{const l=parseInt(document.getElementById("angle-image").value)||0,r=parseFloat(document.getElementById("opacity-image").value)||.3,s=.5,c=t.width*s,m=t.height*s;a.drawImage(t,{x:(i-c)/2,y:(u-m)/2,width:c,height:m,opacity:r,rotate:y(l)})}}const d=await o.pdfDoc.save();S(new Blob([new Uint8Array(d)],{type:"application/pdf"}),"watermarked.pdf"),g("Success","Watermark added successfully!","success",()=>{B()})}catch(e){console.error(e),g("Error",e.message||"Could not add the watermark.")}finally{x()}}
