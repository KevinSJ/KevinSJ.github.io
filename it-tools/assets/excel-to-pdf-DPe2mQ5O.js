const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jszip.min-eEAMQJTJ.js","assets/main-CdZmBCMR.js","assets/style-ynO7IsM1.js","assets/style-BjgAlZWF.css","assets/_commonjs-dynamic-modules-TDtrdbi3.js"])))=>i.map(i=>d[i]);
import{c as I,i as D}from"./style-ynO7IsM1.js";import"./version-BXrBJCm5.js";import"./full-width-DliZ98Ur.js";import"./simple-mode-footer-C6L5gDe0.js";import{s as n,a as m,h as u,b as v,d as _,_ as k,f as P}from"./main-CdZmBCMR.js";import{g as T}from"./libreoffice-loader-B7pl3H-_.js";import"./mobileMenu-BoMunYmR.js";document.addEventListener("DOMContentLoaded",()=>{n.files=[];const c=document.getElementById("file-input"),l=document.getElementById("drop-zone"),p=document.getElementById("convert-options"),d=document.getElementById("file-display-area"),f=document.getElementById("file-controls"),y=document.getElementById("add-more-btn"),x=document.getElementById("clear-files-btn"),L=document.getElementById("back-to-tools"),b=document.getElementById("process-btn");L&&L.addEventListener("click",()=>{window.location.href="/itools/"});const g=async()=>{if(p)if(n.files.length>0){if(d){d.innerHTML="";for(let e=0;e<n.files.length;e++){const s=n.files[e],i=document.createElement("div");i.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const o=document.createElement("div");o.className="flex flex-col overflow-hidden";const t=document.createElement("div");t.className="truncate font-medium text-gray-200 text-sm mb-1",t.textContent=s.name;const a=document.createElement("div");a.className="text-xs text-gray-400",a.textContent=P(s.size),o.append(t,a);const r=document.createElement("button");r.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",r.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',r.onclick=()=>{n.files=n.files.filter((w,E)=>E!==e),g()},i.append(o,r),d.appendChild(i)}I({icons:D})}f&&f.classList.remove("hidden"),p.classList.remove("hidden")}else d&&(d.innerHTML=""),f&&f.classList.add("hidden"),p.classList.add("hidden")},h=()=>{n.files=[],n.pdfDoc=null,g()},C=async()=>{try{if(n.files.length===0){m("No Files","Please select at least one Excel file."),u();return}const e=T();if(await e.initialize(s=>{v(s.message,s.percent)}),n.files.length===1){const s=n.files[0];v("Processing...");const i=await e.convertToPdf(s),o=s.name.replace(/\.(xls|xlsx|ods|csv)$/i,"")+".pdf";_(i,o),u(),m("Conversion Complete",`Successfully converted ${s.name} to PDF.`,"success",()=>h())}else{v("Processing...");const s=(await k(async()=>{const{default:t}=await import("./jszip.min-eEAMQJTJ.js").then(a=>a.j);return{default:t}},__vite__mapDeps([0,1,2,3,4]))).default,i=new s;for(let t=0;t<n.files.length;t++){const a=n.files[t];v(`Converting ${t+1}/${n.files.length}: ${a.name}...`);const r=await e.convertToPdf(a),w=a.name.replace(/\.(xls|xlsx|ods|csv)$/i,""),E=await r.arrayBuffer();i.file(`${w}.pdf`,E)}const o=await i.generateAsync({type:"blob"});_(o,"excel-converted.zip"),u(),m("Conversion Complete",`Successfully converted ${n.files.length} Excel file(s) to PDF.`,"success",()=>h())}}catch(e){u(),m("Error",`An error occurred during conversion. Error: ${e.message}`)}},B=e=>{e&&e.length>0&&(n.files=[...n.files,...Array.from(e)],g())};c&&l&&(c.addEventListener("change",e=>{B(e.target.files)}),l.addEventListener("dragover",e=>{e.preventDefault(),l.classList.add("bg-gray-700")}),l.addEventListener("dragleave",e=>{e.preventDefault(),l.classList.remove("bg-gray-700")}),l.addEventListener("drop",e=>{e.preventDefault(),l.classList.remove("bg-gray-700");const s=e.dataTransfer?.files;if(s&&s.length>0){const i=Array.from(s).filter(o=>{const t=o.name.toLowerCase();return t.endsWith(".xls")||t.endsWith(".xlsx")||t.endsWith(".ods")||t.endsWith(".csv")});if(i.length>0){const o=new DataTransfer;i.forEach(t=>o.items.add(t)),B(o.files)}}}),c.addEventListener("click",()=>{c.value=""})),y&&y.addEventListener("click",()=>{c.click()}),x&&x.addEventListener("click",()=>{h()}),b&&b.addEventListener("click",C)});
