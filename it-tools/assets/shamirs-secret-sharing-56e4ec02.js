import{d as pe,a0 as be,r as v,o as O,c as ne,k as h,l as u,m as C,w as y,a6 as M,G as D,j as R,ad as oe,a7 as de,a8 as _e,ae as we,ah as Ae,ai as ve,aj as xe,ag as Ee,af as Se,x as Ie}from"./index-0c1fde36.js";import{_ as Te}from"./InputCopyable.vue_vue_type_script_setup_true_lang-294ac243.js";import{a as se}from"./index-a6f01dde.js";import{_ as Be}from"./FormItem-1b9a5952.js";import{_ as Ne}from"./Space-7fc52151.js";import{_ as Oe}from"./Form-a433c14f.js";import"./context-00991937.js";import"./get-slot-1efb97e5.js";const fe=29,ce=128,I=8,x=2**I,Z=2,Ue=6,w=x-1,V="utf8",G="binary",ke="hex",je={PRIMITIVE_POLYNOMIAL:fe,BIT_PADDING:ce,BIT_COUNT:I,BIT_SIZE:x,MAX_SHARES:w,MAX_BYTES_PER_CHARACTER:Ue,BYTES_PER_CHARACTER:Z,UTF8_ENCODING:V,BIN_ENCODING:G,HEX_ENCODING:ke},ie=new TextEncoder,Ce=new TextDecoder,ae="0123456789abcdef",ue=new Array(256);for(let t=0;t<16;++t){const e=t*16;for(let r=0;r<16;++r)ue[e+r]=ae[t]+ae[r]}const J=64*1024,K=new Set([Int8Array.prototype,Int16Array.prototype,Int32Array.prototype,BigInt64Array.prototype,Uint8Array.prototype,Uint16Array.prototype,Uint32Array.prototype,BigUint64Array.prototype,Float32Array.prototype,Float64Array.prototype]);function Re(t){if(t<0||!Number.isFinite(t)||!Number.isSafeInteger(t))throw new RangeError(`The argument 'byteLength' is invalid: Received ${t}`);return new i(t)}function p(t){return t?t instanceof ArrayBuffer||ArrayBuffer.isView(t)||Array.isArray(t)||typeof t=="object"&&"length"in t&&typeof t.length=="number":!1}function H(t,e=null){if(!p(t))return!1;if(typeof e=="function"&&K.has(e.prototype)){const n=Object.getPrototypeOf(t);return n===e.prototype||e.prototype.isPrototypeOf(n)}const r=Object.getPrototypeOf(t);for(const n of K)if(n===r||n.isPrototypeOf(r))return!0;return!1}function U(t){return t?t.constructor===ArrayBuffer||ArrayBuffer.prototype.isPrototypeOf(Object.getPrototypeOf(t)):!1}function T(t,e="utf8"){if(typeof t=="string")return e==="hex"?t.length>>>1:e==="utf8"?ie.encode(t).byteLength:t.length;if(!p(t))return 0;if("byteLength"in t)return t.byteLength;if("length"in t){for(const r of t)if(!Number.isFinite(r)||!Number.isInteger(r)||!Number.isSafeInteger(r))return 0;return t.length}return 0}function P(t){return p(t)?U(t)?t:H(t)||U(t.buffer)?t.buffer:null:null}function he(...t){if(t.length===0)return null;if(t.length===1&&Array.isArray(t[0]))return he(...t[0]);for(const f of t)if(!p(f))return null;let e,r;const n=t.shift();if(n==null)return null;const s=n.constructor,o=[n].concat(t).map(f=>T(f)).reduce((f,c)=>f+c,0);if(s===ArrayBuffer||ArrayBuffer.prototype.isPrototypeOf(Object.getPrototypeOf(n))){if(r=new s(o),r.byteLength!==o)throw new TypeError("Unable to correctly allocate output buffer");e=new Uint8Array(r)}else if(s===Array||Array.isArray(n)||Array.prototype.isPrototypeOf(Object.getPrototypeOf(n))){if(r=new s(o),T(r)!==o)throw new TypeError("Unable to correctly allocate output buffer");const f=P(r);e=U(f)?new Uint8Array(f):Uint8Array.from(r)}else if(H(n)){if(r=new s(o),r.byteLength!==o)throw new TypeError("Unable to correctly allocate output buffer");const f=P(r);e=new Uint8Array(f)}else{if(r=new s(o),T(r)!==o)throw new TypeError("Unable to correctly allocate output buffer");const f=P(r);e=U(f)?new Uint8Array(f):Uint8Array.from(r)}const l=[n].concat(t);let a=0;for(;l.length;){const f=P(l.shift());if(!f)throw new TypeError("Unable to determine ArrayBuffer in arguments");const c=new Uint8Array(f);e.set(c,a),a+=c.byteLength}return r}function Q(t,e=t.byteOffset||0,r=T(t),n="utf8"){if(typeof t=="string"){if(n==="hex"){r=T(t,"hex");const s=new i(r);for(let o=0;o<t.length;++o){const l=2*o,a=parseInt(t.slice(l,l+2),16);if(Number.isNaN(a))break;s[o]=a}return s}if(n==="base64"){const s=globalThis.atob(t),o=new i(s.length);for(let l=0;l<s.length;++l)o[l]=s.charCodeAt(l);return o}return Q(ie.encode(t))}if(p(t)){const s=P(t);if(U(s))return new i(s,t.byteOffset||e,r)}return Array.isArray(t)?new i(t):new i(0)}function S(t,e,r,n="utf8"){return typeof e=="string"?(n=e,Q(t,0,T(t),n)):Q(t,e||0,r||T(t),n)}function Pe(t,e,r="utf8"){if((t instanceof Uint8Array||Uint8Array.prototype.isPrototypeOf(Object.getPrototypeOf(t)))&&(t=S(t,t.byteOffset,t.byteLength)),(e instanceof Uint8Array||Uint8Array.prototype.isPrototypeOf(Object.getPrototypeOf(e)))&&(e=S(e,e.byteOffset,e.byteLength)),typeof t=="string"&&(t=S(t,r)),typeof e=="string"&&(e=S(e,r)),!p(t)||!p(e))throw new TypeError('Input buffers must be "buffer like"');if(t===e)return 0;U(t)&&(t=S(t)),U(e)&&(e=S(e));let n=t.byteLength,s=e.byteLength;for(let o=0,l=Math.min(n,s);o<l;++o)if(t[o]!==e[o]){n=t[o],s=e[o];break}return n<s?-1:s<n?1:0}function Le(t,e="utf8"){const r=S(t);if(e==="hex"){const n=[];for(let s=0;s<r.byteLength;++s)n.push(ue[r[s]]);return n.join("")}if(e==="base64"){const n=[];for(let s=0;s<r.byteLength;++s)n.push(String.fromCharCode(r[s]));return globalThis.btoa(n.join(""))}return Ce.decode(r)}function $e(t){const e=[];if(typeof globalThis.crypto?.getRandomValues!="function")throw new TypeError("Missing globalThis.crypto.getRandomValues implementation");if(t<=0||!Number.isFinite(t)||!Number.isSafeInteger(t))throw new RangeError(`The argument 'byteLength' is invalid: Received ${t}`);let r=t;do{const n=r>J?J:r,s=globalThis.crypto.getRandomValues(new Int8Array(n)),o=i.from(s);e.push(o),r=Math.max(0,r-J)}while(r>0);return i.concat(e)}class i extends Uint8Array{static alloc=Re;static byteLength=T;static compare=Pe;static concat=he;static from=S;static isBufferLike=p;static random=$e;static get Buffer(){return i}static isBuffer(e){return H(e,this)||H(e,Uint8Array)}get length(){return this.byteLength}toString(e="utf8"){return Le(this,e)}toJSON(){return{type:"Buffer",data:Array.from(this)}}}K.add(i.prototype);const Fe=new Array(4*x).join("0"),k=new Array(x).fill(0),q=new Array(x).fill(0);for(let t=0,e=1;t<x;++t)q[t]=e,k[e]=t,e=e<<1,e>=x&&(e=e^fe,e=e&w);function B(t,e=I){const r=i.from(t).toString();if(e===0)return r;e||(e=I);const n=r?r.length%e:0;if(n){const s=-1*(e-n+r.length);return(Fe+r).slice(s)}return r}function Me(t,e=V){const r=2*Z;if(e||(e=V),typeof t=="string")return n(t);if(p(t))return s(i.from(t));throw new TypeError("Expecting a string or buffer as input.");function n(o){const l=[];if(V===e)for(let a=0;a<o.length;++a){const f=String.fromCharCode(o[a].toString(16)),c=B(f,r);l.unshift(c)}if(G===e){o=B(t,4);for(let a=o.length;a>=4;a-=4){const f=o.slice(a-4,a),c=parseInt(f,2).toString(16);l.unshift(c)}}return l.join("")}function s(o){const l=[];for(let a=0;a<o.length;++a){const f=o[a].toString(16),c=B(f,r);l.unshift(c)}return l.join("")}}function De(t,e=16){const r=[];e||(e=16);const n=i.byteLength(t);for(let s=n-1;s>=0;--s){let o;if(p(t)&&(o=t[s]),typeof t=="string"&&(o=parseInt(t[s],e)),Array.isArray(t)&&(o=t[s],typeof o=="string"&&(o=parseInt(o,e))),o===void 0)throw new TypeError("Unsupported type for chunk in input.");const l=B(o.toString(2),4);r.unshift(l)}return r.join("")}function Ve(t,e){t=typeof t=="number"?t:parseInt(i.from(t).toString(),16);const r=(x-1).toString(16).length,n=i.concat([i.from(I.toString(36).toUpperCase()),i.from(B(t.toString(16),r))]);return p(e)||(e=i.from(e)),i.concat([n,e])}function He(t,e="utf8"){const r=2*Z,n=B(i.from(t).toString(e),r),s=r,o=[];for(let l=0;l<n.length;l+=s){const a=n.slice(l,l+s),f=parseInt(a,16);o.unshift(f)}return i.from(o)}function Ge(t,e=0,r=2){const n=[],s=B(i.from(t).toString(),e);let o=0;for(o=s.length;o>I;o-=I){const l=s.slice(o-I,o),a=parseInt(l,r);n.push(a)}return n.push(parseInt(s.slice(0,o),r)),n}const d={bin:De,decode:He,encode:Ve,hex:Me,pad:B,split:Ge},Ye=x-1;class ze{id=0;bits=0;data="";static from(e=0,r=0,n=null){if(e!==null&&typeof e=="object"){const s=e;return new this(s.id,s.bits||r,s.data||n)}return new this(e||0,r||0,n)}constructor(e=0,r=0,n=null){this.id=typeof e=="number"?e:parseInt(e,16),this.bits=typeof r=="number"?r:parseInt(r,36),this.data=typeof n=="string"?n:""}}function Xe(t){const e=new ze,r=p(t)?i.from(t).toString("hex"):t,n=r[0]==="0"?r.slice(1):r;e.bits=parseInt(n.slice(0,1),36);const o=`^([a-kA-K3-9]{1})([a-fA-F0-9]{${Ye.toString(16).length}})([a-fA-F0-9]+)$`,l=new RegExp(o).exec(n);return l&&l.length&&(e.id=parseInt(l[2],16),e.data=l[3]),e}function Je(t,e){const r=w;let n=0,s=0;for(let o=0;o<e[0].length;++o)if(e[1][o]){n=k[e[1][o]];for(let l=0;l<e[0].length;++l)if(o!==l){if(t===e[0][l]){n=-1;break}const a=k[t^e[0][l]]-k[e[0][o]^e[0][l]];n=(n+a+r)%r}s=s===-1?s:s^q[n]}return s}function Ke(t){const e=[],r=[],n=[],s=t.length;for(let c=0;c<s;++c){const g=Xe(t[c]);if(r.indexOf(g.id)===-1){r.push(g.id);const N=d.bin(g.data,16),L=d.split(N,0,2);for(let E=0;E<L.length;++E)n[E]||(n[E]=[]),n[E][r.length-1]=L[E]}}for(let c=0;c<n.length;++c){const g=Je(0,[r,n[c]]),N=d.pad(g.toString(2));e.unshift(N)}const o=e.join(""),l=o.slice(1+o.indexOf("1")),a=d.hex(l,G),f=d.decode(a);return i.from(f)}const b=new Array(2*w);function Qe(t,e){const r=w,n=e.length-1;let s=0;for(let o=n;o>=0;--o)s=s===0?e[o]:q[(k[t]+k[s])%r]^e[o];return s}function Ze(t,e){const r=e.random,n=[t],s=[],o=e.threshold,l=e.shares;for(let a=1;a<o;++a)n[a]=parseInt(r(1).toString("hex"),16);for(let a=1;a<1+l;++a)s[a-1]={x:a,y:Qe(a,n)};return s}function qe(t,e){if(!t)throw new TypeError("An input secret must be provided");const r=i.from(t);if(r.byteLength===0)throw new TypeError("Secret cannot be empty");if(!e||typeof e!="object")throw new TypeError("Expecting options to be an object.");if("shares"in e&&typeof e.shares!="number")throw new TypeError("Expecting shares to be a number.");if("threshold"in e&&typeof e.threshold!="number")throw new TypeError("Expecting threshold to be a number.");if(!Number.isFinite(e.shares)||!Number.isInteger(e.shares)||!Number.isSafeInteger(e.shares))throw new RangeError("Expecting shares to be a positive integer");if(!Number.isFinite(e.threshold)||!Number.isInteger(e.threshold)||!Number.isSafeInteger(e.threshold))throw new RangeError("Expecting threshold to be a positive integer");if(e.shares<=0||e.shares>w)throw new RangeError(`Shares must be 0 < shares <= ${w}.`);if(e.threshold<=0||e.threshold>e.shares)throw new RangeError(`Threshold must be 0 < threshold <= ${e.shares}.`);if(e={...e},"random"in e||(e.random=i.random),typeof e.random!="function")throw new TypeError("Expecting random to be a function");const n=d.hex(r),s=d.bin(n,16),o=d.split("1"+s,ce,2);for(let a=0;a<o.length;++a){const f=Ze(o[a],{shares:e.shares,threshold:e.threshold,random:e.random});for(let c=0;c<e.shares;++c){b[c]||(b[c]=f[c].x.toString(16));const g=f[c].y.toString(2),N=b[c+w]||"";b[c+w]=d.pad(g)+N}}for(let a=0;a<e.shares;++a){const f=b[a],c=d.hex(b[a+w],G);b[a]=d.encode(f,c),b[a]=i.from("0"+b[a],"hex")}const l=b.slice(0,e.shares);return b.fill(0),l}const le={Buffer:i,combine:Ke,constants:je,split:qe},lt=pe({__name:"shamirs-secret-sharing",setup(t){const{t:e}=be(),r=v(""),n=v("utf8"),s=v([]),o=v(""),l=v(2),a=v(3),f=v(""),c=v(""),g=v(""),N=[{value:"utf8",label:e("tools.shamirs-secret-sharing.texts.label-text")},{value:"hex",label:e("tools.shamirs-secret-sharing.texts.label-hexadecimal")},{value:"base64",label:e("tools.shamirs-secret-sharing.texts.label-base64")}];function L(){if(!r.value){s.value=[];return}o.value="";try{const A=se.from(r.value,n.value);if(A.length===0)throw new Error(`Cannot convert "${r.value}" to ${n.value}`);const m=le.split(A,{shares:a.value,threshold:l.value});s.value=m.map(j=>j.toString("hex"))}catch(A){o.value=A.toString()}}function E(){g.value="";try{const A=f.value.split(`
`).map(j=>{const $=se.from(j,"hex");if($.length===0)throw new Error(`Cannot convert "${r.value}" to ${n.value}`);return $}),m=le.combine(A);c.value=m.toString(n.value)}catch(A){g.value=A.toString()}}return(A,m)=>{const j=we,$=Ae,Y=Be,W=ve,z=Ne,ee=xe,ye=Oe,te=Ee,re=Te,F=Se,me=Ie;return O(),ne("div",null,[h(j,{value:u(n),"onUpdate:value":m[0]||(m[0]=_=>C(n)?n.value=_:null),label:u(e)("tools.shamirs-secret-sharing.texts.label-secret-mode"),"label-position":"left",options:N,"mb-2":""},null,8,["value","label"]),h(F,{title:u(e)("tools.shamirs-secret-sharing.texts.title-share-a-secret-split")},{default:y(()=>[h(ye,{"label-placement":"left"},{default:y(()=>[h(Y,{label:u(e)("tools.shamirs-secret-sharing.texts.label-secret")},{default:y(()=>[h($,{value:u(r),"onUpdate:value":m[1]||(m[1]=_=>C(r)?r.value=_:null),placeholder:u(e)("tools.shamirs-secret-sharing.texts.placeholder-enter-secret-text")},null,8,["value","placeholder"])]),_:1},8,["label"]),h(z,{justify:"center"},{default:y(()=>[h(Y,{label:u(e)("tools.shamirs-secret-sharing.texts.label-threshold-minimum-shares-to-recover")},{default:y(()=>[h(W,{value:u(l),"onUpdate:value":m[2]||(m[2]=_=>C(l)?l.value=_:null),min:2},null,8,["value"])]),_:1},8,["label"]),h(Y,{label:u(e)("tools.shamirs-secret-sharing.texts.label-number-of-shares")},{default:y(()=>[h(W,{value:u(a),"onUpdate:value":m[3]||(m[3]=_=>C(a)?a.value=_:null),min:2},null,8,["value"])]),_:1},8,["label"])]),_:1}),h(z,{justify:"center"},{default:y(()=>[h(ee,{type:"primary",onClick:L},{default:y(()=>[M(D(u(e)("tools.shamirs-secret-sharing.texts.tag-split-secret")),1)]),_:1})]),_:1})]),_:1}),u(o)?(O(),R(te,{key:0},{default:y(()=>[M(D(u(o)),1)]),_:1})):oe("",!0),!u(o)&&u(s).length?(O(),R(F,{key:1,title:u(e)("tools.shamirs-secret-sharing.texts.title-generated-shares")},{default:y(()=>[(O(!0),ne(de,null,_e(u(s),(_,X)=>(O(),R(re,{key:X,value:u(s)[X],"onUpdate:value":ge=>u(s)[X]=ge,readonly:"","mb-1":""},null,8,["value","onUpdate:value"]))),128))]),_:1},8,["title"])):oe("",!0)]),_:1},8,["title"]),h(F,{title:u(e)("tools.shamirs-secret-sharing.texts.title-recombine-a-secret")},{default:y(()=>[h(me,{value:u(f),"onUpdate:value":m[4]||(m[4]=_=>C(f)?f.value=_:null),label:u(e)("tools.shamirs-secret-sharing.texts.label-your-shares"),placeholder:u(e)("tools.shamirs-secret-sharing.texts.placeholder-paste-your-shares-here"),rows:"5",multiline:"","mb-2":""},null,8,["value","label","placeholder"]),h(z,{justify:"center"},{default:y(()=>[h(ee,{type:"success",onClick:E},{default:y(()=>[M(D(u(e)("tools.shamirs-secret-sharing.texts.tag-recombine")),1)]),_:1})]),_:1}),u(g)?(O(),R(te,{key:1},{default:y(()=>[M(D(u(g)),1)]),_:1})):(O(),R(F,{key:0,title:u(e)("tools.shamirs-secret-sharing.texts.title-recombined-secret")},{default:y(()=>[h(re,{value:u(c),readonly:""},null,8,["value"])]),_:1},8,["title"]))]),_:1},8,["title"])])}}});export{lt as default};
