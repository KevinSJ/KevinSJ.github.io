import{d as N,a0 as V,ac as k,i as T,o as u,c as d,k as l,l as t,m as S,j as B,w as c,a6 as $,G as j,ad as h,a as r,a7 as R,a8 as M,x as F,ag as L,af as U}from"./index-0c1fde36.js";import{l as y}from"./index-d58a7f66.js";import{a as E}from"./index-a5958021.js";import{_ as p}from"./SpanCopyable.vue_vue_type_script_setup_true_lang-8d5870e2.js";import{_ as G}from"./TextareaCopyable-59231e95.js";import{_ as O}from"./Divider-5fc425b0.js";import{_ as P}from"./FormItem-1b9a5952.js";import{_ as Q}from"./Table-4b7ecda9.js";import"./index-0898812d.js";import"./base64-ae7cf34b.js";import"./index-a6f01dde.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./context-00991937.js";function C(_){const a=_.convertToSubnet();return a?{cidr:a.toString(),start:a.getFirst().toString(),end:a.getLast().toString()}:{cidr:_.toString(),start:"",end:""}}function q({allowedRanges:_,disallowedRanges:a}){try{const s=_.split(/\s*[,;|]+\s*/g).filter(e=>e).flatMap(e=>y.getMatch(e)?.convertToMasks()||[]),i=a.split(/\s*[,;|]+\s*/g).filter(e=>e).flatMap(e=>y.getMatch(e)?.convertToMasks()||[]),o=s.map(C),m=i.map(C);return{error:"",allowedSubnets:o,disallowedSubnets:m,allowedCIDRs:E(o.map(e=>e.cidr),m.map(e=>e.cidr))}}catch(s){return{error:s.toString(),allowedSubnets:[],disallowedSubnets:[],allowedCIDRs:[]}}}const z={key:1},A={"font-bold":""},H={"font-bold":""},ce=N({__name:"ip-include-exclude",setup(_){const{t:a}=V(),s=k({name:"allow",storageName:"ip-inc-exc:allow",defaultValue:"192.168.0.1/24"}),i=k({name:"disallow",storageName:"ip-inc-exc:disallow",defaultValue:"192.168.0.6"}),o=T(()=>q({allowedRanges:s.value,disallowedRanges:i.value}));return(m,e)=>{const g=F,w=O,D=L,I=P,b=Q,x=U;return u(),d("div",null,[l(g,{value:t(s),"onUpdate:value":e[0]||(e[0]=n=>S(s)?s.value=n:null),label:t(a)("tools.ip-include-exclude.texts.label-allowedips-ipv4-6-cidr-range-mask-wildcard"),placeholder:t(a)("tools.ip-include-exclude.texts.placeholder-an-ipv4-6-cidr-range-mask-wildcard"),"mb-4":""},null,8,["value","label","placeholder"]),l(g,{value:t(i),"onUpdate:value":e[1]||(e[1]=n=>S(i)?i.value=n:null),label:t(a)("tools.ip-include-exclude.texts.label-disallowedips-ipv4-6-cidr-range-mask-wildcard"),placeholder:t(a)("tools.ip-include-exclude.texts.placeholder-an-ipv4-6-cidr-range-mask-wildcard"),"mb-4":""},null,8,["value","label","placeholder"]),l(w),t(o).error?(u(),B(D,{key:0},{default:c(()=>[$(j(t(o).error),1)]),_:1})):h("",!0),t(o).error?h("",!0):(u(),d("div",z,[l(I,{label:t(a)("tools.ip-include-exclude.texts.label-final-allowedips")},{default:c(()=>[l(G,{value:t(o).allowedCIDRs.join(", ")},null,8,["value"])]),_:1},8,["label"]),l(w),l(x,{title:t(a)("tools.ip-include-exclude.texts.title-allowed-subnets")},{default:c(()=>[l(b,null,{default:c(()=>[r("tbody",null,[(u(!0),d(R,null,M(t(o).allowedSubnets,({cidr:n,start:v,end:f})=>(u(),d("tr",{key:n},[r("td",A,[l(p,{value:n},null,8,["value"])]),r("td",null,[l(p,{value:v},null,8,["value"])]),r("td",null,[l(p,{value:f},null,8,["value"])])]))),128))])]),_:1})]),_:1},8,["title"]),l(x,{title:t(a)("tools.ip-include-exclude.texts.title-disallowed-subnets")},{default:c(()=>[l(b,null,{default:c(()=>[r("tbody",null,[(u(!0),d(R,null,M(t(o).disallowedSubnets,({cidr:n,start:v,end:f})=>(u(),d("tr",{key:n},[r("td",H,[l(p,{value:n},null,8,["value"])]),r("td",null,[l(p,{value:v},null,8,["value"])]),r("td",null,[l(p,{value:f},null,8,["value"])])]))),128))])]),_:1})]),_:1},8,["title"])]))])}}});export{ce as default};
