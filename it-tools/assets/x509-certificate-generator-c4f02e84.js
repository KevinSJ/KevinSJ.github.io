import{d as V,a0 as B,r as m,R as D,o as A,c as C,a as n,k as a,w as s,l as e,m as p,a6 as T,G as h,ad as $,ah as H,ai as I,s as F}from"./index-0c1fde36.js";import{l as d}from"./index-20485d98.js";import{g as O,t as G,a as L}from"./crypto-51584306.js";import{_ as U}from"./TextareaCopyable-59231e95.js";import{a as q}from"./defaults-4d6daddf.js";import{c as J}from"./computedRefreshable-6ca60894.js";import{_ as M}from"./FormItem-1b9a5952.js";import{_ as Q}from"./Divider-5fc425b0.js";import"./index-a6f01dde.js";import"./index-892bd980.js";import"./browser-703720a1.js";import"./index-649b5bab.js";import"./inherits_browser-6f38ab1b.js";import"./index-0397ab6f.js";import"./index-fdbe2ce9.js";import"./string_decoder-8ac4312e.js";import"./hash-f152040d.js";import"./index-4bc05a7f.js";import"./index-e6f9cbd8.js";import"./index-5fa9e804.js";import"./prime.worker.min-a8ac05bb.js";import"./base64-ae7cf34b.js";import"./downloadBase64-508288e2.js";import"./index-6fddb70d.js";import"./index-cfd4d427.js";import"./Copy-ef9ec73c.js";import"./Scrollbar-54724e22.js";import"./context-00991937.js";async function W(i={}){const{privateKey:t,publicKey:f}=await O(i),r=d.pki.createCertificate();r.serialNumber=G(d.util.bytesToHex(d.random.getBytesSync(9))),r.validity.notBefore=new Date,r.validity.notAfter=new Date,r.validity.notAfter.setDate(r.validity.notBefore.getDate()+(i.days||365));const u=[{name:"commonName",value:i.commonName},{name:"countryName",value:i.countryName},{name:"stateOrProvinceName",value:i.state},{name:"localityName",value:i.city},{name:"organizationName",value:i.organizationName},{name:"organizationalUnitName",value:i.organizationalUnit},{name:"emailAddress",value:i.contactEmail}].filter(g=>g.value!==null&&g.value?.trim()!=="");r.setSubject(u),r.setIssuer(u);const b=[{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0}],x=L(i.subjectAlternativeNames);x&&b.push(x),b.length&&r.setExtensions(b),r.publicKey=f,r.sign(t);const y=d.md.sha1.create().update(d.asn1.toDer(d.pki.certificateToAsn1(r)).getBytes()).digest().toHex().match(/.{2}/g)?.join(":")??"",_=d.pki.privateKeyToPem(t);return{fingerprint:y,certificatePem:d.pki.certificateToPem(r),publicKeyPem:d.pki.publicKeyToPem(f),privateKeyPem:i?.password?d.pki.encryptRsaPrivateKey(t,i?.password):_}}const X={"mb-2":""},Y={flex:"","justify-center":""},Z={key:0},ze=V({__name:"x509-certificate-generator",setup(i){const{t}=B(),f=m("test.com"),r=D({source:f,rules:[{message:t("tools.x509-certificate-generator.texts.message-common-name-domain-name-must-not-be-empty"),validator:z=>z?.trim()!==""}]}),u=m("Test"),b=m(""),x=m(365),y=m(""),_=m("Paris"),g=m("FR"),w=m("France"),N=m(""),k=m(""),K={certificatePem:"",privateKeyPem:"",publicKeyPem:"",fingerprint:""},[P,S]=J(()=>q(()=>r.isValid?W({password:y.value,commonName:f.value,countryName:w.value,city:_.value,state:g.value,organizationName:u.value,organizationalUnit:b.value,contactEmail:N.value,subjectAlternativeNames:k.value,days:x.value}):K,K),K);return(z,l)=>{const v=H,c=M,E=I,j=F,R=Q;return A(),C("div",null,[n("div",X,[a(c,{label:e(t)("tools.x509-certificate-generator.texts.label-common-name-domain-name"),"label-placement":"top",feedback:e(r).message,"validation-status":e(r).status},{default:s(()=>[a(v,{value:e(f),"onUpdate:value":l[0]||(l[0]=o=>p(f)?f.value=o:null),placeholder:e(t)("tools.x509-certificate-generator.texts.placeholder-common-domain-name")},null,8,["value","placeholder"])]),_:1},8,["label","feedback","validation-status"])]),n("div",null,[a(c,{label:e(t)("tools.x509-certificate-generator.texts.label-duration-days"),"label-placement":"left","label-width":"100"},{default:s(()=>[a(E,{value:e(x),"onUpdate:value":l[1]||(l[1]=o=>p(x)?x.value=o:null),placeholder:e(t)("tools.x509-certificate-generator.texts.placeholder-duration-days"),min:1},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(t)("tools.x509-certificate-generator.texts.label-organization-name"),"label-placement":"left","label-width":"100"},{default:s(()=>[a(v,{value:e(u),"onUpdate:value":l[2]||(l[2]=o=>p(u)?u.value=o:null),placeholder:e(t)("tools.x509-certificate-generator.texts.placeholder-organization-name")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(t)("tools.x509-certificate-generator.texts.label-organizational-unit"),"label-placement":"left","label-width":"100"},{default:s(()=>[a(v,{value:e(b),"onUpdate:value":l[3]||(l[3]=o=>p(b)?b.value=o:null),placeholder:e(t)("tools.x509-certificate-generator.texts.placeholder-organization-unit")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(t)("tools.x509-certificate-generator.texts.label-state"),"label-placement":"left","label-width":"100"},{default:s(()=>[a(v,{value:e(g),"onUpdate:value":l[4]||(l[4]=o=>p(g)?g.value=o:null),placeholder:e(t)("tools.x509-certificate-generator.texts.placeholder-state")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(t)("tools.x509-certificate-generator.texts.label-city"),"label-placement":"left","label-width":"100"},{default:s(()=>[a(v,{value:e(_),"onUpdate:value":l[5]||(l[5]=o=>p(_)?_.value=o:null),placeholder:e(t)("tools.x509-certificate-generator.texts.placeholder-city")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(t)("tools.x509-certificate-generator.texts.label-country"),"label-placement":"left","label-width":"100"},{default:s(()=>[a(v,{value:e(w),"onUpdate:value":l[6]||(l[6]=o=>p(w)?w.value=o:null),placeholder:e(t)("tools.x509-certificate-generator.texts.placeholder-country")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(t)("tools.x509-certificate-generator.texts.label-contact-email"),"label-placement":"left","label-width":"100"},{default:s(()=>[a(v,{value:e(N),"onUpdate:value":l[7]||(l[7]=o=>p(N)?N.value=o:null),placeholder:e(t)("tools.x509-certificate-generator.texts.placeholder-contact-email")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(t)("tools.x509-certificate-generator.texts.label-subject-alternative-names"),"label-placement":"top"},{default:s(()=>[a(v,{value:e(k),"onUpdate:value":l[8]||(l[8]=o=>p(k)?k.value=o:null),placeholder:e(t)("tools.x509-certificate-generator.texts.placeholder-dns-names-emails-ip-uri"),type:"textarea"},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",null,[a(c,{label:e(t)("tools.x509-certificate-generator.texts.label-private-key-passphrase"),"label-placement":"top"},{default:s(()=>[a(v,{value:e(y),"onUpdate:value":l[9]||(l[9]=o=>p(y)?y.value=o:null),type:"password","show-password-on":"mousedown",placeholder:e(t)("tools.x509-certificate-generator.texts.placeholder-passphrase")},null,8,["value","placeholder"])]),_:1},8,["label"])]),n("div",Y,[a(j,{onClick:e(S)},{default:s(()=>[T(h(e(t)("tools.x509-certificate-generator.texts.tag-refresh-certificate")),1)]),_:1},8,["onClick"])]),a(R),e(r).isValid?(A(),C("div",Z,[n("div",null,[n("h3",null,h(e(t)("tools.x509-certificate-generator.texts.tag-certificate-pem")),1),a(U,{value:e(P).certificatePem,"download-file-name":`${e(u)}.crt`},null,8,["value","download-file-name"])]),n("div",null,[n("h3",null,h(e(t)("tools.x509-certificate-generator.texts.tag-fingerprint")),1),a(U,{value:e(P).fingerprint,"word-wrap":""},null,8,["value"])]),n("div",null,[n("h3",null,h(e(t)("tools.x509-certificate-generator.texts.tag-public-key")),1),a(U,{value:e(P).publicKeyPem,"word-wrap":"","download-file-name":`${e(u)}.pem`},null,8,["value","download-file-name"])]),n("div",null,[n("h3",null,h(e(t)("tools.x509-certificate-generator.texts.tag-private-key")),1),a(U,{value:e(P).privateKeyPem,"download-file-name":`${e(u)}.key`},null,8,["value","download-file-name"])])])):$("",!0)])}}});export{ze as default};
